[{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\dev-dist\\registerSW.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\dev-dist\\sw.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\dev-dist\\workbox-5a5d9309.js","messages":[{"ruleId":"@typescript-eslint/ban-types","message":"Definition for rule '@typescript-eslint/ban-types' was not found.","line":69,"column":7,"endLine":69,"endColumn":63,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/ban-types","message":"Definition for rule '@typescript-eslint/ban-types' was not found.","line":436,"column":5,"endLine":436,"endColumn":61,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-member-access","message":"Definition for rule '@typescript-eslint/no-unsafe-member-access' was not found.","line":769,"column":11,"endLine":769,"endColumn":81,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-assignment","message":"Definition for rule '@typescript-eslint/no-unsafe-assignment' was not found.","line":771,"column":13,"endLine":771,"endColumn":80,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-assignment","message":"Definition for rule '@typescript-eslint/no-unsafe-assignment' was not found.","line":965,"column":11,"endLine":965,"endColumn":78,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-assignment","message":"Definition for rule '@typescript-eslint/no-unsafe-assignment' was not found.","line":981,"column":13,"endLine":981,"endColumn":80,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/ban-types","message":"Definition for rule '@typescript-eslint/ban-types' was not found.","line":1665,"column":5,"endLine":1665,"endColumn":61,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-return","message":"Definition for rule '@typescript-eslint/no-unsafe-return' was not found.","line":2793,"column":9,"endLine":2793,"endColumn":72,"severity":2,"nodeType":null},{"ruleId":"@typescript-eslint/no-unsafe-return","message":"Definition for rule '@typescript-eslint/no-unsafe-return' was not found.","line":2840,"column":9,"endLine":2840,"endColumn":72,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"define(['exports'], (function (exports) { 'use strict';\n\n    // @ts-ignore\n    try {\n      self['workbox:core:7.3.0'] && _();\n    } catch (e) {}\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Claim any currently available clients once the service worker\n     * becomes active. This is normally used in conjunction with `skipWaiting()`.\n     *\n     * @memberof workbox-core\n     */\n    function clientsClaim() {\n      self.addEventListener('activate', () => self.clients.claim());\n    }\n\n    /*\n      Copyright 2019 Google LLC\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const logger = (() => {\n      // Don't overwrite this value if it's already set.\n      // See https://github.com/GoogleChrome/workbox/pull/2284#issuecomment-560470923\n      if (!('__WB_DISABLE_DEV_LOGS' in globalThis)) {\n        self.__WB_DISABLE_DEV_LOGS = false;\n      }\n      let inGroup = false;\n      const methodToColorMap = {\n        debug: `#7f8c8d`,\n        log: `#2ecc71`,\n        warn: `#f39c12`,\n        error: `#c0392b`,\n        groupCollapsed: `#3498db`,\n        groupEnd: null // No colored prefix on groupEnd\n      };\n      const print = function (method, args) {\n        if (self.__WB_DISABLE_DEV_LOGS) {\n          return;\n        }\n        if (method === 'groupCollapsed') {\n          // Safari doesn't print all console.groupCollapsed() arguments:\n          // https://bugs.webkit.org/show_bug.cgi?id=182754\n          if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\n            console[method](...args);\n            return;\n          }\n        }\n        const styles = [`background: ${methodToColorMap[method]}`, `border-radius: 0.5em`, `color: white`, `font-weight: bold`, `padding: 2px 0.5em`];\n        // When in a group, the workbox prefix is not displayed.\n        const logPrefix = inGroup ? [] : ['%cworkbox', styles.join(';')];\n        console[method](...logPrefix, ...args);\n        if (method === 'groupCollapsed') {\n          inGroup = true;\n        }\n        if (method === 'groupEnd') {\n          inGroup = false;\n        }\n      };\n      // eslint-disable-next-line @typescript-eslint/ban-types\n      const api = {};\n      const loggerMethods = Object.keys(methodToColorMap);\n      for (const key of loggerMethods) {\n        const method = key;\n        api[method] = (...args) => {\n          print(method, args);\n        };\n      }\n      return api;\n    })();\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const messages = {\n      'invalid-value': ({\n        paramName,\n        validValueDescription,\n        value\n      }) => {\n        if (!paramName || !validValueDescription) {\n          throw new Error(`Unexpected input to 'invalid-value' error.`);\n        }\n        return `The '${paramName}' parameter was given a value with an ` + `unexpected value. ${validValueDescription} Received a value of ` + `${JSON.stringify(value)}.`;\n      },\n      'not-an-array': ({\n        moduleName,\n        className,\n        funcName,\n        paramName\n      }) => {\n        if (!moduleName || !className || !funcName || !paramName) {\n          throw new Error(`Unexpected input to 'not-an-array' error.`);\n        }\n        return `The parameter '${paramName}' passed into ` + `'${moduleName}.${className}.${funcName}()' must be an array.`;\n      },\n      'incorrect-type': ({\n        expectedType,\n        paramName,\n        moduleName,\n        className,\n        funcName\n      }) => {\n        if (!expectedType || !paramName || !moduleName || !funcName) {\n          throw new Error(`Unexpected input to 'incorrect-type' error.`);\n        }\n        const classNameStr = className ? `${className}.` : '';\n        return `The parameter '${paramName}' passed into ` + `'${moduleName}.${classNameStr}` + `${funcName}()' must be of type ${expectedType}.`;\n      },\n      'incorrect-class': ({\n        expectedClassName,\n        paramName,\n        moduleName,\n        className,\n        funcName,\n        isReturnValueProblem\n      }) => {\n        if (!expectedClassName || !moduleName || !funcName) {\n          throw new Error(`Unexpected input to 'incorrect-class' error.`);\n        }\n        const classNameStr = className ? `${className}.` : '';\n        if (isReturnValueProblem) {\n          return `The return value from ` + `'${moduleName}.${classNameStr}${funcName}()' ` + `must be an instance of class ${expectedClassName}.`;\n        }\n        return `The parameter '${paramName}' passed into ` + `'${moduleName}.${classNameStr}${funcName}()' ` + `must be an instance of class ${expectedClassName}.`;\n      },\n      'missing-a-method': ({\n        expectedMethod,\n        paramName,\n        moduleName,\n        className,\n        funcName\n      }) => {\n        if (!expectedMethod || !paramName || !moduleName || !className || !funcName) {\n          throw new Error(`Unexpected input to 'missing-a-method' error.`);\n        }\n        return `${moduleName}.${className}.${funcName}() expected the ` + `'${paramName}' parameter to expose a '${expectedMethod}' method.`;\n      },\n      'add-to-cache-list-unexpected-type': ({\n        entry\n      }) => {\n        return `An unexpected entry was passed to ` + `'workbox-precaching.PrecacheController.addToCacheList()' The entry ` + `'${JSON.stringify(entry)}' isn't supported. You must supply an array of ` + `strings with one or more characters, objects with a url property or ` + `Request objects.`;\n      },\n      'add-to-cache-list-conflicting-entries': ({\n        firstEntry,\n        secondEntry\n      }) => {\n        if (!firstEntry || !secondEntry) {\n          throw new Error(`Unexpected input to ` + `'add-to-cache-list-duplicate-entries' error.`);\n        }\n        return `Two of the entries passed to ` + `'workbox-precaching.PrecacheController.addToCacheList()' had the URL ` + `${firstEntry} but different revision details. Workbox is ` + `unable to cache and version the asset correctly. Please remove one ` + `of the entries.`;\n      },\n      'plugin-error-request-will-fetch': ({\n        thrownErrorMessage\n      }) => {\n        if (!thrownErrorMessage) {\n          throw new Error(`Unexpected input to ` + `'plugin-error-request-will-fetch', error.`);\n        }\n        return `An error was thrown by a plugins 'requestWillFetch()' method. ` + `The thrown error message was: '${thrownErrorMessage}'.`;\n      },\n      'invalid-cache-name': ({\n        cacheNameId,\n        value\n      }) => {\n        if (!cacheNameId) {\n          throw new Error(`Expected a 'cacheNameId' for error 'invalid-cache-name'`);\n        }\n        return `You must provide a name containing at least one character for ` + `setCacheDetails({${cacheNameId}: '...'}). Received a value of ` + `'${JSON.stringify(value)}'`;\n      },\n      'unregister-route-but-not-found-with-method': ({\n        method\n      }) => {\n        if (!method) {\n          throw new Error(`Unexpected input to ` + `'unregister-route-but-not-found-with-method' error.`);\n        }\n        return `The route you're trying to unregister was not  previously ` + `registered for the method type '${method}'.`;\n      },\n      'unregister-route-route-not-registered': () => {\n        return `The route you're trying to unregister was not previously ` + `registered.`;\n      },\n      'queue-replay-failed': ({\n        name\n      }) => {\n        return `Replaying the background sync queue '${name}' failed.`;\n      },\n      'duplicate-queue-name': ({\n        name\n      }) => {\n        return `The Queue name '${name}' is already being used. ` + `All instances of backgroundSync.Queue must be given unique names.`;\n      },\n      'expired-test-without-max-age': ({\n        methodName,\n        paramName\n      }) => {\n        return `The '${methodName}()' method can only be used when the ` + `'${paramName}' is used in the constructor.`;\n      },\n      'unsupported-route-type': ({\n        moduleName,\n        className,\n        funcName,\n        paramName\n      }) => {\n        return `The supplied '${paramName}' parameter was an unsupported type. ` + `Please check the docs for ${moduleName}.${className}.${funcName} for ` + `valid input types.`;\n      },\n      'not-array-of-class': ({\n        value,\n        expectedClass,\n        moduleName,\n        className,\n        funcName,\n        paramName\n      }) => {\n        return `The supplied '${paramName}' parameter must be an array of ` + `'${expectedClass}' objects. Received '${JSON.stringify(value)},'. ` + `Please check the call to ${moduleName}.${className}.${funcName}() ` + `to fix the issue.`;\n      },\n      'max-entries-or-age-required': ({\n        moduleName,\n        className,\n        funcName\n      }) => {\n        return `You must define either config.maxEntries or config.maxAgeSeconds` + `in ${moduleName}.${className}.${funcName}`;\n      },\n      'statuses-or-headers-required': ({\n        moduleName,\n        className,\n        funcName\n      }) => {\n        return `You must define either config.statuses or config.headers` + `in ${moduleName}.${className}.${funcName}`;\n      },\n      'invalid-string': ({\n        moduleName,\n        funcName,\n        paramName\n      }) => {\n        if (!paramName || !moduleName || !funcName) {\n          throw new Error(`Unexpected input to 'invalid-string' error.`);\n        }\n        return `When using strings, the '${paramName}' parameter must start with ` + `'http' (for cross-origin matches) or '/' (for same-origin matches). ` + `Please see the docs for ${moduleName}.${funcName}() for ` + `more info.`;\n      },\n      'channel-name-required': () => {\n        return `You must provide a channelName to construct a ` + `BroadcastCacheUpdate instance.`;\n      },\n      'invalid-responses-are-same-args': () => {\n        return `The arguments passed into responsesAreSame() appear to be ` + `invalid. Please ensure valid Responses are used.`;\n      },\n      'expire-custom-caches-only': () => {\n        return `You must provide a 'cacheName' property when using the ` + `expiration plugin with a runtime caching strategy.`;\n      },\n      'unit-must-be-bytes': ({\n        normalizedRangeHeader\n      }) => {\n        if (!normalizedRangeHeader) {\n          throw new Error(`Unexpected input to 'unit-must-be-bytes' error.`);\n        }\n        return `The 'unit' portion of the Range header must be set to 'bytes'. ` + `The Range header provided was \"${normalizedRangeHeader}\"`;\n      },\n      'single-range-only': ({\n        normalizedRangeHeader\n      }) => {\n        if (!normalizedRangeHeader) {\n          throw new Error(`Unexpected input to 'single-range-only' error.`);\n        }\n        return `Multiple ranges are not supported. Please use a  single start ` + `value, and optional end value. The Range header provided was ` + `\"${normalizedRangeHeader}\"`;\n      },\n      'invalid-range-values': ({\n        normalizedRangeHeader\n      }) => {\n        if (!normalizedRangeHeader) {\n          throw new Error(`Unexpected input to 'invalid-range-values' error.`);\n        }\n        return `The Range header is missing both start and end values. At least ` + `one of those values is needed. The Range header provided was ` + `\"${normalizedRangeHeader}\"`;\n      },\n      'no-range-header': () => {\n        return `No Range header was found in the Request provided.`;\n      },\n      'range-not-satisfiable': ({\n        size,\n        start,\n        end\n      }) => {\n        return `The start (${start}) and end (${end}) values in the Range are ` + `not satisfiable by the cached response, which is ${size} bytes.`;\n      },\n      'attempt-to-cache-non-get-request': ({\n        url,\n        method\n      }) => {\n        return `Unable to cache '${url}' because it is a '${method}' request and ` + `only 'GET' requests can be cached.`;\n      },\n      'cache-put-with-no-response': ({\n        url\n      }) => {\n        return `There was an attempt to cache '${url}' but the response was not ` + `defined.`;\n      },\n      'no-response': ({\n        url,\n        error\n      }) => {\n        let message = `The strategy could not generate a response for '${url}'.`;\n        if (error) {\n          message += ` The underlying error is ${error}.`;\n        }\n        return message;\n      },\n      'bad-precaching-response': ({\n        url,\n        status\n      }) => {\n        return `The precaching request for '${url}' failed` + (status ? ` with an HTTP status of ${status}.` : `.`);\n      },\n      'non-precached-url': ({\n        url\n      }) => {\n        return `createHandlerBoundToURL('${url}') was called, but that URL is ` + `not precached. Please pass in a URL that is precached instead.`;\n      },\n      'add-to-cache-list-conflicting-integrities': ({\n        url\n      }) => {\n        return `Two of the entries passed to ` + `'workbox-precaching.PrecacheController.addToCacheList()' had the URL ` + `${url} with different integrity values. Please remove one of them.`;\n      },\n      'missing-precache-entry': ({\n        cacheName,\n        url\n      }) => {\n        return `Unable to find a precached response in ${cacheName} for ${url}.`;\n      },\n      'cross-origin-copy-response': ({\n        origin\n      }) => {\n        return `workbox-core.copyResponse() can only be used with same-origin ` + `responses. It was passed a response with origin ${origin}.`;\n      },\n      'opaque-streams-source': ({\n        type\n      }) => {\n        const message = `One of the workbox-streams sources resulted in an ` + `'${type}' response.`;\n        if (type === 'opaqueredirect') {\n          return `${message} Please do not use a navigation request that results ` + `in a redirect as a source.`;\n        }\n        return `${message} Please ensure your sources are CORS-enabled.`;\n      }\n    };\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const generatorFunction = (code, details = {}) => {\n      const message = messages[code];\n      if (!message) {\n        throw new Error(`Unable to find message for code '${code}'.`);\n      }\n      return message(details);\n    };\n    const messageGenerator = generatorFunction;\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Workbox errors should be thrown with this class.\n     * This allows use to ensure the type easily in tests,\n     * helps developers identify errors from workbox\n     * easily and allows use to optimise error\n     * messages correctly.\n     *\n     * @private\n     */\n    class WorkboxError extends Error {\n      /**\n       *\n       * @param {string} errorCode The error code that\n       * identifies this particular error.\n       * @param {Object=} details Any relevant arguments\n       * that will help developers identify issues should\n       * be added as a key on the context object.\n       */\n      constructor(errorCode, details) {\n        const message = messageGenerator(errorCode, details);\n        super(message);\n        this.name = errorCode;\n        this.details = details;\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /*\n     * This method throws if the supplied value is not an array.\n     * The destructed values are required to produce a meaningful error for users.\n     * The destructed and restructured object is so it's clear what is\n     * needed.\n     */\n    const isArray = (value, details) => {\n      if (!Array.isArray(value)) {\n        throw new WorkboxError('not-an-array', details);\n      }\n    };\n    const hasMethod = (object, expectedMethod, details) => {\n      const type = typeof object[expectedMethod];\n      if (type !== 'function') {\n        details['expectedMethod'] = expectedMethod;\n        throw new WorkboxError('missing-a-method', details);\n      }\n    };\n    const isType = (object, expectedType, details) => {\n      if (typeof object !== expectedType) {\n        details['expectedType'] = expectedType;\n        throw new WorkboxError('incorrect-type', details);\n      }\n    };\n    const isInstance = (object,\n    // Need the general type to do the check later.\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    expectedClass, details) => {\n      if (!(object instanceof expectedClass)) {\n        details['expectedClassName'] = expectedClass.name;\n        throw new WorkboxError('incorrect-class', details);\n      }\n    };\n    const isOneOf = (value, validValues, details) => {\n      if (!validValues.includes(value)) {\n        details['validValueDescription'] = `Valid values are ${JSON.stringify(validValues)}.`;\n        throw new WorkboxError('invalid-value', details);\n      }\n    };\n    const isArrayOfClass = (value,\n    // Need general type to do check later.\n    expectedClass,\n     \n    details) => {\n      const error = new WorkboxError('not-array-of-class', details);\n      if (!Array.isArray(value)) {\n        throw error;\n      }\n      for (const item of value) {\n        if (!(item instanceof expectedClass)) {\n          throw error;\n        }\n      }\n    };\n    const finalAssertExports = {\n      hasMethod,\n      isArray,\n      isInstance,\n      isOneOf,\n      isType,\n      isArrayOfClass\n    };\n\n    // @ts-ignore\n    try {\n      self['workbox:routing:7.3.0'] && _();\n    } catch (e) {}\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * The default HTTP method, 'GET', used when there's no specific method\n     * configured for a route.\n     *\n     * @type {string}\n     *\n     * @private\n     */\n    const defaultMethod = 'GET';\n    /**\n     * The list of valid HTTP methods associated with requests that could be routed.\n     *\n     * @type {Array<string>}\n     *\n     * @private\n     */\n    const validMethods = ['DELETE', 'GET', 'HEAD', 'PATCH', 'POST', 'PUT'];\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * @param {function()|Object} handler Either a function, or an object with a\n     * 'handle' method.\n     * @return {Object} An object with a handle method.\n     *\n     * @private\n     */\n    const normalizeHandler = handler => {\n      if (handler && typeof handler === 'object') {\n        {\n          finalAssertExports.hasMethod(handler, 'handle', {\n            moduleName: 'workbox-routing',\n            className: 'Route',\n            funcName: 'constructor',\n            paramName: 'handler'\n          });\n        }\n        return handler;\n      } else {\n        {\n          finalAssertExports.isType(handler, 'function', {\n            moduleName: 'workbox-routing',\n            className: 'Route',\n            funcName: 'constructor',\n            paramName: 'handler'\n          });\n        }\n        return {\n          handle: handler\n        };\n      }\n    };\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A `Route` consists of a pair of callback functions, \"match\" and \"handler\".\n     * The \"match\" callback determine if a route should be used to \"handle\" a\n     * request by returning a non-falsy value if it can. The \"handler\" callback\n     * is called when there is a match and should return a Promise that resolves\n     * to a `Response`.\n     *\n     * @memberof workbox-routing\n     */\n    class Route {\n      /**\n       * Constructor for Route class.\n       *\n       * @param {workbox-routing~matchCallback} match\n       * A callback function that determines whether the route matches a given\n       * `fetch` event by returning a non-falsy value.\n       * @param {workbox-routing~handlerCallback} handler A callback\n       * function that returns a Promise resolving to a Response.\n       * @param {string} [method='GET'] The HTTP method to match the Route\n       * against.\n       */\n      constructor(match, handler, method = defaultMethod) {\n        {\n          finalAssertExports.isType(match, 'function', {\n            moduleName: 'workbox-routing',\n            className: 'Route',\n            funcName: 'constructor',\n            paramName: 'match'\n          });\n          if (method) {\n            finalAssertExports.isOneOf(method, validMethods, {\n              paramName: 'method'\n            });\n          }\n        }\n        // These values are referenced directly by Router so cannot be\n        // altered by minificaton.\n        this.handler = normalizeHandler(handler);\n        this.match = match;\n        this.method = method;\n      }\n      /**\n       *\n       * @param {workbox-routing-handlerCallback} handler A callback\n       * function that returns a Promise resolving to a Response\n       */\n      setCatchHandler(handler) {\n        this.catchHandler = normalizeHandler(handler);\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * RegExpRoute makes it easy to create a regular expression based\n     * {@link workbox-routing.Route}.\n     *\n     * For same-origin requests the RegExp only needs to match part of the URL. For\n     * requests against third-party servers, you must define a RegExp that matches\n     * the start of the URL.\n     *\n     * @memberof workbox-routing\n     * @extends workbox-routing.Route\n     */\n    class RegExpRoute extends Route {\n      /**\n       * If the regular expression contains\n       * [capture groups]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp#grouping-back-references},\n       * the captured values will be passed to the\n       * {@link workbox-routing~handlerCallback} `params`\n       * argument.\n       *\n       * @param {RegExp} regExp The regular expression to match against URLs.\n       * @param {workbox-routing~handlerCallback} handler A callback\n       * function that returns a Promise resulting in a Response.\n       * @param {string} [method='GET'] The HTTP method to match the Route\n       * against.\n       */\n      constructor(regExp, handler, method) {\n        {\n          finalAssertExports.isInstance(regExp, RegExp, {\n            moduleName: 'workbox-routing',\n            className: 'RegExpRoute',\n            funcName: 'constructor',\n            paramName: 'pattern'\n          });\n        }\n        const match = ({\n          url\n        }) => {\n          const result = regExp.exec(url.href);\n          // Return immediately if there's no match.\n          if (!result) {\n            return;\n          }\n          // Require that the match start at the first character in the URL string\n          // if it's a cross-origin request.\n          // See https://github.com/GoogleChrome/workbox/issues/281 for the context\n          // behind this behavior.\n          if (url.origin !== location.origin && result.index !== 0) {\n            {\n              logger.debug(`The regular expression '${regExp.toString()}' only partially matched ` + `against the cross-origin URL '${url.toString()}'. RegExpRoute's will only ` + `handle cross-origin requests if they match the entire URL.`);\n            }\n            return;\n          }\n          // If the route matches, but there aren't any capture groups defined, then\n          // this will return [], which is truthy and therefore sufficient to\n          // indicate a match.\n          // If there are capture groups, then it will return their values.\n          return result.slice(1);\n        };\n        super(match, handler, method);\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const getFriendlyURL = url => {\n      const urlObj = new URL(String(url), location.href);\n      // See https://github.com/GoogleChrome/workbox/issues/2323\n      // We want to include everything, except for the origin if it's same-origin.\n      return urlObj.href.replace(new RegExp(`^${location.origin}`), '');\n    };\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * The Router can be used to process a `FetchEvent` using one or more\n     * {@link workbox-routing.Route}, responding with a `Response` if\n     * a matching route exists.\n     *\n     * If no route matches a given a request, the Router will use a \"default\"\n     * handler if one is defined.\n     *\n     * Should the matching Route throw an error, the Router will use a \"catch\"\n     * handler if one is defined to gracefully deal with issues and respond with a\n     * Request.\n     *\n     * If a request matches multiple routes, the **earliest** registered route will\n     * be used to respond to the request.\n     *\n     * @memberof workbox-routing\n     */\n    class Router {\n      /**\n       * Initializes a new Router.\n       */\n      constructor() {\n        this._routes = new Map();\n        this._defaultHandlerMap = new Map();\n      }\n      /**\n       * @return {Map<string, Array<workbox-routing.Route>>} routes A `Map` of HTTP\n       * method name ('GET', etc.) to an array of all the corresponding `Route`\n       * instances that are registered.\n       */\n      get routes() {\n        return this._routes;\n      }\n      /**\n       * Adds a fetch event listener to respond to events when a route matches\n       * the event's request.\n       */\n      addFetchListener() {\n        // See https://github.com/Microsoft/TypeScript/issues/28357#issuecomment-436484705\n        self.addEventListener('fetch', event => {\n          const {\n            request\n          } = event;\n          const responsePromise = this.handleRequest({\n            request,\n            event\n          });\n          if (responsePromise) {\n            event.respondWith(responsePromise);\n          }\n        });\n      }\n      /**\n       * Adds a message event listener for URLs to cache from the window.\n       * This is useful to cache resources loaded on the page prior to when the\n       * service worker started controlling it.\n       *\n       * The format of the message data sent from the window should be as follows.\n       * Where the `urlsToCache` array may consist of URL strings or an array of\n       * URL string + `requestInit` object (the same as you'd pass to `fetch()`).\n       *\n       * ```\n       * {\n       *   type: 'CACHE_URLS',\n       *   payload: {\n       *     urlsToCache: [\n       *       './script1.js',\n       *       './script2.js',\n       *       ['./script3.js', {mode: 'no-cors'}],\n       *     ],\n       *   },\n       * }\n       * ```\n       */\n      addCacheListener() {\n        // See https://github.com/Microsoft/TypeScript/issues/28357#issuecomment-436484705\n        self.addEventListener('message', event => {\n          // event.data is type 'any'\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n          if (event.data && event.data.type === 'CACHE_URLS') {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            const {\n              payload\n            } = event.data;\n            {\n              logger.debug(`Caching URLs from the window`, payload.urlsToCache);\n            }\n            const requestPromises = Promise.all(payload.urlsToCache.map(entry => {\n              if (typeof entry === 'string') {\n                entry = [entry];\n              }\n              const request = new Request(...entry);\n              return this.handleRequest({\n                request,\n                event\n              });\n              // TODO(philipwalton): TypeScript errors without this typecast for\n              // some reason (probably a bug). The real type here should work but\n              // doesn't: `Array<Promise<Response> | undefined>`.\n            })); // TypeScript\n            event.waitUntil(requestPromises);\n            // If a MessageChannel was used, reply to the message on success.\n            if (event.ports && event.ports[0]) {\n              void requestPromises.then(() => event.ports[0].postMessage(true));\n            }\n          }\n        });\n      }\n      /**\n       * Apply the routing rules to a FetchEvent object to get a Response from an\n       * appropriate Route's handler.\n       *\n       * @param {Object} options\n       * @param {Request} options.request The request to handle.\n       * @param {ExtendableEvent} options.event The event that triggered the\n       *     request.\n       * @return {Promise<Response>|undefined} A promise is returned if a\n       *     registered route can handle the request. If there is no matching\n       *     route and there's no `defaultHandler`, `undefined` is returned.\n       */\n      handleRequest({\n        request,\n        event\n      }) {\n        {\n          finalAssertExports.isInstance(request, Request, {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'handleRequest',\n            paramName: 'options.request'\n          });\n        }\n        const url = new URL(request.url, location.href);\n        if (!url.protocol.startsWith('http')) {\n          {\n            logger.debug(`Workbox Router only supports URLs that start with 'http'.`);\n          }\n          return;\n        }\n        const sameOrigin = url.origin === location.origin;\n        const {\n          params,\n          route\n        } = this.findMatchingRoute({\n          event,\n          request,\n          sameOrigin,\n          url\n        });\n        let handler = route && route.handler;\n        const debugMessages = [];\n        {\n          if (handler) {\n            debugMessages.push([`Found a route to handle this request:`, route]);\n            if (params) {\n              debugMessages.push([`Passing the following params to the route's handler:`, params]);\n            }\n          }\n        }\n        // If we don't have a handler because there was no matching route, then\n        // fall back to defaultHandler if that's defined.\n        const method = request.method;\n        if (!handler && this._defaultHandlerMap.has(method)) {\n          {\n            debugMessages.push(`Failed to find a matching route. Falling ` + `back to the default handler for ${method}.`);\n          }\n          handler = this._defaultHandlerMap.get(method);\n        }\n        if (!handler) {\n          {\n            // No handler so Workbox will do nothing. If logs is set of debug\n            // i.e. verbose, we should print out this information.\n            logger.debug(`No route found for: ${getFriendlyURL(url)}`);\n          }\n          return;\n        }\n        {\n          // We have a handler, meaning Workbox is going to handle the route.\n          // print the routing details to the console.\n          logger.groupCollapsed(`Router is responding to: ${getFriendlyURL(url)}`);\n          debugMessages.forEach(msg => {\n            if (Array.isArray(msg)) {\n              logger.log(...msg);\n            } else {\n              logger.log(msg);\n            }\n          });\n          logger.groupEnd();\n        }\n        // Wrap in try and catch in case the handle method throws a synchronous\n        // error. It should still callback to the catch handler.\n        let responsePromise;\n        try {\n          responsePromise = handler.handle({\n            url,\n            request,\n            event,\n            params\n          });\n        } catch (err) {\n          responsePromise = Promise.reject(err);\n        }\n        // Get route's catch handler, if it exists\n        const catchHandler = route && route.catchHandler;\n        if (responsePromise instanceof Promise && (this._catchHandler || catchHandler)) {\n          responsePromise = responsePromise.catch(async err => {\n            // If there's a route catch handler, process that first\n            if (catchHandler) {\n              {\n                // Still include URL here as it will be async from the console group\n                // and may not make sense without the URL\n                logger.groupCollapsed(`Error thrown when responding to: ` + ` ${getFriendlyURL(url)}. Falling back to route's Catch Handler.`);\n                logger.error(`Error thrown by:`, route);\n                logger.error(err);\n                logger.groupEnd();\n              }\n              try {\n                return await catchHandler.handle({\n                  url,\n                  request,\n                  event,\n                  params\n                });\n              } catch (catchErr) {\n                if (catchErr instanceof Error) {\n                  err = catchErr;\n                }\n              }\n            }\n            if (this._catchHandler) {\n              {\n                // Still include URL here as it will be async from the console group\n                // and may not make sense without the URL\n                logger.groupCollapsed(`Error thrown when responding to: ` + ` ${getFriendlyURL(url)}. Falling back to global Catch Handler.`);\n                logger.error(`Error thrown by:`, route);\n                logger.error(err);\n                logger.groupEnd();\n              }\n              return this._catchHandler.handle({\n                url,\n                request,\n                event\n              });\n            }\n            throw err;\n          });\n        }\n        return responsePromise;\n      }\n      /**\n       * Checks a request and URL (and optionally an event) against the list of\n       * registered routes, and if there's a match, returns the corresponding\n       * route along with any params generated by the match.\n       *\n       * @param {Object} options\n       * @param {URL} options.url\n       * @param {boolean} options.sameOrigin The result of comparing `url.origin`\n       *     against the current origin.\n       * @param {Request} options.request The request to match.\n       * @param {Event} options.event The corresponding event.\n       * @return {Object} An object with `route` and `params` properties.\n       *     They are populated if a matching route was found or `undefined`\n       *     otherwise.\n       */\n      findMatchingRoute({\n        url,\n        sameOrigin,\n        request,\n        event\n      }) {\n        const routes = this._routes.get(request.method) || [];\n        for (const route of routes) {\n          let params;\n          // route.match returns type any, not possible to change right now.\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n          const matchResult = route.match({\n            url,\n            sameOrigin,\n            request,\n            event\n          });\n          if (matchResult) {\n            {\n              // Warn developers that using an async matchCallback is almost always\n              // not the right thing to do.\n              if (matchResult instanceof Promise) {\n                logger.warn(`While routing ${getFriendlyURL(url)}, an async ` + `matchCallback function was used. Please convert the ` + `following route to use a synchronous matchCallback function:`, route);\n              }\n            }\n            // See https://github.com/GoogleChrome/workbox/issues/2079\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            params = matchResult;\n            if (Array.isArray(params) && params.length === 0) {\n              // Instead of passing an empty array in as params, use undefined.\n              params = undefined;\n            } else if (matchResult.constructor === Object &&\n             \n            Object.keys(matchResult).length === 0) {\n              // Instead of passing an empty object in as params, use undefined.\n              params = undefined;\n            } else if (typeof matchResult === 'boolean') {\n              // For the boolean value true (rather than just something truth-y),\n              // don't set params.\n              // See https://github.com/GoogleChrome/workbox/pull/2134#issuecomment-513924353\n              params = undefined;\n            }\n            // Return early if have a match.\n            return {\n              route,\n              params\n            };\n          }\n        }\n        // If no match was found above, return and empty object.\n        return {};\n      }\n      /**\n       * Define a default `handler` that's called when no routes explicitly\n       * match the incoming request.\n       *\n       * Each HTTP method ('GET', 'POST', etc.) gets its own default handler.\n       *\n       * Without a default handler, unmatched requests will go against the\n       * network as if there were no service worker present.\n       *\n       * @param {workbox-routing~handlerCallback} handler A callback\n       * function that returns a Promise resulting in a Response.\n       * @param {string} [method='GET'] The HTTP method to associate with this\n       * default handler. Each method has its own default.\n       */\n      setDefaultHandler(handler, method = defaultMethod) {\n        this._defaultHandlerMap.set(method, normalizeHandler(handler));\n      }\n      /**\n       * If a Route throws an error while handling a request, this `handler`\n       * will be called and given a chance to provide a response.\n       *\n       * @param {workbox-routing~handlerCallback} handler A callback\n       * function that returns a Promise resulting in a Response.\n       */\n      setCatchHandler(handler) {\n        this._catchHandler = normalizeHandler(handler);\n      }\n      /**\n       * Registers a route with the router.\n       *\n       * @param {workbox-routing.Route} route The route to register.\n       */\n      registerRoute(route) {\n        {\n          finalAssertExports.isType(route, 'object', {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'registerRoute',\n            paramName: 'route'\n          });\n          finalAssertExports.hasMethod(route, 'match', {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'registerRoute',\n            paramName: 'route'\n          });\n          finalAssertExports.isType(route.handler, 'object', {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'registerRoute',\n            paramName: 'route'\n          });\n          finalAssertExports.hasMethod(route.handler, 'handle', {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'registerRoute',\n            paramName: 'route.handler'\n          });\n          finalAssertExports.isType(route.method, 'string', {\n            moduleName: 'workbox-routing',\n            className: 'Router',\n            funcName: 'registerRoute',\n            paramName: 'route.method'\n          });\n        }\n        if (!this._routes.has(route.method)) {\n          this._routes.set(route.method, []);\n        }\n        // Give precedence to all of the earlier routes by adding this additional\n        // route to the end of the array.\n        this._routes.get(route.method).push(route);\n      }\n      /**\n       * Unregisters a route with the router.\n       *\n       * @param {workbox-routing.Route} route The route to unregister.\n       */\n      unregisterRoute(route) {\n        if (!this._routes.has(route.method)) {\n          throw new WorkboxError('unregister-route-but-not-found-with-method', {\n            method: route.method\n          });\n        }\n        const routeIndex = this._routes.get(route.method).indexOf(route);\n        if (routeIndex > -1) {\n          this._routes.get(route.method).splice(routeIndex, 1);\n        } else {\n          throw new WorkboxError('unregister-route-route-not-registered');\n        }\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    let defaultRouter;\n    /**\n     * Creates a new, singleton Router instance if one does not exist. If one\n     * does already exist, that instance is returned.\n     *\n     * @private\n     * @return {Router}\n     */\n    const getOrCreateDefaultRouter = () => {\n      if (!defaultRouter) {\n        defaultRouter = new Router();\n        // The helpers that use the default Router assume these listeners exist.\n        defaultRouter.addFetchListener();\n        defaultRouter.addCacheListener();\n      }\n      return defaultRouter;\n    };\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Easily register a RegExp, string, or function with a caching\n     * strategy to a singleton Router instance.\n     *\n     * This method will generate a Route for you if needed and\n     * call {@link workbox-routing.Router#registerRoute}.\n     *\n     * @param {RegExp|string|workbox-routing.Route~matchCallback|workbox-routing.Route} capture\n     * If the capture param is a `Route`, all other arguments will be ignored.\n     * @param {workbox-routing~handlerCallback} [handler] A callback\n     * function that returns a Promise resulting in a Response. This parameter\n     * is required if `capture` is not a `Route` object.\n     * @param {string} [method='GET'] The HTTP method to match the Route\n     * against.\n     * @return {workbox-routing.Route} The generated `Route`.\n     *\n     * @memberof workbox-routing\n     */\n    function registerRoute(capture, handler, method) {\n      let route;\n      if (typeof capture === 'string') {\n        const captureUrl = new URL(capture, location.href);\n        {\n          if (!(capture.startsWith('/') || capture.startsWith('http'))) {\n            throw new WorkboxError('invalid-string', {\n              moduleName: 'workbox-routing',\n              funcName: 'registerRoute',\n              paramName: 'capture'\n            });\n          }\n          // We want to check if Express-style wildcards are in the pathname only.\n          // TODO: Remove this log message in v4.\n          const valueToCheck = capture.startsWith('http') ? captureUrl.pathname : capture;\n          // See https://github.com/pillarjs/path-to-regexp#parameters\n          const wildcards = '[*:?+]';\n          if (new RegExp(`${wildcards}`).exec(valueToCheck)) {\n            logger.debug(`The '$capture' parameter contains an Express-style wildcard ` + `character (${wildcards}). Strings are now always interpreted as ` + `exact matches; use a RegExp for partial or wildcard matches.`);\n          }\n        }\n        const matchCallback = ({\n          url\n        }) => {\n          {\n            if (url.pathname === captureUrl.pathname && url.origin !== captureUrl.origin) {\n              logger.debug(`${capture} only partially matches the cross-origin URL ` + `${url.toString()}. This route will only handle cross-origin requests ` + `if they match the entire URL.`);\n            }\n          }\n          return url.href === captureUrl.href;\n        };\n        // If `capture` is a string then `handler` and `method` must be present.\n        route = new Route(matchCallback, handler, method);\n      } else if (capture instanceof RegExp) {\n        // If `capture` is a `RegExp` then `handler` and `method` must be present.\n        route = new RegExpRoute(capture, handler, method);\n      } else if (typeof capture === 'function') {\n        // If `capture` is a function then `handler` and `method` must be present.\n        route = new Route(capture, handler, method);\n      } else if (capture instanceof Route) {\n        route = capture;\n      } else {\n        throw new WorkboxError('unsupported-route-type', {\n          moduleName: 'workbox-routing',\n          funcName: 'registerRoute',\n          paramName: 'capture'\n        });\n      }\n      const defaultRouter = getOrCreateDefaultRouter();\n      defaultRouter.registerRoute(route);\n      return route;\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const _cacheNameDetails = {\n      googleAnalytics: 'googleAnalytics',\n      precache: 'precache-v2',\n      prefix: 'workbox',\n      runtime: 'runtime',\n      suffix: typeof registration !== 'undefined' ? registration.scope : ''\n    };\n    const _createCacheName = cacheName => {\n      return [_cacheNameDetails.prefix, cacheName, _cacheNameDetails.suffix].filter(value => value && value.length > 0).join('-');\n    };\n    const eachCacheNameDetail = fn => {\n      for (const key of Object.keys(_cacheNameDetails)) {\n        fn(key);\n      }\n    };\n    const cacheNames = {\n      updateDetails: details => {\n        eachCacheNameDetail(key => {\n          if (typeof details[key] === 'string') {\n            _cacheNameDetails[key] = details[key];\n          }\n        });\n      },\n      getGoogleAnalyticsName: userCacheName => {\n        return userCacheName || _createCacheName(_cacheNameDetails.googleAnalytics);\n      },\n      getPrecacheName: userCacheName => {\n        return userCacheName || _createCacheName(_cacheNameDetails.precache);\n      },\n      getPrefix: () => {\n        return _cacheNameDetails.prefix;\n      },\n      getRuntimeName: userCacheName => {\n        return userCacheName || _createCacheName(_cacheNameDetails.runtime);\n      },\n      getSuffix: () => {\n        return _cacheNameDetails.suffix;\n      }\n    };\n\n    /*\n      Copyright 2020 Google LLC\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A utility method that makes it easier to use `event.waitUntil` with\n     * async functions and return the result.\n     *\n     * @param {ExtendableEvent} event\n     * @param {Function} asyncFn\n     * @return {Function}\n     * @private\n     */\n    function waitUntil(event, asyncFn) {\n      const returnPromise = asyncFn();\n      event.waitUntil(returnPromise);\n      return returnPromise;\n    }\n\n    // @ts-ignore\n    try {\n      self['workbox:precaching:7.3.0'] && _();\n    } catch (e) {}\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    // Name of the search parameter used to store revision info.\n    const REVISION_SEARCH_PARAM = '__WB_REVISION__';\n    /**\n     * Converts a manifest entry into a versioned URL suitable for precaching.\n     *\n     * @param {Object|string} entry\n     * @return {string} A URL with versioning info.\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    function createCacheKey(entry) {\n      if (!entry) {\n        throw new WorkboxError('add-to-cache-list-unexpected-type', {\n          entry\n        });\n      }\n      // If a precache manifest entry is a string, it's assumed to be a versioned\n      // URL, like '/app.abcd1234.js'. Return as-is.\n      if (typeof entry === 'string') {\n        const urlObject = new URL(entry, location.href);\n        return {\n          cacheKey: urlObject.href,\n          url: urlObject.href\n        };\n      }\n      const {\n        revision,\n        url\n      } = entry;\n      if (!url) {\n        throw new WorkboxError('add-to-cache-list-unexpected-type', {\n          entry\n        });\n      }\n      // If there's just a URL and no revision, then it's also assumed to be a\n      // versioned URL.\n      if (!revision) {\n        const urlObject = new URL(url, location.href);\n        return {\n          cacheKey: urlObject.href,\n          url: urlObject.href\n        };\n      }\n      // Otherwise, construct a properly versioned URL using the custom Workbox\n      // search parameter along with the revision info.\n      const cacheKeyURL = new URL(url, location.href);\n      const originalURL = new URL(url, location.href);\n      cacheKeyURL.searchParams.set(REVISION_SEARCH_PARAM, revision);\n      return {\n        cacheKey: cacheKeyURL.href,\n        url: originalURL.href\n      };\n    }\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A plugin, designed to be used with PrecacheController, to determine the\n     * of assets that were updated (or not updated) during the install event.\n     *\n     * @private\n     */\n    class PrecacheInstallReportPlugin {\n      constructor() {\n        this.updatedURLs = [];\n        this.notUpdatedURLs = [];\n        this.handlerWillStart = async ({\n          request,\n          state\n        }) => {\n          // TODO: `state` should never be undefined...\n          if (state) {\n            state.originalRequest = request;\n          }\n        };\n        this.cachedResponseWillBeUsed = async ({\n          event,\n          state,\n          cachedResponse\n        }) => {\n          if (event.type === 'install') {\n            if (state && state.originalRequest && state.originalRequest instanceof Request) {\n              // TODO: `state` should never be undefined...\n              const url = state.originalRequest.url;\n              if (cachedResponse) {\n                this.notUpdatedURLs.push(url);\n              } else {\n                this.updatedURLs.push(url);\n              }\n            }\n          }\n          return cachedResponse;\n        };\n      }\n    }\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A plugin, designed to be used with PrecacheController, to translate URLs into\n     * the corresponding cache key, based on the current revision info.\n     *\n     * @private\n     */\n    class PrecacheCacheKeyPlugin {\n      constructor({\n        precacheController\n      }) {\n        this.cacheKeyWillBeUsed = async ({\n          request,\n          params\n        }) => {\n          // Params is type any, can't change right now.\n           \n          const cacheKey = (params === null || params === void 0 ? void 0 : params.cacheKey) || this._precacheController.getCacheKeyForURL(request.url);\n           \n          return cacheKey ? new Request(cacheKey, {\n            headers: request.headers\n          }) : request;\n        };\n        this._precacheController = precacheController;\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * @param {string} groupTitle\n     * @param {Array<string>} deletedURLs\n     *\n     * @private\n     */\n    const logGroup = (groupTitle, deletedURLs) => {\n      logger.groupCollapsed(groupTitle);\n      for (const url of deletedURLs) {\n        logger.log(url);\n      }\n      logger.groupEnd();\n    };\n    /**\n     * @param {Array<string>} deletedURLs\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    function printCleanupDetails(deletedURLs) {\n      const deletionCount = deletedURLs.length;\n      if (deletionCount > 0) {\n        logger.groupCollapsed(`During precaching cleanup, ` + `${deletionCount} cached ` + `request${deletionCount === 1 ? ' was' : 's were'} deleted.`);\n        logGroup('Deleted Cache Requests', deletedURLs);\n        logger.groupEnd();\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * @param {string} groupTitle\n     * @param {Array<string>} urls\n     *\n     * @private\n     */\n    function _nestedGroup(groupTitle, urls) {\n      if (urls.length === 0) {\n        return;\n      }\n      logger.groupCollapsed(groupTitle);\n      for (const url of urls) {\n        logger.log(url);\n      }\n      logger.groupEnd();\n    }\n    /**\n     * @param {Array<string>} urlsToPrecache\n     * @param {Array<string>} urlsAlreadyPrecached\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    function printInstallDetails(urlsToPrecache, urlsAlreadyPrecached) {\n      const precachedCount = urlsToPrecache.length;\n      const alreadyPrecachedCount = urlsAlreadyPrecached.length;\n      if (precachedCount || alreadyPrecachedCount) {\n        let message = `Precaching ${precachedCount} file${precachedCount === 1 ? '' : 's'}.`;\n        if (alreadyPrecachedCount > 0) {\n          message += ` ${alreadyPrecachedCount} ` + `file${alreadyPrecachedCount === 1 ? ' is' : 's are'} already cached.`;\n        }\n        logger.groupCollapsed(message);\n        _nestedGroup(`View newly precached URLs.`, urlsToPrecache);\n        _nestedGroup(`View previously precached URLs.`, urlsAlreadyPrecached);\n        logger.groupEnd();\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    let supportStatus;\n    /**\n     * A utility function that determines whether the current browser supports\n     * constructing a new `Response` from a `response.body` stream.\n     *\n     * @return {boolean} `true`, if the current browser can successfully\n     *     construct a `Response` from a `response.body` stream, `false` otherwise.\n     *\n     * @private\n     */\n    function canConstructResponseFromBodyStream() {\n      if (supportStatus === undefined) {\n        const testResponse = new Response('');\n        if ('body' in testResponse) {\n          try {\n            new Response(testResponse.body);\n            supportStatus = true;\n          } catch (error) {\n            supportStatus = false;\n          }\n        }\n        supportStatus = false;\n      }\n      return supportStatus;\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Allows developers to copy a response and modify its `headers`, `status`,\n     * or `statusText` values (the values settable via a\n     * [`ResponseInit`]{@link https://developer.mozilla.org/en-US/docs/Web/API/Response/Response#Syntax}\n     * object in the constructor).\n     * To modify these values, pass a function as the second argument. That\n     * function will be invoked with a single object with the response properties\n     * `{headers, status, statusText}`. The return value of this function will\n     * be used as the `ResponseInit` for the new `Response`. To change the values\n     * either modify the passed parameter(s) and return it, or return a totally\n     * new object.\n     *\n     * This method is intentionally limited to same-origin responses, regardless of\n     * whether CORS was used or not.\n     *\n     * @param {Response} response\n     * @param {Function} modifier\n     * @memberof workbox-core\n     */\n    async function copyResponse(response, modifier) {\n      let origin = null;\n      // If response.url isn't set, assume it's cross-origin and keep origin null.\n      if (response.url) {\n        const responseURL = new URL(response.url);\n        origin = responseURL.origin;\n      }\n      if (origin !== self.location.origin) {\n        throw new WorkboxError('cross-origin-copy-response', {\n          origin\n        });\n      }\n      const clonedResponse = response.clone();\n      // Create a fresh `ResponseInit` object by cloning the headers.\n      const responseInit = {\n        headers: new Headers(clonedResponse.headers),\n        status: clonedResponse.status,\n        statusText: clonedResponse.statusText\n      };\n      // Apply any user modifications.\n      const modifiedResponseInit = modifier ? modifier(responseInit) : responseInit;\n      // Create the new response from the body stream and `ResponseInit`\n      // modifications. Note: not all browsers support the Response.body stream,\n      // so fall back to reading the entire body into memory as a blob.\n      const body = canConstructResponseFromBodyStream() ? clonedResponse.body : await clonedResponse.blob();\n      return new Response(body, modifiedResponseInit);\n    }\n\n    /*\n      Copyright 2020 Google LLC\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    function stripParams(fullURL, ignoreParams) {\n      const strippedURL = new URL(fullURL);\n      for (const param of ignoreParams) {\n        strippedURL.searchParams.delete(param);\n      }\n      return strippedURL.href;\n    }\n    /**\n     * Matches an item in the cache, ignoring specific URL params. This is similar\n     * to the `ignoreSearch` option, but it allows you to ignore just specific\n     * params (while continuing to match on the others).\n     *\n     * @private\n     * @param {Cache} cache\n     * @param {Request} request\n     * @param {Object} matchOptions\n     * @param {Array<string>} ignoreParams\n     * @return {Promise<Response|undefined>}\n     */\n    async function cacheMatchIgnoreParams(cache, request, ignoreParams, matchOptions) {\n      const strippedRequestURL = stripParams(request.url, ignoreParams);\n      // If the request doesn't include any ignored params, match as normal.\n      if (request.url === strippedRequestURL) {\n        return cache.match(request, matchOptions);\n      }\n      // Otherwise, match by comparing keys\n      const keysOptions = Object.assign(Object.assign({}, matchOptions), {\n        ignoreSearch: true\n      });\n      const cacheKeys = await cache.keys(request, keysOptions);\n      for (const cacheKey of cacheKeys) {\n        const strippedCacheKeyURL = stripParams(cacheKey.url, ignoreParams);\n        if (strippedRequestURL === strippedCacheKeyURL) {\n          return cache.match(cacheKey, matchOptions);\n        }\n      }\n      return;\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * The Deferred class composes Promises in a way that allows for them to be\n     * resolved or rejected from outside the constructor. In most cases promises\n     * should be used directly, but Deferreds can be necessary when the logic to\n     * resolve a promise must be separate.\n     *\n     * @private\n     */\n    class Deferred {\n      /**\n       * Creates a promise and exposes its resolve and reject functions as methods.\n       */\n      constructor() {\n        this.promise = new Promise((resolve, reject) => {\n          this.resolve = resolve;\n          this.reject = reject;\n        });\n      }\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    // Callbacks to be executed whenever there's a quota error.\n    // Can't change Function type right now.\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const quotaErrorCallbacks = new Set();\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Runs all of the callback functions, one at a time sequentially, in the order\n     * in which they were registered.\n     *\n     * @memberof workbox-core\n     * @private\n     */\n    async function executeQuotaErrorCallbacks() {\n      {\n        logger.log(`About to run ${quotaErrorCallbacks.size} ` + `callbacks to clean up caches.`);\n      }\n      for (const callback of quotaErrorCallbacks) {\n        await callback();\n        {\n          logger.log(callback, 'is complete.');\n        }\n      }\n      {\n        logger.log('Finished running callbacks.');\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Returns a promise that resolves and the passed number of milliseconds.\n     * This utility is an async/await-friendly version of `setTimeout`.\n     *\n     * @param {number} ms\n     * @return {Promise}\n     * @private\n     */\n    function timeout(ms) {\n      return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    // @ts-ignore\n    try {\n      self['workbox:strategies:7.3.0'] && _();\n    } catch (e) {}\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    function toRequest(input) {\n      return typeof input === 'string' ? new Request(input) : input;\n    }\n    /**\n     * A class created every time a Strategy instance calls\n     * {@link workbox-strategies.Strategy~handle} or\n     * {@link workbox-strategies.Strategy~handleAll} that wraps all fetch and\n     * cache actions around plugin callbacks and keeps track of when the strategy\n     * is \"done\" (i.e. all added `event.waitUntil()` promises have resolved).\n     *\n     * @memberof workbox-strategies\n     */\n    class StrategyHandler {\n      /**\n       * Creates a new instance associated with the passed strategy and event\n       * that's handling the request.\n       *\n       * The constructor also initializes the state that will be passed to each of\n       * the plugins handling this request.\n       *\n       * @param {workbox-strategies.Strategy} strategy\n       * @param {Object} options\n       * @param {Request|string} options.request A request to run this strategy for.\n       * @param {ExtendableEvent} options.event The event associated with the\n       *     request.\n       * @param {URL} [options.url]\n       * @param {*} [options.params] The return value from the\n       *     {@link workbox-routing~matchCallback} (if applicable).\n       */\n      constructor(strategy, options) {\n        this._cacheKeys = {};\n        /**\n         * The request the strategy is performing (passed to the strategy's\n         * `handle()` or `handleAll()` method).\n         * @name request\n         * @instance\n         * @type {Request}\n         * @memberof workbox-strategies.StrategyHandler\n         */\n        /**\n         * The event associated with this request.\n         * @name event\n         * @instance\n         * @type {ExtendableEvent}\n         * @memberof workbox-strategies.StrategyHandler\n         */\n        /**\n         * A `URL` instance of `request.url` (if passed to the strategy's\n         * `handle()` or `handleAll()` method).\n         * Note: the `url` param will be present if the strategy was invoked\n         * from a workbox `Route` object.\n         * @name url\n         * @instance\n         * @type {URL|undefined}\n         * @memberof workbox-strategies.StrategyHandler\n         */\n        /**\n         * A `param` value (if passed to the strategy's\n         * `handle()` or `handleAll()` method).\n         * Note: the `param` param will be present if the strategy was invoked\n         * from a workbox `Route` object and the\n         * {@link workbox-routing~matchCallback} returned\n         * a truthy value (it will be that value).\n         * @name params\n         * @instance\n         * @type {*|undefined}\n         * @memberof workbox-strategies.StrategyHandler\n         */\n        {\n          finalAssertExports.isInstance(options.event, ExtendableEvent, {\n            moduleName: 'workbox-strategies',\n            className: 'StrategyHandler',\n            funcName: 'constructor',\n            paramName: 'options.event'\n          });\n        }\n        Object.assign(this, options);\n        this.event = options.event;\n        this._strategy = strategy;\n        this._handlerDeferred = new Deferred();\n        this._extendLifetimePromises = [];\n        // Copy the plugins list (since it's mutable on the strategy),\n        // so any mutations don't affect this handler instance.\n        this._plugins = [...strategy.plugins];\n        this._pluginStateMap = new Map();\n        for (const plugin of this._plugins) {\n          this._pluginStateMap.set(plugin, {});\n        }\n        this.event.waitUntil(this._handlerDeferred.promise);\n      }\n      /**\n       * Fetches a given request (and invokes any applicable plugin callback\n       * methods) using the `fetchOptions` (for non-navigation requests) and\n       * `plugins` defined on the `Strategy` object.\n       *\n       * The following plugin lifecycle methods are invoked when using this method:\n       * - `requestWillFetch()`\n       * - `fetchDidSucceed()`\n       * - `fetchDidFail()`\n       *\n       * @param {Request|string} input The URL or request to fetch.\n       * @return {Promise<Response>}\n       */\n      async fetch(input) {\n        const {\n          event\n        } = this;\n        let request = toRequest(input);\n        if (request.mode === 'navigate' && event instanceof FetchEvent && event.preloadResponse) {\n          const possiblePreloadResponse = await event.preloadResponse;\n          if (possiblePreloadResponse) {\n            {\n              logger.log(`Using a preloaded navigation response for ` + `'${getFriendlyURL(request.url)}'`);\n            }\n            return possiblePreloadResponse;\n          }\n        }\n        // If there is a fetchDidFail plugin, we need to save a clone of the\n        // original request before it's either modified by a requestWillFetch\n        // plugin or before the original request's body is consumed via fetch().\n        const originalRequest = this.hasCallback('fetchDidFail') ? request.clone() : null;\n        try {\n          for (const cb of this.iterateCallbacks('requestWillFetch')) {\n            request = await cb({\n              request: request.clone(),\n              event\n            });\n          }\n        } catch (err) {\n          if (err instanceof Error) {\n            throw new WorkboxError('plugin-error-request-will-fetch', {\n              thrownErrorMessage: err.message\n            });\n          }\n        }\n        // The request can be altered by plugins with `requestWillFetch` making\n        // the original request (most likely from a `fetch` event) different\n        // from the Request we make. Pass both to `fetchDidFail` to aid debugging.\n        const pluginFilteredRequest = request.clone();\n        try {\n          let fetchResponse;\n          // See https://github.com/GoogleChrome/workbox/issues/1796\n          fetchResponse = await fetch(request, request.mode === 'navigate' ? undefined : this._strategy.fetchOptions);\n          if (\"development\" !== 'production') {\n            logger.debug(`Network request for ` + `'${getFriendlyURL(request.url)}' returned a response with ` + `status '${fetchResponse.status}'.`);\n          }\n          for (const callback of this.iterateCallbacks('fetchDidSucceed')) {\n            fetchResponse = await callback({\n              event,\n              request: pluginFilteredRequest,\n              response: fetchResponse\n            });\n          }\n          return fetchResponse;\n        } catch (error) {\n          {\n            logger.log(`Network request for ` + `'${getFriendlyURL(request.url)}' threw an error.`, error);\n          }\n          // `originalRequest` will only exist if a `fetchDidFail` callback\n          // is being used (see above).\n          if (originalRequest) {\n            await this.runCallbacks('fetchDidFail', {\n              error: error,\n              event,\n              originalRequest: originalRequest.clone(),\n              request: pluginFilteredRequest.clone()\n            });\n          }\n          throw error;\n        }\n      }\n      /**\n       * Calls `this.fetch()` and (in the background) runs `this.cachePut()` on\n       * the response generated by `this.fetch()`.\n       *\n       * The call to `this.cachePut()` automatically invokes `this.waitUntil()`,\n       * so you do not have to manually call `waitUntil()` on the event.\n       *\n       * @param {Request|string} input The request or URL to fetch and cache.\n       * @return {Promise<Response>}\n       */\n      async fetchAndCachePut(input) {\n        const response = await this.fetch(input);\n        const responseClone = response.clone();\n        void this.waitUntil(this.cachePut(input, responseClone));\n        return response;\n      }\n      /**\n       * Matches a request from the cache (and invokes any applicable plugin\n       * callback methods) using the `cacheName`, `matchOptions`, and `plugins`\n       * defined on the strategy object.\n       *\n       * The following plugin lifecycle methods are invoked when using this method:\n       * - cacheKeyWillBeUsed()\n       * - cachedResponseWillBeUsed()\n       *\n       * @param {Request|string} key The Request or URL to use as the cache key.\n       * @return {Promise<Response|undefined>} A matching response, if found.\n       */\n      async cacheMatch(key) {\n        const request = toRequest(key);\n        let cachedResponse;\n        const {\n          cacheName,\n          matchOptions\n        } = this._strategy;\n        const effectiveRequest = await this.getCacheKey(request, 'read');\n        const multiMatchOptions = Object.assign(Object.assign({}, matchOptions), {\n          cacheName\n        });\n        cachedResponse = await caches.match(effectiveRequest, multiMatchOptions);\n        {\n          if (cachedResponse) {\n            logger.debug(`Found a cached response in '${cacheName}'.`);\n          } else {\n            logger.debug(`No cached response found in '${cacheName}'.`);\n          }\n        }\n        for (const callback of this.iterateCallbacks('cachedResponseWillBeUsed')) {\n          cachedResponse = (await callback({\n            cacheName,\n            matchOptions,\n            cachedResponse,\n            request: effectiveRequest,\n            event: this.event\n          })) || undefined;\n        }\n        return cachedResponse;\n      }\n      /**\n       * Puts a request/response pair in the cache (and invokes any applicable\n       * plugin callback methods) using the `cacheName` and `plugins` defined on\n       * the strategy object.\n       *\n       * The following plugin lifecycle methods are invoked when using this method:\n       * - cacheKeyWillBeUsed()\n       * - cacheWillUpdate()\n       * - cacheDidUpdate()\n       *\n       * @param {Request|string} key The request or URL to use as the cache key.\n       * @param {Response} response The response to cache.\n       * @return {Promise<boolean>} `false` if a cacheWillUpdate caused the response\n       * not be cached, and `true` otherwise.\n       */\n      async cachePut(key, response) {\n        const request = toRequest(key);\n        // Run in the next task to avoid blocking other cache reads.\n        // https://github.com/w3c/ServiceWorker/issues/1397\n        await timeout(0);\n        const effectiveRequest = await this.getCacheKey(request, 'write');\n        {\n          if (effectiveRequest.method && effectiveRequest.method !== 'GET') {\n            throw new WorkboxError('attempt-to-cache-non-get-request', {\n              url: getFriendlyURL(effectiveRequest.url),\n              method: effectiveRequest.method\n            });\n          }\n          // See https://github.com/GoogleChrome/workbox/issues/2818\n          const vary = response.headers.get('Vary');\n          if (vary) {\n            logger.debug(`The response for ${getFriendlyURL(effectiveRequest.url)} ` + `has a 'Vary: ${vary}' header. ` + `Consider setting the {ignoreVary: true} option on your strategy ` + `to ensure cache matching and deletion works as expected.`);\n          }\n        }\n        if (!response) {\n          {\n            logger.error(`Cannot cache non-existent response for ` + `'${getFriendlyURL(effectiveRequest.url)}'.`);\n          }\n          throw new WorkboxError('cache-put-with-no-response', {\n            url: getFriendlyURL(effectiveRequest.url)\n          });\n        }\n        const responseToCache = await this._ensureResponseSafeToCache(response);\n        if (!responseToCache) {\n          {\n            logger.debug(`Response '${getFriendlyURL(effectiveRequest.url)}' ` + `will not be cached.`, responseToCache);\n          }\n          return false;\n        }\n        const {\n          cacheName,\n          matchOptions\n        } = this._strategy;\n        const cache = await self.caches.open(cacheName);\n        const hasCacheUpdateCallback = this.hasCallback('cacheDidUpdate');\n        const oldResponse = hasCacheUpdateCallback ? await cacheMatchIgnoreParams(\n        // TODO(philipwalton): the `__WB_REVISION__` param is a precaching\n        // feature. Consider into ways to only add this behavior if using\n        // precaching.\n        cache, effectiveRequest.clone(), ['__WB_REVISION__'], matchOptions) : null;\n        {\n          logger.debug(`Updating the '${cacheName}' cache with a new Response ` + `for ${getFriendlyURL(effectiveRequest.url)}.`);\n        }\n        try {\n          await cache.put(effectiveRequest, hasCacheUpdateCallback ? responseToCache.clone() : responseToCache);\n        } catch (error) {\n          if (error instanceof Error) {\n            // See https://developer.mozilla.org/en-US/docs/Web/API/DOMException#exception-QuotaExceededError\n            if (error.name === 'QuotaExceededError') {\n              await executeQuotaErrorCallbacks();\n            }\n            throw error;\n          }\n        }\n        for (const callback of this.iterateCallbacks('cacheDidUpdate')) {\n          await callback({\n            cacheName,\n            oldResponse,\n            newResponse: responseToCache.clone(),\n            request: effectiveRequest,\n            event: this.event\n          });\n        }\n        return true;\n      }\n      /**\n       * Checks the list of plugins for the `cacheKeyWillBeUsed` callback, and\n       * executes any of those callbacks found in sequence. The final `Request`\n       * object returned by the last plugin is treated as the cache key for cache\n       * reads and/or writes. If no `cacheKeyWillBeUsed` plugin callbacks have\n       * been registered, the passed request is returned unmodified\n       *\n       * @param {Request} request\n       * @param {string} mode\n       * @return {Promise<Request>}\n       */\n      async getCacheKey(request, mode) {\n        const key = `${request.url} | ${mode}`;\n        if (!this._cacheKeys[key]) {\n          let effectiveRequest = request;\n          for (const callback of this.iterateCallbacks('cacheKeyWillBeUsed')) {\n            effectiveRequest = toRequest(await callback({\n              mode,\n              request: effectiveRequest,\n              event: this.event,\n              // params has a type any can't change right now.\n              params: this.params  \n            }));\n          }\n          this._cacheKeys[key] = effectiveRequest;\n        }\n        return this._cacheKeys[key];\n      }\n      /**\n       * Returns true if the strategy has at least one plugin with the given\n       * callback.\n       *\n       * @param {string} name The name of the callback to check for.\n       * @return {boolean}\n       */\n      hasCallback(name) {\n        for (const plugin of this._strategy.plugins) {\n          if (name in plugin) {\n            return true;\n          }\n        }\n        return false;\n      }\n      /**\n       * Runs all plugin callbacks matching the given name, in order, passing the\n       * given param object (merged ith the current plugin state) as the only\n       * argument.\n       *\n       * Note: since this method runs all plugins, it's not suitable for cases\n       * where the return value of a callback needs to be applied prior to calling\n       * the next callback. See\n       * {@link workbox-strategies.StrategyHandler#iterateCallbacks}\n       * below for how to handle that case.\n       *\n       * @param {string} name The name of the callback to run within each plugin.\n       * @param {Object} param The object to pass as the first (and only) param\n       *     when executing each callback. This object will be merged with the\n       *     current plugin state prior to callback execution.\n       */\n      async runCallbacks(name, param) {\n        for (const callback of this.iterateCallbacks(name)) {\n          // TODO(philipwalton): not sure why `any` is needed. It seems like\n          // this should work with `as WorkboxPluginCallbackParam[C]`.\n          await callback(param);\n        }\n      }\n      /**\n       * Accepts a callback and returns an iterable of matching plugin callbacks,\n       * where each callback is wrapped with the current handler state (i.e. when\n       * you call each callback, whatever object parameter you pass it will\n       * be merged with the plugin's current state).\n       *\n       * @param {string} name The name fo the callback to run\n       * @return {Array<Function>}\n       */\n      *iterateCallbacks(name) {\n        for (const plugin of this._strategy.plugins) {\n          if (typeof plugin[name] === 'function') {\n            const state = this._pluginStateMap.get(plugin);\n            const statefulCallback = param => {\n              const statefulParam = Object.assign(Object.assign({}, param), {\n                state\n              });\n              // TODO(philipwalton): not sure why `any` is needed. It seems like\n              // this should work with `as WorkboxPluginCallbackParam[C]`.\n              return plugin[name](statefulParam);\n            };\n            yield statefulCallback;\n          }\n        }\n      }\n      /**\n       * Adds a promise to the\n       * [extend lifetime promises]{@link https://w3c.github.io/ServiceWorker/#extendableevent-extend-lifetime-promises}\n       * of the event associated with the request being handled (usually a\n       * `FetchEvent`).\n       *\n       * Note: you can await\n       * {@link workbox-strategies.StrategyHandler~doneWaiting}\n       * to know when all added promises have settled.\n       *\n       * @param {Promise} promise A promise to add to the extend lifetime promises\n       *     of the event that triggered the request.\n       */\n      waitUntil(promise) {\n        this._extendLifetimePromises.push(promise);\n        return promise;\n      }\n      /**\n       * Returns a promise that resolves once all promises passed to\n       * {@link workbox-strategies.StrategyHandler~waitUntil}\n       * have settled.\n       *\n       * Note: any work done after `doneWaiting()` settles should be manually\n       * passed to an event's `waitUntil()` method (not this handler's\n       * `waitUntil()` method), otherwise the service worker thread may be killed\n       * prior to your work completing.\n       */\n      async doneWaiting() {\n        while (this._extendLifetimePromises.length) {\n          const promises = this._extendLifetimePromises.splice(0);\n          const result = await Promise.allSettled(promises);\n          const firstRejection = result.find(i => i.status === 'rejected');\n          if (firstRejection) {\n            throw firstRejection.reason;\n          }\n        }\n      }\n      /**\n       * Stops running the strategy and immediately resolves any pending\n       * `waitUntil()` promises.\n       */\n      destroy() {\n        this._handlerDeferred.resolve(null);\n      }\n      /**\n       * This method will call cacheWillUpdate on the available plugins (or use\n       * status === 200) to determine if the Response is safe and valid to cache.\n       *\n       * @param {Request} options.request\n       * @param {Response} options.response\n       * @return {Promise<Response|undefined>}\n       *\n       * @private\n       */\n      async _ensureResponseSafeToCache(response) {\n        let responseToCache = response;\n        let pluginsUsed = false;\n        for (const callback of this.iterateCallbacks('cacheWillUpdate')) {\n          responseToCache = (await callback({\n            request: this.request,\n            response: responseToCache,\n            event: this.event\n          })) || undefined;\n          pluginsUsed = true;\n          if (!responseToCache) {\n            break;\n          }\n        }\n        if (!pluginsUsed) {\n          if (responseToCache && responseToCache.status !== 200) {\n            responseToCache = undefined;\n          }\n          {\n            if (responseToCache) {\n              if (responseToCache.status !== 200) {\n                if (responseToCache.status === 0) {\n                  logger.warn(`The response for '${this.request.url}' ` + `is an opaque response. The caching strategy that you're ` + `using will not cache opaque responses by default.`);\n                } else {\n                  logger.debug(`The response for '${this.request.url}' ` + `returned a status code of '${response.status}' and won't ` + `be cached as a result.`);\n                }\n              }\n            }\n          }\n        }\n        return responseToCache;\n      }\n    }\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * An abstract base class that all other strategy classes must extend from:\n     *\n     * @memberof workbox-strategies\n     */\n    class Strategy {\n      /**\n       * Creates a new instance of the strategy and sets all documented option\n       * properties as public instance properties.\n       *\n       * Note: if a custom strategy class extends the base Strategy class and does\n       * not need more than these properties, it does not need to define its own\n       * constructor.\n       *\n       * @param {Object} [options]\n       * @param {string} [options.cacheName] Cache name to store and retrieve\n       * requests. Defaults to the cache names provided by\n       * {@link workbox-core.cacheNames}.\n       * @param {Array<Object>} [options.plugins] [Plugins]{@link https://developers.google.com/web/tools/workbox/guides/using-plugins}\n       * to use in conjunction with this caching strategy.\n       * @param {Object} [options.fetchOptions] Values passed along to the\n       * [`init`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters)\n       * of [non-navigation](https://github.com/GoogleChrome/workbox/issues/1796)\n       * `fetch()` requests made by this strategy.\n       * @param {Object} [options.matchOptions] The\n       * [`CacheQueryOptions`]{@link https://w3c.github.io/ServiceWorker/#dictdef-cachequeryoptions}\n       * for any `cache.match()` or `cache.put()` calls made by this strategy.\n       */\n      constructor(options = {}) {\n        /**\n         * Cache name to store and retrieve\n         * requests. Defaults to the cache names provided by\n         * {@link workbox-core.cacheNames}.\n         *\n         * @type {string}\n         */\n        this.cacheName = cacheNames.getRuntimeName(options.cacheName);\n        /**\n         * The list\n         * [Plugins]{@link https://developers.google.com/web/tools/workbox/guides/using-plugins}\n         * used by this strategy.\n         *\n         * @type {Array<Object>}\n         */\n        this.plugins = options.plugins || [];\n        /**\n         * Values passed along to the\n         * [`init`]{@link https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters}\n         * of all fetch() requests made by this strategy.\n         *\n         * @type {Object}\n         */\n        this.fetchOptions = options.fetchOptions;\n        /**\n         * The\n         * [`CacheQueryOptions`]{@link https://w3c.github.io/ServiceWorker/#dictdef-cachequeryoptions}\n         * for any `cache.match()` or `cache.put()` calls made by this strategy.\n         *\n         * @type {Object}\n         */\n        this.matchOptions = options.matchOptions;\n      }\n      /**\n       * Perform a request strategy and returns a `Promise` that will resolve with\n       * a `Response`, invoking all relevant plugin callbacks.\n       *\n       * When a strategy instance is registered with a Workbox\n       * {@link workbox-routing.Route}, this method is automatically\n       * called when the route matches.\n       *\n       * Alternatively, this method can be used in a standalone `FetchEvent`\n       * listener by passing it to `event.respondWith()`.\n       *\n       * @param {FetchEvent|Object} options A `FetchEvent` or an object with the\n       *     properties listed below.\n       * @param {Request|string} options.request A request to run this strategy for.\n       * @param {ExtendableEvent} options.event The event associated with the\n       *     request.\n       * @param {URL} [options.url]\n       * @param {*} [options.params]\n       */\n      handle(options) {\n        const [responseDone] = this.handleAll(options);\n        return responseDone;\n      }\n      /**\n       * Similar to {@link workbox-strategies.Strategy~handle}, but\n       * instead of just returning a `Promise` that resolves to a `Response` it\n       * it will return an tuple of `[response, done]` promises, where the former\n       * (`response`) is equivalent to what `handle()` returns, and the latter is a\n       * Promise that will resolve once any promises that were added to\n       * `event.waitUntil()` as part of performing the strategy have completed.\n       *\n       * You can await the `done` promise to ensure any extra work performed by\n       * the strategy (usually caching responses) completes successfully.\n       *\n       * @param {FetchEvent|Object} options A `FetchEvent` or an object with the\n       *     properties listed below.\n       * @param {Request|string} options.request A request to run this strategy for.\n       * @param {ExtendableEvent} options.event The event associated with the\n       *     request.\n       * @param {URL} [options.url]\n       * @param {*} [options.params]\n       * @return {Array<Promise>} A tuple of [response, done]\n       *     promises that can be used to determine when the response resolves as\n       *     well as when the handler has completed all its work.\n       */\n      handleAll(options) {\n        // Allow for flexible options to be passed.\n        if (options instanceof FetchEvent) {\n          options = {\n            event: options,\n            request: options.request\n          };\n        }\n        const event = options.event;\n        const request = typeof options.request === 'string' ? new Request(options.request) : options.request;\n        const params = 'params' in options ? options.params : undefined;\n        const handler = new StrategyHandler(this, {\n          event,\n          request,\n          params\n        });\n        const responseDone = this._getResponse(handler, request, event);\n        const handlerDone = this._awaitComplete(responseDone, handler, request, event);\n        // Return an array of promises, suitable for use with Promise.all().\n        return [responseDone, handlerDone];\n      }\n      async _getResponse(handler, request, event) {\n        await handler.runCallbacks('handlerWillStart', {\n          event,\n          request\n        });\n        let response = undefined;\n        try {\n          response = await this._handle(request, handler);\n          // The \"official\" Strategy subclasses all throw this error automatically,\n          // but in case a third-party Strategy doesn't, ensure that we have a\n          // consistent failure when there's no response or an error response.\n          if (!response || response.type === 'error') {\n            throw new WorkboxError('no-response', {\n              url: request.url\n            });\n          }\n        } catch (error) {\n          if (error instanceof Error) {\n            for (const callback of handler.iterateCallbacks('handlerDidError')) {\n              response = await callback({\n                error,\n                event,\n                request\n              });\n              if (response) {\n                break;\n              }\n            }\n          }\n          if (!response) {\n            throw error;\n          } else {\n            logger.log(`While responding to '${getFriendlyURL(request.url)}', ` + `an ${error instanceof Error ? error.toString() : ''} error occurred. Using a fallback response provided by ` + `a handlerDidError plugin.`);\n          }\n        }\n        for (const callback of handler.iterateCallbacks('handlerWillRespond')) {\n          response = await callback({\n            event,\n            request,\n            response\n          });\n        }\n        return response;\n      }\n      async _awaitComplete(responseDone, handler, request, event) {\n        let response;\n        let error;\n        try {\n          response = await responseDone;\n        } catch (error) {\n          // Ignore errors, as response errors should be caught via the `response`\n          // promise above. The `done` promise will only throw for errors in\n          // promises passed to `handler.waitUntil()`.\n        }\n        try {\n          await handler.runCallbacks('handlerDidRespond', {\n            event,\n            request,\n            response\n          });\n          await handler.doneWaiting();\n        } catch (waitUntilError) {\n          if (waitUntilError instanceof Error) {\n            error = waitUntilError;\n          }\n        }\n        await handler.runCallbacks('handlerDidComplete', {\n          event,\n          request,\n          response,\n          error: error\n        });\n        handler.destroy();\n        if (error) {\n          throw error;\n        }\n      }\n    }\n    /**\n     * Classes extending the `Strategy` based class should implement this method,\n     * and leverage the {@link workbox-strategies.StrategyHandler}\n     * arg to perform all fetching and cache logic, which will ensure all relevant\n     * cache, cache options, fetch options and plugins are used (per the current\n     * strategy instance).\n     *\n     * @name _handle\n     * @instance\n     * @abstract\n     * @function\n     * @param {Request} request\n     * @param {workbox-strategies.StrategyHandler} handler\n     * @return {Promise<Response>}\n     *\n     * @memberof workbox-strategies.Strategy\n     */\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A {@link workbox-strategies.Strategy} implementation\n     * specifically designed to work with\n     * {@link workbox-precaching.PrecacheController}\n     * to both cache and fetch precached assets.\n     *\n     * Note: an instance of this class is created automatically when creating a\n     * `PrecacheController`; it's generally not necessary to create this yourself.\n     *\n     * @extends workbox-strategies.Strategy\n     * @memberof workbox-precaching\n     */\n    class PrecacheStrategy extends Strategy {\n      /**\n       *\n       * @param {Object} [options]\n       * @param {string} [options.cacheName] Cache name to store and retrieve\n       * requests. Defaults to the cache names provided by\n       * {@link workbox-core.cacheNames}.\n       * @param {Array<Object>} [options.plugins] {@link https://developers.google.com/web/tools/workbox/guides/using-plugins|Plugins}\n       * to use in conjunction with this caching strategy.\n       * @param {Object} [options.fetchOptions] Values passed along to the\n       * {@link https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters|init}\n       * of all fetch() requests made by this strategy.\n       * @param {Object} [options.matchOptions] The\n       * {@link https://w3c.github.io/ServiceWorker/#dictdef-cachequeryoptions|CacheQueryOptions}\n       * for any `cache.match()` or `cache.put()` calls made by this strategy.\n       * @param {boolean} [options.fallbackToNetwork=true] Whether to attempt to\n       * get the response from the network if there's a precache miss.\n       */\n      constructor(options = {}) {\n        options.cacheName = cacheNames.getPrecacheName(options.cacheName);\n        super(options);\n        this._fallbackToNetwork = options.fallbackToNetwork === false ? false : true;\n        // Redirected responses cannot be used to satisfy a navigation request, so\n        // any redirected response must be \"copied\" rather than cloned, so the new\n        // response doesn't contain the `redirected` flag. See:\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=669363&desc=2#c1\n        this.plugins.push(PrecacheStrategy.copyRedirectedCacheableResponsesPlugin);\n      }\n      /**\n       * @private\n       * @param {Request|string} request A request to run this strategy for.\n       * @param {workbox-strategies.StrategyHandler} handler The event that\n       *     triggered the request.\n       * @return {Promise<Response>}\n       */\n      async _handle(request, handler) {\n        const response = await handler.cacheMatch(request);\n        if (response) {\n          return response;\n        }\n        // If this is an `install` event for an entry that isn't already cached,\n        // then populate the cache.\n        if (handler.event && handler.event.type === 'install') {\n          return await this._handleInstall(request, handler);\n        }\n        // Getting here means something went wrong. An entry that should have been\n        // precached wasn't found in the cache.\n        return await this._handleFetch(request, handler);\n      }\n      async _handleFetch(request, handler) {\n        let response;\n        const params = handler.params || {};\n        // Fall back to the network if we're configured to do so.\n        if (this._fallbackToNetwork) {\n          {\n            logger.warn(`The precached response for ` + `${getFriendlyURL(request.url)} in ${this.cacheName} was not ` + `found. Falling back to the network.`);\n          }\n          const integrityInManifest = params.integrity;\n          const integrityInRequest = request.integrity;\n          const noIntegrityConflict = !integrityInRequest || integrityInRequest === integrityInManifest;\n          // Do not add integrity if the original request is no-cors\n          // See https://github.com/GoogleChrome/workbox/issues/3096\n          response = await handler.fetch(new Request(request, {\n            integrity: request.mode !== 'no-cors' ? integrityInRequest || integrityInManifest : undefined\n          }));\n          // It's only \"safe\" to repair the cache if we're using SRI to guarantee\n          // that the response matches the precache manifest's expectations,\n          // and there's either a) no integrity property in the incoming request\n          // or b) there is an integrity, and it matches the precache manifest.\n          // See https://github.com/GoogleChrome/workbox/issues/2858\n          // Also if the original request users no-cors we don't use integrity.\n          // See https://github.com/GoogleChrome/workbox/issues/3096\n          if (integrityInManifest && noIntegrityConflict && request.mode !== 'no-cors') {\n            this._useDefaultCacheabilityPluginIfNeeded();\n            const wasCached = await handler.cachePut(request, response.clone());\n            {\n              if (wasCached) {\n                logger.log(`A response for ${getFriendlyURL(request.url)} ` + `was used to \"repair\" the precache.`);\n              }\n            }\n          }\n        } else {\n          // This shouldn't normally happen, but there are edge cases:\n          // https://github.com/GoogleChrome/workbox/issues/1441\n          throw new WorkboxError('missing-precache-entry', {\n            cacheName: this.cacheName,\n            url: request.url\n          });\n        }\n        {\n          const cacheKey = params.cacheKey || (await handler.getCacheKey(request, 'read'));\n          // Workbox is going to handle the route.\n          // print the routing details to the console.\n          logger.groupCollapsed(`Precaching is responding to: ` + getFriendlyURL(request.url));\n          logger.log(`Serving the precached url: ${getFriendlyURL(cacheKey instanceof Request ? cacheKey.url : cacheKey)}`);\n          logger.groupCollapsed(`View request details here.`);\n          logger.log(request);\n          logger.groupEnd();\n          logger.groupCollapsed(`View response details here.`);\n          logger.log(response);\n          logger.groupEnd();\n          logger.groupEnd();\n        }\n        return response;\n      }\n      async _handleInstall(request, handler) {\n        this._useDefaultCacheabilityPluginIfNeeded();\n        const response = await handler.fetch(request);\n        // Make sure we defer cachePut() until after we know the response\n        // should be cached; see https://github.com/GoogleChrome/workbox/issues/2737\n        const wasCached = await handler.cachePut(request, response.clone());\n        if (!wasCached) {\n          // Throwing here will lead to the `install` handler failing, which\n          // we want to do if *any* of the responses aren't safe to cache.\n          throw new WorkboxError('bad-precaching-response', {\n            url: request.url,\n            status: response.status\n          });\n        }\n        return response;\n      }\n      /**\n       * This method is complex, as there a number of things to account for:\n       *\n       * The `plugins` array can be set at construction, and/or it might be added to\n       * to at any time before the strategy is used.\n       *\n       * At the time the strategy is used (i.e. during an `install` event), there\n       * needs to be at least one plugin that implements `cacheWillUpdate` in the\n       * array, other than `copyRedirectedCacheableResponsesPlugin`.\n       *\n       * - If this method is called and there are no suitable `cacheWillUpdate`\n       * plugins, we need to add `defaultPrecacheCacheabilityPlugin`.\n       *\n       * - If this method is called and there is exactly one `cacheWillUpdate`, then\n       * we don't have to do anything (this might be a previously added\n       * `defaultPrecacheCacheabilityPlugin`, or it might be a custom plugin).\n       *\n       * - If this method is called and there is more than one `cacheWillUpdate`,\n       * then we need to check if one is `defaultPrecacheCacheabilityPlugin`. If so,\n       * we need to remove it. (This situation is unlikely, but it could happen if\n       * the strategy is used multiple times, the first without a `cacheWillUpdate`,\n       * and then later on after manually adding a custom `cacheWillUpdate`.)\n       *\n       * See https://github.com/GoogleChrome/workbox/issues/2737 for more context.\n       *\n       * @private\n       */\n      _useDefaultCacheabilityPluginIfNeeded() {\n        let defaultPluginIndex = null;\n        let cacheWillUpdatePluginCount = 0;\n        for (const [index, plugin] of this.plugins.entries()) {\n          // Ignore the copy redirected plugin when determining what to do.\n          if (plugin === PrecacheStrategy.copyRedirectedCacheableResponsesPlugin) {\n            continue;\n          }\n          // Save the default plugin's index, in case it needs to be removed.\n          if (plugin === PrecacheStrategy.defaultPrecacheCacheabilityPlugin) {\n            defaultPluginIndex = index;\n          }\n          if (plugin.cacheWillUpdate) {\n            cacheWillUpdatePluginCount++;\n          }\n        }\n        if (cacheWillUpdatePluginCount === 0) {\n          this.plugins.push(PrecacheStrategy.defaultPrecacheCacheabilityPlugin);\n        } else if (cacheWillUpdatePluginCount > 1 && defaultPluginIndex !== null) {\n          // Only remove the default plugin; multiple custom plugins are allowed.\n          this.plugins.splice(defaultPluginIndex, 1);\n        }\n        // Nothing needs to be done if cacheWillUpdatePluginCount is 1\n      }\n    }\n    PrecacheStrategy.defaultPrecacheCacheabilityPlugin = {\n      async cacheWillUpdate({\n        response\n      }) {\n        if (!response || response.status >= 400) {\n          return null;\n        }\n        return response;\n      }\n    };\n    PrecacheStrategy.copyRedirectedCacheableResponsesPlugin = {\n      async cacheWillUpdate({\n        response\n      }) {\n        return response.redirected ? await copyResponse(response) : response;\n      }\n    };\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Performs efficient precaching of assets.\n     *\n     * @memberof workbox-precaching\n     */\n    class PrecacheController {\n      /**\n       * Create a new PrecacheController.\n       *\n       * @param {Object} [options]\n       * @param {string} [options.cacheName] The cache to use for precaching.\n       * @param {string} [options.plugins] Plugins to use when precaching as well\n       * as responding to fetch events for precached assets.\n       * @param {boolean} [options.fallbackToNetwork=true] Whether to attempt to\n       * get the response from the network if there's a precache miss.\n       */\n      constructor({\n        cacheName,\n        plugins = [],\n        fallbackToNetwork = true\n      } = {}) {\n        this._urlsToCacheKeys = new Map();\n        this._urlsToCacheModes = new Map();\n        this._cacheKeysToIntegrities = new Map();\n        this._strategy = new PrecacheStrategy({\n          cacheName: cacheNames.getPrecacheName(cacheName),\n          plugins: [...plugins, new PrecacheCacheKeyPlugin({\n            precacheController: this\n          })],\n          fallbackToNetwork\n        });\n        // Bind the install and activate methods to the instance.\n        this.install = this.install.bind(this);\n        this.activate = this.activate.bind(this);\n      }\n      /**\n       * @type {workbox-precaching.PrecacheStrategy} The strategy created by this controller and\n       * used to cache assets and respond to fetch events.\n       */\n      get strategy() {\n        return this._strategy;\n      }\n      /**\n       * Adds items to the precache list, removing any duplicates and\n       * stores the files in the\n       * {@link workbox-core.cacheNames|\"precache cache\"} when the service\n       * worker installs.\n       *\n       * This method can be called multiple times.\n       *\n       * @param {Array<Object|string>} [entries=[]] Array of entries to precache.\n       */\n      precache(entries) {\n        this.addToCacheList(entries);\n        if (!this._installAndActiveListenersAdded) {\n          self.addEventListener('install', this.install);\n          self.addEventListener('activate', this.activate);\n          this._installAndActiveListenersAdded = true;\n        }\n      }\n      /**\n       * This method will add items to the precache list, removing duplicates\n       * and ensuring the information is valid.\n       *\n       * @param {Array<workbox-precaching.PrecacheController.PrecacheEntry|string>} entries\n       *     Array of entries to precache.\n       */\n      addToCacheList(entries) {\n        {\n          finalAssertExports.isArray(entries, {\n            moduleName: 'workbox-precaching',\n            className: 'PrecacheController',\n            funcName: 'addToCacheList',\n            paramName: 'entries'\n          });\n        }\n        const urlsToWarnAbout = [];\n        for (const entry of entries) {\n          // See https://github.com/GoogleChrome/workbox/issues/2259\n          if (typeof entry === 'string') {\n            urlsToWarnAbout.push(entry);\n          } else if (entry && entry.revision === undefined) {\n            urlsToWarnAbout.push(entry.url);\n          }\n          const {\n            cacheKey,\n            url\n          } = createCacheKey(entry);\n          const cacheMode = typeof entry !== 'string' && entry.revision ? 'reload' : 'default';\n          if (this._urlsToCacheKeys.has(url) && this._urlsToCacheKeys.get(url) !== cacheKey) {\n            throw new WorkboxError('add-to-cache-list-conflicting-entries', {\n              firstEntry: this._urlsToCacheKeys.get(url),\n              secondEntry: cacheKey\n            });\n          }\n          if (typeof entry !== 'string' && entry.integrity) {\n            if (this._cacheKeysToIntegrities.has(cacheKey) && this._cacheKeysToIntegrities.get(cacheKey) !== entry.integrity) {\n              throw new WorkboxError('add-to-cache-list-conflicting-integrities', {\n                url\n              });\n            }\n            this._cacheKeysToIntegrities.set(cacheKey, entry.integrity);\n          }\n          this._urlsToCacheKeys.set(url, cacheKey);\n          this._urlsToCacheModes.set(url, cacheMode);\n          if (urlsToWarnAbout.length > 0) {\n            const warningMessage = `Workbox is precaching URLs without revision ` + `info: ${urlsToWarnAbout.join(', ')}\\nThis is generally NOT safe. ` + `Learn more at https://bit.ly/wb-precache`;\n            {\n              logger.warn(warningMessage);\n            }\n          }\n        }\n      }\n      /**\n       * Precaches new and updated assets. Call this method from the service worker\n       * install event.\n       *\n       * Note: this method calls `event.waitUntil()` for you, so you do not need\n       * to call it yourself in your event handlers.\n       *\n       * @param {ExtendableEvent} event\n       * @return {Promise<workbox-precaching.InstallResult>}\n       */\n      install(event) {\n        // waitUntil returns Promise<any>\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return waitUntil(event, async () => {\n          const installReportPlugin = new PrecacheInstallReportPlugin();\n          this.strategy.plugins.push(installReportPlugin);\n          // Cache entries one at a time.\n          // See https://github.com/GoogleChrome/workbox/issues/2528\n          for (const [url, cacheKey] of this._urlsToCacheKeys) {\n            const integrity = this._cacheKeysToIntegrities.get(cacheKey);\n            const cacheMode = this._urlsToCacheModes.get(url);\n            const request = new Request(url, {\n              integrity,\n              cache: cacheMode,\n              credentials: 'same-origin'\n            });\n            await Promise.all(this.strategy.handleAll({\n              params: {\n                cacheKey\n              },\n              request,\n              event\n            }));\n          }\n          const {\n            updatedURLs,\n            notUpdatedURLs\n          } = installReportPlugin;\n          {\n            printInstallDetails(updatedURLs, notUpdatedURLs);\n          }\n          return {\n            updatedURLs,\n            notUpdatedURLs\n          };\n        });\n      }\n      /**\n       * Deletes assets that are no longer present in the current precache manifest.\n       * Call this method from the service worker activate event.\n       *\n       * Note: this method calls `event.waitUntil()` for you, so you do not need\n       * to call it yourself in your event handlers.\n       *\n       * @param {ExtendableEvent} event\n       * @return {Promise<workbox-precaching.CleanupResult>}\n       */\n      activate(event) {\n        // waitUntil returns Promise<any>\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return waitUntil(event, async () => {\n          const cache = await self.caches.open(this.strategy.cacheName);\n          const currentlyCachedRequests = await cache.keys();\n          const expectedCacheKeys = new Set(this._urlsToCacheKeys.values());\n          const deletedURLs = [];\n          for (const request of currentlyCachedRequests) {\n            if (!expectedCacheKeys.has(request.url)) {\n              await cache.delete(request);\n              deletedURLs.push(request.url);\n            }\n          }\n          {\n            printCleanupDetails(deletedURLs);\n          }\n          return {\n            deletedURLs\n          };\n        });\n      }\n      /**\n       * Returns a mapping of a precached URL to the corresponding cache key, taking\n       * into account the revision information for the URL.\n       *\n       * @return {Map<string, string>} A URL to cache key mapping.\n       */\n      getURLsToCacheKeys() {\n        return this._urlsToCacheKeys;\n      }\n      /**\n       * Returns a list of all the URLs that have been precached by the current\n       * service worker.\n       *\n       * @return {Array<string>} The precached URLs.\n       */\n      getCachedURLs() {\n        return [...this._urlsToCacheKeys.keys()];\n      }\n      /**\n       * Returns the cache key used for storing a given URL. If that URL is\n       * unversioned, like `/index.html', then the cache key will be the original\n       * URL with a search parameter appended to it.\n       *\n       * @param {string} url A URL whose cache key you want to look up.\n       * @return {string} The versioned URL that corresponds to a cache key\n       * for the original URL, or undefined if that URL isn't precached.\n       */\n      getCacheKeyForURL(url) {\n        const urlObject = new URL(url, location.href);\n        return this._urlsToCacheKeys.get(urlObject.href);\n      }\n      /**\n       * @param {string} url A cache key whose SRI you want to look up.\n       * @return {string} The subresource integrity associated with the cache key,\n       * or undefined if it's not set.\n       */\n      getIntegrityForCacheKey(cacheKey) {\n        return this._cacheKeysToIntegrities.get(cacheKey);\n      }\n      /**\n       * This acts as a drop-in replacement for\n       * [`cache.match()`](https://developer.mozilla.org/en-US/docs/Web/API/Cache/match)\n       * with the following differences:\n       *\n       * - It knows what the name of the precache is, and only checks in that cache.\n       * - It allows you to pass in an \"original\" URL without versioning parameters,\n       * and it will automatically look up the correct cache key for the currently\n       * active revision of that URL.\n       *\n       * E.g., `matchPrecache('index.html')` will find the correct precached\n       * response for the currently active service worker, even if the actual cache\n       * key is `'/index.html?__WB_REVISION__=1234abcd'`.\n       *\n       * @param {string|Request} request The key (without revisioning parameters)\n       * to look up in the precache.\n       * @return {Promise<Response|undefined>}\n       */\n      async matchPrecache(request) {\n        const url = request instanceof Request ? request.url : request;\n        const cacheKey = this.getCacheKeyForURL(url);\n        if (cacheKey) {\n          const cache = await self.caches.open(this.strategy.cacheName);\n          return cache.match(cacheKey);\n        }\n        return undefined;\n      }\n      /**\n       * Returns a function that looks up `url` in the precache (taking into\n       * account revision information), and returns the corresponding `Response`.\n       *\n       * @param {string} url The precached URL which will be used to lookup the\n       * `Response`.\n       * @return {workbox-routing~handlerCallback}\n       */\n      createHandlerBoundToURL(url) {\n        const cacheKey = this.getCacheKeyForURL(url);\n        if (!cacheKey) {\n          throw new WorkboxError('non-precached-url', {\n            url\n          });\n        }\n        return options => {\n          options.request = new Request(url);\n          options.params = Object.assign({\n            cacheKey\n          }, options.params);\n          return this.strategy.handle(options);\n        };\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    let precacheController;\n    /**\n     * @return {PrecacheController}\n     * @private\n     */\n    const getOrCreatePrecacheController = () => {\n      if (!precacheController) {\n        precacheController = new PrecacheController();\n      }\n      return precacheController;\n    };\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Removes any URL search parameters that should be ignored.\n     *\n     * @param {URL} urlObject The original URL.\n     * @param {Array<RegExp>} ignoreURLParametersMatching RegExps to test against\n     * each search parameter name. Matches mean that the search parameter should be\n     * ignored.\n     * @return {URL} The URL with any ignored search parameters removed.\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    function removeIgnoredSearchParams(urlObject, ignoreURLParametersMatching = []) {\n      // Convert the iterable into an array at the start of the loop to make sure\n      // deletion doesn't mess up iteration.\n      for (const paramName of [...urlObject.searchParams.keys()]) {\n        if (ignoreURLParametersMatching.some(regExp => regExp.test(paramName))) {\n          urlObject.searchParams.delete(paramName);\n        }\n      }\n      return urlObject;\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Generator function that yields possible variations on the original URL to\n     * check, one at a time.\n     *\n     * @param {string} url\n     * @param {Object} options\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    function* generateURLVariations(url, {\n      ignoreURLParametersMatching = [/^utm_/, /^fbclid$/],\n      directoryIndex = 'index.html',\n      cleanURLs = true,\n      urlManipulation\n    } = {}) {\n      const urlObject = new URL(url, location.href);\n      urlObject.hash = '';\n      yield urlObject.href;\n      const urlWithoutIgnoredParams = removeIgnoredSearchParams(urlObject, ignoreURLParametersMatching);\n      yield urlWithoutIgnoredParams.href;\n      if (directoryIndex && urlWithoutIgnoredParams.pathname.endsWith('/')) {\n        const directoryURL = new URL(urlWithoutIgnoredParams.href);\n        directoryURL.pathname += directoryIndex;\n        yield directoryURL.href;\n      }\n      if (cleanURLs) {\n        const cleanURL = new URL(urlWithoutIgnoredParams.href);\n        cleanURL.pathname += '.html';\n        yield cleanURL.href;\n      }\n      if (urlManipulation) {\n        const additionalURLs = urlManipulation({\n          url: urlObject\n        });\n        for (const urlToAttempt of additionalURLs) {\n          yield urlToAttempt.href;\n        }\n      }\n    }\n\n    /*\n      Copyright 2020 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * A subclass of {@link workbox-routing.Route} that takes a\n     * {@link workbox-precaching.PrecacheController}\n     * instance and uses it to match incoming requests and handle fetching\n     * responses from the precache.\n     *\n     * @memberof workbox-precaching\n     * @extends workbox-routing.Route\n     */\n    class PrecacheRoute extends Route {\n      /**\n       * @param {PrecacheController} precacheController A `PrecacheController`\n       * instance used to both match requests and respond to fetch events.\n       * @param {Object} [options] Options to control how requests are matched\n       * against the list of precached URLs.\n       * @param {string} [options.directoryIndex=index.html] The `directoryIndex` will\n       * check cache entries for a URLs ending with '/' to see if there is a hit when\n       * appending the `directoryIndex` value.\n       * @param {Array<RegExp>} [options.ignoreURLParametersMatching=[/^utm_/, /^fbclid$/]] An\n       * array of regex's to remove search params when looking for a cache match.\n       * @param {boolean} [options.cleanURLs=true] The `cleanURLs` option will\n       * check the cache for the URL with a `.html` added to the end of the end.\n       * @param {workbox-precaching~urlManipulation} [options.urlManipulation]\n       * This is a function that should take a URL and return an array of\n       * alternative URLs that should be checked for precache matches.\n       */\n      constructor(precacheController, options) {\n        const match = ({\n          request\n        }) => {\n          const urlsToCacheKeys = precacheController.getURLsToCacheKeys();\n          for (const possibleURL of generateURLVariations(request.url, options)) {\n            const cacheKey = urlsToCacheKeys.get(possibleURL);\n            if (cacheKey) {\n              const integrity = precacheController.getIntegrityForCacheKey(cacheKey);\n              return {\n                cacheKey,\n                integrity\n              };\n            }\n          }\n          {\n            logger.debug(`Precaching did not find a match for ` + getFriendlyURL(request.url));\n          }\n          return;\n        };\n        super(match, precacheController.strategy);\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Add a `fetch` listener to the service worker that will\n     * respond to\n     * [network requests]{@link https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers#Custom_responses_to_requests}\n     * with precached assets.\n     *\n     * Requests for assets that aren't precached, the `FetchEvent` will not be\n     * responded to, allowing the event to fall through to other `fetch` event\n     * listeners.\n     *\n     * @param {Object} [options] See the {@link workbox-precaching.PrecacheRoute}\n     * options.\n     *\n     * @memberof workbox-precaching\n     */\n    function addRoute(options) {\n      const precacheController = getOrCreatePrecacheController();\n      const precacheRoute = new PrecacheRoute(precacheController, options);\n      registerRoute(precacheRoute);\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Adds items to the precache list, removing any duplicates and\n     * stores the files in the\n     * {@link workbox-core.cacheNames|\"precache cache\"} when the service\n     * worker installs.\n     *\n     * This method can be called multiple times.\n     *\n     * Please note: This method **will not** serve any of the cached files for you.\n     * It only precaches files. To respond to a network request you call\n     * {@link workbox-precaching.addRoute}.\n     *\n     * If you have a single array of files to precache, you can just call\n     * {@link workbox-precaching.precacheAndRoute}.\n     *\n     * @param {Array<Object|string>} [entries=[]] Array of entries to precache.\n     *\n     * @memberof workbox-precaching\n     */\n    function precache(entries) {\n      const precacheController = getOrCreatePrecacheController();\n      precacheController.precache(entries);\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * This method will add entries to the precache list and add a route to\n     * respond to fetch events.\n     *\n     * This is a convenience method that will call\n     * {@link workbox-precaching.precache} and\n     * {@link workbox-precaching.addRoute} in a single call.\n     *\n     * @param {Array<Object|string>} entries Array of entries to precache.\n     * @param {Object} [options] See the\n     * {@link workbox-precaching.PrecacheRoute} options.\n     *\n     * @memberof workbox-precaching\n     */\n    function precacheAndRoute(entries, options) {\n      precache(entries);\n      addRoute(options);\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    const SUBSTRING_TO_FIND = '-precache-';\n    /**\n     * Cleans up incompatible precaches that were created by older versions of\n     * Workbox, by a service worker registered under the current scope.\n     *\n     * This is meant to be called as part of the `activate` event.\n     *\n     * This should be safe to use as long as you don't include `substringToFind`\n     * (defaulting to `-precache-`) in your non-precache cache names.\n     *\n     * @param {string} currentPrecacheName The cache name currently in use for\n     * precaching. This cache won't be deleted.\n     * @param {string} [substringToFind='-precache-'] Cache names which include this\n     * substring will be deleted (excluding `currentPrecacheName`).\n     * @return {Array<string>} A list of all the cache names that were deleted.\n     *\n     * @private\n     * @memberof workbox-precaching\n     */\n    const deleteOutdatedCaches = async (currentPrecacheName, substringToFind = SUBSTRING_TO_FIND) => {\n      const cacheNames = await self.caches.keys();\n      const cacheNamesToDelete = cacheNames.filter(cacheName => {\n        return cacheName.includes(substringToFind) && cacheName.includes(self.registration.scope) && cacheName !== currentPrecacheName;\n      });\n      await Promise.all(cacheNamesToDelete.map(cacheName => self.caches.delete(cacheName)));\n      return cacheNamesToDelete;\n    };\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Adds an `activate` event listener which will clean up incompatible\n     * precaches that were created by older versions of Workbox.\n     *\n     * @memberof workbox-precaching\n     */\n    function cleanupOutdatedCaches() {\n      // See https://github.com/Microsoft/TypeScript/issues/28357#issuecomment-436484705\n      self.addEventListener('activate', event => {\n        const cacheName = cacheNames.getPrecacheName();\n        event.waitUntil(deleteOutdatedCaches(cacheName).then(cachesDeleted => {\n          {\n            if (cachesDeleted.length > 0) {\n              logger.log(`The following out-of-date precaches were cleaned up ` + `automatically:`, cachesDeleted);\n            }\n          }\n        }));\n      });\n    }\n\n    /*\n      Copyright 2018 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * NavigationRoute makes it easy to create a\n     * {@link workbox-routing.Route} that matches for browser\n     * [navigation requests]{@link https://developers.google.com/web/fundamentals/primers/service-workers/high-performance-loading#first_what_are_navigation_requests}.\n     *\n     * It will only match incoming Requests whose\n     * {@link https://fetch.spec.whatwg.org/#concept-request-mode|mode}\n     * is set to `navigate`.\n     *\n     * You can optionally only apply this route to a subset of navigation requests\n     * by using one or both of the `denylist` and `allowlist` parameters.\n     *\n     * @memberof workbox-routing\n     * @extends workbox-routing.Route\n     */\n    class NavigationRoute extends Route {\n      /**\n       * If both `denylist` and `allowlist` are provided, the `denylist` will\n       * take precedence and the request will not match this route.\n       *\n       * The regular expressions in `allowlist` and `denylist`\n       * are matched against the concatenated\n       * [`pathname`]{@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/pathname}\n       * and [`search`]{@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/search}\n       * portions of the requested URL.\n       *\n       * *Note*: These RegExps may be evaluated against every destination URL during\n       * a navigation. Avoid using\n       * [complex RegExps](https://github.com/GoogleChrome/workbox/issues/3077),\n       * or else your users may see delays when navigating your site.\n       *\n       * @param {workbox-routing~handlerCallback} handler A callback\n       * function that returns a Promise resulting in a Response.\n       * @param {Object} options\n       * @param {Array<RegExp>} [options.denylist] If any of these patterns match,\n       * the route will not handle the request (even if a allowlist RegExp matches).\n       * @param {Array<RegExp>} [options.allowlist=[/./]] If any of these patterns\n       * match the URL's pathname and search parameter, the route will handle the\n       * request (assuming the denylist doesn't match).\n       */\n      constructor(handler, {\n        allowlist = [/./],\n        denylist = []\n      } = {}) {\n        {\n          finalAssertExports.isArrayOfClass(allowlist, RegExp, {\n            moduleName: 'workbox-routing',\n            className: 'NavigationRoute',\n            funcName: 'constructor',\n            paramName: 'options.allowlist'\n          });\n          finalAssertExports.isArrayOfClass(denylist, RegExp, {\n            moduleName: 'workbox-routing',\n            className: 'NavigationRoute',\n            funcName: 'constructor',\n            paramName: 'options.denylist'\n          });\n        }\n        super(options => this._match(options), handler);\n        this._allowlist = allowlist;\n        this._denylist = denylist;\n      }\n      /**\n       * Routes match handler.\n       *\n       * @param {Object} options\n       * @param {URL} options.url\n       * @param {Request} options.request\n       * @return {boolean}\n       *\n       * @private\n       */\n      _match({\n        url,\n        request\n      }) {\n        if (request && request.mode !== 'navigate') {\n          return false;\n        }\n        const pathnameAndSearch = url.pathname + url.search;\n        for (const regExp of this._denylist) {\n          if (regExp.test(pathnameAndSearch)) {\n            {\n              logger.log(`The navigation route ${pathnameAndSearch} is not ` + `being used, since the URL matches this denylist pattern: ` + `${regExp.toString()}`);\n            }\n            return false;\n          }\n        }\n        if (this._allowlist.some(regExp => regExp.test(pathnameAndSearch))) {\n          {\n            logger.debug(`The navigation route ${pathnameAndSearch} ` + `is being used.`);\n          }\n          return true;\n        }\n        {\n          logger.log(`The navigation route ${pathnameAndSearch} is not ` + `being used, since the URL being navigated to doesn't ` + `match the allowlist.`);\n        }\n        return false;\n      }\n    }\n\n    /*\n      Copyright 2019 Google LLC\n\n      Use of this source code is governed by an MIT-style\n      license that can be found in the LICENSE file or at\n      https://opensource.org/licenses/MIT.\n    */\n    /**\n     * Helper function that calls\n     * {@link PrecacheController#createHandlerBoundToURL} on the default\n     * {@link PrecacheController} instance.\n     *\n     * If you are creating your own {@link PrecacheController}, then call the\n     * {@link PrecacheController#createHandlerBoundToURL} on that instance,\n     * instead of using this function.\n     *\n     * @param {string} url The precached URL which will be used to lookup the\n     * `Response`.\n     * @param {boolean} [fallbackToNetwork=true] Whether to attempt to get the\n     * response from the network if there's a precache miss.\n     * @return {workbox-routing~handlerCallback}\n     *\n     * @memberof workbox-precaching\n     */\n    function createHandlerBoundToURL(url) {\n      const precacheController = getOrCreatePrecacheController();\n      return precacheController.createHandlerBoundToURL(url);\n    }\n\n    exports.NavigationRoute = NavigationRoute;\n    exports.cleanupOutdatedCaches = cleanupOutdatedCaches;\n    exports.clientsClaim = clientsClaim;\n    exports.createHandlerBoundToURL = createHandlerBoundToURL;\n    exports.precacheAndRoute = precacheAndRoute;\n    exports.registerRoute = registerRoute;\n\n}));\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\__tests__\\startup.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\InstallPWAHint.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\SyncStatusWatcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\analytics\\ConsistencyHeatmap.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'parseISO' is defined but never used.","line":11,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport {\r\n    AreaChart,\r\n    Area,\r\n    XAxis,\r\n    Tooltip,\r\n    ResponsiveContainer,\r\n    YAxis\r\n} from 'recharts';\r\nimport { format, subDays, parseISO } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { Activity } from 'lucide-react';\r\n\r\nexport const ConsistencyHeatmap: React.FC = () => {\r\n    const { gamification } = useStudy();\r\n\r\n    const data = useMemo(() => {\r\n        if (!gamification?.stats?.dailyHistory) return [];\r\n\r\n        const history = gamification.stats.dailyHistory;\r\n        const today = new Date();\r\n        const daysToShow = 14;\r\n\r\n        return Array.from({ length: daysToShow }, (_, i) => {\r\n            const d = subDays(today, (daysToShow - 1) - i);\r\n            const dateStr = format(d, 'yyyy-MM-dd');\r\n            return {\r\n                fullDate: dateStr,\r\n                date: format(d, 'dd/MM', { locale: ptBR }),\r\n                minutes: history[dateStr] || 0\r\n            };\r\n        });\r\n    }, [gamification]);\r\n\r\n    const averageMinutes = useMemo(() => {\r\n        const total = data.reduce((acc, curr) => acc + curr.minutes, 0);\r\n        return Math.round(total / 14 || 0);\r\n    }, [data]);\r\n\r\n    if (!gamification || !gamification.stats) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"w-full bg-slate-950/50 backdrop-blur-xl border border-white/10 rounded-[2rem] p-6 relative overflow-hidden shadow-2xl group\">\r\n            {/* Realistic Glossy Highlight */}\r\n            <div className=\"absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/5 to-transparent pointer-events-none\" />\r\n\r\n            {/* Background Glow */}\r\n            <div className=\"absolute -bottom-20 -right-20 w-64 h-64 bg-blue-600/20 rounded-full blur-[80px] pointer-events-none\" />\r\n            <div className=\"absolute -top-20 -left-20 w-64 h-64 bg-indigo-600/20 rounded-full blur-[80px] pointer-events-none\" />\r\n\r\n\r\n            <div className=\"flex items-center justify-between mb-8 relative z-10\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-gradient-to-br from-blue-500/20 to-indigo-500/20 flex items-center justify-center text-blue-400 border border-white/5 shadow-inner\">\r\n                        <Activity className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"font-bold text-white text-xl tracking-tight\">Ritmo de Estudos</h3>\r\n                        <p className=\"text-sm text-slate-400 font-medium\">Sua consistncia nas ltimas 2 semanas</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Stats Summary Badge */}\r\n                <div className=\"bg-slate-900/80 border border-white/10 px-4 py-2 rounded-xl backdrop-blur-md\">\r\n                    <span className=\"text-xs text-slate-400 uppercase tracking-wider font-bold block mb-0.5\">Mdia Diria</span>\r\n                    <span className=\"text-lg font-bold text-white\">\r\n                        {averageMinutes} min\r\n                    </span>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"h-[280px] w-full relative z-10\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <AreaChart data={data} margin={{ top: 10, right: 0, left: 0, bottom: 0 }}>\r\n                        <defs>\r\n                            <linearGradient id=\"colorMinutes\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                <stop offset=\"5%\" stopColor=\"#3b82f6\" stopOpacity={0.5} />\r\n                                <stop offset=\"50%\" stopColor=\"#6366f1\" stopOpacity={0.1} />\r\n                                <stop offset=\"95%\" stopColor=\"#3b82f6\" stopOpacity={0} />\r\n                            </linearGradient>\r\n                        </defs>\r\n                        <Tooltip\r\n                            content={({ active, payload, label }) => {\r\n                                if (active && payload && payload.length) {\r\n                                    return (\r\n                                        <div className=\"bg-slate-900/90 border border-slate-700/50 p-3 rounded-xl shadow-xl backdrop-blur-xl\">\r\n                                            <p className=\"text-slate-300 text-xs font-medium mb-1\">{label}</p>\r\n                                            <p className=\"text-white font-bold text-sm\">\r\n                                                {payload[0].value} minutos\r\n                                            </p>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n                                return null;\r\n                            }}\r\n                        />\r\n                        <XAxis\r\n                            dataKey=\"date\"\r\n                            axisLine={false}\r\n                            tickLine={false}\r\n                            tick={{ fill: '#94a3b8', fontSize: 11, fontFamily: 'Inter' }}\r\n                            dy={10}\r\n                            interval={1}\r\n                        />\r\n                        {/* YAxis hidden but present for scaling */}\r\n                        <YAxis hide domain={[0, 'auto']} />\r\n                        <Area\r\n                            type=\"monotone\"\r\n                            dataKey=\"minutes\"\r\n                            stroke=\"#60a5fa\"\r\n                            strokeWidth={3}\r\n                            fill=\"url(#colorMinutes)\"\r\n                            activeDot={{ r: 6, stroke: '#3b82f6', strokeWidth: 2, fill: '#fff' }}\r\n                        />\r\n                    </AreaChart>\r\n                </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Bottom fading reflection */}\r\n            <div className=\"absolute bottom-0 left-0 w-full h-8 bg-gradient-to-t from-slate-950/50 to-transparent pointer-events-none\" />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\forms\\ColorPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\forms\\DaySelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\forms\\DurationStepper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\forms\\ImageUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\forms\\PrioritySelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\gamification\\AchievementModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useState' is defined but never used.","line":1,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[706,709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[706,709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Trophy, X } from 'lucide-react';\r\nimport * as Icons from 'lucide-react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\n\r\nexport const AchievementModal = () => {\r\n    const { newlyUnlocked, dismissAchievement } = useStudy();\r\n\r\n    useEffect(() => {\r\n        if (newlyUnlocked) {\r\n            const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3');\r\n            audio.play().catch(() => { });\r\n        }\r\n    }, [newlyUnlocked]);\r\n\r\n    if (!newlyUnlocked) return null;\r\n\r\n    // Dynamic Icon\r\n    const IconComponent = (Icons as Record<string, any>)[newlyUnlocked.iconName] || Trophy;\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {newlyUnlocked && (\r\n                <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4 pointer-events-none\">\r\n                    <motion.div\r\n                        initial={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                        animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                        exit={{ opacity: 0, scale: 0.5, y: -50 }}\r\n                        className=\"bg-slate-900/90 backdrop-blur-xl border border-yellow-500/50 p-6 rounded-2xl shadow-2xl shadow-yellow-500/20 max-w-sm w-full text-center pointer-events-auto relative overflow-hidden\"\r\n                    >\r\n                        {/* Shine Effect */}\r\n                        <div className=\"absolute inset-0 bg-gradient-to-tr from-transparent via-white/5 to-transparent skew-x-12 pointer-events-none\" />\r\n\r\n                        <button\r\n                            onClick={dismissAchievement}\r\n                            className=\"absolute top-2 right-2 p-1 text-slate-500 hover:text-white\"\r\n                        >\r\n                            <X className=\"w-4 h-4\" />\r\n                        </button>\r\n\r\n                        <div className=\"flex justify-center mb-4 relative\">\r\n                            <div className=\"absolute inset-0 bg-yellow-500/30 blur-xl rounded-full\" />\r\n                            <div className=\"w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-600 rounded-full flex items-center justify-center relative shadow-inner border-4 border-slate-900\">\r\n                                <IconComponent className=\"w-10 h-10 text-white drop-shadow-md\" />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 10 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: 0.2 }}\r\n                        >\r\n                            <h2 className=\"text-yellow-400 font-bold uppercase tracking-widest text-xs mb-1\">Conquista Desbloqueada!</h2>\r\n                            <h3 className=\"text-2xl font-bold text-white mb-2\">{newlyUnlocked.title}</h3>\r\n                            <p className=\"text-slate-400 text-sm mb-6\">{newlyUnlocked.description}</p>\r\n\r\n                            <button\r\n                                onClick={dismissAchievement}\r\n                                className=\"w-full bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold py-3 rounded-xl transition-colors\"\r\n                            >\r\n                                Incrvel!\r\n                            </button>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                </div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\gamification\\Badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\gamification\\LevelBar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'nextTitle' is assigned a value but never used.","line":15,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":110,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7541,7544],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7541,7544],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Trophy, X, ChevronRight } from 'lucide-react';\r\nimport { XP_TABLE_DISPLAY, getTitleForLevel } from '../../config/gamification';\r\nimport { cn } from '../../lib/utils';\r\n\r\nexport const LevelBar = () => {\r\n    const { gamification } = useStudy();\r\n    const { level } = gamification || { level: { level: 1, currentXp: 0, nextLevelXp: 500, totalXp: 0 } };\r\n    const [showDetails, setShowDetails] = useState(false);\r\n\r\n    const percentage = Math.min(100, Math.max(0, (level.currentXp / level.nextLevelXp) * 100));\r\n    const currentTitle = getTitleForLevel(level.level);\r\n    const nextTitle = getTitleForLevel(level.level + 5);\r\n\r\n    return (\r\n        <div className=\"relative font-sans w-full cursor-default select-none group/level\">\r\n            {/* Main Widget Card */}\r\n            <div\r\n                onClick={() => setShowDetails(true)}\r\n                className=\"relative w-full bg-slate-900/60 backdrop-blur-xl rounded-2xl border border-white/5 p-3 overflow-hidden transition-all duration-300 hover:border-blue-500/30 hover:bg-slate-900/80 cursor-pointer active:scale-[0.98]\"\r\n            >\r\n                {/* Subtle Active Glow */}\r\n                <div className=\"absolute inset-x-0 bottom-0 h-px bg-gradient-to-r from-transparent via-blue-500/50 to-transparent opacity-0 group-hover/level:opacity-100 transition-opacity\" />\r\n\r\n                <div className=\"flex items-center gap-3 relative z-10\">\r\n                    {/* Rank Icon */}\r\n                    <div className=\"relative shrink-0\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center shadow-lg shadow-blue-500/20 group-hover/level:shadow-blue-500/40 transition-shadow\">\r\n                            <Trophy className=\"w-5 h-5 text-white drop-shadow-sm\" />\r\n                        </div>\r\n                        <div className=\"absolute -bottom-1 -right-1 bg-slate-950 border border-slate-800 text-[9px] font-bold text-white px-1.5 rounded-md shadow-sm z-20\">\r\n                            v{level.level}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Info & Progress */}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-center justify-between mb-1.5\">\r\n                            <div className=\"flex items-center gap-2 min-w-0\">\r\n                                <span className=\"text-xs font-bold text-slate-100 truncate group-hover/level:text-blue-200 transition-colors\">\r\n                                    {currentTitle}\r\n                                </span>\r\n                                <ChevronRight className=\"w-3 h-3 text-slate-600 group-hover/level:translate-x-0.5 transition-transform\" />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-mono font-bold text-blue-400\">\r\n                                {Math.round(percentage)}%\r\n                            </span>\r\n                        </div>\r\n\r\n                        {/* Liquid Progress Bar */}\r\n                        <div className=\"h-1.5 w-full bg-slate-800/50 rounded-full overflow-hidden relative\">\r\n                            <div\r\n                                className=\"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 via-cyan-400 to-blue-500 rounded-full transition-all duration-700 ease-out shadow-[0_0_10px_rgba(59,130,246,0.5)]\"\r\n                                style={{ width: `${percentage}%` }}\r\n                            >\r\n                                <div className=\"absolute inset-0 bg-white/20 animate-[shimmer_2s_infinite]\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* SAFE PORTAL DETAILS MODAL */}\r\n            {showDetails && (\r\n                createPortal(\r\n                    <div className=\"fixed inset-0 z-[99999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200\" onClick={() => setShowDetails(false)}>\r\n                        <div\r\n                            onClick={(e) => e.stopPropagation()}\r\n                            className=\"w-full max-w-xs bg-slate-950/95 backdrop-blur-2xl border border-white/10 rounded-3xl p-0 shadow-2xl relative overflow-hidden ring-1 ring-white/10 animate-in zoom-in-95 duration-200\"\r\n                        >\r\n                            {/* Header Gradient */}\r\n                            <div className=\"absolute top-0 inset-x-0 h-32 bg-gradient-to-b from-blue-900/20 to-transparent pointer-events-none\" />\r\n                            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none\" />\r\n\r\n                            {/* Modal Header */}\r\n                            <div className=\"relative p-5 text-center pb-0\">\r\n                                <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-600 to-indigo-700 shadow-xl shadow-blue-500/20 mb-4 ring-1 ring-white/10\">\r\n                                    <Trophy className=\"w-8 h-8 text-white drop-shadow-md\" />\r\n                                </div>\r\n                                <h2 className=\"text-xl font-black text-white tracking-tight mb-1\">Nvel {level.level}</h2>\r\n                                <p className=\"text-sm text-blue-200 font-medium\">{currentTitle}</p>\r\n\r\n                                <button\r\n                                    onClick={() => setShowDetails(false)}\r\n                                    className=\"absolute top-4 right-4 p-2 text-slate-500 hover:text-white rounded-full hover:bg-white/5 transition-colors\"\r\n                                >\r\n                                    <X className=\"w-4 h-4\" />\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Stats Grid */}\r\n                            <div className=\"grid grid-cols-2 gap-3 px-5 py-6\">\r\n                                <div className=\"p-3 rounded-xl bg-white/5 border border-white/5 flex flex-col items-center\">\r\n                                    <span className=\"text-[10px] uppercase text-slate-500 font-bold tracking-wider mb-1\">Total XP</span>\r\n                                    <span className=\"text-lg font-mono font-bold text-blue-400\">{level.totalXp}</span>\r\n                                </div>\r\n                                <div className=\"p-3 rounded-xl bg-white/5 border border-white/5 flex flex-col items-center\">\r\n                                    <span className=\"text-[10px] uppercase text-slate-500 font-bold tracking-wider mb-1\">Prximo</span>\r\n                                    <span className=\"text-lg font-mono font-bold text-slate-300\">{level.nextLevelXp}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* XP Table List */}\r\n                            <div className=\"px-5 pb-6 space-y-2\">\r\n                                <div className=\"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-3 pl-1\">\r\n                                    Como ganhar XP\r\n                                </div>\r\n                                {XP_TABLE_DISPLAY.map((item: any, idx: number) => (\r\n                                    <div key={idx} className=\"flex items-center justify-between p-2 rounded-xl bg-white/[0.03] border border-white/[0.02] hover:bg-white/5 transition-colors\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <div className={cn(\"p-1.5 rounded-lg\", (item.color || \"\").replace('text-', 'bg-').replace('400', '500/10'))}>\r\n                                                <item.icon className={cn(\"w-3.5 h-3.5\", item.color)} />\r\n                                            </div>\r\n                                            <span className=\"text-xs font-medium text-slate-300\">{item.label}</span>\r\n                                        </div>\r\n                                        <span className={cn(\"text-xs font-bold font-mono\", item.color)}>+{item.value}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    , document.body as HTMLElement)\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\gamification\\XPBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\layout\\GlobalActionBar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleValidate' is assigned a value but never used.","line":79,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { useAudio } from '../../context/AudioContext';\r\nimport { Play, Pause, CheckCircle2, X } from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\nimport { format } from 'date-fns';\r\n\r\nexport const GlobalActionBar = () => {\r\n    const {\r\n        activeFocus,\r\n        endFocus,\r\n        completeReview,\r\n        toggleTask,\r\n        toggleGoal,\r\n        toggleGoalItem,\r\n        tasks,\r\n        goals\r\n    } = useStudy();\r\n\r\n    const {\r\n        timeLeft,\r\n        isActive,\r\n        mode,\r\n        toggleTimer,\r\n        openWidget,\r\n        isWidgetVisible,\r\n        resetTimer,\r\n        linkedItemId,\r\n        settings\r\n    } = usePomodoroContext();\r\n\r\n    const { stopAudio } = useAudio();\r\n\r\n    const prevIsActive = useRef(isActive);\r\n\r\n    // Auto-start audio when focus begins, auto-stop when focus ends\r\n    useEffect(() => {\r\n        // Detect when focus session ends\r\n        if (!isActive && prevIsActive.current) {\r\n            stopAudio();\r\n        }\r\n        prevIsActive.current = isActive;\r\n    }, [isActive, stopAudio]);\r\n\r\n    // Robust Active Title Logic\r\n    // If activeFocus (Session) is missing, try to resolve from linkedItemId (Pomodoro persistence)\r\n    const activeTitle = React.useMemo(() => {\r\n        if (activeFocus?.title) return activeFocus.title;\r\n\r\n        if (linkedItemId) {\r\n            // Try finding in Tasks\r\n            const task = tasks.find(t => t.id === linkedItemId);\r\n            if (task) return task.title;\r\n\r\n            // Try Goals\r\n            const goal = goals.find(g => g.id === linkedItemId);\r\n            if (goal) return goal.title;\r\n\r\n            // Try Goal Items\r\n            for (const g of goals) {\r\n                const item = g.checklist?.find(i => i.id === linkedItemId);\r\n                if (item) return item.title;\r\n            }\r\n\r\n            // Try Themes/Subthemes\r\n            // (Assuming flat lookup or known structure, simplest is main themes or iterating)\r\n            // For now, let's keep it simple or user might just restart.\r\n        }\r\n\r\n        return 'Sem tarefa selecionada';\r\n    }, [activeFocus, linkedItemId, tasks, goals]);\r\n\r\n    // Determines if we are in \"Validation Mode\" (Timer finished + Active Focus)\r\n    const isValidationReady = timeLeft === 0 && mode === 'focus' && (!!activeFocus || !!linkedItemId);\r\n\r\n    // Handle Validation\r\n    const handleValidate = async (difficulty: 'easy' | 'medium' | 'hard' = 'medium') => {\r\n        // Fallback to linkedItemId if activeFocus is missing\r\n        const targetId = activeFocus?.id || linkedItemId;\r\n        if (!targetId) {\r\n            console.error(\"No target ID found for validation\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Attempt to resolve type if missing from activeFocus\r\n            let type = activeFocus?.type;\r\n            let parentId = activeFocus?.parentId;\r\n\r\n            // If type is missing (e.g. reload or just linkedItemId), try to find it\r\n            if (!type) {\r\n                // Check Tasks\r\n                if (tasks.some(t => t.id === targetId)) {\r\n                    type = 'task';\r\n                }\r\n                // Check Goals (Main Goal)\r\n                else if (goals.some(g => g.id === targetId)) {\r\n                    type = 'goal';\r\n                }\r\n                // Check Goal Items (Sub-goals)\r\n                else {\r\n                    for (const g of goals) {\r\n                        const item = g.checklist?.find(i => i.id === targetId);\r\n                        if (item) {\r\n                            type = 'goal'; // Treat as goal item\r\n                            parentId = g.id;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                // Check Themes (Reviews) - simplified check\r\n                // (This is trickier without more context, but let's assume if not others, it might be a review if we can find it)\r\n                if (!type) {\r\n                    // Iterate themes/subthemes\r\n                    // For now, if activeFocus is gone, review completion might fail without 'reviewNumber'.\r\n                    // We might need to assume a default or skip review completion if data is missing.\r\n                    // But for Tasks/Goals it IS robust now.\r\n                }\r\n            }\r\n\r\n            console.log(`Validating item: ${targetId}, Type: ${type}, Parent: ${parentId}, Time: ${format(new Date(), 'HH:mm:ss')}`);\r\n\r\n            // Current date for completion timestamp\r\n            const currentDate = format(new Date(), 'yyyy-MM-dd');\r\n\r\n            if (type === 'subtheme') {\r\n                if (activeFocus?.reviewNumber !== undefined) {\r\n                    await completeReview(targetId, activeFocus.reviewNumber, activeFocus.reviewType || 'review', difficulty);\r\n                } else {\r\n                    console.warn(\"Review validation partially skipped: missing reviewNumber\");\r\n                    // If it's an intro, difficulty doesn't matter much yet but we can pass it\r\n                    await completeReview(targetId, 0, 'intro', difficulty);\r\n                }\r\n            } else if (type === 'task') {\r\n                // Pass current date to ensure timestamp is saved\r\n                toggleTask(targetId, currentDate);\r\n            } else if (type === 'goal') {\r\n                if (parentId) {\r\n                    toggleGoalItem(parentId, targetId, currentDate);\r\n                } else {\r\n                    toggleGoal(targetId, currentDate);\r\n                }\r\n            }\r\n\r\n            endFocus(true); // End with success\r\n            resetTimer();   // Reset timer\r\n        } catch (error) {\r\n            console.error(\"Failed to validate:\", error);\r\n        }\r\n    };\r\n\r\n    const handleStop = () => {\r\n        endFocus(false); // Cancel\r\n        resetTimer();\r\n        stopAudio(); // Stop background audio\r\n    };\r\n\r\n    const formatTime = (seconds: number) => {\r\n        const m = Math.floor(seconds / 60);\r\n        const s = seconds % 60;\r\n        return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const getModeDuration = () => {\r\n        if (mode === 'focus') return settings.focusDuration * 60;\r\n        if (mode === 'shortBreak') return settings.shortBreakDuration * 60;\r\n        return settings.longBreakDuration * 60;\r\n    };\r\n\r\n    // If nothing is active and no timer is running, we could show a \"Daily Status\" or just hide.\r\n    // For now, let's only show if there is an Active Focus OR the Timer is Active/Paused (not initial state).\r\n    // Actually, user wants it \"always visible\" maybe? Let's check requirements.\r\n    // \"aparea em todas as telas\".\r\n    // If nothing active, maybe show \"Pronto para focar?\"\r\n    // Let's settle on: Show if Active Focus OR Timer Running OR Validation Ready.\r\n    const shouldShow = !!activeFocus || isActive || isValidationReady || timeLeft !== getModeDuration();\r\n\r\n    // Always show when active - don't hide even if big widget is open\r\n    // REVISION: Hide if big widget is already showing to avoid \"double validation\" buttons\r\n    if (!shouldShow || isWidgetVisible) return null;\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-[9999] pointer-events-none\">\r\n            <AnimatePresence>\r\n                {shouldShow && (\r\n                    <motion.div\r\n                        drag\r\n                        dragMomentum={false}\r\n                        initial={{ y: 100, opacity: 0, scale: 0.9 }}\r\n                        animate={{ y: 0, opacity: 1, scale: 1 }}\r\n                        exit={{ y: 100, opacity: 0, scale: 0.9 }}\r\n                        transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\r\n                        className={cn(\r\n                            \"pointer-events-auto flex items-center gap-2 px-3 py-2 rounded-full shadow-2xl backdrop-blur-xl border border-white/10 transition-all duration-300 cursor-move\",\r\n                            isValidationReady\r\n                                ? \"bg-emerald-950/90 border-emerald-500/50 shadow-emerald-900/40\"\r\n                                : \"bg-slate-900/80 border-slate-700/50 shadow-black/50\"\r\n                        )}\r\n                        onClick={() => {\r\n                            if (!isValidationReady) {\r\n                                toggleTimer();\r\n                            }\r\n                        }}\r\n                    >\r\n                        {/* 1. Validation Logic */}\r\n                        {isValidationReady ? (\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center animate-pulse\">\r\n                                    <CheckCircle2 className=\"w-6 h-6 text-emerald-950\" />\r\n                                </div>\r\n                                <div className=\"flex flex-col\">\r\n                                    <span className=\"text-xs text-emerald-300 font-bold uppercase tracking-wider\">Foco Finalizado</span>\r\n                                    <span className=\"text-sm font-medium text-white max-w-[200px] truncate\">{activeTitle}</span>\r\n                                </div>\r\n                                <div className=\"h-8 w-px bg-white/10 mx-1\" />\r\n\r\n                                {activeFocus?.type === 'subtheme' && activeFocus?.reviewType === 'review' ? (\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <button\r\n                                            onClick={openWidget}\r\n                                            className=\"px-6 py-1.5 bg-emerald-500 hover:bg-emerald-400 text-emerald-950 font-bold rounded-full transition-all text-sm shadow-lg shadow-emerald-500/20\"\r\n                                        >\r\n                                            Validar Sesso\r\n                                        </button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <button\r\n                                        onClick={openWidget}\r\n                                        className=\"px-6 py-1.5 bg-emerald-500 hover:bg-emerald-400 text-emerald-950 font-bold rounded-full transition-colors text-sm shadow-lg shadow-emerald-500/20\"\r\n                                    >\r\n                                        Validar Sesso\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n                        ) : (\r\n                            /* 2. Active Focus / Timer Logic - Compact Version */\r\n                            <>\r\n                                {/* Timer Circle - Smaller */}\r\n                                <div className={cn(\r\n                                    \"w-8 h-8 rounded-full flex items-center justify-center relative select-none shrink-0\",\r\n                                    mode === 'focus' ? \"bg-rose-500/20 text-rose-400\" : \"bg-blue-500/20 text-blue-400\"\r\n                                )}>\r\n                                    <svg className=\"absolute inset-0 w-full h-full -rotate-90\">\r\n                                        <circle cx=\"16\" cy=\"16\" r=\"14\" className=\"fill-none stroke-white/5\" strokeWidth=\"2\" />\r\n                                        <motion.circle\r\n                                            cx=\"16\" cy=\"16\" r=\"14\"\r\n                                            className=\"fill-none stroke-current\"\r\n                                            strokeWidth=\"2\"\r\n                                            initial={{ pathLength: 1 }}\r\n                                            animate={{ pathLength: timeLeft / getModeDuration() }}\r\n                                        />\r\n                                    </svg>\r\n                                    <span className=\"text-[9px] font-mono font-bold z-10\">{formatTime(timeLeft)}</span>\r\n                                </div>\r\n\r\n                                {/* Activity Name - More Prominent */}\r\n                                <span className=\"text-sm font-medium text-white max-w-[180px] truncate select-none\">\r\n                                    {activeTitle}\r\n                                </span>\r\n\r\n                                {/* Controls - Compact */}\r\n                                <div className=\"flex items-center gap-0.5\">\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); e.preventDefault(); toggleTimer(); }}\r\n                                        className=\"p-1.5 hover:bg-white/10 rounded-full text-slate-300 hover:text-white transition-colors\"\r\n                                        title={isActive ? \"Pausar\" : \"Retomar\"}\r\n                                    >\r\n                                        {isActive ? <Pause className=\"w-3.5 h-3.5\" /> : <Play className=\"w-3.5 h-3.5\" />}\r\n                                    </button>\r\n\r\n                                    {/* Cancel Focus button - always visible */}\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); e.preventDefault(); handleStop(); }}\r\n                                        className=\"p-1.5 hover:bg-red-500/20 rounded-full text-red-400 hover:text-red-300 transition-colors\"\r\n                                        title=\"Cancelar Foco\"\r\n                                    >\r\n                                        <X className=\"w-3.5 h-3.5\" />\r\n                                    </button>\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\layout\\Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setIsSidebarOpen' is defined but never used.","line":56,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport {\r\n    CheckSquare,\r\n    Target,\r\n    BookOpen,\r\n    Menu,\r\n    LogOut,\r\n    Cloud,\r\n    CloudOff,\r\n    RefreshCw,\r\n    AlertCircle,\r\n    Clock,\r\n    Eye,\r\n    Settings,\r\n    EyeOff,\r\n    X\r\n} from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface HeaderProps {\r\n    isPWA: boolean;\r\n    isIOS: boolean;\r\n    safeAreaTopClass: string;\r\n    isHeaderVisible: boolean;\r\n    isMobileMenuOpen: boolean;\r\n    setIsMobileMenuOpen: (isOpen: boolean) => void;\r\n    zenMode: boolean;\r\n    toggleZenMode: () => void;\r\n    setIsMissionModalOpen: (isOpen: boolean) => void;\r\n    setIsSummaryModalOpen: (isOpen: boolean) => void;\r\n    setIsTaskModalOpen: (isOpen: boolean) => void;\r\n    setIsSidebarOpen: (isOpen: boolean) => void;\r\n    setIsThemeModalOpen: (isOpen: boolean) => void;\r\n    syncStatus: string;\r\n    clearSyncQueue: () => void;\r\n    time: Date;\r\n    user: { email?: string; id?: string; name?: string } | null;\r\n    onTabChange: (tab: string) => void;\r\n    logout: () => void;\r\n\r\n}\r\n\r\nexport const Header: React.FC<HeaderProps> = ({\r\n    isPWA,\r\n    isIOS,\r\n    safeAreaTopClass,\r\n    isHeaderVisible,\r\n    isMobileMenuOpen,\r\n    setIsMobileMenuOpen,\r\n    zenMode,\r\n    toggleZenMode,\r\n    setIsMissionModalOpen,\r\n    setIsSummaryModalOpen,\r\n    setIsTaskModalOpen,\r\n    setIsSidebarOpen,\r\n    setIsThemeModalOpen,\r\n    syncStatus,\r\n    clearSyncQueue,\r\n    time,\r\n    user,\r\n    onTabChange,\r\n    logout,\r\n}) => {\r\n    return (\r\n        <>\r\n            <header className={cn(\r\n                \"bg-slate-950 border-b border-white/5 shadow-2xl flex items-center justify-between px-6 md:px-8 absolute top-0 w-full z-50 overflow-hidden transition-all duration-500\",\r\n                isPWA && isIOS ? \"h-24 pt-8\" : \"h-20\", // Taller header for iOS PWA to accommodate notch\r\n                safeAreaTopClass, // Add safe area padding top\r\n                !isHeaderVisible && \"-translate-y-full\"\r\n            )}>\r\n                {/* Noise Texture Overlay */}\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none\" />\r\n\r\n                {/* Top Glow Line */}\r\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-blue-500/50 to-transparent opacity-50\" />\r\n\r\n                <div className=\"md:hidden z-20\">\r\n                    {/* Mobile Menu Button - Keeping for \"Secondary\" menu items not in bottom nav? Or remove? \r\n                        Let's keep for \"Profile/Logout\" actions which might not fit in bottom nav 5 items. \r\n                    */}\r\n                    <button onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)} className=\"p-2 rounded-xl hover:bg-white/5 transition-colors\" aria-label=\"Menu Principal\">\r\n                        <Menu className=\"w-6 h-6 text-slate-300\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"flex-1 flex items-center gap-3 z-20\">\r\n                    {/* ZEN MODE Button */}\r\n                    <button\r\n                        onClick={toggleZenMode}\r\n                        title={zenMode ? \"Desativar Modo Zen\" : \"Ativar Modo Zen\"}\r\n                        className={cn(\r\n                            \"flex items-center gap-2 px-3 py-2 rounded-lg border transition-all\",\r\n                            zenMode\r\n                                ? \"bg-emerald-500/10 text-emerald-400 border-emerald-500/20\"\r\n                                : \"bg-slate-800/50 text-slate-300 border-white/10 hover:bg-slate-700/50 hover:border-white/20\"\r\n                        )}\r\n                        aria-label=\"Zen Mode\"\r\n                    >\r\n                        {zenMode ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\r\n                    </button>\r\n\r\n                    {/* METAS - MOVIDO PARA O TOPO */}\r\n                    <button\r\n                        onClick={() => onTabChange('goals')}\r\n                        className=\"flex items-center gap-2 px-4 py-2 rounded-lg border border-emerald-500/20 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 hover:text-emerald-300 transition-all font-bold text-xs uppercase tracking-wider\"\r\n                        aria-label=\"Ver Metas\"\r\n                        title=\"Metas\"\r\n                    >\r\n                        <Target className=\"w-4 h-4\" />\r\n                        <span className=\"hidden lg:inline\">METAS</span>\r\n                    </button>\r\n\r\n                    {/* NOVO TEMA */}\r\n                    <button\r\n                        onClick={() => setIsThemeModalOpen(true)}\r\n                        className=\"flex items-center gap-2 px-4 py-2 rounded-lg border border-white/10 bg-slate-800/50 hover:bg-slate-700/50 text-slate-300 hover:text-purple-300 transition-all font-bold text-xs uppercase tracking-wider\"\r\n                        aria-label=\"Criar Novo Tema\"\r\n                        title=\"Novo Tema\"\r\n                    >\r\n                        <BookOpen className=\"w-4 h-4\" />\r\n                        <span className=\"hidden lg:inline\">NOVO TEMA</span>\r\n                    </button>\r\n\r\n                    {/* Misses de Hoje */}\r\n                    <button\r\n                        onClick={() => setIsMissionModalOpen(true)}\r\n                        className=\"flex items-center gap-2 px-4 py-2 rounded-lg border border-blue-500/20 bg-gradient-to-br from-blue-600 to-indigo-700 hover:from-blue-500 hover:to-indigo-600 text-white transition-all font-bold text-xs uppercase tracking-wider\"\r\n                        aria-label=\"Ver Misses de Hoje\"\r\n                        title=\"Misses de Hoje\"\r\n                    >\r\n                        <CheckSquare className=\"w-4 h-4\" />\r\n                        <span className=\"hidden lg:inline\">Misses de Hoje</span>\r\n                    </button>\r\n\r\n                    {/* Projetos */}\r\n                    <button\r\n                        onClick={() => setIsSummaryModalOpen(true)}\r\n                        className=\"flex items-center gap-2 px-4 py-2 rounded-lg border border-white/10 bg-slate-800/50 hover:bg-orange-500/20 hover:border-orange-500/30 text-slate-300 hover:text-orange-400 transition-all font-bold text-xs uppercase tracking-wider\"\r\n                        aria-label=\"Projetos\"\r\n                        title=\"Projetos\"\r\n                    >\r\n                        <Clock className=\"w-4 h-4\" />\r\n                        <span className=\"hidden lg:inline\">Projetos</span>\r\n                    </button>\r\n\r\n                    {/* NOVA TAREFA */}\r\n                    <button\r\n                        onClick={() => setIsTaskModalOpen(true)}\r\n                        className=\"flex items-center gap-2 px-4 py-2 rounded-lg border border-blue-500/20 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 hover:text-blue-300 transition-all font-bold text-xs uppercase tracking-wider\"\r\n                        aria-label=\"Criar Nova Tarefa\"\r\n                        title=\"Nova Tarefa\"\r\n                    >\r\n                        <CheckSquare className=\"w-4 h-4\" />\r\n                        <span className=\"hidden lg:inline\">NOVA TAREFA</span>\r\n                    </button>\r\n\r\n                    {/* Status HUD - Right aligned */}\r\n                    <div className=\"ml-auto flex items-center gap-3 bg-black/40 backdrop-blur-md rounded-2xl p-1.5 border border-white/5 shadow-inner\">\r\n                        {/* Sync Status Indicator */}\r\n                        {/* Sync Status Indicator */}\r\n                        <div\r\n                            onClick={() => {\r\n                                if (syncStatus === 'error') {\r\n                                    if (confirm(\"Ocorreu um erro na sincronizao. Limpar fila de tarefas pendentes?\\n\\nIsso pode resolver o cone vermelho, mas verifique se seus ltimos dados foram salvos.\")) {\r\n                                        clearSyncQueue();\r\n                                    }\r\n                                }\r\n                            }}\r\n                            className={cn(\r\n                                \"flex items-center gap-2.5 px-3 py-1.5 bg-white/5 rounded-xl border border-white/5 transition-all select-none group/sync relative\",\r\n                                syncStatus === 'error' ? \"cursor-pointer hover:bg-red-500/20 border-red-500/50 hover:scale-105 active:scale-95\" : \"hover:bg-white/10\"\r\n                            )}\r\n                        >\r\n                            <div className=\"relative\">\r\n                                {syncStatus === 'synced' && <Cloud className=\"w-3.5 h-3.5 text-emerald-400\" />}\r\n                                {syncStatus === 'syncing' && <RefreshCw className=\"w-3.5 h-3.5 text-blue-400 animate-spin\" />}\r\n                                {syncStatus === 'offline' && <CloudOff className=\"w-3.5 h-3.5 text-amber-400\" />}\r\n                                {syncStatus === 'error' && <AlertCircle className=\"w-3.5 h-3.5 text-red-500 animate-pulse\" />}\r\n\r\n                                <div className={cn(\r\n                                    \"absolute -top-1 -right-1 w-2 h-2 rounded-full border border-slate-900\",\r\n                                    syncStatus === 'synced' ? \"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]\" :\r\n                                        syncStatus === 'syncing' ? \"bg-blue-500 animate-pulse\" :\r\n                                            syncStatus === 'offline' ? \"bg-amber-500\" : \"bg-red-500 shadow-[0_0_10px_rgba(239,68,68,0.8)]\"\r\n                                )} />\r\n                            </div>\r\n\r\n                            <span className={cn(\r\n                                \"text-[10px] font-bold uppercase tracking-widest hidden sm:inline\",\r\n                                syncStatus === 'synced' ? \"text-emerald-400/80\" :\r\n                                    syncStatus === 'syncing' ? \"text-blue-400/80\" :\r\n                                        syncStatus === 'offline' ? \"text-amber-400/80\" : \"text-red-400\"\r\n                            )}>\r\n                                {syncStatus === 'synced' ? 'Online' :\r\n                                    syncStatus === 'syncing' ? 'Salvando' :\r\n                                        syncStatus === 'offline' ? 'Offline' : 'Erro'}\r\n                            </span>\r\n\r\n                            {/* Info Tooltip */}\r\n                            <div className=\"absolute top-full right-0 mt-3 p-3 bg-slate-900/95 border border-white/10 rounded-xl shadow-2xl opacity-0 group-hover/sync:opacity-100 transition-opacity pointer-events-none w-48 z-50 backdrop-blur-xl\">\r\n                                <p className=\"text-[10px] text-white font-bold mb-1\">\r\n                                    {syncStatus === 'synced' ? 'Nuvem Atualizada' :\r\n                                        syncStatus === 'syncing' ? 'Sincronizando...' :\r\n                                            syncStatus === 'offline' ? 'Dados Locais' : 'Falha na Sincronizao'}\r\n                                </p>\r\n                                <p className=\"text-[9px] text-slate-400 leading-tight\">\r\n                                    {syncStatus === 'synced' ? 'Todos os seus dados esto seguros na nuvem.' :\r\n                                        syncStatus === 'syncing' ? 'Enviando suas alteraes para o banco de dados.' :\r\n                                            syncStatus === 'offline' ? 'As alteraes sero enviadas quando voc voltar a ficar online.' : 'Clique para tentar resolver os conflitos pendentes.'}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Clock */}\r\n                        <div className=\"flex shrink-0 items-center gap-2 px-3 py-1.5 bg-white/5 rounded-xl border border-white/5\">\r\n                            <Clock className=\"w-3.5 h-3.5 text-slate-400\" />\r\n                            <span className=\"text-sm font-bold text-slate-200 font-mono tracking-widest\">\r\n                                {format(time, \"HH:mm\")}\r\n                            </span>\r\n                            <span className=\"hidden md:inline text-[10px] font-bold text-slate-500 border-l border-white/10 pl-2 whitespace-nowrap\">\r\n                                {format(time, \"dd/MM\")}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Mobile Menu Overlay - Keeps access to profile/logout if needed */}\r\n            {isMobileMenuOpen && (\r\n                <div className=\"fixed inset-0 z-[100] md:hidden overflow-y-auto bg-slate-950/95 backdrop-blur-3xl animate-in fade-in duration-300\">\r\n                    {/* Noise Texture */}\r\n                    <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none fixed\" />\r\n\r\n                    <div className=\"relative z-10 p-6 min-h-screen flex flex-col\">\r\n                        {/* Header: Brand & Close */}\r\n                        <div className=\"flex items-center justify-between mb-8\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                                    <span className=\"text-white font-black text-xl\"></span>\r\n                                </div>\r\n                                <div>\r\n                                    <h1 className=\"font-bold text-slate-100 text-lg leading-none\">\r\n                                        Reviso <span className=\"text-blue-400\">PRO</span>\r\n                                    </h1>\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setIsMobileMenuOpen(false)}\r\n                                className=\"p-3 bg-white/5 hover:bg-white/10 rounded-full border border-white/5 transition-colors\"\r\n                            >\r\n                                <X className=\"w-6 h-6 text-slate-400\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* User Profile & XP (Visible on Mobile) */}\r\n                        <div className=\"mb-8 p-4 rounded-2xl bg-white/5 border border-white/5 shadow-xl backdrop-blur-md\">\r\n                            <div className=\"flex items-center gap-3 mb-4\">\r\n                                <div className=\"w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-800 rounded-full flex items-center justify-center ring-2 ring-white/10 shadow-inner\">\r\n                                    <span className=\"text-white font-bold text-lg\">{user?.name?.[0].toUpperCase()}</span>\r\n                                </div>\r\n                                <div className=\"flex flex-col\">\r\n                                    <span className=\"text-lg font-bold text-white\">{user?.name}</span>\r\n                                    <span className=\"text-xs text-emerald-400 font-medium flex items-center gap-1\">\r\n                                        <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\r\n                                        Online\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"pt-2 border-t border-white/5\">\r\n                                {/* LevelBar Removed */}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Mobile Menu Options */}\r\n                        <div className=\"space-y-2 mt-4\">\r\n                            <button\r\n                                onClick={() => {\r\n                                    onTabChange('settings');\r\n                                    setIsMobileMenuOpen(false);\r\n                                }}\r\n                                className=\"flex items-center gap-3 w-full px-4 py-4 text-slate-300 hover:text-white bg-white/5 hover:bg-white/10 rounded-xl transition-all font-medium\"\r\n                            >\r\n                                <Settings className=\"w-5 h-5 text-blue-400\" />\r\n                                <span>Configuraes</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Footer: Logout */}\r\n                        <div className=\"pt-6 border-t border-slate-800 mt-auto\">\r\n                            <button onClick={logout} className=\"flex items-center justify-center gap-2 w-full px-4 py-4 text-red-400 hover:text-red-300 bg-red-500/5 hover:bg-red-500/10 border border-red-500/10 rounded-xl transition-all font-medium\">\r\n                                <LogOut className=\"w-5 h-5\" />\r\n                                <span>Encerrar Sesso</span>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\layout\\LayoutModals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\layout\\MobileBottomNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\layout\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\timeline\\Timeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\timeline\\TimelineItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\timeline\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\AnimatedContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\CommandPalette.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\CommandPalette.tsx:37:13\n  35 |     useEffect(() => {\n  36 |         if (isOpen) {\n> 37 |             setQuery('');\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  38 |             setSelectedIndex(0);\n  39 |         }\n  40 |     }, [isOpen]);","line":37,"column":13,"nodeType":null,"endLine":37,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\r\nimport {\r\n    Search,\r\n    ArrowRight\r\n} from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\n// MainLayout uses props for navigation, so no router hook needed here. \r\n// Actually MainLayout passes onTabChange. The palette needs access to these contexts.\r\n// To keep it clean, maybe we pass actions as props or use context? \r\n// Re-reading MainLayout: it uses props for onTabChange. \r\n// So CommandPalette should probably accept an `onAction` callback or the individual handlers.\r\n// Let's make it accept `onNavigate` and specific action handlers.\r\n\r\ninterface CommandAction {\r\n    id: string;\r\n    label: string;\r\n    icon: React.ElementType;\r\n    shortcut?: string[]; // e.g. [\"G\", \"D\"]\r\n    category: 'Navigation' | 'Action' | 'System';\r\n    keywords?: string; // extra keywords for search\r\n    action: () => void;\r\n}\r\n\r\ninterface CommandPaletteProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    actions: CommandAction[];\r\n}\r\n\r\nexport const CommandPalette: React.FC<CommandPaletteProps> = ({ isOpen, onClose, actions }) => {\r\n    const [query, setQuery] = useState('');\r\n    const [selectedIndex, setSelectedIndex] = useState(0);\r\n\r\n    // Reset state when opening\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setQuery('');\r\n            setSelectedIndex(0);\r\n        }\r\n    }, [isOpen]);\r\n\r\n    // Filter commands\r\n    const filteredActions = useMemo(() => {\r\n        if (!query) return actions;\r\n        const lowerQuery = query.toLowerCase();\r\n        return actions.filter(action =>\r\n            action.label.toLowerCase().includes(lowerQuery) ||\r\n            action.category.toLowerCase().includes(lowerQuery) ||\r\n            action.keywords?.toLowerCase().includes(lowerQuery)\r\n        );\r\n    }, [query, actions]);\r\n\r\n    // Keyboard Navigation\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (e.key === 'ArrowDown') {\r\n                e.preventDefault();\r\n                setSelectedIndex(prev => (prev + 1) % filteredActions.length);\r\n            } else if (e.key === 'ArrowUp') {\r\n                e.preventDefault();\r\n                setSelectedIndex(prev => (prev - 1 + filteredActions.length) % filteredActions.length);\r\n            } else if (e.key === 'Enter') {\r\n                e.preventDefault();\r\n                if (filteredActions[selectedIndex]) {\r\n                    filteredActions[selectedIndex].action();\r\n                    onClose();\r\n                }\r\n            } else if (e.key === 'Escape') {\r\n                onClose();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [isOpen, filteredActions, selectedIndex, onClose]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    // Group for display\r\n    const groups = {\r\n        Navigation: filteredActions.filter(a => a.category === 'Navigation'),\r\n        Action: filteredActions.filter(a => a.category === 'Action'),\r\n        System: filteredActions.filter(a => a.category === 'System'),\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] flex items-start justify-center pt-[15vh] px-4\">\r\n            {/* Backdrop */}\r\n            <div\r\n                className=\"absolute inset-0 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200\"\r\n                onClick={onClose}\r\n            />\r\n\r\n            {/* Modal */}\r\n            <div className=\"w-full max-w-xl bg-slate-900 border border-white/10 rounded-xl shadow-2xl shadow-black/50 overflow-hidden relative z-10 animate-in zoom-in-95 duration-200 flex flex-col max-h-[60vh]\">\r\n\r\n                {/* Search Header */}\r\n                <div className=\"flex items-center gap-3 px-4 py-3 border-b border-white/5 bg-slate-900/50\">\r\n                    <Search className=\"w-5 h-5 text-slate-400 shrink-0\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        value={query}\r\n                        onChange={(e) => {\r\n                            setQuery(e.target.value);\r\n                            setSelectedIndex(0);\r\n                        }}\r\n                        placeholder=\"O que voc precisa?\"\r\n                        className=\"flex-1 bg-transparent border-none outline-none text-slate-200 placeholder-slate-500 font-medium\"\r\n                        autoFocus\r\n                    />\r\n                    <kbd className=\"hidden md:flex items-center gap-1 text-[10px] font-bold text-slate-500 bg-white/5 px-2 py-0.5 rounded border border-white/5\">\r\n                        <span className=\"text-xs\">ESC</span>\r\n                    </kbd>\r\n                </div>\r\n\r\n                {/* Results List */}\r\n                <div className=\"overflow-y-auto custom-scrollbar p-2 space-y-4\">\r\n                    {filteredActions.length === 0 ? (\r\n                        <div className=\"py-8 text-center text-slate-500 text-sm\">\r\n                            Nenhum comando encontrado.\r\n                        </div>\r\n                    ) : (\r\n                        (['Navigation', 'Action', 'System'] as const).map(category => {\r\n                            const categoryActions = groups[category];\r\n                            if (categoryActions.length === 0) return null;\r\n\r\n                            return (\r\n                                <div key={category}>\r\n                                    <h3 className=\"px-2 mb-1 text-[10px] font-bold uppercase tracking-wider text-slate-500\">\r\n                                        {category === 'Navigation' ? 'Ir para...' : category === 'Action' ? 'Aes' : 'Sistema'}\r\n                                    </h3>\r\n                                    <div className=\"space-y-0.5\">\r\n                                        {categoryActions.map((action) => {\r\n                                            const globalIndex = filteredActions.indexOf(action);\r\n                                            const isSelected = globalIndex === selectedIndex;\r\n\r\n                                            return (\r\n                                                <button\r\n                                                    key={action.id}\r\n                                                    onClick={() => {\r\n                                                        action.action();\r\n                                                        onClose();\r\n                                                    }}\r\n                                                    onMouseEnter={() => setSelectedIndex(globalIndex)}\r\n                                                    className={cn(\r\n                                                        \"w-full flex items-center justify-between px-3 py-2.5 rounded-lg transition-all duration-100 group\",\r\n                                                        isSelected\r\n                                                            ? \"bg-blue-600 text-white shadow-lg shadow-blue-900/20\"\r\n                                                            : \"text-slate-400 hover:bg-white/5 hover:text-slate-200\"\r\n                                                    )}\r\n                                                >\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        <action.icon className={cn(\r\n                                                            \"w-4 h-4\",\r\n                                                            isSelected ? \"text-white\" : \"text-slate-500 group-hover:text-slate-300\"\r\n                                                        )} />\r\n                                                        <span className=\"font-medium\">{action.label}</span>\r\n                                                    </div>\r\n\r\n                                                    {action.category === 'Action' && isSelected && (\r\n                                                        <ArrowRight className=\"w-3.5 h-3.5 text-white/50 animate-pulse\" />\r\n                                                    )}\r\n                                                </button>\r\n                                            )\r\n                                        })}\r\n                                    </div>\r\n                                </div>\r\n                            )\r\n                        })\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer hints */}\r\n                <div className=\"px-4 py-2 bg-slate-950/30 border-t border-white/5 flex items-center justify-between text-[10px] text-slate-500 font-medium\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <span className=\"flex items-center gap-1\">\r\n                            <ArrowRight className=\"w-3 h-3 rotate-90\" />\r\n                            <ArrowRight className=\"w-3 h-3 -rotate-90\" />\r\n                            Navegar\r\n                        </span>\r\n                        <span className=\"flex items-center gap-1\">\r\n                            <span className=\"bg-white/10 px-1 rounded\"></span>\r\n                            Selecionar\r\n                        </span>\r\n                    </div>\r\n                    <span>Reviso Espaada PRO</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\ConfirmationModal.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\ConfirmationModal.tsx:31:9\n  29 |\n  30 |     useEffect(() => {\n> 31 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  32 |         if (isOpen) {\n  33 |             document.body.style.overflow = 'hidden';\n  34 |         } else {","line":31,"column":9,"nodeType":null,"endLine":31,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { AlertTriangle, X } from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface ConfirmationModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onConfirm: () => void;\r\n    title: string;\r\n    description: string;\r\n    confirmText?: string;\r\n    cancelText?: string;\r\n    type?: 'danger' | 'warning' | 'info';\r\n}\r\n\r\nexport const ConfirmationModal: React.FC<ConfirmationModalProps> = ({\r\n    isOpen,\r\n    onClose,\r\n    onConfirm,\r\n    title,\r\n    description,\r\n    confirmText = 'Confirmar',\r\n    cancelText = 'Cancelar',\r\n    type = 'danger'\r\n}) => {\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        if (isOpen) {\r\n            document.body.style.overflow = 'hidden';\r\n        } else {\r\n            document.body.style.overflow = 'unset';\r\n            // Wait for animation to finish before unmounting (handled by AnimatePresence)\r\n        }\r\n        return () => {\r\n            document.body.style.overflow = 'unset';\r\n        };\r\n    }, [isOpen]);\r\n\r\n    if (!mounted) return null;\r\n\r\n    const colorStyles = {\r\n        danger: {\r\n            icon: 'text-red-500',\r\n            bgIcon: 'bg-red-500/10',\r\n            border: 'border-red-500/20',\r\n            button: 'bg-red-600 hover:bg-red-700',\r\n            buttonRing: 'focus:ring-red-500'\r\n        },\r\n        warning: {\r\n            icon: 'text-amber-500',\r\n            bgIcon: 'bg-amber-500/10',\r\n            border: 'border-amber-500/20',\r\n            button: 'bg-amber-600 hover:bg-amber-700',\r\n            buttonRing: 'focus:ring-amber-500'\r\n        },\r\n        info: {\r\n            icon: 'text-blue-500',\r\n            bgIcon: 'bg-blue-500/10',\r\n            border: 'border-blue-500/20',\r\n            button: 'bg-blue-600 hover:bg-blue-700',\r\n            buttonRing: 'focus:ring-blue-500'\r\n        }\r\n    }[type];\r\n\r\n    return createPortal(\r\n        <AnimatePresence>\r\n            {isOpen && (\r\n                <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\r\n                    {/* Backdrop */}\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={onClose}\r\n                        className=\"absolute inset-0 bg-slate-950/80 backdrop-blur-sm\"\r\n                    />\r\n\r\n                    {/* Modal Content */}\r\n                    <motion.div\r\n                        initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                        animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                        exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                        transition={{ type: \"spring\", duration: 0.3 }}\r\n                        className={cn(\r\n                            \"relative w-full max-w-sm bg-slate-900 border rounded-2xl shadow-2xl p-6 overflow-hidden\",\r\n                            colorStyles.border\r\n                        )}\r\n                    >\r\n                        {/* Noise Texture */}\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none\" />\r\n\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"flex items-start gap-4\">\r\n                                <div className={cn(\"p-3 rounded-full flex-shrink-0\", colorStyles.bgIcon)}>\r\n                                    <AlertTriangle className={cn(\"w-6 h-6\", colorStyles.icon)} />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <h3 className=\"text-lg font-bold text-white leading-none mb-2 pt-1\">{title}</h3>\r\n                                    <p className=\"text-sm text-slate-400 leading-relaxed\">{description}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"mt-6 flex items-center justify-end gap-3\">\r\n                                <button\r\n                                    onClick={onClose}\r\n                                    className=\"px-4 py-2 rounded-xl text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-colors\"\r\n                                >\r\n                                    {cancelText}\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => {\r\n                                        onConfirm();\r\n                                        onClose();\r\n                                    }}\r\n                                    className={cn(\r\n                                        \"px-4 py-2 rounded-xl text-sm font-bold text-white shadow-lg transition-all transform active:scale-95\",\r\n                                        colorStyles.button\r\n                                    )}\r\n                                >\r\n                                    {confirmText}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Close X */}\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors\"\r\n                        >\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </motion.div>\r\n                </div>\r\n            )}\r\n        </AnimatePresence>,\r\n        document.body\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\DatePicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\LoadingSpinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\RichTextEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[446,449],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[446,449],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useEditor, EditorContent } from '@tiptap/react';\r\nimport StarterKit from '@tiptap/starter-kit';\r\nimport Placeholder from '@tiptap/extension-placeholder';\r\nimport { Bold, Italic, List, ListOrdered, Heading1, Heading2 } from 'lucide-react';\r\n\r\ninterface RichTextEditorProps {\r\n    content?: string;\r\n    onChange: (content: string) => void;\r\n    editable?: boolean;\r\n}\r\n\r\nconst MenuBar = ({ editor }: { editor: any }) => {\r\n    if (!editor) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap gap-1 p-2 bg-slate-900 border-b border-white/5 rounded-t-xl\">\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleBold().run()}\r\n                disabled={!editor.can().chain().focus().toggleBold().run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('bold') ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Negrito\"\r\n            >\r\n                <Bold className=\"w-4 h-4\" />\r\n            </button>\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleItalic().run()}\r\n                disabled={!editor.can().chain().focus().toggleItalic().run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('italic') ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Itlico\"\r\n            >\r\n                <Italic className=\"w-4 h-4\" />\r\n            </button>\r\n            <div className=\"w-px h-6 bg-white/10 mx-1 self-center\" />\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('heading', { level: 1 }) ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Ttulo 1\"\r\n            >\r\n                <Heading1 className=\"w-4 h-4\" />\r\n            </button>\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleHeading({ level: 2 }).run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('heading', { level: 2 }) ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Ttulo 2\"\r\n            >\r\n                <Heading2 className=\"w-4 h-4\" />\r\n            </button>\r\n            <div className=\"w-px h-6 bg-white/10 mx-1 self-center\" />\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleBulletList().run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('bulletList') ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Lista com Marcadores\"\r\n            >\r\n                <List className=\"w-4 h-4\" />\r\n            </button>\r\n            <button\r\n                onClick={() => editor.chain().focus().toggleOrderedList().run()}\r\n                className={`p-2 rounded hover:bg-white/10 text-slate-400 hover:text-white transition-colors ${editor.isActive('orderedList') ? 'bg-white/20 text-white' : ''}`}\r\n                title=\"Lista Numerada\"\r\n            >\r\n                <ListOrdered className=\"w-4 h-4\" />\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const RichTextEditor: React.FC<RichTextEditorProps> = ({ content = '', onChange, editable = true }) => {\r\n    const editor = useEditor({\r\n        extensions: [\r\n            StarterKit,\r\n            Placeholder.configure({\r\n                placeholder: 'Escreva suas anotaes ou o contedo do flashcard aqui...',\r\n            })\r\n        ],\r\n        content,\r\n        editable,\r\n        onUpdate: ({ editor }) => {\r\n            onChange(editor.getHTML());\r\n        },\r\n        editorProps: {\r\n            attributes: {\r\n                class: 'prose prose-invert max-w-none focus:outline-none min-h-[200px] p-4 font-mono text-sm text-slate-300',\r\n            },\r\n        },\r\n    });\r\n\r\n    return (\r\n        <div className=\"w-full bg-slate-950/50 border border-slate-800 rounded-xl overflow-hidden focus-within:border-blue-500/50 transition-colors\">\r\n            {editable && <MenuBar editor={editor} />}\r\n            <EditorContent editor={editor} />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\SummaryTimeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\components\\ui\\Toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\config\\gamification.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'currentTitleEntry' is assigned a value but never used.","line":126,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":126,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { BrainCircuit, CheckSquare, Target, Zap, BookOpen, Flame } from 'lucide-react';\r\nimport type { Achievement } from '../types/gamification';\r\n\r\nexport const XP_VALUES = {\r\n    REVIEW: 100,\r\n    INTRO: 50,\r\n    TASK: 50,\r\n    GOAL: 500,\r\n    FOCUS_PER_MIN: 10,\r\n    STREAK_BONUS_BASE: 50, // 50 * streak days\r\n} as const;\r\n\r\nexport const XP_TABLE_DISPLAY = [\r\n    { label: 'Reviso SRS', value: XP_VALUES.REVIEW, icon: BrainCircuit, color: 'text-purple-400' },\r\n    { label: 'Novo Tpico', value: XP_VALUES.INTRO, icon: BookOpen, color: 'text-blue-400' },\r\n    { label: 'Tarefa Concluda', value: XP_VALUES.TASK, icon: CheckSquare, color: 'text-emerald-400' },\r\n    { label: 'Meta Alcanada', value: XP_VALUES.GOAL, icon: Target, color: 'text-yellow-400' },\r\n    { label: 'Sesso de Foco', value: `${XP_VALUES.FOCUS_PER_MIN} / min`, icon: Zap, color: 'text-pink-400' },\r\n    { label: 'Ofensiva Diria', value: '50x Dias', icon: Flame, color: 'text-orange-500' },\r\n];\r\n\r\nexport const LEVEL_TITLES = [\r\n    { level: 1, title: 'Recruta' },\r\n    { level: 5, title: 'Soldado' },\r\n    { level: 10, title: 'Cabo' },\r\n    { level: 15, title: 'Sargento' },\r\n    { level: 20, title: 'Tenente' },\r\n    { level: 25, title: 'Capito' },\r\n    { level: 30, title: 'Major' },\r\n    { level: 40, title: 'Coronel' },\r\n    { level: 50, title: 'General' },\r\n    { level: 75, title: 'Marechal' },\r\n    { level: 100, title: 'Lenda' }\r\n];\r\n\r\nexport const ACHIEVEMENTS_LIST: Omit<Achievement, 'unlockedAt'>[] = [\r\n    {\r\n        id: 'first_steps',\r\n        title: 'Primeiros Passos',\r\n        description: 'Ganhe seus primeiros 100 XP.',\r\n        iconName: 'Footprints',\r\n        condition: { type: 'xp', target: 100 },\r\n        xpReward: 100\r\n    },\r\n    {\r\n        id: 'streak_3',\r\n        title: 'Em Chamas',\r\n        description: 'Mantenha uma ofensiva de 3 dias.',\r\n        iconName: 'Flame',\r\n        condition: { type: 'streak', target: 3 },\r\n        xpReward: 300\r\n    },\r\n    {\r\n        id: 'streak_7',\r\n        title: 'Imparvel',\r\n        description: 'Mantenha uma ofensiva de 7 dias.',\r\n        iconName: 'Zap',\r\n        condition: { type: 'streak', target: 7 },\r\n        xpReward: 1000\r\n    },\r\n    {\r\n        id: 'streak_30',\r\n        title: 'Lendrio',\r\n        description: 'Mantenha uma ofensiva de 30 dias.',\r\n        iconName: 'Crown',\r\n        condition: { type: 'streak', target: 30 },\r\n        xpReward: 5000\r\n    },\r\n    {\r\n        id: 'review_master_10',\r\n        title: 'Mente Afiada',\r\n        description: 'Complete 10 revises.',\r\n        iconName: 'Brain',\r\n        condition: { type: 'reviews', target: 10 },\r\n        xpReward: 500\r\n    },\r\n    {\r\n        id: 'review_master_50',\r\n        title: 'Sbio de Dados',\r\n        description: 'Complete 50 revises.',\r\n        iconName: 'Cpu',\r\n        condition: { type: 'reviews', target: 50 },\r\n        xpReward: 2000\r\n    },\r\n    {\r\n        id: 'task_warrior_20',\r\n        title: 'Guerreiro de Tarefas',\r\n        description: 'Complete 20 tarefas.',\r\n        iconName: 'ShieldCheck',\r\n        condition: { type: 'tasks', target: 20 },\r\n        xpReward: 1000\r\n    },\r\n    {\r\n        id: 'task_warrior_100',\r\n        title: 'Maestro da Produtividade',\r\n        description: 'Complete 100 tarefas.',\r\n        iconName: 'Award',\r\n        condition: { type: 'tasks', target: 100 },\r\n        xpReward: 5000\r\n    },\r\n    {\r\n        id: 'focus_guru_500',\r\n        title: 'Foco Profundo',\r\n        description: 'Acumule 500 minutos de foco.',\r\n        iconName: 'Timer',\r\n        condition: { type: 'xp', target: 5000 }, // XP tracks roughly with focus\r\n        xpReward: 500\r\n    },\r\n    {\r\n        id: 'level_10',\r\n        title: 'Graduado',\r\n        description: 'Alcance o nvel 10.',\r\n        iconName: 'GraduationCap',\r\n        condition: { type: 'xp', target: 15000 }, // Level 10 is roughly 15k XP\r\n        xpReward: 1500\r\n    }\r\n];\r\n\r\nexport const getTitleForLevel = (level: number) => {\r\n    return LEVEL_TITLES.slice().reverse().find(t => level >= t.level)?.title || 'Novato';\r\n};\r\n\r\nexport const getNextTitleForLevel = (currentLevel: number) => {\r\n    // Find the current title index\r\n    const currentTitle = getTitleForLevel(currentLevel);\r\n    const currentTitleEntry = LEVEL_TITLES.slice().reverse().find(t => currentLevel >= t.level);\r\n\r\n    // Find the next title in the progression\r\n    const nextTitleEntry = LEVEL_TITLES.find(t => t.level > currentLevel);\r\n\r\n    // If there's a next title, return it; otherwise return the current title with indicator\r\n    return nextTitleEntry ? nextTitleEntry.title : currentTitle;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\AppContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'user' is assigned a value but never used.","line":34,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":44,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":63,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setUnlockedSubthemes' is assigned a value but never used.","line":75,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'completed' is defined but never used.","line":100,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":100,"endColumn":32},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":148,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":148,"endColumn":27}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\nimport { format } from 'date-fns';\r\n\r\nexport interface ActiveFocusSession {\r\n    id: string;\r\n    type: 'task' | 'goal' | 'subtheme';\r\n    title: string;\r\n    duration: number;\r\n    startTime: number;\r\n    reviewNumber?: number;\r\n    reviewType?: 'review' | 'intro';\r\n    parentId?: string; // For goal steps\r\n}\r\n\r\ninterface AppContextType {\r\n    activeFocus: ActiveFocusSession | null;\r\n    loading: boolean;\r\n    syncStatus: 'synced' | 'syncing' | 'error' | 'offline';\r\n    startFocus: (id: string, type: 'task' | 'goal' | 'subtheme', title: string, duration: number, reviewNumber?: number, reviewType?: 'review' | 'intro', parentId?: string) => void;\r\n    endFocus: (completed: boolean) => void;\r\n    zenMode: boolean;\r\n    toggleZenMode: () => void;\r\n    unlockedSubthemes: string[];\r\n    activeStudySession: string | null;\r\n    startStudySession: (subthemeId: string) => void;\r\n    endStudySession: () => void;\r\n}\r\n\r\nconst AppContext = createContext<AppContextType | undefined>(undefined);\r\n\r\nexport const AppProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [syncStatus, setSyncStatus] = useState<'synced' | 'syncing' | 'offline' | 'error'>('synced');\r\n\r\n    // Initialize activeFocus from localStorage\r\n    const [activeFocus, setActiveFocus] = useState<ActiveFocusSession | null>(() => {\r\n        try {\r\n            const saved = localStorage.getItem('active_focus_session');\r\n            return saved ? JSON.parse(saved) : null;\r\n        } catch (e) { return null; }\r\n    });\r\n\r\n    // Persist activeFocus changes\r\n    useEffect(() => {\r\n        if (activeFocus) {\r\n            localStorage.setItem('active_focus_session', JSON.stringify(activeFocus));\r\n        } else {\r\n            localStorage.removeItem('active_focus_session');\r\n        }\r\n    }, [activeFocus]);\r\n\r\n    const [activeStudySession, setActiveStudySession] = useState<string | null>(null);\r\n\r\n    // Zen Mode State\r\n    const [zenMode, setZenMode] = useState<boolean>(() => {\r\n        try {\r\n            const saved = localStorage.getItem('zen_mode');\r\n            return saved ? JSON.parse(saved) : false;\r\n        } catch (e) { return false; }\r\n    });\r\n\r\n    const toggleZenMode = () => {\r\n        setZenMode(prev => {\r\n            const newValue = !prev;\r\n            localStorage.setItem('zen_mode', JSON.stringify(newValue));\r\n            return newValue;\r\n        });\r\n    };\r\n\r\n    // Strict Summary Access Logic\r\n    const [unlockedSubthemes, setUnlockedSubthemes] = useState<string[]>(() => {\r\n        const saved = localStorage.getItem('daily_unlocked_subthemes');\r\n        if (saved) {\r\n            try {\r\n                const parsed = JSON.parse(saved);\r\n                if (parsed.date === format(new Date(), 'yyyy-MM-dd')) {\r\n                    return parsed.ids || [];\r\n                }\r\n            } catch (e) { console.error(e); }\r\n        }\r\n        return [];\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('daily_unlocked_subthemes', JSON.stringify({\r\n            date: format(new Date(), 'yyyy-MM-dd'),\r\n            ids: unlockedSubthemes\r\n        }));\r\n    }, [unlockedSubthemes]);\r\n\r\n    const startFocus = (id: string, type: 'task' | 'goal' | 'subtheme', title: string, duration: number, reviewNumber?: number, reviewType?: 'review' | 'intro', parentId?: string) => {\r\n        // Set active focus session - PomodoroContext handles duplicate prevention\r\n        setActiveFocus({ id, type, title, duration, startTime: Date.now(), reviewNumber, reviewType, parentId });\r\n    };\r\n\r\n    const endFocus = (completed: boolean) => {\r\n        setActiveFocus(null);\r\n    };\r\n\r\n    const startStudySession = (subthemeId: string) => {\r\n        setActiveStudySession(subthemeId);\r\n    };\r\n\r\n    const endStudySession = () => {\r\n        setActiveStudySession(null);\r\n    };\r\n\r\n    // Sync status listener\r\n    useEffect(() => {\r\n        SyncQueueService.loadQueue();\r\n\r\n        // Subscribe to real-time sync status\r\n        const unsubscribe = SyncQueueService.subscribe((status) => {\r\n            setSyncStatus(status);\r\n        });\r\n\r\n        // Mock loading finish\r\n        setTimeout(() => setLoading(false), 1000);\r\n\r\n        return () => {\r\n            unsubscribe();\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <AppContext.Provider value={{\r\n            activeFocus,\r\n            loading,\r\n            syncStatus,\r\n            startFocus,\r\n            endFocus,\r\n            zenMode,\r\n            toggleZenMode,\r\n            unlockedSubthemes,\r\n            activeStudySession,\r\n            startStudySession,\r\n            endStudySession\r\n        }}>\r\n            {children}\r\n        </AppContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAppContext = () => {\r\n    const context = useContext(AppContext);\r\n    if (!context) throw new Error('useAppContext must be used within AppProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\AudioContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1643,1646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1643,1646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":93,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'playAudio'. Either include it or remove the dependency array.","line":133,"column":8,"nodeType":"ArrayExpression","endLine":133,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isPlaying, currentSound, playAudio]","fix":{"range":[5281,5306],"text":"[isPlaying, currentSound, playAudio]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":250,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":250,"endColumn":22}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useRef, useState } from 'react';\r\n\r\ntype SoundType = 'white' | 'pink' | 'brown' | 'rain';\r\n\r\ninterface AudioContextType {\r\n    isPlaying: boolean;\r\n    volume: number;\r\n    currentSound: SoundType;\r\n    togglePlay: () => void;\r\n    setVolume: (vol: number) => void;\r\n    setSound: (sound: SoundType) => void;\r\n    startAudio: () => void;\r\n    stopAudio: () => void;\r\n    playSFX: (type: 'success' | 'xp' | 'achievement' | 'levelUp') => void;\r\n}\r\n\r\nconst AudioContext = createContext<AudioContextType | undefined>(undefined);\r\n\r\nexport const AudioProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [volume, setVolumeState] = useState(() => {\r\n        const saved = localStorage.getItem('audio_volume');\r\n        return saved ? parseFloat(saved) : 0.2; // Reduced from 0.5 to 0.2 (20%)\r\n    });\r\n    const [currentSound, setCurrentSoundState] = useState<SoundType>(() => {\r\n        const saved = localStorage.getItem('audio_sound');\r\n        return (saved as SoundType) || 'white';\r\n    });\r\n\r\n    const audioCtxRef = useRef<AudioContext | null>(null);\r\n    const gainNodeRef = useRef<GainNode | null>(null);\r\n    const sourceNodeRef = useRef<AudioBufferSourceNode | null>(null);\r\n\r\n    // For Rain sound (using HTML5 Audio for simplicity if using a file)\r\n    const rainAudioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n    // Initialize Audio Context (Lazy interaction)\r\n    const initAudio = () => {\r\n        if (!audioCtxRef.current) {\r\n            const Ctx = (window.AudioContext || (window as any).webkitAudioContext);\r\n            audioCtxRef.current = new Ctx();\r\n            gainNodeRef.current = audioCtxRef.current!.createGain();\r\n            gainNodeRef.current.connect(audioCtxRef.current!.destination);\r\n            gainNodeRef.current.gain.value = volume;\r\n        }\r\n        if (audioCtxRef.current?.state === 'suspended') {\r\n            audioCtxRef.current.resume();\r\n        }\r\n    };\r\n\r\n    // Generate Noise Buffer\r\n    const createNoiseBuffer = (type: 'white' | 'pink' | 'brown'): AudioBuffer => {\r\n        const ctx = audioCtxRef.current!;\r\n        const bufferSize = 2 * ctx.sampleRate; // 2 seconds buffer\r\n        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);\r\n        const output = buffer.getChannelData(0);\r\n\r\n        if (type === 'white') {\r\n            for (let i = 0; i < bufferSize; i++) {\r\n                output[i] = Math.random() * 2 - 1;\r\n            }\r\n        } else if (type === 'pink') {\r\n            let b0 = 0, b1 = 0, b2 = 0, b3 = 0, b4 = 0, b5 = 0, b6 = 0;\r\n            for (let i = 0; i < bufferSize; i++) {\r\n                const white = Math.random() * 2 - 1;\r\n                b0 = 0.99886 * b0 + white * 0.0555179;\r\n                b1 = 0.99332 * b1 + white * 0.0750759;\r\n                b2 = 0.96900 * b2 + white * 0.1538520;\r\n                b3 = 0.86650 * b3 + white * 0.3104856;\r\n                b4 = 0.55000 * b4 + white * 0.5329522;\r\n                b5 = -0.7616 * b5 - white * 0.0168980;\r\n                output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\r\n                output[i] *= 0.11; // (roughly) compensate for gain\r\n                b6 = white * 0.115926;\r\n            }\r\n        } else if (type === 'brown') {\r\n            let lastOut = 0;\r\n            for (let i = 0; i < bufferSize; i++) {\r\n                const white = Math.random() * 2 - 1;\r\n                output[i] = (lastOut + (0.02 * white)) / 1.02;\r\n                lastOut = output[i];\r\n                output[i] *= 3.5; // (roughly) compensate for gain\r\n            }\r\n        }\r\n        return buffer;\r\n    };\r\n\r\n    const stopAudio = () => {\r\n        if (sourceNodeRef.current) {\r\n            try {\r\n                sourceNodeRef.current.stop();\r\n                sourceNodeRef.current.disconnect();\r\n            } catch (e) { /* ignore */ }\r\n            sourceNodeRef.current = null;\r\n        }\r\n        if (rainAudioRef.current) {\r\n            rainAudioRef.current.pause();\r\n            rainAudioRef.current.currentTime = 0;\r\n        }\r\n    };\r\n\r\n    const playAudio = () => {\r\n        initAudio();\r\n        stopAudio();\r\n\r\n        if (currentSound === 'rain') {\r\n            if (!rainAudioRef.current) {\r\n                rainAudioRef.current = new Audio('https://actions.google.com/sounds/v1/weather/rain_heavy_loud.ogg'); // Reliable Google URL\r\n                rainAudioRef.current.loop = true;\r\n            }\r\n            rainAudioRef.current.volume = volume;\r\n            rainAudioRef.current.play().catch(e => console.error(\"Audio play failed\", e));\r\n        } else {\r\n            const buffer = createNoiseBuffer(currentSound);\r\n            const source = audioCtxRef.current!.createBufferSource();\r\n            source.buffer = buffer;\r\n            source.loop = true;\r\n            source.connect(gainNodeRef.current!);\r\n            source.start();\r\n            sourceNodeRef.current = source;\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isPlaying) {\r\n            playAudio();\r\n        } else {\r\n            stopAudio();\r\n        }\r\n        return () => {\r\n            // Cleanup on unmount only if needed, but context usually persists\r\n        };\r\n    }, [isPlaying, currentSound]);\r\n\r\n    useEffect(() => {\r\n        if (gainNodeRef.current) {\r\n            gainNodeRef.current.gain.value = volume;\r\n        }\r\n        if (rainAudioRef.current) {\r\n            rainAudioRef.current.volume = volume;\r\n        }\r\n        localStorage.setItem('audio_volume', volume.toString());\r\n    }, [volume]);\r\n\r\n    const togglePlay = () => setIsPlaying(!isPlaying);\r\n    const setVolume = (vol: number) => setVolumeState(vol);\r\n    const setSound = (sound: SoundType) => {\r\n        setCurrentSoundState(sound);\r\n        localStorage.setItem('audio_sound', sound);\r\n    };\r\n\r\n    // Start audio (for auto-play when focus starts)\r\n    const startAudioFn = () => {\r\n        if (!isPlaying) {\r\n            setIsPlaying(true);\r\n        }\r\n    };\r\n\r\n    // SFX Logic\r\n    const playSFX = (type: 'success' | 'xp' | 'achievement' | 'levelUp') => {\r\n        try {\r\n            initAudio(); // Ensure context is alive\r\n            const ctx = audioCtxRef.current;\r\n            if (!ctx || ctx.state === 'suspended') return;\r\n\r\n            const oscillator = ctx.createOscillator();\r\n            const gain = ctx.createGain();\r\n\r\n            oscillator.connect(gain);\r\n            gain.connect(ctx.destination);\r\n\r\n            const now = ctx.currentTime;\r\n\r\n            switch (type) {\r\n                case 'levelUp':\r\n                    oscillator.type = 'square';\r\n                    oscillator.frequency.setValueAtTime(220, now);\r\n                    oscillator.frequency.exponentialRampToValueAtTime(880, now + 0.5);\r\n                    gain.gain.setValueAtTime(0, now);\r\n                    gain.gain.linearRampToValueAtTime(0.1, now + 0.1);\r\n                    gain.gain.linearRampToValueAtTime(0, now + 0.8);\r\n                    oscillator.start(now);\r\n                    oscillator.stop(now + 0.8);\r\n                    break;\r\n                case 'achievement':\r\n                    // Simple chord effect\r\n                    [523.25, 659.25, 783.99].forEach((freq, i) => {\r\n                        const osc = ctx.createOscillator();\r\n                        const g = ctx.createGain();\r\n                        osc.connect(g);\r\n                        g.connect(ctx.destination);\r\n                        osc.frequency.setValueAtTime(freq, now + i * 0.1);\r\n                        g.gain.setValueAtTime(0, now + i * 0.1);\r\n                        g.gain.linearRampToValueAtTime(0.1, now + i * 0.1 + 0.05);\r\n                        g.gain.linearRampToValueAtTime(0, now + i * 0.1 + 0.5);\r\n                        osc.start(now + i * 0.1);\r\n                        osc.stop(now + i * 0.1 + 0.5);\r\n                    });\r\n                    break;\r\n                case 'xp':\r\n                    oscillator.type = 'sine';\r\n                    oscillator.frequency.setValueAtTime(880, now);\r\n                    oscillator.frequency.exponentialRampToValueAtTime(440, now + 0.1);\r\n                    gain.gain.setValueAtTime(0, now);\r\n                    gain.gain.linearRampToValueAtTime(0.05, now + 0.02);\r\n                    gain.gain.linearRampToValueAtTime(0, now + 0.1);\r\n                    oscillator.start(now);\r\n                    oscillator.stop(now + 0.1);\r\n                    break;\r\n                case 'success':\r\n                    oscillator.type = 'sine';\r\n                    oscillator.frequency.setValueAtTime(523.25, now);\r\n                    oscillator.frequency.setValueAtTime(659.25, now + 0.1);\r\n                    gain.gain.setValueAtTime(0, now);\r\n                    gain.gain.linearRampToValueAtTime(0.1, now + 0.05);\r\n                    gain.gain.linearRampToValueAtTime(0, now + 0.3);\r\n                    oscillator.start(now);\r\n                    oscillator.stop(now + 0.3);\r\n                    break;\r\n            }\r\n        } catch (e) {\r\n            console.warn(\"SFX play failed (likely browser restriction):\", e);\r\n        }\r\n    };\r\n\r\n    // Stop audio (for when focus ends)\r\n    const stopAudioFn = () => {\r\n        if (isPlaying) {\r\n            setIsPlaying(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AudioContext.Provider value={{\r\n            isPlaying,\r\n            volume,\r\n            currentSound,\r\n            togglePlay,\r\n            setVolume,\r\n            setSound,\r\n            startAudio: startAudioFn,\r\n            stopAudio: stopAudioFn,\r\n            playSFX\r\n        }}>\r\n            {children}\r\n        </AudioContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAudio = () => {\r\n    const context = useContext(AudioContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAudio must be used within an AudioProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\AuthContext.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'user'. Either include it or remove the dependency array.","line":83,"column":8,"nodeType":"ArrayExpression","endLine":83,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [user]","fix":{"range":[3148,3150],"text":"[user]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":238,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":238,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\n\r\nexport interface User {\r\n    id: string;\r\n    name: string;\r\n    email?: string;\r\n    avatar?: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    loading: boolean;\r\n    loginWithEmail: (email: string, password: string) => Promise<{ error: { message: string } | null }>;\r\n    registerWithEmail: (name: string, email: string, password: string) => Promise<{ error: { message: string } | null }>;\r\n    resetPassword: (email: string) => Promise<{ error: { message: string } | null }>;\r\n    logout: () => Promise<void>;\r\n    profile: (User & { [key: string]: unknown }) | null;\r\n    updateProfile: (updates: { display_name?: string, avatar_url?: string }) => Promise<void>;\r\n    enterGuestMode: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [user, setUser] = useState<User | null>(() => {\r\n        try {\r\n            const stored = localStorage.getItem('app_user');\r\n            return stored ? JSON.parse(stored) : null;\r\n        } catch (e) {\r\n            console.error(\"Failed to parse app_user\", e);\r\n            return null;\r\n        }\r\n    });\r\n\r\n    // Local-First: If we have a stored user, we're not \"loading\" the initial UI block\r\n    const [loading, setLoading] = useState(!user);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            localStorage.setItem('app_user', JSON.stringify(user));\r\n        } else {\r\n            localStorage.removeItem('app_user');\r\n        }\r\n    }, [user]);\r\n\r\n    useEffect(() => {\r\n        // Offline Check: If no internet, trust local storage completely and skip Supabase\r\n        if (!navigator.onLine) {\r\n            console.log(\"Offline detected on mount. Using cached session.\");\r\n            setLoading(false);\r\n            // Optionally set up a one-time listener to re-verify when online?\r\n            // For now, simple robustness is priority.\r\n            return;\r\n        }\r\n\r\n        // Check active session\r\n        supabase.auth.getSession().then(({ data: { session } }) => {\r\n            if (session?.user) {\r\n                // Only fetch if not already set locally to avoid flickering\r\n                if (!user) fetchProfile(session.user.id, session.user.email);\r\n            } else {\r\n                setLoading(false);\r\n            }\r\n        }).catch(err => {\r\n            console.error(\"Session check failed\", err);\r\n            setLoading(false);\r\n        });\r\n\r\n        const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\r\n            if (session?.user) {\r\n                fetchProfile(session.user.id, session.user.email);\r\n            } else {\r\n                if (_event === 'SIGNED_OUT') {\r\n                    setUser(null);\r\n                }\r\n                setLoading(false);\r\n            }\r\n        });\r\n\r\n        return () => subscription.unsubscribe();\r\n    }, []);\r\n\r\n    const fetchProfile = async (userId: string, email?: string) => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', userId)\r\n                .maybeSingle();\r\n\r\n            if (error) {\r\n                console.error('Error fetching profile:', error);\r\n                // Continue anyway, it will fall back to the auth user data\r\n            }\r\n\r\n            if (data) {\r\n                setUser({\r\n                    id: data.id,\r\n                    name: data.name || email?.split('@')[0] || 'User',\r\n                    email: data.email,\r\n                    avatar: data.avatar_url,\r\n                    // Include gamification as a reference if needed, \r\n                    // though it's managed by GamificationContext\r\n                });\r\n            } else {\r\n                // If profile doesn't exist yet (e.g. slight delay in trigger), use Auth data\r\n                setUser({\r\n                    id: userId,\r\n                    name: email?.split('@')[0] || 'User',\r\n                    email: email\r\n                });\r\n            }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const loginWithEmail = async (email: string, password: string) => {\r\n        const { data, error } = await supabase.auth.signInWithPassword({ email, password });\r\n        if (!error && data.user) {\r\n            // Optimistic Update\r\n            const optimisticUser = {\r\n                id: data.user.id,\r\n                name: email.split('@')[0], // Temporary until profile fetch\r\n                email: data.user.email\r\n            };\r\n            setUser(optimisticUser); // Immediate unlock\r\n\r\n            // Then fetch real profile\r\n            fetchProfile(data.user.id, data.user.email);\r\n        }\r\n        return { error };\r\n    };\r\n\r\n    const registerWithEmail = async (name: string, email: string, password: string) => {\r\n        const { data, error } = await supabase.auth.signUp({\r\n            email,\r\n            password,\r\n            options: {\r\n                data: { name }\r\n            }\r\n        });\r\n\r\n        if (!error && data.user) {\r\n            // Optimistic Update\r\n            setUser({\r\n                id: data.user.id,\r\n                name: name,\r\n                email: data.user.email\r\n            });\r\n        }\r\n        return { error };\r\n    };\r\n\r\n    const logout = async () => {\r\n        await supabase.auth.signOut();\r\n\r\n        // Clear Application State & Cache\r\n        SyncQueueService.clearQueue();\r\n        localStorage.removeItem('app_user');\r\n\r\n        // Clear Study Data Backups\r\n        localStorage.removeItem('study_themes_backup');\r\n        localStorage.removeItem('study_tasks_backup');\r\n        localStorage.removeItem('study_goals_backup');\r\n\r\n        // Clear operational flags\r\n        localStorage.removeItem('deleted_theme_ids');\r\n        localStorage.removeItem('gamification_state');\r\n\r\n        setUser(null);\r\n    };\r\n\r\n    const enterGuestMode = async () => {\r\n        // Use a valid UUID for guest users instead of a string\r\n        // This prevents Supabase sync errors: \"invalid input syntax for type uuid\"\r\n        const guestUser: User = {\r\n            id: '00000000-0000-0000-0000-000000000001', // Valid UUID for guest mode\r\n            name: 'Convidado Offline',\r\n            email: 'offline@local',\r\n            avatar: undefined\r\n        };\r\n        setUser(guestUser);\r\n        localStorage.setItem('app_user', JSON.stringify(guestUser));\r\n        return Promise.resolve();\r\n    };\r\n\r\n    const resetPassword = async (email: string) => {\r\n        const { error } = await supabase.auth.resetPasswordForEmail(email, {\r\n            redirectTo: `${window.location.origin}/reset-password`\r\n        });\r\n        return { error };\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            user,\r\n            loading,\r\n            loginWithEmail,\r\n            registerWithEmail,\r\n            resetPassword,\r\n            logout,\r\n            enterGuestMode, // Expose\r\n            profile: user ? { display_name: user.name, ...user } : null,\r\n            updateProfile: async (updates: { display_name?: string, avatar_url?: string }) => {\r\n                if (!user) return;\r\n                const dbUpdates: Record<string, string> = {};\r\n                if (updates.display_name) dbUpdates.name = updates.display_name;\r\n                if (updates.avatar_url) dbUpdates.avatar_url = updates.avatar_url;\r\n\r\n                const { error } = await supabase.from('profiles').update(dbUpdates).eq('id', user.id);\r\n\r\n                if (!error) {\r\n                    setUser(prev => prev ? {\r\n                        ...prev,\r\n                        name: updates.display_name || prev.name,\r\n                        avatar: updates.avatar_url || prev.avatar\r\n                    } : null);\r\n                }\r\n            }\r\n        }}>\r\n            {loading ? (\r\n                <div className=\"min-h-screen bg-slate-950 flex flex-col items-center justify-center\">\r\n                    <div className=\"relative\">\r\n                        <div className=\"w-12 h-12 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin\" />\r\n                        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                            <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-pulse\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            ) : children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\ConfirmContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":19,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":19,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, type ReactNode } from 'react';\r\nimport { AlertTriangle, X } from 'lucide-react';\r\nimport { cn } from '../lib/utils';\r\n\r\ninterface ConfirmOptions {\r\n    title?: string;\r\n    message: string;\r\n    confirmText?: string;\r\n    cancelText?: string;\r\n    isDangerous?: boolean;\r\n}\r\n\r\ninterface ConfirmContextType {\r\n    confirm: (options: ConfirmOptions) => Promise<boolean>;\r\n}\r\n\r\nconst ConfirmContext = createContext<ConfirmContextType | undefined>(undefined);\r\n\r\nexport const useConfirm = () => {\r\n    const context = useContext(ConfirmContext);\r\n    if (!context) {\r\n        throw new Error('useConfirm must be used within ConfirmProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\ninterface ConfirmProviderProps {\r\n    children: ReactNode;\r\n}\r\n\r\nexport const ConfirmProvider: React.FC<ConfirmProviderProps> = ({ children }) => {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [options, setOptions] = useState<ConfirmOptions | null>(null);\r\n    const [resolver, setResolver] = useState<((value: boolean) => void) | null>(null);\r\n\r\n    const confirm = (opts: ConfirmOptions): Promise<boolean> => {\r\n        setOptions(opts);\r\n        setIsOpen(true);\r\n\r\n        return new Promise<boolean>((resolve) => {\r\n            setResolver(() => resolve);\r\n        });\r\n    };\r\n\r\n    const handleConfirm = () => {\r\n        if (resolver) {\r\n            resolver(true);\r\n        }\r\n        setIsOpen(false);\r\n        setOptions(null);\r\n        setResolver(null);\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        if (resolver) {\r\n            resolver(false);\r\n        }\r\n        setIsOpen(false);\r\n        setOptions(null);\r\n        setResolver(null);\r\n    };\r\n\r\n    return (\r\n        <ConfirmContext.Provider value={{ confirm }}>\r\n            {children}\r\n\r\n            {/* Confirm Modal */}\r\n            {isOpen && options && (\r\n                <div\r\n                    className=\"fixed inset-0 z-[200] flex items-center justify-center p-4 animate-in fade-in duration-200\"\r\n                    onClick={handleCancel}\r\n                >\r\n                    {/* Backdrop with blur */}\r\n                    <div className=\"absolute inset-0 bg-black/60 backdrop-blur-md\" />\r\n\r\n                    {/* Modal Card */}\r\n                    <div\r\n                        className=\"relative w-full max-w-md bg-slate-900/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl animate-in zoom-in-95 duration-200\"\r\n                        onClick={(e) => e.stopPropagation()}\r\n                    >\r\n                        {/* Noise Texture */}\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none rounded-2xl\" />\r\n\r\n                        {/* Header */}\r\n                        <div className=\"relative p-6 border-b border-white/5\">\r\n                            <div className=\"flex items-start gap-4\">\r\n                                <div className={cn(\r\n                                    \"flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center\",\r\n                                    options.isDangerous\r\n                                        ? \"bg-red-500/10 border border-red-500/20\"\r\n                                        : \"bg-blue-500/10 border border-blue-500/20\"\r\n                                )}>\r\n                                    <AlertTriangle className={cn(\r\n                                        \"w-6 h-6\",\r\n                                        options.isDangerous ? \"text-red-400\" : \"text-blue-400\"\r\n                                    )} />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <h3 className=\"text-lg font-bold text-white mb-1\">\r\n                                        {options.title || 'Confirmao necessria'}\r\n                                    </h3>\r\n                                </div>\r\n                                <button\r\n                                    onClick={handleCancel}\r\n                                    className=\"flex-shrink-0 p-2 hover:bg-white/5 rounded-lg transition-colors\"\r\n                                    aria-label=\"Fechar\"\r\n                                >\r\n                                    <X className=\"w-5 h-5 text-slate-400\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Content */}\r\n                        <div className=\"relative p-6\">\r\n                            <p className=\"text-slate-300 leading-relaxed\">\r\n                                {options.message}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"relative p-6 border-t border-white/5 flex gap-3 justify-end\">\r\n                            <button\r\n                                onClick={handleCancel}\r\n                                className=\"px-4 py-2.5 bg-slate-800/50 hover:bg-slate-700/50 text-slate-300 hover:text-white border border-white/10 rounded-lg font-medium transition-all\"\r\n                            >\r\n                                {options.cancelText || 'Cancelar'}\r\n                            </button>\r\n                            <button\r\n                                onClick={handleConfirm}\r\n                                className={cn(\r\n                                    \"px-4 py-2.5 rounded-lg font-medium transition-all shadow-lg\",\r\n                                    options.isDangerous\r\n                                        ? \"bg-red-600 hover:bg-red-500 text-white border border-red-500/20\"\r\n                                        : \"bg-blue-600 hover:bg-blue-500 text-white border border-blue-500/20\"\r\n                                )}\r\n                            >\r\n                                {options.confirmText || 'Confirmar'}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </ConfirmContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\GamificationContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":164,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":164,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { supabase } from '../lib/supabase';\r\nimport { GamificationService } from '../services/GamificationService';\r\nimport type { GamificationState, GameStats, Achievement } from '../types/gamification';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\nimport { useAudio } from './AudioContext';\r\n\r\nimport { useToast } from './ToastContext';\r\n\r\ninterface GamificationContextType {\r\n    gamification: GamificationState;\r\n    newlyUnlocked: Achievement | null;\r\n    awardXP: (amount: number, silent?: boolean) => void;\r\n    updateStats: (updates: Partial<GameStats>) => void;\r\n    dismissAchievement: () => void;\r\n    resetGamification: () => Promise<void>;\r\n}\r\n\r\nconst GamificationContext = createContext<GamificationContextType | undefined>(undefined);\r\n\r\nexport const GamificationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const [gamification, setGamification] = useState<GamificationState>(GamificationService.getInitialState());\r\n    const [newlyUnlocked, setNewlyUnlocked] = useState<Achievement | null>(null);\r\n    const [hasLoaded, setHasLoaded] = useState(false);\r\n    const { playSFX } = useAudio();\r\n    const { showToast } = useToast();\r\n\r\n    // Initial load from Supabase if user exists\r\n    useEffect(() => {\r\n        const loadGamification = async () => {\r\n            if (user) {\r\n                const { data, error } = await supabase\r\n                    .from('profiles')\r\n                    .select('gamification')\r\n                    .eq('id', user.id)\r\n                    .maybeSingle();\r\n\r\n                if (error) {\r\n                    console.error('Error fetching gamification data:', error);\r\n                    setHasLoaded(true); // Treat as loaded to allow local progress\r\n                    return;\r\n                }\r\n\r\n                let loadedState = GamificationService.getInitialState();\r\n\r\n                if (data?.gamification) {\r\n                    // Ensure it has the correct structure (level is required)\r\n                    if (data.gamification.level) {\r\n                        loadedState = data.gamification;\r\n                    } else {\r\n                        console.warn('Empty or invalid gamification data received, keeping initial state');\r\n                    }\r\n                }\r\n\r\n                // Check Streak immediately on load\r\n                const { newState, newUnlock } = GamificationService.checkStreak(loadedState);\r\n\r\n                setGamification(newState);\r\n                if (newUnlock) setNewlyUnlocked(newUnlock);\r\n\r\n                // If streak updated (state changed), we should sync back to server\r\n                // We can detect if 'lastLoginDate' changed or just always sync to be safe/consistent?\r\n                // checkStreak returns same object if no change? \r\n                // GamificationService.checkStreak returns { newState: state... } if no change.\r\n                // But we constructed a new object structure in service... actually checkStreak returns `state` ref if no change in line 112: `return { newState: state, newUnlock: null };`\r\n                // So strict equality check works.\r\n\r\n                if (newState !== loadedState) {\r\n                    // Queue Sync if changed\r\n                    // We need to wait for state set? No, we can enqueue directly.\r\n                    // But we need to make sure we don't block render.\r\n                    // We'll defer the sync call or just let the handleGamificationUpdate equivalent logic run.\r\n                    // Since we are inside useEffect using local vars, we can't use 'gamification' state yet.\r\n                    // We'll manually queue sync here.\r\n                    SyncQueueService.enqueue({\r\n                        type: 'UPDATE',\r\n                        table: 'profiles',\r\n                        data: {\r\n                            id: user.id,\r\n                            gamification: newState\r\n                        }\r\n                    });\r\n                }\r\n\r\n                setHasLoaded(true);\r\n            } else {\r\n                setHasLoaded(false);\r\n            }\r\n        };\r\n        loadGamification();\r\n    }, [user]);\r\n\r\n    const handleGamificationUpdate = async (result: { newState: GamificationState, newUnlock: Achievement | null }) => {\r\n        // Check for Level Up\r\n        if (result.newState.level.level > gamification.level.level) {\r\n            playSFX('levelUp');\r\n        }\r\n\r\n        // Check for Achievement\r\n        if (result.newUnlock) {\r\n            setNewlyUnlocked(result.newUnlock);\r\n            playSFX('achievement');\r\n        }\r\n\r\n        setGamification(result.newState);\r\n\r\n        // Sync to Supabase...\r\n        if (user && hasLoaded) {\r\n            // Use SyncQueue to handle offline updates\r\n            // (Import SyncQueueService at top of file first)\r\n            SyncQueueService.enqueue({\r\n                type: 'UPDATE',\r\n                table: 'profiles',\r\n                data: {\r\n                    id: user.id,\r\n                    gamification: result.newState\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const awardXP = (amount: number, silent: boolean = false) => {\r\n        if (amount > 0) {\r\n            playSFX('xp');\r\n            if (!silent) {\r\n                showToast(`+${amount} XP`, \"success\");\r\n            }\r\n        }\r\n        const result = GamificationService.awardXP(gamification, amount);\r\n        handleGamificationUpdate(result);\r\n    };\r\n\r\n    const updateStats = (updates: Partial<GameStats>) => {\r\n        const result = GamificationService.updateStats(gamification, updates);\r\n        handleGamificationUpdate(result);\r\n    };\r\n\r\n    const dismissAchievement = () => setNewlyUnlocked(null);\r\n\r\n    const resetGamification = async () => {\r\n        const initialState = GamificationService.getInitialState();\r\n        setGamification(initialState);\r\n        if (user) {\r\n            await supabase.from('profiles').update({ gamification: initialState }).eq('id', user.id);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <GamificationContext.Provider value={{\r\n            gamification,\r\n            newlyUnlocked,\r\n            awardXP,\r\n            updateStats,\r\n            dismissAchievement,\r\n            resetGamification\r\n        }}>\r\n            {children}\r\n        </GamificationContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useGamification = () => {\r\n    const context = useContext(GamificationContext);\r\n    if (!context) throw new Error('useGamification must be used within GamificationProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\GoalContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":107,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":107,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { useGamification } from './GamificationContext';\r\nimport { useGoals } from '../hooks/useGoals';\r\nimport type { Goal } from '../types';\r\nimport { supabase } from '../lib/supabase';\r\n\r\ninterface GoalContextType {\r\n    goals: Goal[];\r\n    addGoal: (goal: Omit<Goal, 'id' | 'progress' | 'createdAt'>) => void;\r\n    deleteGoal: (goalId: string) => void;\r\n    updateGoal: (id: string, updates: Partial<Goal>) => void;\r\n    toggleGoal: (goalId: string, date?: string, summaryText?: string) => void;\r\n    toggleGoalItem: (goalId: string, itemId: string, date?: string, summaryText?: string) => void;\r\n    setGoals: React.Dispatch<React.SetStateAction<Goal[]>>;\r\n}\r\n\r\nconst GoalContext = createContext<GoalContextType | undefined>(undefined);\r\n\r\nexport const GoalProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const { gamification, awardXP, updateStats } = useGamification();\r\n\r\n    const goalActions = useGoals({\r\n        user,\r\n        gamification,\r\n        awardXP,\r\n        updateStats\r\n    });\r\n\r\n    // Initial Fetch from Supabase\r\n    useEffect(() => {\r\n        const fetchGoals = async () => {\r\n            if (user) {\r\n                const { data, error } = await supabase\r\n                    .from('goals')\r\n                    .select('*')\r\n                    .eq('user_id', user.id);\r\n\r\n                if (data && !error) {\r\n                    const normalized = data.map(g => ({\r\n                        ...g,\r\n                        createdAt: new Date(g.created_at).getTime(),\r\n                        imageUrl: g.image_url,\r\n                        durationMinutes: g.duration_minutes,\r\n                        timeSpent: g.time_spent || 0,\r\n                        completionHistory: g.completion_history || [],\r\n                        sessions: g.sessions || [],\r\n                        summaries: g.summaries || []\r\n                    }));\r\n\r\n                    // --- ROBUST DELETION PROTECTION ---\r\n                    const pendingDeletes = new Set<string>();\r\n                    try {\r\n                        const queueRaw = localStorage.getItem('sync_queue_v1');\r\n                        if (queueRaw) {\r\n                            const queue = JSON.parse(queueRaw);\r\n                            if (Array.isArray(queue)) {\r\n                                queue.forEach((op: { type: string; table: string; data?: { id?: string } }) => {\r\n                                    if (op.type === 'DELETE' && op.table === 'goals' && op.data?.id) {\r\n                                        pendingDeletes.add(op.data.id);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(\"Error reading sync queue for goal protection\", e);\r\n                    }\r\n                    // ----------------------------------\r\n\r\n                    goalActions.setGoals(prevGoals => {\r\n                        const finalGoals: Goal[] = [];\r\n                        const processedIds = new Set<string>();\r\n\r\n                        // 1. Add/Update from Server (filtered)\r\n                        normalized.forEach(serverGoal => {\r\n                            if (pendingDeletes.has(serverGoal.id)) {\r\n                                console.log(` Blocked zombie goal resurrecion: ${serverGoal.id}`);\r\n                                return;\r\n                            }\r\n                            finalGoals.push(serverGoal);\r\n                            processedIds.add(serverGoal.id);\r\n                        });\r\n\r\n                        // 2. Preserve Local-Only (Optimistic)\r\n                        prevGoals.forEach(localGoal => {\r\n                            if (!processedIds.has(localGoal.id)) {\r\n                                finalGoals.push(localGoal);\r\n                            }\r\n                        });\r\n\r\n                        return finalGoals;\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        fetchGoals();\r\n    }, [user, goalActions]);\r\n\r\n    return (\r\n        <GoalContext.Provider value={goalActions}>\r\n            {children}\r\n        </GoalContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useGoalContext = () => {\r\n    const context = useContext(GoalContext);\r\n    if (!context) throw new Error('useGoalContext must be used within GoalProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\PomodoroContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\PomodoroContext.tsx:55:21\n  53 |                 // Only restore if saved less than 24h ago\n  54 |                 if (Date.now() - parsed.timestamp < 24 * 60 * 60 * 1000) {\n> 55 |                     setMode(parsed.mode);\n     |                     ^^^^^^^ Avoid calling setState() directly within an effect\n  56 |                     setTimeLeft(parsed.timeLeft);\n  57 |                     setIsActive(parsed.isActive);\n  58 |                     setCycles(parsed.cycles);","line":55,"column":21,"nodeType":null,"endLine":55,"endColumn":28},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\PomodoroContext.tsx:139:17\n  137 |             // We do NOT auto-switch to break anymore.\n  138 |             if (mode === 'focus' && isActive) {\n> 139 |                 setIsActive(false);\n      |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  140 |                 playSound();\n  141 |                 setIsWidgetVisible(true); // Force open widget for validation\n  142 |                 // We keep mode='focus' and timeLeft=0 so the UI shows \"Validar\"","line":139,"column":17,"nodeType":null,"endLine":139,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'mode' and 'playSound'. Either include them or remove the dependency array.","line":151,"column":8,"nodeType":"ArrayExpression","endLine":151,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [isActive, timeLeft, handleTimerComplete, mode, playSound]","fix":{"range":[5944,5985],"text":"[isActive, timeLeft, handleTimerComplete, mode, playSound]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":208,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":208,"endColumn":32}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, useRef, useCallback } from 'react';\r\n\r\ntype Mode = 'focus' | 'shortBreak' | 'longBreak';\r\n\r\ninterface PomodoroContextType {\r\n    mode: Mode;\r\n    timeLeft: number;\r\n    isActive: boolean;\r\n    cycles: number;\r\n    linkedItemId: string | null; // ID of the task/goal/theme being focused on\r\n    isWidgetVisible: boolean;\r\n    toggleTimer: () => void;\r\n    resetTimer: () => void;\r\n    skipTimer: () => void;\r\n    startFocusSession: (itemId: string, durationMinutes?: number) => void; // Start timer linked to an item\r\n    closeWidget: () => void;\r\n    openWidget: () => void;\r\n    settings: { focusDuration: number; shortBreakDuration: number; longBreakDuration: number; strictMode: boolean };\r\n    updateSettings: (settings: { focusDuration: number; shortBreakDuration: number; longBreakDuration: number; strictMode: boolean }) => void;\r\n}\r\n\r\nconst PomodoroContext = createContext<PomodoroContextType | undefined>(undefined);\r\n\r\nconst SETTINGS = {\r\n    focus: 25 * 60,\r\n    shortBreak: 5 * 60,\r\n    longBreak: 15 * 60,\r\n    cyclesForLongBreak: 4,\r\n    strictMode: false,\r\n};\r\n\r\nexport const PomodoroProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    // 1. State Declarations\r\n    const [mode, setMode] = useState<Mode>('focus');\r\n    const [settings, setSettings] = useState(SETTINGS); // Dynamic settings state\r\n    const [timeLeft, setTimeLeft] = useState(SETTINGS.focus);\r\n    const [isActive, setIsActive] = useState(false);\r\n    const [cycles, setCycles] = useState(0);\r\n    const [linkedItemId, setLinkedItemId] = useState<string | null>(null);\r\n    const [isWidgetVisible, setIsWidgetVisible] = useState(false);\r\n\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n    // 2. Initialization & Persistence\r\n    useEffect(() => {\r\n        audioRef.current = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3');\r\n\r\n        // Load persisted state\r\n        const saved = localStorage.getItem('pomodoro_state');\r\n        if (saved) {\r\n            try {\r\n                const parsed = JSON.parse(saved);\r\n                // Only restore if saved less than 24h ago\r\n                if (Date.now() - parsed.timestamp < 24 * 60 * 60 * 1000) {\r\n                    setMode(parsed.mode);\r\n                    setTimeLeft(parsed.timeLeft);\r\n                    setIsActive(parsed.isActive);\r\n                    setCycles(parsed.cycles);\r\n                    setLinkedItemId(parsed.linkedItemId);\r\n\r\n                    // Restore widget visibility if timer is running OR if it just finished (waiting validation)\r\n                    // DISABLED: We only show the compact GlobalActionBar now\r\n                    // if ((parsed.isActive && parsed.timeLeft > 0) || (parsed.timeLeft === 0 && parsed.mode === 'focus')) {\r\n                    //     setIsWidgetVisible(true);\r\n                    // } else {\r\n                    //     setIsWidgetVisible(false);\r\n                    // }\r\n                    setIsWidgetVisible(false);\r\n                }\r\n            } catch (e) { console.error(\"Pomodoro persistence error\", e); }\r\n        }\r\n    }, []);\r\n\r\n    // Persist state\r\n    useEffect(() => {\r\n        const state = { mode, timeLeft, isActive, cycles, linkedItemId, timestamp: Date.now() };\r\n        localStorage.setItem('pomodoro_state', JSON.stringify(state));\r\n    }, [mode, timeLeft, isActive, cycles, linkedItemId]);\r\n\r\n    // 3. Helper Functions\r\n    const playSound = useCallback(() => {\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = 0;\r\n            audioRef.current.play().catch((e: unknown) => console.log('Audio play failed:', e));\r\n        }\r\n    }, []);\r\n\r\n    // 4. Core Logic\r\n    const updateSettings = (newSettings: Partial<typeof SETTINGS>) => {\r\n        setSettings(prev => ({ ...prev, ...newSettings }));\r\n        // Note: Changing settings while timer is running might be weird, but for now we accept it.\r\n    };\r\n\r\n    // Override resetTimer to use dynamic settings\r\n    const resetTimer = () => {\r\n        setIsActive(false);\r\n        setTimeLeft(settings[mode]);\r\n    };\r\n\r\n    const switchMode = useCallback((nextMode: Mode) => {\r\n        setMode(nextMode);\r\n        setTimeLeft(settings[nextMode]);\r\n        setIsActive(false);\r\n    }, [settings]);\r\n\r\n    const handleTimerComplete = useCallback(() => {\r\n        playSound();\r\n\r\n        if (mode === 'focus') {\r\n            const newCycles = cycles + 1;\r\n            setCycles(newCycles);\r\n\r\n            if (newCycles % settings.cyclesForLongBreak === 0) {\r\n                switchMode('longBreak');\r\n            } else {\r\n                switchMode('shortBreak');\r\n            }\r\n        } else {\r\n            switchMode('focus');\r\n        }\r\n    }, [mode, cycles, playSound, switchMode, settings]);\r\n\r\n    const skipTimer = () => {\r\n        handleTimerComplete();\r\n    };\r\n\r\n    // 5. Timer Effect\r\n    useEffect(() => {\r\n        let interval: ReturnType<typeof setInterval>;\r\n\r\n        if (isActive && timeLeft > 0) {\r\n            interval = setInterval(() => {\r\n                setTimeLeft((time) => time - 1);\r\n            }, 1000);\r\n        } else if (timeLeft === 0) {\r\n            // If in focus mode, we STOP here to allow validation.\r\n            // We do NOT auto-switch to break anymore.\r\n            if (mode === 'focus' && isActive) {\r\n                setIsActive(false);\r\n                playSound();\r\n                setIsWidgetVisible(true); // Force open widget for validation\r\n                // We keep mode='focus' and timeLeft=0 so the UI shows \"Validar\"\r\n            } else if (mode !== 'focus') {\r\n                // For breaks, we can auto-switch back to focus or stop?\r\n                // Let's stop at 0 for breaks too, letting user choose to start focus.\r\n                handleTimerComplete();\r\n            }\r\n        }\r\n\r\n        return () => clearInterval(interval);\r\n    }, [isActive, timeLeft, handleTimerComplete]);\r\n\r\n    // 6. Public API Implementations\r\n    const toggleTimer = () => setIsActive(!isActive);\r\n\r\n    const startFocusSession = (itemId: string, durationMinutes?: number) => {\r\n        // We force start a new session, overwriting any active one.\r\n        // This fixes race conditions where a previous session stopped in the same event loop \r\n        // hasn't updated the 'isActive' state variable yet.\r\n\r\n        console.log(`Starting focus session for ${itemId}`);\r\n\r\n        setLinkedItemId(itemId);\r\n        setMode('focus');\r\n        const durationSeconds = durationMinutes ? durationMinutes * 60 : settings.focus;\r\n        setTimeLeft(durationSeconds);\r\n        setIsActive(true);\r\n\r\n        // Don't open the big widget automatically - let GlobalActionBar (compact) handle it\r\n        // setIsWidgetVisible(true);\r\n    };\r\n\r\n    const closeWidget = () => setIsWidgetVisible(false);\r\n    const openWidget = () => setIsWidgetVisible(true);\r\n\r\n    return (\r\n        <PomodoroContext.Provider value={{\r\n            mode,\r\n            timeLeft,\r\n            isActive,\r\n            cycles,\r\n            linkedItemId,\r\n            isWidgetVisible,\r\n            settings: {\r\n                focusDuration: settings.focus / 60,\r\n                shortBreakDuration: settings.shortBreak / 60,\r\n                longBreakDuration: settings.longBreak / 60,\r\n                strictMode: settings.strictMode\r\n            },\r\n            updateSettings: (s) => updateSettings({\r\n                focus: s.focusDuration * 60,\r\n                shortBreak: s.shortBreakDuration * 60,\r\n                longBreak: s.longBreakDuration * 60,\r\n                strictMode: s.strictMode\r\n            }),\r\n            toggleTimer,\r\n            resetTimer,\r\n            skipTimer,\r\n            startFocusSession,\r\n            closeWidget,\r\n            openWidget\r\n        }}>\r\n            {children}\r\n        </PomodoroContext.Provider>\r\n    );\r\n};\r\n\r\nexport const usePomodoroContext = () => {\r\n    const context = useContext(PomodoroContext);\r\n    if (context === undefined) {\r\n        throw new Error('usePomodoroContext must be used within a PomodoroProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\StudyContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GameStats' is defined but never used.","line":10,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":56},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":215,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":215,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext } from 'react';\nimport { GamificationProvider, useGamification } from './GamificationContext';\nimport { useAuth } from './AuthContext'; // Import useAuth\nimport { TaskProvider, useTaskContext } from './TaskContext';\nimport { GoalProvider, useGoalContext } from './GoalContext';\nimport { ThemeProvider, useThemeContext } from './ThemeContext';\nimport { AppProvider, useAppContext, type ActiveFocusSession } from './AppContext';\nimport type { AppState, Theme, Task, Goal } from '../types';\nimport { supabase } from '../lib/supabase';\nimport type { Achievement, GamificationState, GameStats } from '../types/gamification';\n\n\ninterface StudyContextType extends AppState {\n    activeFocus: ActiveFocusSession | null;\n    loading: boolean;\n    syncStatus: 'synced' | 'syncing' | 'error' | 'offline';\n    startFocus: (id: string, type: 'task' | 'goal' | 'subtheme', title: string, duration: number, reviewNumber?: number, reviewType?: 'review' | 'intro', parentId?: string) => void;\n    endFocus: (completed: boolean, summary?: string) => void;\n\n    zenMode: boolean;\n    toggleZenMode: () => void;\n\n    gamification: GamificationState;\n    newlyUnlocked: Achievement | null;\n    dismissAchievement: () => void;\n\n    addTheme: (title: string, subthemes: { title: string; duration?: number }[], options?: { icon?: string, imageUrl?: string, color?: string, priority?: 'low' | 'medium' | 'high', startDate?: string, deadline?: string, category?: 'study' | 'project', subtitle?: string }) => void;\n    addSubtheme: (themeId: string, title: string, duration?: number) => Promise<void>;\n    deleteSubtheme: (themeId: string, subthemeId: string) => Promise<void>;\n    deleteTheme: (themeId: string) => void;\n    updateTheme: (id: string, updates: Partial<Theme>) => void;\n    completeReview: (subthemeId: string, reviewNumber?: number, type?: 'review' | 'intro', difficulty?: 'easy' | 'medium' | 'hard', summary?: string) => Promise<void>;\n    updateSubthemeContent: (subthemeId: string, content: string) => Promise<void>;\n\n    // Study Session (Flashcards)\n    activeStudySession: string | null;\n    startStudySession: (subthemeId: string) => void;\n    endStudySession: () => void;\n\n    addTask: (task: Omit<Task, 'id' | 'createdAt'>) => void;\n    deleteTask: (taskId: string) => void;\n    updateTask: (id: string, updates: Partial<Task>) => void;\n    toggleTask: (taskId: string, date?: string, summaryText?: string) => void;\n\n    addGoal: (goal: Omit<Goal, 'id' | 'progress' | 'createdAt'>) => void;\n    deleteGoal: (goalId: string) => void;\n    updateGoal: (id: string, updates: Partial<Goal>) => void;\n    toggleGoal: (goalId: string, date?: string, summaryText?: string) => void;\n    toggleGoalItem: (goalId: string, itemId: string, date?: string, summaryText?: string) => void;\n\n    logTime: (id: string, type: 'task' | 'goal' | 'subtheme', minutes: number) => void;\n    resetAccount: () => Promise<void>;\n    resetGamification: () => Promise<void>;\n    clearSyncQueue: () => void;\n    unlockedSubthemes: string[];\n}\n\nconst StudyContext = createContext<StudyContextType | undefined>(undefined);\n\nconst StudyContextFacade: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    const gamificationCtx = useGamification();\n    const taskCtx = useTaskContext();\n    const goalCtx = useGoalContext();\n    const themeCtx = useThemeContext();\n    const appCtx = useAppContext();\n    const { user } = useAuth(); // Import useAuth to get user\n    const { notificationService } = React.useMemo(() => ({ notificationService: import('../services/NotificationService').then(m => m.NotificationService) }), []);\n\n    // Initial Permission & Polling\n    React.useEffect(() => {\n        const initNotifications = async () => {\n            const Service = await notificationService;\n            await Service.requestPermission();\n        };\n        initNotifications();\n\n        const interval = setInterval(async () => {\n            const Service = await notificationService;\n            // Check Themes\n            const itemsToCheck = themeCtx.themes.map(t => ({ id: t.id, title: t.title, notificationTime: t.notificationTime, startDate: t.startDate }));\n            // Add Tasks later if needed\n            Service.checkNotifications(itemsToCheck);\n        }, 60000); // Check every minute\n\n        return () => clearInterval(interval);\n    }, [themeCtx.themes, notificationService]);\n\n    const value: StudyContextType = {\n        // AppState part (settings maintained as explicit override if needed, but AppContext has it too?)\n        // Let's check AppState interface.\n        settings: { username: 'Estudante', focusTime: 25 },\n\n        // App Infra\n        ...appCtx,\n\n        // Gamification\n        ...gamificationCtx,\n\n        // Domain Actions (These contain the tasks/goals/themes arrays)\n        ...taskCtx,\n        ...goalCtx,\n        ...themeCtx,\n\n        logTime: (id, type, minutes) => {\n            gamificationCtx.updateStats({ totalFocusMinutes: (gamificationCtx.gamification.stats?.totalFocusMinutes || 0) + minutes });\n        },\n        endFocus: async (completed: boolean, summary?: string) => {\n            const currentFocus = appCtx.activeFocus;\n            if (currentFocus) {\n                const endTime = new Date();\n                const startTime = new Date(currentFocus.startTime);\n                const durationMinutes = Math.round((endTime.getTime() - startTime.getTime()) / (60 * 1000));\n\n                const sessionLog = {\n                    start: startTime.toISOString(),\n                    end: endTime.toISOString(),\n                    durationMinutes: Math.max(1, durationMinutes),\n                    status: (completed ? 'completed' : 'cancelled') as 'completed' | 'cancelled',\n                    summary: summary\n                };\n\n                // Update the item safely\n                if (currentFocus.type === 'task') {\n                    const task = user\n                        ? (await supabase.from('tasks').select('*').eq('id', currentFocus.id).single()).data as Task | null\n                        : taskCtx.tasks.find(t => t.id === currentFocus.id);\n\n                    if (task) {\n                        const newSessions = [...(task.sessions || []), sessionLog];\n                        if (user) await supabase.from('tasks').update({ sessions: newSessions }).eq('id', currentFocus.id);\n                        taskCtx.updateTask(currentFocus.id, { sessions: newSessions });\n                    }\n                } else if (currentFocus.type === 'goal') {\n                    const goal = user\n                        ? (await supabase.from('goals').select('*').eq('id', currentFocus.id).single()).data as Goal | null\n                        : goalCtx.goals.find(g => g.id === currentFocus.id);\n\n                    if (goal) {\n                        const newSessions = [...(goal.sessions || []), sessionLog];\n                        if (user) await supabase.from('goals').update({ sessions: newSessions }).eq('id', currentFocus.id);\n                        goalCtx.updateGoal(currentFocus.id, { sessions: newSessions });\n                    }\n                } else if (currentFocus.type === 'subtheme') {\n                    const theme = themeCtx.themes.find(t => t.subthemes.some(st => st.id === currentFocus.id));\n                    if (theme) {\n                        const subtheme = theme.subthemes.find(st => st.id === currentFocus.id);\n                        if (subtheme) {\n                            const newSessions = [...(subtheme.sessions || []), sessionLog];\n                            const updatedSubthemes = theme.subthemes.map(st => st.id === currentFocus.id ? { ...st, sessions: newSessions } : st);\n                            themeCtx.updateTheme(theme.id, { subthemes: updatedSubthemes });\n                            if (user) {\n                                await supabase.from('subthemes').update({ sessions: newSessions }).eq('id', currentFocus.id);\n                            }\n                        }\n                    }\n                }\n            }\n            appCtx.endFocus(completed);\n        },\n        resetAccount: async () => {\n            if (!user) return; // Should not happen if authenticated\n\n            // 1. Delete from Supabase (Persistent)\n            const { error: tErrors } = await supabase.from('tasks').delete().eq('user_id', user.id);\n            const { error: gErrors } = await supabase.from('goals').delete().eq('user_id', user.id);\n            // Cascading delete usually handles subthemes, but let's be safe if needed or mostly rely on cascade\n            const { error: thErrors } = await supabase.from('themes').delete().eq('user_id', user.id);\n\n            if (tErrors || gErrors || thErrors) {\n                console.error(\"Error resetting account data:\", tErrors, gErrors, thErrors);\n                alert(\"Erro ao excluir dados do servidor. Tente novamente.\");\n                return;\n            }\n\n            // 2. Clear Local State\n            taskCtx.setTasks([]);\n            goalCtx.setGoals([]);\n            themeCtx.setThemes([]);\n            await gamificationCtx.resetGamification();\n\n            // 3. Clear Storage & Reload\n            localStorage.clear();\n            window.location.reload();\n        },\n        clearSyncQueue: () => {\n            // This would normally call SyncQueueService.clearQueue()\n        }\n    };\n\n    return (\n        <StudyContext.Provider value={value}>\n            {children}\n        </StudyContext.Provider>\n    );\n};\n\nexport const StudyProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    return (\n        <GamificationProvider>\n            <TaskProvider>\n                <GoalProvider>\n                    <ThemeProvider>\n                        <AppProvider>\n                            <StudyContextFacade>\n                                {children}\n                            </StudyContextFacade>\n                        </AppProvider>\n                    </ThemeProvider>\n                </GoalProvider>\n            </TaskProvider>\n        </GamificationProvider>\n    );\n};\n\nexport const useStudy = () => {\n    const context = useContext(StudyContext);\n    if (!context) throw new Error('useStudy must be used within StudyProvider');\n    return context;\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\TaskContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":109,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":109,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { useGamification } from './GamificationContext';\r\nimport { useTasks } from '../hooks/useTasks';\r\nimport type { Task } from '../types';\r\nimport { supabase } from '../lib/supabase';\r\n\r\ninterface TaskContextType {\r\n    tasks: Task[];\r\n    addTask: (task: Omit<Task, 'id' | 'createdAt'>) => void;\r\n    deleteTask: (taskId: string) => void;\r\n    updateTask: (id: string, updates: Partial<Task>) => void;\r\n    toggleTask: (taskId: string, date?: string, summaryText?: string) => void;\r\n    setTasks: React.Dispatch<React.SetStateAction<Task[]>>;\r\n}\r\n\r\nconst TaskContext = createContext<TaskContextType | undefined>(undefined);\r\n\r\nexport const TaskProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const { gamification, awardXP, updateStats } = useGamification();\r\n\r\n    const taskActions = useTasks({\r\n        user,\r\n        gamification,\r\n        awardXP,\r\n        updateStats\r\n    });\r\n\r\n    // Initial Fetch from Supabase\r\n    useEffect(() => {\r\n        const fetchTasks = async () => {\r\n            if (user) {\r\n                const { data, error } = await supabase\r\n                    .from('tasks')\r\n                    .select('*')\r\n                    .eq('user_id', user.id);\r\n\r\n                if (data && !error) {\r\n                    const normalized = data.map(t => ({\r\n                        ...t,\r\n                        startDate: t.start_date,\r\n                        endDate: t.end_date,\r\n                        createdAt: new Date(t.created_at).getTime(),\r\n                        imageUrl: t.image_url,\r\n                        durationMinutes: t.duration_minutes,\r\n                        timeSpent: t.time_spent || 0,\r\n                        completionHistory: t.completion_history || [],\r\n                        sessions: t.sessions || [],\r\n                        summaries: t.summaries || []\r\n                    }));\r\n\r\n                    // --- ROBUST DELETION PROTECTION ---\r\n                    // Read pending deletions from Sync Queue to prevent 'zombies'\r\n                    const pendingDeletes = new Set<string>();\r\n                    try {\r\n                        const queueRaw = localStorage.getItem('sync_queue_v1');\r\n                        if (queueRaw) {\r\n                            const queue = JSON.parse(queueRaw);\r\n                            if (Array.isArray(queue)) {\r\n                                queue.forEach((op: { type: string; table: string; data?: { id?: string } }) => {\r\n                                    if (op.type === 'DELETE' && op.table === 'tasks' && op.data?.id) {\r\n                                        pendingDeletes.add(op.data.id);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(\"Error reading sync queue for protection\", e);\r\n                    }\r\n                    // ----------------------------------\r\n\r\n                    taskActions.setTasks(prevTasks => {\r\n                        const finalTasks: Task[] = [];\r\n                        const processedIds = new Set<string>();\r\n\r\n                        // 1. Add/Update from Server (filtered)\r\n                        normalized.forEach(serverTask => {\r\n                            if (pendingDeletes.has(serverTask.id)) {\r\n                                console.log(` Blocked zombie task resurrecion: ${serverTask.id}`);\r\n                                return; // Skip deleted item\r\n                            }\r\n                            finalTasks.push(serverTask);\r\n                            processedIds.add(serverTask.id);\r\n                        });\r\n\r\n                        // 2. Preserve Local-Only (Optimistic)\r\n                        prevTasks.forEach(localTask => {\r\n                            if (!processedIds.has(localTask.id)) {\r\n                                finalTasks.push(localTask);\r\n                            }\r\n                        });\r\n\r\n                        return finalTasks;\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        fetchTasks();\r\n    }, [user, taskActions]);\r\n\r\n    return (\r\n        <TaskContext.Provider value={taskActions}>\r\n            {children}\r\n        </TaskContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useTaskContext = () => {\r\n    const context = useContext(TaskContext);\r\n    if (!context) throw new Error('useTaskContext must be used within TaskProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\ThemeContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":110,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5685,5688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5685,5688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7549,7552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7549,7552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'themeActions'. Either include it or remove the dependency array.","line":162,"column":8,"nodeType":"ArrayExpression","endLine":162,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [user, themeActions.setThemes, themeActions]","fix":{"range":[8673,8703],"text":"[user, themeActions.setThemes, themeActions]"}}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":171,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":171,"endColumn":29}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\nimport { useGamification } from './GamificationContext';\r\nimport { useThemes } from '../hooks/useThemes';\r\nimport type { Theme, Subtheme } from '../types';\r\nimport { supabase } from '../lib/supabase';\r\nimport { useAudio } from './AudioContext';\r\n\r\ninterface ThemeContextType {\r\n    themes: Theme[];\r\n    addTheme: (title: string, subthemes: { title: string; duration?: number }[], options?: { icon?: string, imageUrl?: string, color?: string, priority?: 'low' | 'medium' | 'high', startDate?: string, deadline?: string, category?: 'study' | 'project', subtitle?: string }) => void;\r\n    addSubtheme: (themeId: string, title: string, duration?: number) => Promise<void>;\r\n    deleteSubtheme: (themeId: string, subthemeId: string) => Promise<void>;\r\n    deleteTheme: (themeId: string) => void;\r\n    updateTheme: (id: string, updates: Partial<Theme>) => void;\r\n    completeReview: (subthemeId: string, reviewNumber?: number, type?: 'review' | 'intro', difficulty?: 'easy' | 'medium' | 'hard', summary?: string) => Promise<void>;\r\n    updateSubthemeContent: (subthemeId: string, content: string) => Promise<void>;\r\n    setThemes: React.Dispatch<React.SetStateAction<Theme[]>>;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const { gamification, awardXP, updateStats } = useGamification();\r\n    const { playSFX } = useAudio();\r\n\r\n    const themeActions = useThemes({\r\n        user,\r\n        gamification,\r\n        awardXP,\r\n        updateStats,\r\n        playSFX\r\n    });\r\n\r\n    // Initial Fetch from Supabase\r\n    useEffect(() => {\r\n        const fetchThemes = async () => {\r\n            if (user) {\r\n                const { data: themesData, error: themesError } = await supabase\r\n                    .from('themes')\r\n                    .select('*, subthemes(*)')\r\n                    .eq('user_id', user.id)\r\n                    .order('order_index', { foreignTable: 'subthemes', ascending: true });\r\n\r\n                if (themesData && !themesError) {\r\n                    const normalized = themesData.map(t => ({\r\n                        ...t,\r\n                        createdAt: new Date(t.created_at).getTime(),\r\n                        imageUrl: t.image_url,\r\n                        startDate: t.start_date,\r\n                        summaries: t.summaries || [],\r\n                        subthemes: t.subthemes.map((st: Subtheme & { theme_id: string; duration_minutes: number; time_spent: number }) => ({\r\n                            ...st,\r\n                            themeId: st.theme_id,\r\n                            durationMinutes: st.duration_minutes,\r\n                            timeSpent: st.time_spent || 0,\r\n                            summaries: st.summaries || []\r\n                        }))\r\n                    }));\r\n\r\n                    // --- ROBUST DELETION PROTECTION ---\r\n                    const pendingDeletes = new Set<string>();\r\n                    const pendingSubthemeDeletes = new Set<string>();\r\n                    let deletedIds = new Set<string>();\r\n\r\n                    try {\r\n                        const storedDeleted = localStorage.getItem('deleted_theme_ids');\r\n                        if (storedDeleted) {\r\n                            deletedIds = new Set(JSON.parse(storedDeleted));\r\n                        }\r\n\r\n\r\n                        const queueRaw = localStorage.getItem('sync_queue_v1');\r\n                        if (queueRaw) {\r\n                            const queue = JSON.parse(queueRaw);\r\n                            if (Array.isArray(queue)) {\r\n                                queue.forEach((op: { type: string; table: string; data?: { id?: string } }) => {\r\n                                    if (op.type === 'DELETE' && op.data?.id) {\r\n                                        if (op.table === 'themes') pendingDeletes.add(op.data.id);\r\n                                        if (op.table === 'subthemes') pendingSubthemeDeletes.add(op.data.id);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(\"Error reading sync queue for theme protection\", e);\r\n                    }\r\n                    // ----------------------------------\r\n\r\n                    themeActions.setThemes(prevThemes => {\r\n                        // Create a map of current themes for easy lookup\r\n                        const currentThemesMap = new Map(prevThemes.map(t => [t.id, t]));\r\n                        const finalThemes: Theme[] = [];\r\n                        const processedIds = new Set<string>();\r\n\r\n                        // 1. Process Server Themes (Merge with Local)\r\n                        normalized.forEach(serverTheme => {\r\n                            if (pendingDeletes.has(serverTheme.id) || deletedIds.has(serverTheme.id)) {\r\n                                console.log(` Blocked zombie theme resurrecion: ${serverTheme.id}`);\r\n                                return;\r\n                            }\r\n\r\n                            processedIds.add(serverTheme.id);\r\n                            const localTheme = currentThemesMap.get(serverTheme.id);\r\n\r\n                            let finalSubthemes = serverTheme.subthemes;\r\n\r\n                            // Filter Server Subthemes against pending deletes\r\n                            finalSubthemes = finalSubthemes.filter((st: any) => !pendingSubthemeDeletes.has(st.id));\r\n\r\n\r\n                            if (localTheme) {\r\n                                // --- SMART SUBTHEME MERGE ---\r\n                                // 1. If server has 0 subthemes but local has them, this is likely a sync glitch or latency.\r\n                                //    KEEP local subthemes to prevent \"zeroing\".\r\n                                if (serverTheme.subthemes.length === 0 && localTheme.subthemes.length > 0) {\r\n                                    console.warn(`[SmartMerge] Preserving ${localTheme.subthemes.length} local subthemes for theme ${serverTheme.title} (Server returned 0)`);\r\n                                    finalSubthemes = localTheme.subthemes;\r\n                                }\r\n                                else {\r\n                                    // 2. Union Merge: Keep local-only items (optimistic adds) + Server updates\r\n                                    const subthemeMap = new Map<string, Subtheme>();\r\n\r\n                                    // Start with Local (preserves un-synced added items)\r\n                                    // But ignore if they are pending delete locally (already handled by useThemes deleteSubtheme logic which updates state)\r\n                                    localTheme.subthemes.forEach(st => subthemeMap.set(st.id, st));\r\n\r\n                                    // Overlay Server (Source of Truth for synced items)\r\n                                    // serverTheme.subthemes are technically arrays from server.\r\n                                    // We must check if any server subtheme is in pendingSubthemeDeletes (already filtered above in finalSubthemes assignment)\r\n                                    // So we overlay the filtered server subthemes.\r\n                                    serverTheme.subthemes.forEach((st: any) => {\r\n                                        if (!pendingSubthemeDeletes.has(st.id)) {\r\n                                            subthemeMap.set(st.id, st);\r\n                                        }\r\n                                    });\r\n\r\n                                    finalSubthemes = Array.from(subthemeMap.values());\r\n                                }\r\n                            }\r\n\r\n                            finalThemes.push({\r\n                                ...serverTheme,\r\n                                subthemes: finalSubthemes\r\n                            });\r\n                        });\r\n\r\n                        // 2. Preserve Local-Only Themes (Optimistic Adds not yet on server)\r\n                        prevThemes.forEach(localTheme => {\r\n                            if (!processedIds.has(localTheme.id)) {\r\n                                finalThemes.push(localTheme);\r\n                            }\r\n                        });\r\n\r\n                        return finalThemes;\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        fetchThemes();\r\n    }, [user, themeActions.setThemes]);\r\n\r\n    return (\r\n        <ThemeContext.Provider value={themeActions}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useThemeContext = () => {\r\n    const context = useContext(ThemeContext);\r\n    if (!context) throw new Error('useThemeContext must be used within ThemeProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\context\\ToastContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":52,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":52,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useCallback } from 'react';\r\nimport { Toast } from '../components/ui/Toast';\r\n\r\nexport type ToastType = 'success' | 'error' | 'info' | 'warning';\r\n\r\ninterface ToastMessage {\r\n    id: string;\r\n    message: string;\r\n    type: ToastType;\r\n}\r\n\r\ninterface ToastContextType {\r\n    showToast: (message: string, type?: ToastType) => void;\r\n}\r\n\r\nconst ToastContext = createContext<ToastContextType | undefined>(undefined);\r\n\r\nexport const ToastProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [toasts, setToasts] = useState<ToastMessage[]>([]);\r\n\r\n    const showToast = useCallback((message: string, type: ToastType = 'info') => {\r\n        const id = crypto.randomUUID();\r\n        setToasts(prev => [...prev, { id, message, type }]);\r\n\r\n        setTimeout(() => {\r\n            setToasts(prev => prev.filter(t => t.id !== id));\r\n        }, 5000);\r\n    }, []);\r\n\r\n    const removeToast = useCallback((id: string) => {\r\n        setToasts(prev => prev.filter(t => t.id !== id));\r\n    }, []);\r\n\r\n    return (\r\n        <ToastContext.Provider value={{ showToast }}>\r\n            {children}\r\n            <div className=\"fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 pointer-events-none\">\r\n                {toasts.map(toast => (\r\n                    <Toast\r\n                        key={toast.id}\r\n                        id={toast.id}\r\n                        title={toast.message}\r\n                        type={toast.type}\r\n                        onClose={removeToast}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </ToastContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useToast = () => {\r\n    const context = useContext(ToastContext);\r\n    if (!context) throw new Error('useToast must be used within ToastProvider');\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\AnalyticsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\AchievementsList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1673,1676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1673,1676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { ACHIEVEMENTS_LIST } from '../../../config/gamification';\r\nimport type { Achievement } from '../../../types/gamification';\r\nimport * as Icons from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport { Lock, CheckCircle2 } from 'lucide-react';\r\n\r\ninterface AchievementsListProps {\r\n    unlockedAchievements: Achievement[];\r\n}\r\n\r\nexport const AchievementsList: React.FC<AchievementsListProps> = ({ unlockedAchievements }) => {\r\n    return (\r\n        <div className=\"bg-slate-900/40 border border-white/5 rounded-[2.5rem] p-8 backdrop-blur-xl relative overflow-hidden group\">\r\n            {/* Ambient Light */}\r\n            <div className=\"absolute top-0 right-0 w-64 h-64 bg-yellow-500/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\" />\r\n\r\n            <div className=\"flex items-center justify-between mb-8 relative z-10\">\r\n                <div>\r\n                    <h3 className=\"text-2xl font-black text-white tracking-tight flex items-center gap-3\">\r\n                        <Icons.Trophy className=\"w-6 h-6 text-yellow-500\" />\r\n                        Conquistas\r\n                    </h3>\r\n                    <p className=\"text-slate-400 text-sm font-medium mt-1\">\r\n                        {unlockedAchievements.length} de {ACHIEVEMENTS_LIST.length} desbloqueadas\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 relative z-10\">\r\n                {ACHIEVEMENTS_LIST.map((config) => {\r\n                    const unlocked = unlockedAchievements.find(a => a.id === config.id);\r\n                    const Icon = (Icons as any)[config.iconName] || Icons.Trophy;\r\n\r\n                    return (\r\n                        <div\r\n                            key={config.id}\r\n                            className={cn(\r\n                                \"relative p-4 rounded-2xl border transition-all duration-500 group/achievement overflow-hidden\",\r\n                                unlocked\r\n                                    ? \"bg-slate-800/40 border-yellow-500/20 shadow-lg shadow-yellow-500/5\"\r\n                                    : \"bg-slate-950/40 border-white/5 opacity-60 grayscale\"\r\n                            )}\r\n                        >\r\n                            {/* Unlocked Shine */}\r\n                            {unlocked && (\r\n                                <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-yellow-500/5 to-transparent -translate-x-full group-hover/achievement:translate-x-full transition-transform duration-1000\" />\r\n                            )}\r\n\r\n                            <div className=\"flex items-center gap-4 relative z-10\">\r\n                                <div className={cn(\r\n                                    \"w-12 h-12 rounded-xl flex items-center justify-center shrink-0 shadow-inner\",\r\n                                    unlocked\r\n                                        ? \"bg-gradient-to-br from-yellow-400 to-orange-600 text-white\"\r\n                                        : \"bg-slate-800 text-slate-600\"\r\n                                )}>\r\n                                    {unlocked ? <Icon className=\"w-6 h-6\" /> : <Lock className=\"w-5 h-5\" />}\r\n                                </div>\r\n\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <h4 className={cn(\r\n                                        \"text-sm font-bold truncate\",\r\n                                        unlocked ? \"text-white\" : \"text-slate-500\"\r\n                                    )}>\r\n                                        {config.title}\r\n                                    </h4>\r\n                                    <p className=\"text-[11px] text-slate-400 leading-tight line-clamp-2 mt-0.5\">\r\n                                        {config.description}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {unlocked && (\r\n                                    <CheckCircle2 className=\"w-5 h-5 text-emerald-500 shrink-0\" />\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Progress bar (Visual only for now since we don't track steps) */}\r\n                            {!unlocked && (\r\n                                <div className=\"mt-3 h-1 w-full bg-slate-800 rounded-full overflow-hidden\">\r\n                                    <div className=\"h-full bg-slate-700 w-1/3\" />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\CategoryDistributionChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":35,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts';\r\nimport type { Theme, Task, Goal } from '../../../types';\r\n\r\ninterface CategoryDistributionChartProps {\r\n    themes: Theme[];\r\n    tasks: Task[];\r\n    goals: Goal[];\r\n}\r\n\r\nexport const CategoryDistributionChart: React.FC<CategoryDistributionChartProps> = ({ themes, tasks, goals }) => {\r\n    // Process categories\r\n    const categories: Record<string, number> = {};\r\n\r\n    // From Themes/Subthemes\r\n    themes.forEach(theme => {\r\n        const cat = theme.category || 'Estudos';\r\n        const minutes = theme.subthemes.reduce((acc, st) => acc + (st.timeSpent || 0), 0);\r\n        categories[cat] = (categories[cat] || 0) + minutes;\r\n    });\r\n\r\n    // From Tasks\r\n    tasks.forEach(task => {\r\n        const cat = 'Tarefas';\r\n        categories[cat] = (categories[cat] || 0) + (task.timeSpent || 0);\r\n    });\r\n\r\n    // From Goals\r\n    goals.forEach(goal => {\r\n        const cat = goal.category || 'Metas';\r\n        categories[cat] = (categories[cat] || 0) + (goal.timeSpent || 0);\r\n    });\r\n\r\n    const data = Object.entries(categories)\r\n        .filter(([_, value]) => value > 0)\r\n        .map(([name, value]) => ({ name, value }));\r\n\r\n    // Fallback if no data\r\n    if (data.length === 0) {\r\n        data.push({ name: 'Sem dados', value: 1 });\r\n    }\r\n\r\n    const COLORS = ['#3b82f6', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#6366f1'];\r\n\r\n    return (\r\n        <div className=\"bg-slate-900/40 border border-white/5 rounded-[2.5rem] p-8 backdrop-blur-xl relative overflow-hidden group h-full flex flex-col\">\r\n            <div className=\"absolute top-0 right-0 w-64 h-64 bg-pink-500/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\" />\r\n\r\n            <h3 className=\"text-xl font-bold text-white mb-6 relative z-10 flex items-center gap-3\">\r\n                <div className=\"p-2 rounded-lg bg-pink-500/10 text-pink-400 border border-pink-500/20\">\r\n                    <span className=\"w-1.5 h-1.5 rounded-full bg-pink-400\" />\r\n                </div>\r\n                Distribuio de Foco\r\n            </h3>\r\n\r\n            <div className=\"flex-1 min-h-[300px] relative z-10\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <PieChart>\r\n                        <Pie\r\n                            data={data}\r\n                            innerRadius={80}\r\n                            outerRadius={100}\r\n                            paddingAngle={8}\r\n                            dataKey=\"value\"\r\n                            stroke=\"none\"\r\n                        >\r\n                            {data.map((_, index) => (\r\n                                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\r\n                            ))}\r\n                        </Pie>\r\n                        <Tooltip\r\n                            contentStyle={{\r\n                                backgroundColor: 'rgba(15, 23, 42, 0.9)',\r\n                                border: '1px solid rgba(255,255,255,0.1)',\r\n                                borderRadius: '16px',\r\n                                boxShadow: '0 10px 40px -10px rgba(0,0,0,0.5)',\r\n                                padding: '12px 16px',\r\n                                color: '#f8fafc'\r\n                            }}\r\n                            itemStyle={{ color: '#e2e8f0', fontSize: '13px', fontWeight: 'bold' }}\r\n                            formatter={(value: number) => [`${value} min`, 'Tempo']}\r\n                        />\r\n                        <Legend\r\n                            verticalAlign=\"bottom\"\r\n                            align=\"center\"\r\n                            iconType=\"circle\"\r\n                            formatter={(value) => <span className=\"text-slate-400 text-xs font-bold uppercase tracking-wider ml-1\">{value}</span>}\r\n                        />\r\n                    </PieChart>\r\n                </ResponsiveContainer>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\DetailedStatsTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\HeatmapWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'subDays' is defined but never used.","line":3,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startOfYear' is defined but never used.","line":3,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'endOfYear' is defined but never used.","line":3,"column":59,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getDay' is defined but never used.","line":3,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":76}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n// import { Tooltip as ReactTooltip } from 'react-tooltip'; // Wait, standard tooltip is fine or custom. I'll build custom grid.\r\nimport { format, eachDayOfInterval, subDays, startOfYear, endOfYear, getDay, subWeeks } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\n\r\ninterface HeatmapWidgetProps {\r\n    dailyHistory: Record<string, number>;\r\n}\r\n\r\nexport const HeatmapWidget: React.FC<HeatmapWidgetProps> = ({ dailyHistory }) => {\r\n    // We'll show the last 365 days (or approx 1 year) like GitHub\r\n    const today = new Date();\r\n    // Start approx 52 weeks ago to fill grid nicely\r\n    // 52 weeks * 7 = 364 days.\r\n    const startDate = subWeeks(today, 52);\r\n\r\n    // Generate dates\r\n    const dates = eachDayOfInterval({ start: startDate, end: today });\r\n\r\n    // Determine color based on minutes\r\n    const getColor = (minutes: number) => {\r\n        if (minutes === 0) return 'bg-slate-800/50';\r\n        if (minutes < 30) return 'bg-blue-900/40';\r\n        if (minutes < 60) return 'bg-blue-800/60';\r\n        if (minutes < 120) return 'bg-blue-600/80';\r\n        return 'bg-blue-500'; // High level\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white/5 border border-white/5 rounded-2xl p-6 backdrop-blur-sm overflow-x-auto custom-scrollbar\">\r\n            <h3 className=\"text-lg font-bold text-white mb-6 flex items-center gap-2\">\r\n                <span className=\"w-1 h-6 bg-emerald-500 rounded-full\" />\r\n                Mapa de Consistncia (ltimo Ano)\r\n            </h3>\r\n\r\n            <div className=\"flex gap-1 min-w-max\">\r\n                {/* We need to group by Week (Columns) */}\r\n                {/* \r\n                    Logic: \r\n                    Grid is 7 rows (Sun-Sat).\r\n                    Columns are weeks.\r\n                */}\r\n\r\n                {Array.from({ length: 53 }).map((_, weekIndex) => {\r\n                    return (\r\n                        <div key={weekIndex} className=\"flex flex-col gap-1\">\r\n                            {Array.from({ length: 7 }).map((_, dayIndex) => {\r\n                                // Calculate actual date for this cell\r\n                                // Grid fills column first (days of week)\r\n                                // start date might not be Sunday. Adjust.\r\n                                // Actually, simpler: just map the Flat 'dates' array into chunks of 7?\r\n                                // No, because we want row=DayOfWeek.\r\n\r\n                                // Let's iterate weeks, then days.\r\n                                // StartDate should ideally be a Sunday to align grid?\r\n                                // If startDate is Wednesday, first col has empty slots top?\r\n                                // Assuming standard alignment.\r\n\r\n                                const dayOffset = weekIndex * 7 + dayIndex;\r\n                                if (dayOffset >= dates.length) return null;\r\n\r\n                                const date = dates[dayOffset];\r\n                                const minutes = dailyHistory[format(date, 'yyyy-MM-dd')] || 0;\r\n                                const dateStr = format(date, \"d 'de' MMMM, yyyy\", { locale: ptBR });\r\n                                const durationStr = minutes > 0 ? `${Math.floor(minutes / 60)}h ${minutes % 60}m` : 'Sem atividade';\r\n\r\n                                return (\r\n                                    <div\r\n                                        key={dayIndex}\r\n                                        className={`w-3 h-3 rounded-sm ${getColor(minutes)} hover:ring-1 hover:ring-white transition-all relative group cursor-pointer`}\r\n                                        title={`${dateStr}: ${durationStr}`} // Native tooltip for simplicity\r\n                                    >\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    )\r\n                })}\r\n            </div>\r\n\r\n            <div className=\"flex justify-end items-center gap-2 mt-4 text-xs text-slate-500\">\r\n                <span>Menos</span>\r\n                <div className=\"flex gap-1\">\r\n                    <div className=\"w-3 h-3 rounded-sm bg-slate-800/50\" />\r\n                    <div className=\"w-3 h-3 rounded-sm bg-blue-900/40\" />\r\n                    <div className=\"w-3 h-3 rounded-sm bg-blue-800/60\" />\r\n                    <div className=\"w-3 h-3 rounded-sm bg-blue-600/80\" />\r\n                    <div className=\"w-3 h-3 rounded-sm bg-blue-500\" />\r\n                </div>\r\n                <span>Mais</span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\RetentionChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\StatCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\WeeklyFocusChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startOfWeek' is defined but never used.","line":3,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addDays' is defined but never used.","line":3,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getDay' is defined but never used.","line":3,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'label' is defined but never used.","line":26,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":52},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1110,1113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1110,1113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\WeeklyFocusChart.tsx:115:39\n  113 |                         />\n  114 |                         <Tooltip\n> 115 |                             content={<CustomTooltip />}\n      |                                       ^^^^^^^^^^^^^ This component is created during render\n  116 |                             cursor={{ fill: 'rgba(255,255,255,0.03)', radius: 8 }}\n  117 |                         />\n  118 |                         <Bar\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\analytics\\components\\WeeklyFocusChart.tsx:26:27\n  24 |     });\n  25 |\n> 26 |     const CustomTooltip = ({ active, payload, label }: any) => {\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 27 |         if (active && payload && payload.length) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |             return (\n     \n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |         return null;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |     };\n     | ^^^^^^ The component is created during render here\n  40 |\n  41 |     return (\n  42 |         <div className=\"relative overflow-hidden bg-slate-900/40 border border-white/5 rounded-3xl p-6 backdrop-blur-xl hover:bg-slate-800/40 transition-colors group\">","line":115,"column":39,"nodeType":null,"endLine":115,"endColumn":52}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } from 'recharts';\r\nimport { format, subDays, startOfWeek, addDays, getDay } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\n\r\ninterface WeeklyFocusChartProps {\r\n    dailyHistory: Record<string, number>; // date \"yyyy-MM-dd\": minutes\r\n}\r\n\r\nexport const WeeklyFocusChart: React.FC<WeeklyFocusChartProps> = ({ dailyHistory }) => {\r\n    // Generate last 7 days data\r\n    const today = format(new Date(), 'yyyy-MM-dd');\r\n    const data = Array.from({ length: 7 }).map((_, i) => {\r\n        const date = subDays(new Date(), 6 - i); // Last 7 days including today\r\n        const dateStr = format(date, 'yyyy-MM-dd');\r\n        const isToday = dateStr === today;\r\n        return {\r\n            name: format(date, 'EEE', { locale: ptBR }), // Mon, Tue...\r\n            fullDate: format(date, \"d 'de' MMMM\", { locale: ptBR }),\r\n            minutes: dailyHistory[dateStr] || 0,\r\n            originalDate: date,\r\n            isToday\r\n        };\r\n    });\r\n\r\n    const CustomTooltip = ({ active, payload, label }: any) => {\r\n        if (active && payload && payload.length) {\r\n            return (\r\n                <div className=\"bg-slate-900/90 border border-slate-700 p-4 rounded-2xl shadow-2xl backdrop-blur-xl ring-1 ring-white/10\">\r\n                    <p className=\"text-xs font-bold text-slate-400 mb-1 uppercase tracking-wider\">{payload[0].payload.fullDate}</p>\r\n                    <p className=\"text-2xl font-bold text-white tabular-nums\">\r\n                        {Math.floor(payload[0].value / 60)}<span className=\"text-sm font-medium text-slate-500 ml-0.5 mr-2\">h</span>\r\n                        {payload[0].value % 60}<span className=\"text-sm font-medium text-slate-500 ml-0.5\">m</span>\r\n                    </p>\r\n                </div>\r\n            );\r\n        }\r\n        return null;\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative overflow-hidden bg-slate-900/40 border border-white/5 rounded-3xl p-6 backdrop-blur-xl hover:bg-slate-800/40 transition-colors group\">\r\n            {/* Ambient Background */}\r\n            <div className=\"absolute top-0 right-0 w-64 h-64 bg-blue-500/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\" />\r\n\r\n            <div className=\"flex items-center justify-between mb-8 relative z-10\">\r\n                <div>\r\n                    <h3 className=\"text-lg font-bold text-white flex items-center gap-3\">\r\n                        <div className=\"p-2 rounded-lg bg-blue-500/10 text-blue-400 ring-1 ring-blue-500/20\">\r\n                            <span className=\"w-1.5 h-1.5 rounded-full bg-blue-400 animate-pulse\" />\r\n                        </div>\r\n                        Foco nos ltimos 7 Dias\r\n                    </h3>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"h-72 w-full relative z-10\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <BarChart data={data} margin={{ top: 10, right: 10, left: -20, bottom: 0 }}>\r\n                        <defs>\r\n                            <linearGradient id=\"barGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                <stop offset=\"0%\" stopColor=\"#3b82f6\" stopOpacity={0.8} />\r\n                                <stop offset=\"100%\" stopColor=\"#3b82f6\" stopOpacity={0.2} />\r\n                            </linearGradient>\r\n                            <linearGradient id=\"barGradientHover\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                <stop offset=\"0%\" stopColor=\"#60a5fa\" stopOpacity={1} />\r\n                                <stop offset=\"100%\" stopColor=\"#3b82f6\" stopOpacity={0.4} />\r\n                            </linearGradient>\r\n                        </defs>\r\n                        <XAxis\r\n                            dataKey=\"name\"\r\n                            axisLine={false}\r\n                            tickLine={false}\r\n                            tick={(props) => {\r\n                                const { x, y, payload, index } = props;\r\n                                const entry = data[index];\r\n                                return (\r\n                                    <g transform={`translate(${x},${y})`}>\r\n                                        <text\r\n                                            x={0}\r\n                                            y={0}\r\n                                            dy={-10}\r\n                                            textAnchor=\"middle\"\r\n                                            fill={entry?.isToday ? '#60a5fa' : '#e2e8f0'}\r\n                                            fontSize={14}\r\n                                            fontWeight={entry?.isToday ? 700 : 600}\r\n                                        >\r\n                                            {payload.value}\r\n                                        </text>\r\n                                        {entry?.isToday && (\r\n                                            <text\r\n                                                x={0}\r\n                                                y={0}\r\n                                                dy={8}\r\n                                                textAnchor=\"middle\"\r\n                                                fill=\"#60a5fa\"\r\n                                                fontSize={10}\r\n                                                fontWeight={700}\r\n                                            >\r\n                                                HOJE\r\n                                            </text>\r\n                                        )}\r\n                                    </g>\r\n                                );\r\n                            }}\r\n                        />\r\n                        <YAxis\r\n                            hide={false}\r\n                            axisLine={false}\r\n                            tickLine={false}\r\n                            tick={{ fill: '#475569', fontSize: 11, fontWeight: 500 }}\r\n                            tickFormatter={(value) => `${Math.floor(value / 60)}h`}\r\n                        />\r\n                        <Tooltip\r\n                            content={<CustomTooltip />}\r\n                            cursor={{ fill: 'rgba(255,255,255,0.03)', radius: 8 }}\r\n                        />\r\n                        <Bar\r\n                            dataKey=\"minutes\"\r\n                            radius={[8, 8, 8, 8]}\r\n                            className=\"transition-all duration-300\"\r\n                        >\r\n                            {data.map((entry, index) => (\r\n                                <Cell\r\n                                    key={`cell-${index}`}\r\n                                    fill={entry.isToday ? \"url(#barGradientHover)\" : \"url(#barGradient)\"}\r\n                                    className=\"hover:opacity-100 opacity-80 transition-all cursor-pointer hover:filter hover:drop-shadow-[0_0_10px_rgba(59,130,246,0.5)]\"\r\n                                />\r\n                            ))}\r\n                        </Bar>\r\n                    </BarChart>\r\n                </ResponsiveContainer>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\auth\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\auth\\components\\ForgotPasswordModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\Calendar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronLeft' is defined but never used.","line":3,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronRight' is defined but never used.","line":4,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":6,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isSameMonth' is defined but never used.","line":16,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isSameDay' is defined but never used.","line":19,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2521,2524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2521,2524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3748,3751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3748,3751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":170,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6544,6547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6544,6547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\r\nimport {\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    PlayCircle,\r\n    Clock,\r\n    Loader2\r\n} from 'lucide-react';\r\nimport {\r\n    format,\r\n    addMonths,\r\n    subMonths,\r\n    startOfMonth,\r\n    endOfMonth,\r\n    eachDayOfInterval,\r\n    isSameMonth,\r\n    isToday,\r\n    addDays,\r\n    isSameDay\r\n} from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useCalendarEvents } from './hooks/useCalendarEvents';\r\nimport { CalendarHeader } from './components/CalendarHeader';\r\nimport { CalendarGrid } from './components/CalendarGrid';\r\nimport { CalendarDay } from './components/CalendarDay';\r\nimport { DayDetails } from './components/DayDetails';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { UpcomingReviewsSidebar } from './components/UpcomingReviewsSidebar';\r\nimport { cn } from '../../lib/utils';\r\nimport { parseLocalDate } from '../../utils/dateHelpers';\r\nimport type { Review } from '../../types';\r\n\r\nexport const Calendar = () => {\r\n    const [currentMonth, setCurrentMonth] = useState(new Date());\r\n    const [selectedDate, setSelectedDate] = useState<Date | null>(null);\r\n    const {\r\n        themes,\r\n        tasks,\r\n        goals,\r\n        completeReview,\r\n        startStudySession,\r\n        activeFocus,\r\n        endFocus,\r\n        startFocus,\r\n        toggleTask,\r\n        toggleGoal,\r\n        toggleGoalItem,\r\n        deleteGoal,\r\n        deleteTask\r\n    } = useStudy();\r\n\r\n    const { startFocusSession, resetTimer } = usePomodoroContext();\r\n    const { getEventsForDay, upcomingList, now } = useCalendarEvents({ themes, tasks, goals });\r\n\r\n    const calendarDays = useMemo(() => {\r\n        const start = startOfMonth(currentMonth);\r\n        const end = endOfMonth(currentMonth);\r\n        return eachDayOfInterval({ start, end });\r\n    }, [currentMonth]);\r\n\r\n    const nextMonth = () => setCurrentMonth(addMonths(currentMonth, 1));\r\n    const prevMonth = () => setCurrentMonth(subMonths(currentMonth, 1));\r\n\r\n\r\n    const [selectedSubthemeSchedule, setSelectedSubthemeSchedule] = useState<{\r\n        subthemeTitle: string;\r\n        themeTitle: string;\r\n        schedule: (Review | { number: number; date: string; status: 'simulated' })[];\r\n        introDate: string;\r\n        type: string;\r\n        id: string;\r\n        color?: string;\r\n    } | null>(null);\r\n\r\n    const handleSubthemeClick = (e: React.MouseEvent, item: any, isProjected: boolean, date: Date) => {\r\n        e.stopPropagation();\r\n\r\n        let schedule: (Review | { number: number; date: string; status: 'simulated' })[] = [];\r\n        let introDate = '';\r\n\r\n        if (isProjected) {\r\n            const baseDate = item.introDate ? parseLocalDate(item.introDate) : new Date(date);\r\n            introDate = format(baseDate, \"d/MM\");\r\n            const offsets = [1, 3, 10, 18, 33];\r\n            schedule = offsets.map((off, i) => ({\r\n                number: i + 1,\r\n                date: format(addDays(baseDate, off), 'yyyy-MM-dd'),\r\n                status: 'simulated'\r\n            }));\r\n        } else {\r\n            const theme = themes.find(t => t.title === item.themeTitle);\r\n            const subtheme = theme?.subthemes.find(st => st.title === item.subthemeTitle);\r\n            if (subtheme && subtheme.reviews) {\r\n                schedule = subtheme.reviews;\r\n                introDate = subtheme.introductionDate || '';\r\n            }\r\n        }\r\n\r\n        setSelectedSubthemeSchedule({\r\n            ...item,\r\n            schedule,\r\n            introDate,\r\n            type: isProjected ? 'projected' : 'active'\r\n        });\r\n    };\r\n\r\n    const handleStartFocus = (item: any) => {\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        if (item.date > todayStr) return;\r\n\r\n        startFocus(item.id, 'subtheme', item.subthemeTitle, 25);\r\n        startFocusSession(item.id, 25);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 relative pb-20 fade-in\">\r\n            <div className=\"fixed top-20 left-1/4 w-96 h-96 bg-blue-600/10 rounded-full blur-[128px] pointer-events-none -z-10\" />\r\n            <div className=\"fixed bottom-20 right-1/4 w-96 h-96 bg-indigo-600/10 rounded-full blur-[128px] pointer-events-none -z-10\" />\r\n\r\n            <CalendarHeader\r\n                currentMonth={currentMonth}\r\n                onPrevMonth={prevMonth}\r\n                onNextMonth={nextMonth}\r\n                onToday={() => setCurrentMonth(new Date())}\r\n            />\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n                <div className=\"lg:col-span-3\">\r\n                    <CalendarGrid>\r\n                        {calendarDays.map((day) => (\r\n                            <CalendarDay\r\n                                key={day.toString()}\r\n                                day={day}\r\n                                currentMonth={currentMonth}\r\n                                events={getEventsForDay(day)}\r\n                                onClick={() => {\r\n                                    const d = new Date(day);\r\n                                    d.setHours(12, 0, 0, 0);\r\n                                    setSelectedDate(d);\r\n                                }}\r\n                                onEventClick={(e, item, isProjected) => handleSubthemeClick(e, item, isProjected, day)}\r\n                            />\r\n                        ))}\r\n                    </CalendarGrid>\r\n                </div>\r\n\r\n                <UpcomingReviewsSidebar\r\n                    upcomingList={upcomingList}\r\n                    now={now}\r\n                    activeFocus={activeFocus}\r\n                    onStartFocus={handleStartFocus}\r\n                />\r\n            </div>\r\n\r\n            <Modal\r\n                isOpen={!!selectedDate}\r\n                onClose={() => setSelectedDate(null)}\r\n                title={selectedDate ? format(selectedDate, \"EEEE, d 'de' MMMM\", { locale: ptBR }) : ''}\r\n            >\r\n                {selectedDate && (\r\n                    <DayDetails\r\n                        key={selectedDate.toISOString()}\r\n                        date={selectedDate}\r\n                        events={getEventsForDay(selectedDate)}\r\n                        onCompleteReview={completeReview}\r\n                        onStartStudy={(id: string) => {\r\n                            const dayEvents = getEventsForDay(selectedDate);\r\n                            const review = dayEvents.reviews.find((r: any) => r.id === id);\r\n                            if (review) startStudySession(review.id);\r\n                        }}\r\n                        onToggleTask={toggleTask}\r\n                        onToggleGoal={toggleGoal}\r\n                        onToggleGoalItem={toggleGoalItem}\r\n                        onDeleteGoal={deleteGoal}\r\n                        onDeleteTask={deleteTask}\r\n                    />\r\n                )}\r\n            </Modal>\r\n\r\n            <Modal\r\n                isOpen={!!selectedSubthemeSchedule}\r\n                onClose={() => setSelectedSubthemeSchedule(null)}\r\n                title={selectedSubthemeSchedule?.subthemeTitle || 'Cronograma'}\r\n            >\r\n                {selectedSubthemeSchedule && (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"relative overflow-hidden rounded-2xl bg-slate-900 border border-slate-800 p-6\">\r\n                            <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2 pointer-events-none\" />\r\n\r\n                            <div className=\"flex items-center gap-3 mb-6 relative z-10\">\r\n                                <div className={cn(\r\n                                    \"px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider shadow-lg\",\r\n                                    selectedSubthemeSchedule.type.includes('projected')\r\n                                        ? \"bg-amber-500/10 text-amber-400 border border-amber-500/20\"\r\n                                        : \"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20\"\r\n                                )}>\r\n                                    {selectedSubthemeSchedule.type.includes('projected') ? 'Simulao' : 'Ativo'}\r\n                                </div>\r\n                                <span className=\"text-slate-400 text-sm font-medium\">{selectedSubthemeSchedule.themeTitle}</span>\r\n                            </div>\r\n\r\n                            <h3 className=\"text-sm font-bold text-white mb-4 flex items-center gap-2\">\r\n                                <PlayCircle className=\"w-4 h-4 text-blue-400\" />\r\n                                Prximas Revises (SRS)\r\n                            </h3>\r\n\r\n                            <div className=\"space-y-2 relative z-10\">\r\n                                {selectedSubthemeSchedule.schedule.map((rev: Review | { number: number; date: string; status: 'simulated' | 'pending' | 'completed' }, idx: number) => (\r\n                                    <div key={idx} className=\"group flex justify-between items-center p-3 bg-black/20 hover:bg-black/40 rounded-xl border border-white/5 hover:border-white/10 transition-all\">\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                            <div className=\"w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-xs font-bold text-slate-400 border border-white/5 group-hover:border-white/10 group-hover:text-white transition-colors\">\r\n                                                <span>#{rev.number}</span>\r\n                                            </div>\r\n                                            <div className=\"flex flex-col\">\r\n                                                <span className={cn(\r\n                                                    \"text-sm font-medium\",\r\n                                                    rev.status === 'completed' ? \"text-slate-500 line-through decoration-slate-700\" : \"text-slate-200\"\r\n                                                )}>\r\n                                                    {format(parseLocalDate(rev.date), \"d 'de' MMMM\", { locale: ptBR })}\r\n                                                </span>\r\n                                                {rev.status === 'pending' && !selectedSubthemeSchedule.type.includes('projected') && (() => {\r\n                                                    const today = new Date();\r\n                                                    today.setHours(0, 0, 0, 0);\r\n                                                    const revDate = parseLocalDate(rev.date);\r\n\r\n                                                    const isTodayDate = revDate.getTime() === today.getTime();\r\n                                                    const isOverdue = revDate < today;\r\n\r\n                                                    if (isTodayDate) {\r\n                                                        return (\r\n                                                            <span className=\"text-[10px] text-rose-400 flex items-center gap-1 animate-pulse\">\r\n                                                                <div className=\"w-1.5 h-1.5 rounded-full bg-rose-500\" />\r\n                                                                Em andamento\r\n                                                            </span>\r\n                                                        );\r\n                                                    }\r\n\r\n                                                    if (isOverdue) {\r\n                                                        return (\r\n                                                            <span className=\"text-[10px] text-red-500 flex items-center gap-1 font-bold\">\r\n                                                                <div className=\"w-1.5 h-1.5 rounded-full bg-red-500\" />\r\n                                                                Atrasado\r\n                                                            </span>\r\n                                                        );\r\n                                                    }\r\n\r\n                                                    return null;\r\n                                                })()}\r\n                                                {rev.status === 'completed' && (\r\n                                                    <span className=\"text-[10px] text-emerald-400 font-medium\">Concludo</span>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            {rev.status === 'pending' && !selectedSubthemeSchedule.type.includes('projected') && (\r\n                                                activeFocus?.id === selectedSubthemeSchedule.id && isToday(parseLocalDate(rev.date)) ? (\r\n                                                    <button\r\n                                                        onClick={() => {\r\n                                                            if (confirm('Cancelar o foco?')) {\r\n                                                                endFocus(false);\r\n                                                                resetTimer();\r\n                                                            }\r\n                                                        }}\r\n                                                        className=\"flex items-center gap-2 text-xs bg-rose-500/10 hover:bg-rose-500/20 text-rose-400 px-3 py-1.5 rounded-lg border border-rose-500/20 transition-all\"\r\n                                                    >\r\n                                                        <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                                                        <span className=\"font-bold\">Focando</span>\r\n                                                    </button>\r\n                                                ) : (\r\n                                                    isToday(parseLocalDate(rev.date)) ? (\r\n                                                        <button\r\n                                                            onClick={() => {\r\n                                                                if (activeFocus) return;\r\n                                                                startFocus(selectedSubthemeSchedule.id, 'subtheme', selectedSubthemeSchedule.subthemeTitle, 25);\r\n                                                                startFocusSession(selectedSubthemeSchedule.id, 25);\r\n                                                            }}\r\n                                                            disabled={!!activeFocus}\r\n                                                            className={cn(\r\n                                                                \"flex items-center gap-2 text-xs px-3 py-1.5 rounded-lg border transition-all shadow-lg active:scale-95\",\r\n                                                                activeFocus\r\n                                                                    ? \"opacity-50 cursor-not-allowed border-slate-700 text-slate-600 bg-transparent\"\r\n                                                                    : \"bg-blue-600 hover:bg-blue-500 text-white border-blue-500 hover:border-blue-400 shadow-blue-500/20\"\r\n                                                            )}\r\n                                                        >\r\n                                                            <PlayCircle className=\"w-3.5 h-3.5\" />\r\n                                                            <span className=\"font-bold\">Iniciar</span>\r\n                                                        </button>\r\n                                                    ) : (\r\n                                                        (() => {\r\n                                                            const today = new Date();\r\n                                                            today.setHours(0, 0, 0, 0);\r\n                                                            const revDate = parseLocalDate(rev.date);\r\n                                                            const isOverdue = rev.status === 'pending' && revDate < today;\r\n\r\n                                                            return (\r\n                                                                <span className={cn(\r\n                                                                    \"text-[10px] font-medium px-2 py-1 rounded border opacity-80\",\r\n                                                                    isOverdue\r\n                                                                        ? \"text-red-400 bg-red-500/10 border-red-500/20 animate-pulse\"\r\n                                                                        : \"text-slate-500 bg-slate-800/50 border-white/5\"\r\n                                                                )}>\r\n                                                                    {isOverdue ? 'Atrasado' : 'Agendado'}\r\n                                                                </span>\r\n                                                            );\r\n                                                        })()\r\n                                                    )\r\n                                                )\r\n                                            )}\r\n                                            <div className={cn(\r\n                                                \"w-2 h-2 rounded-full ml-2\",\r\n                                                rev.status === 'completed' ? \"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]\" : \"bg-slate-700\"\r\n                                            )} />\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {selectedSubthemeSchedule.type.includes('projected') && (\r\n                            <p className=\"text-xs text-slate-500 text-center bg-slate-900/50 py-2 rounded-lg border border-white/5\">\r\n                                <span className=\"text-amber-500/80 mr-1\">*</span>\r\n                                Datas simuladas com incio em <span className=\"text-slate-300 font-medium\">{selectedSubthemeSchedule.introDate}</span>\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\CalendarDay.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[233,236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[233,236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[257,260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[257,260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[284,287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[284,287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[307,310],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[307,310],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[330,333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[330,333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[418,421],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[418,421],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { format, isSameMonth, isToday } from 'date-fns';\r\nimport { cn } from '../../../lib/utils';\r\n\r\ninterface CalendarDayProps {\r\n    day: Date;\r\n    currentMonth: Date;\r\n    events: {\r\n        reviews: any[];\r\n        intros: any[];\r\n        projected: any[];\r\n        tasks: any[];\r\n        goals: any[];\r\n    };\r\n    onClick: () => void;\r\n    onEventClick: (e: React.MouseEvent, item: any, isProjected: boolean) => void;\r\n}\r\n\r\nexport const CalendarDay: React.FC<CalendarDayProps> = ({\r\n    day,\r\n    currentMonth,\r\n    events,\r\n    onClick,\r\n    onEventClick\r\n}) => {\r\n    const isOutside = !isSameMonth(day, currentMonth);\r\n    const isDayToday = isToday(day);\r\n    const { reviews, intros, projected, tasks, goals } = events;\r\n\r\n    const projectedIntros = projected.filter((p: { type: string }) => p.type === 'projected-intro');\r\n    const projectedReviews = projected.filter((p: { type: string }) => p.type === 'projected-review');\r\n\r\n    return (\r\n        <div\r\n            onClick={onClick}\r\n            className={cn(\r\n                \"min-h-[120px] p-2 transition-colors duration-300 relative group border-r border-b border-white/5 select-none overflow-hidden\",\r\n                isOutside ? \"bg-slate-950/40 opacity-40 grayscale\" : \"bg-transparent hover:bg-white/[0.02]\",\r\n                isDayToday && \"bg-blue-600/5 shadow-[inset_0_0_40px_rgba(37,99,235,0.1)]\"\r\n            )}\r\n        >\r\n            {isDayToday && (\r\n                <div className=\"absolute top-0 left-0 right-0 h-[2px] bg-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.8)]\" />\r\n            )}\r\n\r\n            <div className=\"flex justify-between items-start mb-1\">\r\n                <span className={cn(\r\n                    \"text-xs font-bold w-6 h-6 flex items-center justify-center rounded-lg transition-all\",\r\n                    isDayToday\r\n                        ? \"bg-blue-600 text-white shadow-lg shadow-blue-500/30 scale-110\"\r\n                        : \"text-slate-500 group-hover:text-slate-300 group-hover:bg-white/5\"\r\n                )}>\r\n                    {format(day, 'd')}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"space-y-1 relative z-10\">\r\n                {/* Intros */}\r\n                {intros.map((intro: { id: string; subthemeTitle: string; themeTitle?: string }, idx: number) => (\r\n                    <div\r\n                        key={`intro-${idx}`}\r\n                        onClick={(e) => onEventClick(e, intro, false)}\r\n                        className=\"group/tag relative overflow-hidden px-1.5 py-0.5 rounded bg-amber-500/10 border border-amber-500/20 hover:border-amber-500/40 hover:bg-amber-500/20 cursor-pointer transition-all\"\r\n                    >\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <div className=\"w-1 h-1 rounded-full bg-amber-400\" />\r\n                            <span className=\"text-[9px] font-medium text-amber-200 truncate\">{intro.subthemeTitle}</span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n\r\n                {/* Projected Intros */}\r\n                {projectedIntros.map((p: { subthemeTitle: string }, idx: number) => (\r\n                    <div\r\n                        key={`proj-intro-${idx}`}\r\n                        onClick={(e) => onEventClick(e, p, true)}\r\n                        className=\"px-1.5 py-0.5 rounded border border-dashed border-slate-700/50 hover:bg-slate-800/50 cursor-pointer transition-all opacity-60 hover:opacity-100\"\r\n                    >\r\n                        <span className=\"text-[9px] text-slate-400 truncate block\">{p.subthemeTitle}</span>\r\n                    </div>\r\n                ))}\r\n\r\n                {/* Reviews */}\r\n                {reviews.slice(0, 3).map((r: { status: string; subthemeTitle: string }, idx: number) => (\r\n                    <div\r\n                        key={`rev-${idx}`}\r\n                        onClick={(e) => onEventClick(e, r, false)}\r\n                        className={cn(\r\n                            \"relative px-1.5 py-0.5 rounded cursor-pointer transition-all border\",\r\n                            r.status === 'pending'\r\n                                ? \"bg-blue-600/10 border-blue-500/20 hover:border-blue-400/50 hover:bg-blue-600/20\"\r\n                                : \"bg-emerald-500/5 border-emerald-500/10 hover:bg-emerald-500/10 opacity-60\"\r\n                        )}\r\n                    >\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <div className={cn(\r\n                                \"w-1 h-1 rounded-full shadow-[0_0_5px_currentColor]\",\r\n                                r.status === 'pending' ? \"bg-blue-400 text-blue-400\" : \"bg-emerald-400 text-emerald-400\"\r\n                            )} />\r\n                            <span className={cn(\r\n                                \"text-[9px] font-medium truncate\",\r\n                                r.status === 'pending' ? \"text-blue-200\" : \"text-emerald-300 line-through decoration-emerald-500/50\"\r\n                            )}>\r\n                                {r.subthemeTitle}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n\r\n                {reviews.length > 3 && (\r\n                    <div className=\"text-[9px] text-slate-500 font-medium px-1 flex items-center justify-between\">\r\n                        <span>+{reviews.length - 3}</span>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Projected Reviews */}\r\n                {projectedReviews.slice(0, 2).map((p: { subthemeTitle: string }, idx: number) => (\r\n                    <div\r\n                        key={`proj-rev-${idx}`}\r\n                        onClick={(e) => onEventClick(e, p, true)}\r\n                        className=\"px-1.5 py-0.5 rounded border border-dashed border-slate-800 hover:border-slate-600 cursor-pointer transition-all opacity-40 hover:opacity-100\"\r\n                    >\r\n                        <span className=\"text-[9px] text-slate-500 truncate block\">{p.subthemeTitle}</span>\r\n                    </div>\r\n                ))}\r\n\r\n                {/* Tasks/Goals */}\r\n                {(tasks.length > 0 || goals.length > 0) && (\r\n                    <div className=\"space-y-0.5 mt-0.5 pt-0.5 border-t border-white/5 opacity-80\">\r\n                        {tasks.slice(0, 2).map((t: { id: string; title: string }) => <div key={t.id} className=\"w-1.5 h-1.5 rounded-full bg-amber-500 inline-block mr-1\" title={t.title} />)}\r\n                        {goals.slice(0, 2).map((g: { id: string; title: string }) => <div key={g.id} className=\"w-1.5 h-1.5 rounded-sm bg-emerald-500 inline-block mr-1\" title={g.title} />)}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\CalendarEventItem.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Flag' is defined but never used.","line":2,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'id' is defined but never used.","line":27,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'type' is defined but never used.","line":30,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":9}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { CheckSquare, Flag, PlayCircle, Loader2, Trash2, Clock } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Priority } from '../../../types';\r\n\r\ninterface CalendarEventItemProps {\r\n    id: string;\r\n    title: string;\r\n    subtitle?: string;\r\n    type: 'task' | 'goal' | 'subtheme';\r\n    isDone: boolean;\r\n    isFuture: boolean;\r\n    priority?: Priority;\r\n    durationMinutes?: number;\r\n    completionTime?: string | null;\r\n    onFocus: () => void;\r\n    onDelete?: () => void;\r\n    onOpenDetails?: () => void;\r\n    isActive?: boolean;\r\n    isSomeoneElseFocused?: boolean;\r\n    lockReason?: string;\r\n    children?: React.ReactNode; // For extra content like progress bars\r\n    colorTheme?: 'indigo' | 'blue' | 'purple' | 'pink';\r\n}\r\n\r\nexport const CalendarEventItem: React.FC<CalendarEventItemProps> = ({\r\n    id,\r\n    title,\r\n    subtitle,\r\n    type,\r\n    isDone,\r\n    isFuture,\r\n    priority,\r\n    durationMinutes,\r\n    completionTime,\r\n    onFocus,\r\n    onDelete,\r\n    onOpenDetails,\r\n    isActive = false,\r\n    isSomeoneElseFocused = false,\r\n    lockReason,\r\n    children,\r\n    colorTheme = 'blue'\r\n}) => {\r\n\r\n    const themeStyles = {\r\n        indigo: \"hover:border-indigo-500/30 bg-indigo-950/20\",\r\n        blue: \"hover:border-blue-500/30 bg-blue-950/20\",\r\n        purple: \"hover:border-purple-500/30 bg-purple-950/20\",\r\n        pink: \"hover:border-pink-500/30 bg-pink-950/20\"\r\n    };\r\n\r\n    const getPriorityBorderColor = (p?: string) => {\r\n        switch (p) {\r\n            case 'high': return 'border-l-red-500';\r\n            case 'medium': return 'border-l-amber-500';\r\n            case 'low': return 'border-l-emerald-500';\r\n            default: return 'border-l-slate-700';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"group relative p-4 rounded-xl border transition-all duration-300 border-l-4\",\r\n                getPriorityBorderColor(priority),\r\n                isDone\r\n                    ? \"bg-slate-900/30 border-slate-800 opacity-50 grayscale-[0.5] border-l-slate-800\"\r\n                    : cn(\r\n                        \"bg-slate-900/60 backdrop-blur-md border-white/5 shadow-lg\",\r\n                        themeStyles[colorTheme]\r\n                    )\r\n            )}\r\n        >\r\n            <div className=\"flex items-start gap-4\">\r\n                {/* Visual Checkbox Indicator (Manual Blocked) */}\r\n                <div\r\n                    className={cn(\r\n                        \"w-6 h-6 rounded-lg border-2 flex items-center justify-center shrink-0 transition-all mt-1\",\r\n                        isDone\r\n                            ? \"bg-emerald-500 border-emerald-400 shadow-[0_0_12px_rgba(16,185,129,0.5)]\"\r\n                            : \"border-slate-600 bg-slate-950/50 opacity-40 cursor-not-allowed\"\r\n                    )}\r\n                    title={isDone ? \"Concludo\" : \"Utilize o Pomodoro para concluir\"}\r\n                >\r\n                    <CheckSquare className={cn(\"w-3.5 h-3.5 text-white transition-all\", isDone ? \"scale-100\" : \"scale-0\")} />\r\n                </div>\r\n\r\n                <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                        <div className=\"space-y-1\">\r\n                            <div className=\"flex items-center gap-2 flex-wrap\">\r\n                                <span\r\n                                    onClick={onOpenDetails}\r\n                                    className={cn(\r\n                                        \"font-bold text-sm transition-colors\",\r\n                                        isDone ? \"text-slate-500 line-through decoration-slate-700\" : \"text-white cursor-pointer hover:underline\"\r\n                                    )}\r\n                                >\r\n                                    {title}\r\n                                </span>\r\n                                {isDone && (\r\n                                    <span className=\"text-[9px] px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-300 border border-emerald-500/30 font-bold uppercase tracking-wider\">\r\n                                         Feito\r\n                                    </span>\r\n                                )}\r\n                            </div>\r\n                            {subtitle && (\r\n                                <p className=\"text-[10px] text-slate-500 flex items-center gap-2\">\r\n                                    {subtitle}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-2 shrink-0 ml-2\">\r\n                            {/* Actions Column */}\r\n                            <div className=\"flex flex-col items-end gap-2\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    {durationMinutes !== undefined && (\r\n                                        <span className=\"flex items-center gap-1 text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded border border-slate-700\" title=\"Tempo Estimado\">\r\n                                            <Clock className=\"w-2.5 h-2.5\" />\r\n                                            {durationMinutes} min\r\n                                        </span>\r\n                                    )}\r\n                                    {isDone && completionTime && (\r\n                                        <span className=\"text-[10px] font-mono text-emerald-500/80 bg-emerald-500/10 px-1.5 py-0.5 rounded border border-emerald-500/20\">\r\n                                            {completionTime}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    {!isDone && (\r\n                                        <>\r\n                                            {isSomeoneElseFocused ? null : (\r\n                                                lockReason ? (\r\n                                                    <span className=\"text-[10px] text-slate-500 italic px-2 flex items-center gap-1\">\r\n                                                        <span className=\"w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse\" />\r\n                                                        {lockReason}\r\n                                                    </span>\r\n                                                ) : isActive ? (\r\n                                                    <button\r\n                                                        className=\"flex items-center gap-1 text-[10px] bg-rose-500/20 text-rose-400 px-1.5 py-0.5 rounded border border-rose-500/50 animate-pulse cursor-default\"\r\n                                                        title=\"Foco Ativo\"\r\n                                                    >\r\n                                                        <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                                                        <span>Focando...</span>\r\n                                                    </button>\r\n                                                ) : (\r\n                                                    <button\r\n                                                        onClick={(e) => { e.stopPropagation(); onFocus(); }}\r\n                                                        disabled={isFuture}\r\n                                                        className={cn(\r\n                                                            \"flex items-center gap-1 text-[10px] px-2 py-0.5 rounded border transition-all\",\r\n                                                            isFuture\r\n                                                                ? \"bg-slate-800 text-slate-600 border-slate-700 cursor-not-allowed\"\r\n                                                                : \"bg-rose-500/10 hover:bg-rose-500/20 text-rose-400 border-rose-500/20 group hover:border-rose-500/40\"\r\n                                                        )}\r\n                                                        title={isFuture ? \"Agendado para o futuro\" : \"Iniciar Pomodoro\"}\r\n                                                    >\r\n                                                        <PlayCircle className=\"w-3 h-3\" />\r\n                                                        <span>Focar</span>\r\n                                                    </button>\r\n                                                )\r\n                                            )}\r\n\r\n                                            {onDelete && (\r\n                                                <button\r\n                                                    type=\"button\"\r\n                                                    onClick={(e) => { e.stopPropagation(); onDelete(); }}\r\n                                                    className=\"p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-500/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100 duration-300\"\r\n                                                    title=\"Excluir\"\r\n                                                >\r\n                                                    <Trash2 className=\"w-3.5 h-3.5\" />\r\n                                                </button>\r\n                                            )}\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {children}\r\n                </div>\r\n            </div>\r\n            {/* Active Highlight Line */}\r\n            {!isDone && <div className={cn(\r\n                \"absolute left-0 top-3 bottom-3 w-0.5 rounded-r-full opacity-0 group-hover:opacity-100 transition-opacity\",\r\n                colorTheme === 'indigo' ? \"bg-indigo-500\" : colorTheme === 'purple' ? \"bg-purple-500\" : colorTheme === 'pink' ? \"bg-pink-500\" : \"bg-blue-500\"\r\n            )} />}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\CalendarGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\CalendarHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\DayDetails.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PlayCircle' is defined but never used.","line":2,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Loader2' is defined but never used.","line":2,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":62},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Trash2' is defined but never used.","line":2,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Review' is defined but never used.","line":10,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleStopFocus' is assigned a value but never used.","line":77,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":26}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { BrainCircuit, CheckSquare, Flag, PlayCircle, Loader2, Trash2 } from 'lucide-react';\r\nimport { format, isToday, differenceInCalendarDays } from 'date-fns';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { usePomodoroContext } from '../../../context/PomodoroContext';\r\nimport { useAudio } from '../../../context/AudioContext';\r\nimport { useConfirm } from '../../../context/ConfirmContext';\r\nimport { cn } from '../../../lib/utils';\r\nimport { parseLocalDate } from '../../../utils/dateHelpers';\r\nimport type { Review, Task, Goal, Priority, CalendarIntroItem, CalendarReviewItem, CalendarGoalItem, CalendarTaskItem, Subtheme } from '../../../types';\r\nimport { CalendarEventItem } from './CalendarEventItem';\r\nimport { TaskDetailsModal } from '../../tasks/components/TaskDetailsModal';\r\nimport { GoalDetailsModal } from '../../goals/components/GoalDetailsModal';\r\nimport { StudyContentModal } from '../../themes/components/StudyContentModal';\r\n\r\ninterface DayDetailsProps {\r\n    date: Date | null;\r\n    events: {\r\n        reviews: CalendarReviewItem[];\r\n        tasks: CalendarTaskItem[];\r\n        goals: CalendarGoalItem[];\r\n        intros?: CalendarIntroItem[];\r\n        projected?: { subthemeTitle: string; themeTitle: string; priority: Priority; description: string }[];\r\n    };\r\n    onStartStudy?: (id: string) => void;\r\n    onDeleteGoal: (id: string) => void;\r\n    onDeleteTask?: (id: string) => void;\r\n}\r\n\r\nexport const DayDetails = ({ events, onStartStudy, onDeleteGoal, onDeleteTask, date }: DayDetailsProps) => {\r\n    const { reviews, tasks, goals } = events;\r\n    const { activeFocus, startFocus, endFocus, themes, goals: allGoals, tasks: allTasks, updateSubthemeContent } = useStudy();\r\n    const { startFocusSession, resetTimer } = usePomodoroContext();\r\n    const { stopAudio } = useAudio();\r\n    const { confirm: confirmAction } = useConfirm();\r\n\r\n    // --- DETAIL MODALS STATE ---\r\n    const [selectedTask, setSelectedTask] = useState<Task | null>(null);\r\n    const [selectedGoal, setSelectedGoal] = useState<Goal | null>(null);\r\n    const [selectedSubtheme, setSelectedSubtheme] = useState<Subtheme | null>(null);\r\n\r\n    const handleOpenDetails = (id: string, type: 'task' | 'goal' | 'subtheme') => {\r\n        if (type === 'task') {\r\n            const task = allTasks.find(t => t.id === id);\r\n            if (task) setSelectedTask(task);\r\n        } else if (type === 'goal') {\r\n            const goal = allGoals.find(g => g.id === id);\r\n            if (goal) setSelectedGoal(goal);\r\n        } else if (type === 'subtheme') {\r\n            const subtheme = themes.flatMap(t => t.subthemes).find(st => st.id === id);\r\n            if (subtheme) setSelectedSubtheme(subtheme);\r\n        }\r\n    };\r\n\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    const targetDate = date ? new Date(date) : today;\r\n    const isFuture = targetDate > today;\r\n    const isPast = targetDate < today;\r\n    const isDateToday = isToday(targetDate);\r\n    const todayStr = format(today, 'yyyy-MM-dd');\r\n    const dateStr = date ? format(targetDate, 'yyyy-MM-dd') : todayStr;\r\n\r\n    const handleStartFocus = (id: string, type: 'task' | 'goal' | 'subtheme', title: string, duration?: number, parentId?: string) => {\r\n        if (activeFocus) return; // Already focusing\r\n\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        const now = new Date();\r\n        now.setHours(0, 0, 0, 0);\r\n        if (targetDate > now) return;\r\n\r\n        startFocus(id, type, title, duration || 25, undefined, undefined, parentId);\r\n        startFocusSession(id, duration || 25); // Start Timer\r\n    };\r\n\r\n    const handleStopFocus = async () => {\r\n        const confirmed = await confirmAction({ message: 'Deseja cancelar o foco atual?', isDangerous: true });\r\n        if (confirmed) {\r\n            endFocus(false); // End without completing\r\n            resetTimer();\r\n            stopAudio(); // Stop background audio\r\n        }\r\n    };\r\n\r\n    if ((!reviews || reviews.length === 0) && (!tasks || tasks.length === 0) && (!goals || goals.length === 0)) {\r\n        return (\r\n            <div className=\"text-center py-8 text-slate-500\">\r\n                <p>Nada agendado para este dia.</p>\r\n                <p className=\"text-sm\">Aproveite para descansar ou adiantar estudos!</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const isSomethingFocused = !!activeFocus;\r\n\r\n    // Sorting Logic\r\n    const getPriorityScore = (p?: string) => {\r\n        switch (p) {\r\n            case 'high': return 3;\r\n            case 'medium': return 2;\r\n            case 'low': return 1;\r\n            default: return 0;\r\n        }\r\n    };\r\n\r\n    interface SortableItem {\r\n        status?: string;\r\n        isCompletedToday?: boolean;\r\n        time?: string;\r\n        scheduledTime?: string;\r\n        priority?: Priority;\r\n        durationMinutes?: number;\r\n    }\r\n\r\n    const sortItems = <T extends SortableItem>(items: T[]) => {\r\n        if (!items) return [];\r\n        return [...items].sort((a, b) => {\r\n            // 1. Status: Pending first (Active > Done)\r\n            const aDone = a.status === 'completed' || a.isCompletedToday;\r\n            const bDone = b.status === 'completed' || b.isCompletedToday;\r\n            if (aDone !== bDone) return aDone ? 1 : -1;\r\n\r\n            // 2. Check if items have scheduled time\r\n            const timeA = a.time || a.scheduledTime || '';\r\n            const timeB = b.time || b.scheduledTime || '';\r\n            const hasTimeA = !!timeA;\r\n            const hasTimeB = !!timeB;\r\n\r\n            // If BOTH have time defined: order by time\r\n            if (hasTimeA && hasTimeB) {\r\n                return timeA.localeCompare(timeB);\r\n            }\r\n\r\n            // If ONLY ONE has time: the one with time comes first\r\n            if (hasTimeA && !hasTimeB) return -1;\r\n            if (!hasTimeA && hasTimeB) return 1;\r\n\r\n            // If NEITHER has time: order by priority (importance)\r\n            const pA = getPriorityScore(a.priority);\r\n            const pB = getPriorityScore(b.priority);\r\n            if (pA !== pB) return pB - pA; // Higher priority first\r\n\r\n            // Fallback: Duration (shorter first for \"quick wins\")\r\n            const durA = a.durationMinutes || 0;\r\n            const durB = b.durationMinutes || 0;\r\n            return durA - durB;\r\n        });\r\n    };\r\n\r\n    const sortedReviews = sortItems(reviews);\r\n    const sortedTasks = sortItems(tasks);\r\n    const sortedGoals = sortItems(goals);\r\n\r\n    // Helper to get completion time\r\n    const getCompletionTime = (item: { completionHistory?: string[] }) => {\r\n        if (!item.completionHistory) return null;\r\n        const entry = item.completionHistory.find((h: string) => h.startsWith(dateStr));\r\n        if (!entry) return null;\r\n        try {\r\n            return format(new Date(entry), 'HH:mm');\r\n        } catch {\r\n            return null;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={cn(\"space-y-8 w-full overflow-x-hidden relative p-1\", isSomethingFocused && \"opacity-90\")}>\r\n\r\n            {/* SEO 1: INTRODUES (NOVOS TPICOS) - INDIGO */}\r\n            {events.intros && events.intros.length > 0 && (\r\n                <div className=\"space-y-3 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                    <h3 className=\"text-[10px] font-bold text-indigo-400 uppercase tracking-widest pl-1 flex items-center gap-2\">\r\n                        <BrainCircuit className=\"w-3 h-3\" />\r\n                        Novos Tpicos ({events.intros.length})\r\n                    </h3>\r\n                    <div className=\"bg-slate-950/40 border border-white/5 rounded-2xl p-2 space-y-2 relative overflow-hidden group/section\">\r\n                        {events.intros.map((intro: CalendarIntroItem) => (\r\n                            <CalendarEventItem\r\n                                key={intro.id}\r\n                                id={intro.id}\r\n                                title={intro.subthemeTitle}\r\n                                subtitle={intro.themeTitle}\r\n                                type=\"subtheme\"\r\n                                isDone={false}\r\n                                isFuture={isFuture}\r\n                                priority={intro.priority}\r\n                                durationMinutes={intro.durationMinutes}\r\n                                colorTheme=\"indigo\"\r\n                                onFocus={() => handleStartFocus(intro.id, 'subtheme', intro.subthemeTitle, intro.durationMinutes)}\r\n                                onOpenDetails={() => handleOpenDetails(intro.id, 'subtheme')}\r\n                                isActive={activeFocus?.id === intro.id}\r\n                                isSomeoneElseFocused={isSomethingFocused && activeFocus?.id !== intro.id}\r\n                                lockReason={(!isDateToday && !isPast) ? (isFuture ? `Faltam ${differenceInCalendarDays(targetDate, today)} dias` : 'Passado') : undefined}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* SEO 2: REVISES SRS - BLUE */}\r\n            {sortedReviews && sortedReviews.length > 0 && (\r\n                <div className=\"space-y-3 animate-in fade-in slide-in-from-bottom-5 duration-500\">\r\n                    <h3 className=\"text-[10px] font-bold text-blue-500 uppercase tracking-widest pl-1 flex items-center gap-2\">\r\n                        <BrainCircuit className=\"w-3 h-3\" />\r\n                        Revises SRS ({sortedReviews.length})\r\n                    </h3>\r\n                    <div className=\"bg-slate-950/40 border border-white/5 rounded-2xl p-2 space-y-2\">\r\n                        {sortedReviews.map((r: CalendarReviewItem) => (\r\n                            <CalendarEventItem\r\n                                key={r.id}\r\n                                id={r.id}\r\n                                title={r.subthemeTitle}\r\n                                subtitle={`Reviso #${r.number}  ${r.themeTitle}`}\r\n                                type=\"subtheme\"\r\n                                isDone={r.status === 'completed'}\r\n                                isFuture={isFuture}\r\n                                priority={r.priority}\r\n                                durationMinutes={r.durationMinutes}\r\n                                completionTime={getCompletionTime(r)}\r\n                                colorTheme=\"blue\"\r\n                                onFocus={() => onStartStudy?.(r.id)}\r\n                                onOpenDetails={() => handleOpenDetails(r.id, 'subtheme')}\r\n                                isActive={activeFocus?.id === r.id}\r\n                                isSomeoneElseFocused={isSomethingFocused && activeFocus?.id !== r.id}\r\n                                lockReason={(!isDateToday && !isPast) ? (isFuture ? `Faltam ${differenceInCalendarDays(targetDate, today)} dias` : 'Passado') : undefined}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* SEO 3: TAREFAS - ROXO */}\r\n            {sortedTasks && sortedTasks.length > 0 && (\r\n                <div className=\"space-y-3 animate-in fade-in slide-in-from-bottom-6 duration-500\">\r\n                    <h3 className=\"text-[10px] font-bold text-purple-400 uppercase tracking-widest pl-1 flex items-center gap-2\">\r\n                        <CheckSquare className=\"w-3 h-3\" />\r\n                        Tarefas ({sortedTasks.length})\r\n                    </h3>\r\n                    <div className=\"bg-slate-950/40 border border-white/5 rounded-2xl p-2 space-y-2\">\r\n                        {sortedTasks.map((t: CalendarTaskItem) => (\r\n                            <CalendarEventItem\r\n                                key={t.id}\r\n                                id={t.id}\r\n                                title={t.title}\r\n                                subtitle={(t.endDate || t.date) ? `Prazo: ${format(parseLocalDate(t.endDate || t.date || todayStr), 'dd/MM/yyyy')}` : undefined}\r\n                                type=\"task\"\r\n                                isDone={t.status === 'completed'}\r\n                                isFuture={isFuture}\r\n                                priority={t.priority}\r\n                                durationMinutes={t.durationMinutes}\r\n                                completionTime={getCompletionTime(t)}\r\n                                colorTheme=\"purple\"\r\n                                onFocus={() => handleStartFocus(t.id, 'task', t.title, t.durationMinutes)}\r\n                                onOpenDetails={() => handleOpenDetails(t.id, 'task')}\r\n                                onDelete={async () => {\r\n                                    const confirmed = await confirmAction({\r\n                                        message: `Excluir a tarefa \"${t.title}\"?`,\r\n                                        isDangerous: true,\r\n                                        confirmText: \"Excluir\",\r\n                                        cancelText: \"Cancelar\"\r\n                                    });\r\n                                    if (confirmed && onDeleteTask) onDeleteTask(t.id);\r\n                                }}\r\n                                isActive={activeFocus?.id === t.id}\r\n                                isSomeoneElseFocused={isSomethingFocused && activeFocus?.id !== t.id}\r\n                                lockReason={(!isDateToday && !isPast) ? (isFuture ? `Faltam ${differenceInCalendarDays(targetDate, today)} dias` : 'Passado') : undefined}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* SEO 4: METAS - ROSA */}\r\n            {sortedGoals && sortedGoals.length > 0 && (\r\n                <div className=\"space-y-3 animate-in fade-in slide-in-from-bottom-7 duration-500\">\r\n                    <h3 className=\"text-[10px] font-bold text-pink-400 uppercase tracking-widest pl-1 flex items-center gap-2\">\r\n                        <Flag className=\"w-3 h-3\" />\r\n                        Metas ({sortedGoals.length})\r\n                    </h3>\r\n                    <div className=\"bg-slate-950/40 border border-white/5 rounded-2xl p-2 space-y-2\">\r\n                        {sortedGoals.map((g: CalendarGoalItem) => {\r\n                            const isStep = g.type === 'goal-step' || g.type === 'goal-phase';\r\n                            const eventId = (g.checklist_item_id || g.id) as string;\r\n\r\n                            return (\r\n                                <CalendarEventItem\r\n                                    key={`${g.id}-${g.checklist_item_id || 'main'}`}\r\n                                    id={eventId}\r\n                                    title={g.title}\r\n                                    subtitle={isStep ? `${g.parentGoalTitle}  Etapa` : (g.deadline ? `Prazo: ${format(parseLocalDate(g.deadline), 'dd/MM/yyyy')}` : g.label || g.type)}\r\n                                    type=\"goal\"\r\n                                    isDone={g.isCompletedToday || false}\r\n                                    isFuture={isFuture}\r\n                                    priority={g.priority}\r\n                                    durationMinutes={g.durationMinutes}\r\n                                    completionTime={getCompletionTime(g)}\r\n                                    colorTheme=\"pink\"\r\n                                    onFocus={() => handleStartFocus(eventId, 'goal', g.title, g.durationMinutes, g.parentGoalId)}\r\n                                    onOpenDetails={() => handleOpenDetails(g.id, 'goal')}\r\n                                    onDelete={async () => {\r\n                                        const idToDelete = (g.parentGoalId || g.id) as string;\r\n                                        const confirmed = await confirmAction({\r\n                                            message: isStep ? 'Excluir este projeto COMPLETO (todas as etapas)?' : 'Excluir este projeto/meta completamente?',\r\n                                            isDangerous: true,\r\n                                            confirmText: \"Excluir\",\r\n                                            cancelText: \"Cancelar\"\r\n                                        });\r\n                                        if (confirmed && onDeleteGoal) onDeleteGoal(idToDelete);\r\n                                    }}\r\n                                    isActive={activeFocus?.id === eventId}\r\n                                    isSomeoneElseFocused={isSomethingFocused && activeFocus?.id !== eventId}\r\n                                    lockReason={(!isDateToday && !isPast) ? (isFuture ? `Faltam ${differenceInCalendarDays(targetDate, today)} dias` : 'Passado') : undefined}\r\n                                >\r\n                                    {g.phaseProgress !== undefined && !g.isCompletedToday && (\r\n                                        <div className=\"mt-2 space-y-1\">\r\n                                            <div className=\"flex justify-between text-[10px] text-slate-400 uppercase font-bold tracking-wider\">\r\n                                                <span>Dia {g.currentDay} de {g.totalDays}</span>\r\n                                                <span>{g.phaseProgress}%</span>\r\n                                            </div>\r\n                                            <div className=\"h-1 bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                                                <div\r\n                                                    className=\"h-full bg-pink-500 transition-all duration-500\"\r\n                                                    style={{ width: `${g.phaseProgress}%` }}\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </CalendarEventItem>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* SEO 5: PREVISTOS/SIMULAO */}\r\n            {events.projected && events.projected.length > 0 && (\r\n                <div className=\"pt-6 border-t border-white/5 mt-4 opacity-50\">\r\n                    <h3 className=\"text-[10px] font-bold text-slate-500 uppercase tracking-widest pl-1 mb-3\">\r\n                        Simulao Futura\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-1 gap-2\">\r\n                        {events.projected.map((p, idx) => (\r\n                            <div key={idx} className=\"p-3 border border-dashed border-slate-700/50 rounded-xl bg-slate-900/30 flex justify-between items-center\">\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <p className=\"font-medium text-slate-400 text-sm\">{p.subthemeTitle}</p>\r\n                                        <Flag className={cn(\"w-3 h-3 fill-current\", p.priority === 'high' ? 'text-red-500' : p.priority === 'medium' ? 'text-amber-500' : 'text-emerald-500')} />\r\n                                    </div>\r\n                                    <p className=\"text-[10px] text-slate-600\">{p.themeTitle}  {p.description}</p>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Modals for Details */}\r\n            <TaskDetailsModal\r\n                isOpen={!!selectedTask}\r\n                onClose={() => setSelectedTask(null)}\r\n                task={selectedTask}\r\n            />\r\n\r\n            <GoalDetailsModal\r\n                isOpen={!!selectedGoal}\r\n                onClose={() => setSelectedGoal(null)}\r\n                goal={selectedGoal}\r\n            />\r\n\r\n            <StudyContentModal\r\n                isOpen={!!selectedSubtheme}\r\n                onClose={() => setSelectedSubtheme(null)}\r\n                subtheme={selectedSubtheme}\r\n                onSave={(content) => {\r\n                    if (selectedSubtheme) {\r\n                        updateSubthemeContent(selectedSubtheme.id, content);\r\n                    }\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\UpcomingReviewsSidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[669,672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[669,672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1574,1577],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1574,1577],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isBlueDefault' is assigned a value but never used.","line":53,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":48}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { PlayCircle } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport { Button } from '../../../components/ui/Button';\r\n\r\ninterface UpcomingReviewsSidebarProps {\r\n    upcomingList: {\r\n        id: string;\r\n        number: number;\r\n        date: string;\r\n        themeTitle: string;\r\n        subthemeTitle: string;\r\n        type: 'active' | 'projected';\r\n        status: 'pending' | 'completed';\r\n        originalDate: Date;\r\n        color?: string;\r\n    }[];\r\n    now: Date;\r\n    activeFocus: { id: string } | null;\r\n    onStartFocus: (item: any) => void;\r\n}\r\n\r\nexport const UpcomingReviewsSidebar: React.FC<UpcomingReviewsSidebarProps> = ({\r\n    upcomingList,\r\n    now,\r\n    activeFocus,\r\n    onStartFocus\r\n}) => {\r\n    return (\r\n        <div className=\"lg:col-span-1 space-y-6\">\r\n            <div className=\"bg-slate-900/50 border border-white/5 rounded-2xl p-6 backdrop-blur-xl\">\r\n                <h3 className=\"text-lg font-bold text-white mb-4 flex items-center gap-2\">\r\n                    <PlayCircle className=\"w-5 h-5 text-blue-400\" />\r\n                    Cronograma\r\n                </h3>\r\n\r\n                <div className=\"space-y-3 max-h-[600px] overflow-y-auto custom-scrollbar pr-2\">\r\n                    {upcomingList.length === 0 ? (\r\n                        <p className=\"text-slate-500 text-sm text-center py-4\">Nenhuma reviso prxima encontrada.</p>\r\n                    ) : (\r\n                        upcomingList.map((item: any, idx: number) => {\r\n                            const isProjected = item.type === 'projected';\r\n                            const todayTime = new Date(now);\r\n                            todayTime.setHours(0, 0, 0, 0);\r\n\r\n                            const isTodayItem = item.originalDate.getTime() === todayTime.getTime();\r\n                            const isOverdue = !isProjected && item.originalDate < todayTime;\r\n\r\n                            // Dynamic styling based on item color\r\n                            const themeColor = item.color || '#3b82f6';\r\n                            const isBlueDefault = themeColor === '#3b82f6'; // Check if default to avoid overpowering blue if random wasn't used?\r\n\r\n                            return (\r\n                                <div\r\n                                    key={`${item.id}-${item.number}-${idx}`}\r\n                                    style={{\r\n                                        borderColor: isProjected ? undefined : `${themeColor}40`, // 25% opacity\r\n                                        background: isProjected\r\n                                            ? undefined\r\n                                            : `linear-gradient(to right, ${themeColor}08, transparent)` // 5% opacity from left\r\n                                    }}\r\n                                    className={cn(\r\n                                        \"relative p-3 rounded-xl border transition-all group hover:scale-[1.02] overflow-hidden\",\r\n                                        isProjected\r\n                                            ? \"bg-slate-800/30 border-dashed border-slate-700/50 opacity-70 hover:opacity-100\"\r\n                                            : \"bg-slate-900/40 hover:bg-slate-900/60 shadow-lg\",\r\n                                        // Overrides for Overdue/Today\r\n                                        isOverdue && !isProjected && \"ring-1 ring-red-500/50 border-red-500/50 bg-red-950/20\",\r\n                                        isTodayItem && !isOverdue && !isProjected && \"ring-1 ring-blue-500/50 border-blue-500/50 bg-blue-950/20\"\r\n                                    )}\r\n                                >\r\n                                    {/* Accent Bar on Left */}\r\n                                    {!isProjected && (\r\n                                        <div\r\n                                            className=\"absolute left-0 top-0 bottom-0 w-1\"\r\n                                            style={{ backgroundColor: themeColor }}\r\n                                        />\r\n                                    )}\r\n\r\n                                    <div className=\"flex justify-between items-start mb-1 pl-2\">\r\n                                        <span className={cn(\r\n                                            \"text-[10px] font-bold uppercase tracking-wider\",\r\n                                            isProjected ? \"text-slate-500\" : \"text-slate-300\",\r\n                                            isOverdue && \"text-red-400 animate-pulse\",\r\n                                            isTodayItem && !isOverdue && \"text-blue-400\"\r\n                                        )}>\r\n                                            {isOverdue ? 'Atrasado' : (isTodayItem ? 'Hoje' : format(item.originalDate, \"d 'de' MMM\", { locale: ptBR }))}\r\n                                        </span>\r\n                                        <div\r\n                                            className=\"px-1.5 py-0.5 rounded text-[10px] bg-slate-950 border border-white/5\"\r\n                                            style={{ color: isProjected ? undefined : themeColor }}\r\n                                        >\r\n                                            #{item.number}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <h4 className={cn(\r\n                                        \"font-bold text-sm truncate mb-1 pl-2\",\r\n                                        isProjected ? \"text-slate-400\" : \"text-white\"\r\n                                    )}>\r\n                                        {item.subthemeTitle}\r\n                                    </h4>\r\n\r\n                                    <div className=\"flex items-center gap-2 text-[10px] text-slate-500 pl-2\">\r\n                                        <div\r\n                                            className=\"w-1.5 h-1.5 rounded-full\"\r\n                                            style={{ backgroundColor: themeColor }}\r\n                                        />\r\n                                        <span className=\"truncate\">{item.themeTitle}</span>\r\n                                    </div>\r\n\r\n                                    {(isTodayItem || isOverdue) && !isProjected && !activeFocus && (\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            style={{\r\n                                                backgroundColor: isOverdue ? undefined : themeColor,\r\n                                                borderColor: isOverdue ? undefined : themeColor\r\n                                            }}\r\n                                            className={cn(\r\n                                                \"w-full mt-3 h-7 text-xs border-0 text-white shadow-lg\",\r\n                                                isOverdue ? \"bg-red-600 hover:bg-red-500\" : \"hover:brightness-110\"\r\n                                            )}\r\n                                            onClick={() => onStartFocus(item)}\r\n                                        >\r\n                                            {isOverdue ? 'Revisar Agora' : 'Iniciar'}\r\n                                        </Button>\r\n                                    )}\r\n                                </div>\r\n                            );\r\n                        })\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\components\\__tests__\\DayDetails.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2390,2393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2390,2393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3181,3184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3181,3184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, fireEvent } from '@testing-library/react';\r\nimport { describe, it, expect, vi, beforeEach } from 'vitest';\r\nimport { DayDetails } from '../DayDetails';\r\n\r\n// Mock contexts\r\nconst mockUseStudy = vi.fn();\r\nconst mockUsePomodoroContext = vi.fn();\r\nconst mockUseAudio = vi.fn();\r\nconst mockUseConfirm = vi.fn();\r\n\r\nvi.mock('../../../../context/StudyContext', () => ({\r\n    useStudy: () => mockUseStudy()\r\n}));\r\n\r\nvi.mock('../../../../context/PomodoroContext', () => ({\r\n    usePomodoroContext: () => mockUsePomodoroContext()\r\n}));\r\n\r\nvi.mock('../../../../context/AudioContext', () => ({\r\n    useAudio: () => mockUseAudio()\r\n}));\r\n\r\nvi.mock('../../../../context/ConfirmContext', () => ({\r\n    useConfirm: () => mockUseConfirm()\r\n}));\r\n\r\ndescribe('DayDetails', () => {\r\n    beforeEach(() => {\r\n        mockUseStudy.mockReturnValue({\r\n            activeFocus: null,\r\n            startFocus: vi.fn(),\r\n            endFocus: vi.fn()\r\n        });\r\n        mockUsePomodoroContext.mockReturnValue({\r\n            startFocusSession: vi.fn(),\r\n            resetTimer: vi.fn()\r\n        });\r\n        mockUseAudio.mockReturnValue({\r\n            startAudio: vi.fn(),\r\n            stopAudio: vi.fn()\r\n        });\r\n        mockUseConfirm.mockReturnValue({\r\n            confirm: vi.fn()\r\n        });\r\n    });\r\n\r\n    const defaultProps = {\r\n        date: new Date(),\r\n        events: {\r\n            reviews: [],\r\n            tasks: [],\r\n            goals: [],\r\n            intros: [],\r\n            projected: []\r\n        },\r\n        onCompleteReview: vi.fn(),\r\n        onStartStudy: vi.fn(),\r\n        onToggleTask: vi.fn(),\r\n        onToggleGoal: vi.fn(),\r\n        onToggleGoalItem: vi.fn(),\r\n        onDeleteGoal: vi.fn(),\r\n        onDeleteTask: vi.fn()\r\n    };\r\n\r\n    it('renders empty state message when no events', () => {\r\n        render(<DayDetails {...defaultProps} />);\r\n        expect(screen.getByText(/Nada agendado para este dia/i)).toBeInTheDocument();\r\n    });\r\n\r\n    it('renders tasks correctly', () => {\r\n        const propsWithTasks = {\r\n            ...defaultProps,\r\n            events: {\r\n                ...defaultProps.events,\r\n                tasks: [{\r\n                    id: 't1',\r\n                    title: 'Test Task',\r\n                    status: 'pending',\r\n                    priority: 'high',\r\n                    durationMinutes: 30\r\n                } as any]\r\n            }\r\n        };\r\n        render(<DayDetails {...propsWithTasks} />);\r\n        expect(screen.getByText('Test Task')).toBeInTheDocument();\r\n        expect(screen.getByText('Tarefas (1)')).toBeInTheDocument();\r\n    });\r\n\r\n    it('calls onDeleteTask when delete button is clicked', async () => {\r\n        const mockDeleteTask = vi.fn();\r\n        mockUseConfirm.mockReturnValue({\r\n            confirm: vi.fn().mockResolvedValue(true)\r\n        });\r\n\r\n        const propsWithTasks = {\r\n            ...defaultProps,\r\n            onDeleteTask: mockDeleteTask,\r\n            events: {\r\n                ...defaultProps.events,\r\n                tasks: [{\r\n                    id: 't1',\r\n                    title: 'Test Task',\r\n                    status: 'pending'\r\n                } as any]\r\n            }\r\n        };\r\n        render(<DayDetails {...propsWithTasks} />);\r\n\r\n        const deleteBtn = screen.getByRole('button', { name: /Excluir tarefa/i });\r\n        fireEvent.click(deleteBtn);\r\n\r\n        // Wait for async confirm to resolve\r\n        await vi.waitUntil(() => mockDeleteTask.mock.calls.length > 0);\r\n\r\n        expect(mockDeleteTask).toHaveBeenCalledWith('t1');\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\calendar\\hooks\\useCalendarEvents.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addDays' is defined but never used.","line":4,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isSameMonth' is defined but never used.","line":12,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ptBR' is defined but never used.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[617,620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[617,620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[637,640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[637,640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[660,663],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[660,663],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[679,682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[679,682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[698,701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[698,701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5232,5235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5232,5235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validGoalIds' is assigned a value but never used.","line":167,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":167,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":174,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8079,8082],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8079,8082],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":174,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8087,8090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8087,8090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":177,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8263,8266],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8263,8266],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":263,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13131,13134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13131,13134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13644,13647],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13644,13647],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":284,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":284,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13915,13918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13915,13918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":294,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14238,14241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14238,14241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":304,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14567,14570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14567,14570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":327,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":327,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15199,15202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15199,15202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":347,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15942,15945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15942,15945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":348,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16005,16008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16005,16008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":21,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react';\r\nimport {\r\n    format,\r\n    addDays,\r\n    addMonths,\r\n    subMonths,\r\n    startOfMonth,\r\n    endOfMonth,\r\n    startOfWeek,\r\n    endOfWeek,\r\n    eachDayOfInterval,\r\n    isSameMonth\r\n} from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { getAllProjectedReviews } from '../../../lib/srs';\r\nimport { parseLocalDate } from '../../../utils/dateHelpers';\r\nimport type { Theme, Task, Goal } from '../../../types';\r\n\r\ninterface UseCalendarEventsProps {\r\n    themes: Theme[];\r\n    tasks: Task[];\r\n    goals: Goal[];\r\n}\r\n\r\ninterface DayEvents {\r\n    reviews: any[];\r\n    intros: any[];\r\n    projected: any[];\r\n    tasks: any[];\r\n    goals: any[];\r\n}\r\n\r\nexport const useCalendarEvents = ({ themes, tasks, goals }: UseCalendarEventsProps) => {\r\n    const [currentMonth, setCurrentMonth] = useState(new Date());\r\n    const [now, setNow] = useState(new Date());\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => setNow(new Date()), 60000);\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    const nextMonth = () => setCurrentMonth(addMonths(currentMonth, 1));\r\n    const prevMonth = () => setCurrentMonth(subMonths(currentMonth, 1));\r\n\r\n    const { calendarDays } = useMemo(() => {\r\n        const monthStart = startOfMonth(currentMonth);\r\n        const monthEnd = endOfMonth(monthStart);\r\n        const startDate = startOfWeek(monthStart);\r\n        const endDate = endOfWeek(monthEnd);\r\n        const calendarDays = eachDayOfInterval({ start: startDate, end: endDate });\r\n        return { calendarDays };\r\n    }, [currentMonth]);\r\n\r\n    const allProjectedReviews = useMemo(() => getAllProjectedReviews(themes), [themes]);\r\n\r\n    const eventsMap = useMemo(() => {\r\n        const map = new Map<string, DayEvents>();\r\n\r\n        const getDay = (dateStr: string): DayEvents => {\r\n            if (!map.has(dateStr)) {\r\n                map.set(dateStr, { reviews: [], intros: [], projected: [], tasks: [], goals: [] });\r\n            }\r\n            return map.get(dateStr)!;\r\n        };\r\n\r\n        themes.forEach(t => {\r\n            // Handling for PROJECTS in Calendar\r\n            if (t.category === 'project') {\r\n                // For projects, we want to show modules.\r\n                // If they have explicit dates (not yet standard in subtheme, but maybe via 'introductionDate' used as 'deadline' or 'start'?)\r\n                // Currently subthemes have 'introductionDate'. We can use that as the \"Schedule Date\".\r\n                (t.subthemes || []).forEach(st => {\r\n                    if (st.status !== 'completed' && st.introductionDate) {\r\n                        const d = getDay(st.introductionDate); // Or fallback to today if \"Active\"?\r\n                        // Projects act like Tasks.\r\n                        d.tasks.push({\r\n                            id: st.id,\r\n                            title: `${st.title} (${t.title})`,\r\n                            type: 'project-step', // Custom type to distinguish\r\n                            date: st.introductionDate,\r\n                            status: 'pending',\r\n                            priority: t.priority,\r\n                            color: t.color || '#8b5cf6', // Violet for projects\r\n                            isCompletedToday: false\r\n                        });\r\n                    } else if (st.status === 'completed' && st.introductionDate) {\r\n                        // Show completed project steps too?\r\n                        const d = getDay(st.introductionDate);\r\n                        d.tasks.push({\r\n                            id: st.id,\r\n                            title: `${st.title} (${t.title})`,\r\n                            type: 'project-step',\r\n                            date: st.introductionDate,\r\n                            status: 'completed',\r\n                            priority: t.priority,\r\n                            color: t.color || '#8b5cf6',\r\n                            isCompletedToday: true // Assume done on intro date for now or we need completion timestamp\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Standard SRS Logic for Study Themes\r\n            if (t.category !== 'project') {\r\n                (t.subthemes || []).forEach(st => {\r\n                    (st.reviews || []).forEach(r => {\r\n                        const dateKey = r.date.includes('T') ? r.date.split('T')[0] : r.date;\r\n                        const d = getDay(dateKey);\r\n                        d.reviews.push({ ...r, themeTitle: t.title, subthemeTitle: st.title, type: 'review', id: st.id, durationMinutes: st.durationMinutes, priority: t.priority, timeSpent: st.timeSpent, color: t.color || '#3b82f6' });\r\n                    });\r\n                    if (st.introductionDate) {\r\n                        const d = getDay(st.introductionDate);\r\n                        d.intros.push({ themeTitle: t.title, subthemeTitle: st.title, type: 'intro', durationMinutes: st.durationMinutes, priority: t.priority, timeSpent: st.timeSpent, id: st.id, color: t.color || '#f59e0b' });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        allProjectedReviews.forEach((p: any) => {\r\n            const d = getDay(p.date);\r\n            d.projected.push(p);\r\n        });\r\n\r\n        console.log(' === BUILDING EVENTS MAP ===');\r\n        console.log(' Total tasks in system:', tasks.length);\r\n        console.log(' Total goals in system:', goals.length);\r\n\r\n        tasks.forEach(t => {\r\n            console.log(`   Task: \"${t.title}\" | type: ${t.type} | date: ${t.date} | startDate: ${t.startDate} | endDate: ${t.endDate}`);\r\n            if (t.type === 'day' && t.date) {\r\n                console.log(`     DAY task - adding to ${t.date}`);\r\n                const d = getDay(t.date);\r\n                d.tasks.push({ ...t, color: t.color, isCompletedToday: t.status === 'completed' });\r\n            } else if (t.type === 'period' && t.startDate && t.endDate) {\r\n                console.log(`     PERIOD task - adding from ${t.startDate} to ${t.endDate}`);\r\n                eachDayOfInterval({\r\n                    start: parseLocalDate(t.startDate),\r\n                    end: parseLocalDate(t.endDate)\r\n                }).forEach(date => {\r\n                    const dateStr = format(date, 'yyyy-MM-dd');\r\n                    const d = getDay(dateStr);\r\n                    const isCompleted = t.completionHistory?.some(h => h.startsWith(dateStr)) || false;\r\n                    d.tasks.push({ ...t, color: t.color, isCompletedToday: isCompleted });\r\n                });\r\n            } else if (t.type === 'recurring' && t.recurrence) {\r\n                console.log(`     RECURRING task - recurrence: ${t.recurrence}`);\r\n                calendarDays.forEach(day => {\r\n                    const dateStr = format(day, 'yyyy-MM-dd');\r\n                    const dayOfWeek = day.getDay();\r\n                    const taskStart = new Date(t.createdAt).setHours(0, 0, 0, 0);\r\n                    if (day.getTime() < taskStart) return;\r\n                    if (t.endDate && dateStr > t.endDate) return;\r\n\r\n                    if (t.recurrence?.includes(dayOfWeek)) {\r\n                        const d = getDay(dateStr);\r\n                        const isCompleted = t.completionHistory?.some(h => h.startsWith(dateStr)) || false;\r\n                        d.tasks.push({ ...t, color: t.color, isCompletedToday: isCompleted });\r\n                    }\r\n                });\r\n            } else {\r\n                console.log(`     Task did NOT match any filter`);\r\n            }\r\n        });\r\n        console.log(' === EVENTS MAP BUILT ===');\r\n\r\n        // Create a Set of valid goal IDs for quick lookup\r\n        const validGoalIds = new Set(goals.map(g => g.id));\r\n\r\n        goals.forEach(g => {\r\n            // Extra safety: skip if goal doesn't have required fields\r\n            if (!g || !g.id) return;\r\n\r\n            if (g.type === 'checklist' && g.checklist) {\r\n                const steps = [...g.checklist].sort((a: any, b: any) => a.order - b.order);\r\n                let currentPhaseStart = g.startDate ? parseLocalDate(g.startDate) : new Date(g.createdAt);\r\n\r\n                steps.forEach((item: any) => {\r\n                    if (!item.deadline) return;\r\n                    const phaseStart = new Date(currentPhaseStart);\r\n                    phaseStart.setHours(0, 0, 0, 0);\r\n\r\n                    const itemDeadlineKey = item.deadline.includes('T') ? item.deadline.split('T')[0] : item.deadline;\r\n                    const inputs = itemDeadlineKey.split('-').map(Number);\r\n                    const phaseEnd = new Date(inputs[0], inputs[1] - 1, inputs[2]);\r\n                    phaseEnd.setHours(0, 0, 0, 0);\r\n\r\n                    const iterDate = new Date(phaseStart);\r\n                    while (iterDate <= phaseEnd) {\r\n                        const dateKey = format(iterDate, 'yyyy-MM-dd');\r\n                        const d = getDay(dateKey);\r\n                        const history = item.completionHistory || [];\r\n                        const isCompletedToday = history.some((h: string) => h.startsWith(dateKey));\r\n                        const windowDays = Math.ceil((phaseEnd.getTime() - phaseStart.getTime()) / (1000 * 60 * 60 * 24)) + 1;\r\n                        const uniqueChecks = new Set(history.map((h: string) => h.split('T')[0])).size;\r\n                        const progress = Math.min(100, Math.round((uniqueChecks / windowDays) * 100));\r\n\r\n                        d.goals.push({\r\n                            id: item.id,\r\n                            type: 'goal-phase',\r\n                            title: item.title,\r\n                            parentGoalId: g.id,\r\n                            parentGoalTitle: g.title,\r\n                            checklist_item_id: item.id,\r\n                            isCompletedToday: isCompletedToday,\r\n                            color: g.color || '#ec4899',\r\n                            priority: g.priority,\r\n                            deadline: item.deadline,\r\n                            durationMinutes: parseInt(item.estimatedTime) || 0,\r\n                            phaseProgress: progress,\r\n                            currentDay: Math.ceil((iterDate.getTime() - phaseStart.getTime()) / (1000 * 60 * 60 * 24)) + 1,\r\n                            totalDays: windowDays\r\n                        });\r\n                        iterDate.setDate(iterDate.getDate() + 1);\r\n                    }\r\n                    currentPhaseStart = new Date(phaseEnd);\r\n                    currentPhaseStart.setDate(currentPhaseStart.getDate() + 1);\r\n                });\r\n            }\r\n\r\n            if (g.type === 'habit') {\r\n                calendarDays.forEach(day => {\r\n                    const dateStr = format(day, 'yyyy-MM-dd');\r\n                    const dayOfWeek = day.getDay();\r\n                    const goalStart = g.createdAt ? new Date(g.createdAt).setHours(0, 0, 0, 0) : 0;\r\n                    if (day.getTime() < goalStart) return;\r\n                    if (g.deadline && dateStr > g.deadline) return;\r\n\r\n                    if (!g.recurrence || g.recurrence.length === 0 || g.recurrence.includes(dayOfWeek)) {\r\n                        const d = getDay(dateStr);\r\n                        const isCompleted = g.completionHistory?.some(h => h.startsWith(dateStr)) || false;\r\n                        d.goals.push({ ...g, color: g.color, isCompletedToday: isCompleted, isParent: true });\r\n                    }\r\n                });\r\n            } else if (g.deadline) {\r\n                const deadlineKey = g.deadline.includes('T') ? g.deadline.split('T')[0] : g.deadline;\r\n                const dDeadline = getDay(deadlineKey);\r\n                const isCompleted = g.progress === 100;\r\n                dDeadline.goals.push({ ...g, color: g.color, isCompletedToday: isCompleted, isParent: true, label: 'Prazo' });\r\n\r\n                if (g.startDate && g.startDate !== g.deadline) {\r\n                    const startKey = g.startDate.includes('T') ? g.startDate.split('T')[0] : g.startDate;\r\n                    const dStart = getDay(startKey);\r\n                    dStart.goals.push({ ...g, color: g.color || '#3b82f6', isCompletedToday: isCompleted, isParent: true, label: 'Incio' });\r\n                }\r\n            }\r\n        });\r\n\r\n        return map;\r\n    }, [themes, allProjectedReviews, tasks, goals, calendarDays]);\r\n\r\n    // Create Sets of valid IDs for filtering (outside useMemo so they're always fresh)\r\n    const currentGoalIds = new Set(goals.map(g => g.id));\r\n    const currentTaskIds = new Set(tasks.map(t => t.id));\r\n    const currentSubthemeIds = new Set(\r\n        themes.flatMap(t => t.subthemes.map(st => st.id))\r\n    );\r\n\r\n    const getEventsForDay = (date: Date) => {\r\n        const dateStr = format(date, 'yyyy-MM-dd');\r\n        const dayEvents = eventsMap.get(dateStr) || { reviews: [], intros: [], projected: [], tasks: [], goals: [] };\r\n\r\n        // Filter out goals that reference deleted parent goals\r\n        const filteredGoals = (dayEvents.goals || []).filter((g: any) => {\r\n            // If it's a goal-phase (step), check if parent goal still exists\r\n            if (g.parentGoalId) {\r\n                return currentGoalIds.has(g.parentGoalId);\r\n            }\r\n            // If it's a regular goal, check if it still exists\r\n            if (g.id) {\r\n                return currentGoalIds.has(g.id);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        // Filter out tasks that have been deleted\r\n        const filteredTasks = (dayEvents.tasks || []).filter((t: any) => {\r\n            if (t.id) {\r\n                return currentTaskIds.has(t.id);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        // Filter out reviews/intros for deleted subthemes\r\n        const filteredReviews = (dayEvents.reviews || []).filter((r: any) => {\r\n            if (r.subthemeId) {\r\n                return currentSubthemeIds.has(r.subthemeId);\r\n            }\r\n            if (r.id) {\r\n                return currentSubthemeIds.has(r.id);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        const filteredIntros = (dayEvents.intros || []).filter((i: any) => {\r\n            if (i.subthemeId) {\r\n                return currentSubthemeIds.has(i.subthemeId);\r\n            }\r\n            if (i.id) {\r\n                return currentSubthemeIds.has(i.id);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        const filteredProjected = (dayEvents.projected || []).filter((p: any) => {\r\n            if (p.subthemeId) {\r\n                return currentSubthemeIds.has(p.subthemeId);\r\n            }\r\n            if (p.id) {\r\n                return currentSubthemeIds.has(p.id);\r\n            }\r\n            return true;\r\n        });\r\n\r\n        return {\r\n            reviews: filteredReviews,\r\n            intros: filteredIntros,\r\n            projected: filteredProjected,\r\n            tasks: filteredTasks,\r\n            goals: filteredGoals\r\n        };\r\n    };\r\n\r\n    const upcomingList = useMemo(() => {\r\n        const today = new Date(now);\r\n        today.setHours(0, 0, 0, 0);\r\n\r\n        const activeReviews: any[] = [];\r\n        themes.forEach(t => {\r\n            t.subthemes.forEach(st => {\r\n                st.reviews.forEach(r => {\r\n                    if (r.status === 'pending') {\r\n                        activeReviews.push({\r\n                            ...r,\r\n                            themeTitle: t.title,\r\n                            subthemeTitle: st.title,\r\n                            id: st.id,\r\n                            type: 'active',\r\n                            originalDate: new Date(r.date),\r\n                            color: t.color || '#3b82f6'\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        });\r\n\r\n        const projected = allProjectedReviews\r\n            .filter((p: any) => parseLocalDate(p.date) >= today)\r\n            .map((p: any) => ({\r\n                ...p,\r\n                type: 'projected',\r\n                status: 'pending',\r\n                originalDate: parseLocalDate(p.date),\r\n                number: parseInt(p.description.match(/#(\\d+)/)?.[1] || '0')\r\n            }));\r\n\r\n        const combined = [...activeReviews, ...projected].sort((a, b) => a.originalDate.getTime() - b.originalDate.getTime());\r\n        return combined.slice(0, 15);\r\n    }, [themes, allProjectedReviews, now]);\r\n\r\n    return {\r\n        currentMonth,\r\n        now,\r\n        calendarDays,\r\n        nextMonth,\r\n        prevMonth,\r\n        setCurrentMonth,\r\n        getEventsForDay,\r\n        upcomingList\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\AnalyticsWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Zap' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useStudy } from '../../context/StudyContext';\r\nimport { Zap, Clock, Target } from 'lucide-react';\r\nimport { RetentionChart } from './RetentionChart';\r\n\r\nexport const AnalyticsWidget = () => {\r\n    const { gamification, goals } = useStudy();\r\n    const defaultStats = { reviewsCompleted: 0, tasksCompleted: 0, habitsCompleted: 0, totalFocusMinutes: 0, dailyXp: 0, lastXpDate: '', dailyHistory: {} };\r\n    const stats = { ...defaultStats, ...(gamification?.stats || {}) };\r\n\r\n    // Calculate Stats\r\n    const totalHours = (stats.totalFocusMinutes / 60).toFixed(1);\r\n    const completedGoals = goals.filter(g => g.progress === 100).length;\r\n\r\n    return (\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\">\r\n            {/* Chart Section - New Advanced Retention Chart */}\r\n            <div className=\"lg:col-span-2\">\r\n                <RetentionChart />\r\n            </div>\r\n\r\n            {/* Metrics Section */}\r\n            <div className=\"space-y-6\">\r\n                <div className=\"bg-slate-900/40 backdrop-blur-xl border border-white/10 rounded-[2rem] p-8 relative overflow-hidden group hover:bg-slate-800/40 transition-all duration-500 shadow-2xl\">\r\n                    <div className=\"absolute top-0 right-0 -mr-4 -mt-4 w-32 h-32 bg-yellow-500/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-700\" />\r\n\r\n                    <div className=\"relative z-10\">\r\n                        <div className=\"flex items-center gap-3 mb-4\">\r\n                            <div className=\"p-2.5 rounded-xl bg-yellow-500/10 text-yellow-500 border border-yellow-500/20\">\r\n                                <Clock className=\"w-5 h-5\" />\r\n                            </div>\r\n                            <span className=\"text-sm font-bold text-slate-400 uppercase tracking-widest\">Tempo Total</span>\r\n                        </div>\r\n                        <div className=\"flex items-baseline gap-1\">\r\n                            <div className=\"text-5xl font-black text-white tracking-tighter drop-shadow-lg\">\r\n                                {totalHours}\r\n                            </div>\r\n                            <span className=\"text-xl font-medium text-slate-500\">horas</span>\r\n                        </div>\r\n\r\n                        <div className=\"mt-4 pt-4 border-t border-white/5 flex items-center justify-between text-xs font-medium text-slate-400\">\r\n                            <span>{stats.totalFocusMinutes} minutos totais</span>\r\n                            <span className=\"text-yellow-500 bg-yellow-500/10 px-2 py-0.5 rounded border border-yellow-500/20\">Foco Vitalcio</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-slate-900/40 backdrop-blur-xl border border-white/10 rounded-[2rem] p-8 relative overflow-hidden group hover:bg-slate-800/40 transition-all duration-500 shadow-2xl\">\r\n                    <div className=\"absolute top-0 right-0 -mr-4 -mt-4 w-32 h-32 bg-purple-500/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-700\" />\r\n\r\n                    <div className=\"relative z-10\">\r\n                        <div className=\"flex items-center gap-3 mb-4\">\r\n                            <div className=\"p-2.5 rounded-xl bg-purple-500/10 text-purple-500 border border-purple-500/20\">\r\n                                <Target className=\"w-5 h-5\" />\r\n                            </div>\r\n                            <span className=\"text-sm font-bold text-slate-400 uppercase tracking-widest\">Conquistas</span>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <div className=\"text-4xl font-black text-white tracking-tighter\">{completedGoals}</div>\r\n                                <div className=\"text-xs font-bold text-emerald-400 mt-1 flex items-center gap-1\">\r\n                                    <span className=\"w-1.5 h-1.5 rounded-full bg-emerald-500\" />\r\n                                    METAS\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"pl-4 border-l border-white/10\">\r\n                                <div className=\"text-4xl font-black text-white tracking-tighter\">{stats.tasksCompleted}</div>\r\n                                <div className=\"text-xs font-bold text-blue-400 mt-1 flex items-center gap-1\">\r\n                                    <span className=\"w-1.5 h-1.5 rounded-full bg-blue-500\" />\r\n                                    TAREFAS\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\CalendarWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Task' is defined but never used.","line":22,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":133,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":136,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1945,1948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1945,1948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5033,5036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5033,5036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport {\r\n    format,\r\n    startOfMonth,\r\n    endOfMonth,\r\n    startOfWeek,\r\n    endOfWeek,\r\n    eachDayOfInterval,\r\n    addMonths,\r\n    subMonths,\r\n    isSameMonth,\r\n    isToday\r\n} from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { cn } from '../../lib/utils';\r\nimport { Card } from '../../components/ui/Card';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { DayDetails } from '../calendar/components/DayDetails';\r\nimport { getAllProjectedReviews } from '../../lib/srs';\r\nimport type { Task, CalendarReviewItem, CalendarGoalItem, CalendarTaskItem } from '../../types';\r\n\r\nexport const CalendarWidget = () => {\r\n    const { themes, tasks, goals, completeReview, startStudySession, toggleTask, toggleGoal, toggleGoalItem, deleteTask, deleteGoal } = useStudy();\r\n    const [currentMonth, setCurrentMonth] = useState(new Date());\r\n    const [selectedDate, setSelectedDate] = useState<Date | null>(null);\r\n\r\n    // Navigation\r\n    const nextMonth = () => setCurrentMonth(addMonths(currentMonth, 1));\r\n    const prevMonth = () => setCurrentMonth(subMonths(currentMonth, 1));\r\n\r\n    // Calendar Generation\r\n    const monthStart = startOfMonth(currentMonth);\r\n    const monthEnd = endOfMonth(monthStart);\r\n    const startDate = startOfWeek(monthStart);\r\n    const endDate = endOfWeek(monthEnd);\r\n\r\n    const calendarDays = eachDayOfInterval({ start: startDate, end: endDate });\r\n\r\n    // Pre-calculate expensive projections\r\n    const allProjected = useMemo(() => getAllProjectedReviews(themes), [themes]);\r\n\r\n    // OTIMIZAO: Gerar mapa de eventos uma nica vez para o intervalo visvel\r\n    const eventsMap = useMemo(() => {\r\n        const map: Record<string, { reviews: CalendarReviewItem[], tasks: CalendarTaskItem[], goals: CalendarGoalItem[], projected: any[] }> = {};\r\n\r\n        calendarDays.forEach(day => {\r\n            const dateStr = format(day, 'yyyy-MM-dd');\r\n            const dayOfWeek = day.getDay();\r\n\r\n            // Reviews\r\n            const dayReviews: CalendarReviewItem[] = themes.flatMap(t =>\r\n                t.subthemes.flatMap(st =>\r\n                    st.reviews\r\n                        .filter(r => r.date === dateStr)\r\n                        .map(r => ({ ...r, id: `${st.id}-${r.date}`, themeTitle: t.title, subthemeTitle: st.title }))\r\n                )\r\n            );\r\n\r\n            // Tasks\r\n            const dayTasks: CalendarTaskItem[] = tasks.filter(t => {\r\n                if (t.type === 'recurring') {\r\n                    const taskCreationDay = new Date(t.createdAt).setHours(0, 0, 0, 0);\r\n                    if (day.getTime() < taskCreationDay) return false;\r\n                }\r\n                if (t.type === 'day') return t.date === dateStr;\r\n                if (t.type === 'recurring' && t.recurrence) {\r\n                    if (t.endDate && dateStr > t.endDate) return false;\r\n                    return t.recurrence.includes(dayOfWeek);\r\n                }\r\n                if (t.type === 'period' && t.startDate && t.endDate) {\r\n                    return dateStr >= t.startDate && dateStr <= t.endDate;\r\n                }\r\n                return false;\r\n            }).map(t => {\r\n                let isCompletedToday = false;\r\n                if (t.type === 'day') {\r\n                    isCompletedToday = t.status === 'completed';\r\n                } else if (t.completionHistory) {\r\n                    isCompletedToday = t.completionHistory.some(h => h.startsWith(dateStr));\r\n                }\r\n                return { ...t, isCompletedToday };\r\n            });\r\n\r\n            // Goals\r\n            const dayGoals: CalendarGoalItem[] = goals.filter(g => {\r\n                if (g.type === 'habit' && g.createdAt) {\r\n                    const goalCreationDay = new Date(g.createdAt).setHours(0, 0, 0, 0);\r\n                    if (day.getTime() < goalCreationDay) return false;\r\n                }\r\n                if (g.type === 'habit') {\r\n                    if (g.deadline && dateStr > g.deadline) return false;\r\n                    if (g.recurrence && g.recurrence.length > 0) return g.recurrence.includes(dayOfWeek);\r\n                    return true;\r\n                }\r\n                if (g.deadline && g.deadline.split('T')[0] === dateStr) return true;\r\n                return false;\r\n            }).map(g => {\r\n                let isCompletedToday = false;\r\n                if (g.completionHistory) {\r\n                    isCompletedToday = g.completionHistory.some(h => h.startsWith(dateStr));\r\n                } else if (g.type !== 'habit') {\r\n                    isCompletedToday = g.progress === 100;\r\n                }\r\n                return { ...g, isCompletedToday } as CalendarGoalItem;\r\n            });\r\n\r\n            // Projected\r\n            const dayProjected = allProjected\r\n                .filter((p: { date: string }) => p.date === dateStr)\r\n                .map((p: any) => ({ ...p, priority: 'medium' as const }));\r\n\r\n            map[dateStr] = { reviews: dayReviews, tasks: dayTasks, goals: dayGoals, projected: dayProjected };\r\n        });\r\n\r\n        return map;\r\n    }, [themes, tasks, goals, calendarDays, allProjected]);\r\n\r\n    const getEventsForDay = (date: Date) => {\r\n        const dateStr = format(date, 'yyyy-MM-dd');\r\n        const data = eventsMap[dateStr] || { reviews: [], tasks: [], goals: [], projected: [] };\r\n        return data;\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"relative overflow-hidden p-6 rounded-3xl bg-slate-900/40 border border-white/5 shadow-2xl backdrop-blur-md group\">\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10 mix-blend-overlay pointer-events-none\" />\r\n                {/* Ambient Glow */}\r\n                <div className=\"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none transition-all group-hover:bg-indigo-500/20\" />\r\n\r\n                <div className=\"flex items-center justify-between mb-6 relative z-10\">\r\n                    <h2 className=\"text-lg font-bold text-white tracking-tight flex items-center gap-2\">\r\n                        Calendrio\r\n                    </h2>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-xs font-medium text-slate-400 capitalize mr-2\">\r\n                            {format(currentMonth, 'MMMM yyyy', { locale: ptBR })}\r\n                        </span>\r\n                        <div className=\"flex bg-slate-800/50 rounded-lg border border-white/5 p-0.5\">\r\n                            <button onClick={prevMonth} className=\"p-1 hover:bg-white/10 rounded-md text-slate-400 hover:text-white transition-colors\">\r\n                                <ChevronLeft className=\"w-4 h-4\" />\r\n                            </button>\r\n                            <button onClick={nextMonth} className=\"p-1 hover:bg-white/10 rounded-md text-slate-400 hover:text-white transition-colors\">\r\n                                <ChevronRight className=\"w-4 h-4\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-7 text-center mb-2\">\r\n                    {['D', 'S', 'T', 'Q', 'Q', 'S', 'S'].map((d, i) => (\r\n                        <div key={i} className=\"text-[10px] font-bold text-slate-500 uppercase tracking-wider py-2\">{d}</div>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-7 gap-1.5 relative z-10\">\r\n                    {calendarDays.map((day, idx) => {\r\n                        const { reviews, tasks, goals } = getEventsForDay(day);\r\n                        const isCurrentMonth = isSameMonth(day, currentMonth);\r\n                        const isDayToday = isToday(day);\r\n\r\n                        // Dots calculation\r\n                        const pendingReviews = reviews.filter((r: { status: string }) => r.status === 'pending').length;\r\n                        const completedReviews = reviews.filter((r: { status: string }) => r.status === 'completed').length;\r\n                        const hasGoals = goals.some((g: { isCompletedToday?: boolean }) => !g.isCompletedToday);\r\n                        const hasTasks = tasks.some((t: { isCompletedToday?: boolean }) => !t.isCompletedToday);\r\n\r\n                        return (\r\n                            <div\r\n                                key={idx}\r\n                                onClick={() => setSelectedDate(day)}\r\n                                className={cn(\r\n                                    \"aspect-square rounded-xl flex flex-col items-center justify-center relative cursor-pointer transition-all duration-300 border border-transparent\",\r\n                                    isCurrentMonth\r\n                                        ? \"bg-slate-800/20 hover:bg-slate-800/50 hover:border-white/10 hover:scale-105 hover:shadow-lg\"\r\n                                        : \"opacity-20 text-slate-600 grayscale\",\r\n                                    isDayToday && \"bg-blue-600 shadow-[0_4px_12px_rgba(37,99,235,0.4)] text-white scale-110 z-10 border-blue-500/50\"\r\n                                )}\r\n                            >\r\n                                <span className={cn(\r\n                                    \"text-xs font-bold\",\r\n                                    !isDayToday && \"text-slate-400 group-hover:text-white\"\r\n                                )}>\r\n                                    {format(day, 'd')}\r\n                                </span>\r\n\r\n                                {/* Micro Indicators */}\r\n                                <div className=\"flex gap-0.5 mt-1\">\r\n                                    {pendingReviews > 0 && <div className={cn(\"w-1 h-1 rounded-full\", isDayToday ? \"bg-white\" : \"bg-blue-500\")} />}\r\n                                    {pendingReviews === 0 && completedReviews > 0 && <div className={cn(\"w-1 h-1 rounded-full\", isDayToday ? \"bg-white/80\" : \"bg-emerald-500\")} />}\r\n\r\n                                    {hasGoals && <div className={cn(\"w-1 h-1 rounded-full\", isDayToday ? \"bg-white/80\" : \"bg-emerald-500\")} />}\r\n                                    {hasTasks && <div className={cn(\"w-1 h-1 rounded-full\", isDayToday ? \"bg-white/60\" : \"bg-amber-500\")} />}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            <Modal\r\n                isOpen={!!selectedDate}\r\n                onClose={() => setSelectedDate(null)}\r\n                title={selectedDate ? format(selectedDate, \"d 'de' MMMM\", { locale: ptBR }) : ''}\r\n            >\r\n                {selectedDate && (\r\n                    <DayDetails\r\n                        events={getEventsForDay(selectedDate)}\r\n                        date={selectedDate}\r\n                        onCompleteReview={completeReview}\r\n                        onStartStudy={startStudySession}\r\n                        onToggleTask={toggleTask}\r\n                        onToggleGoal={toggleGoal}\r\n                        onToggleGoalItem={toggleGoalItem}\r\n                        onDeleteTask={deleteTask}\r\n                        onDeleteGoal={deleteGoal}\r\n                    />\r\n                )}\r\n            </Modal>\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\Dashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":3,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startFocusSession' is assigned a value but never used.","line":35,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { Target, CheckCircle2, Clock, TrendingUp, FolderKanban } from 'lucide-react';\r\nimport { CalendarWidget } from './CalendarWidget';\r\nimport { ConsistencyHeatmap } from '../../components/analytics/ConsistencyHeatmap';\r\nimport { ProfessionalHero } from './ProfessionalHero';\r\nimport { GamificationModal } from '../gamification/GamificationModal';\r\nimport { RealisticKPICard } from './components/RealisticKPICard';\r\nimport { ActiveGoalsWidget } from './components/ActiveGoalsWidget';\r\nimport { MissionPreviewWidget } from './components/MissionPreviewWidget';\r\nimport { AchievementsSummaryWidget } from './components/AchievementsSummaryWidget';\r\nimport { LeaderboardWidget } from './components/LeaderboardWidget';\r\nimport { useDashboardData } from '../../hooks/useDashboardData';\r\n\r\ninterface DashboardProps {\r\n    onNavigate: (tab: string) => void;\r\n    onOpenSummaryModal: () => void;\r\n    setIsMissionModalOpen: (isOpen: boolean) => void;\r\n}\r\n\r\nexport const Dashboard: React.FC<DashboardProps> = ({ onNavigate, onOpenSummaryModal, setIsMissionModalOpen }) => {\r\n    const {\r\n        zenMode,\r\n        gamification,\r\n        goals,\r\n        themes,\r\n        activeGoals,\r\n        dueReviews,\r\n        progressPercent,\r\n        isAllDone,\r\n        completedCount,\r\n        totalCount\r\n    } = useDashboardData();\r\n\r\n    const { startFocusSession } = usePomodoroContext();\r\n    const [isGamificationModalOpen, setIsGamificationModalOpen] = React.useState(false);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-in fade-in duration-500 pt-6\">\r\n\r\n            {/* Professional Gamification Hero */}\r\n            {!zenMode && <ProfessionalHero onClick={() => setIsGamificationModalOpen(true)} />}\r\n\r\n            {/* Gamification Modal */}\r\n            <GamificationModal\r\n                isOpen={isGamificationModalOpen}\r\n                onClose={() => setIsGamificationModalOpen(false)}\r\n            />\r\n\r\n            {/* KPI Cards (Realistic 3D Glass) */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n                <RealisticKPICard\r\n                    title=\"Dias Seguidos\"\r\n                    value={gamification?.streak?.current?.toString() || \"0\"}\r\n                    icon={TrendingUp}\r\n                    gradient=\"from-purple-600 to-indigo-600\"\r\n                    shadowColor=\"purple\"\r\n                    onClick={() => setIsGamificationModalOpen(true)}\r\n                />\r\n                <RealisticKPICard\r\n                    title=\"Metas Ativas\"\r\n                    value={activeGoals.toString()}\r\n                    icon={Target}\r\n                    gradient=\"from-emerald-500 to-teal-600\"\r\n                    shadowColor=\"emerald\"\r\n                    onClick={() => onNavigate('goals')}\r\n                />\r\n                <RealisticKPICard\r\n                    title=\"Revises Hoje\"\r\n                    value={dueReviews.toString()}\r\n                    icon={CheckCircle2}\r\n                    gradient=\"from-blue-500 to-cyan-500\"\r\n                    shadowColor=\"blue\"\r\n                    onClick={() => setIsMissionModalOpen(true)}\r\n                    alert={dueReviews > 0}\r\n                />\r\n                <RealisticKPICard\r\n                    title=\"Projetos\"\r\n                    value={themes.filter(t => t.category === 'project').length.toString()}\r\n                    icon={FolderKanban}\r\n                    gradient=\"from-amber-500 to-orange-600\"\r\n                    shadowColor=\"amber\"\r\n                    onClick={onOpenSummaryModal}\r\n                />\r\n            </div>\r\n\r\n            {/* Analytics Section (Chart) - Hide in Zen Mode */}\r\n            {!zenMode && (\r\n                <div className=\"relative group\">\r\n                    {/* Decoration */}\r\n                    <div className=\"absolute -inset-1 bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-emerald-500/10 rounded-3xl blur-xl opacity-50 group-hover:opacity-100 transition-opacity\" />\r\n                    <ConsistencyHeatmap />\r\n                </div>\r\n            )}\r\n\r\n            {/* Main Grid: Goals & Tasks */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left Column (2/3): Active Goals List (Detailed) */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    <ActiveGoalsWidget goals={goals} onNavigate={onNavigate} />\r\n                </div>\r\n\r\n                {/* Right Column (1/3): Widgets */}\r\n                <div className=\"space-y-6\">\r\n                    <CalendarWidget />\r\n\r\n                    {/* Today's Mission Preview (Refined) */}\r\n                    <MissionPreviewWidget\r\n                        progressPercent={progressPercent}\r\n                        isAllDone={isAllDone}\r\n                        completedCount={completedCount}\r\n                        totalCount={totalCount}\r\n                        setIsMissionModalOpen={setIsMissionModalOpen}\r\n                    />\r\n\r\n                    {/* Achievements Summary */}\r\n                    <AchievementsSummaryWidget\r\n                        unlockedAchievements={gamification?.achievements || []}\r\n                        onNavigate={onNavigate}\r\n                    />\r\n\r\n                    {/* Global Leaderboard (Gamification) */}\r\n                    <LeaderboardWidget\r\n                        userXp={gamification?.level?.totalXp || 0}\r\n                        userLevel={gamification?.level?.level || 1}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\ProfessionalHero.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Crown' is defined but never used.","line":3,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronRight' is defined but never used.","line":3,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Star' is defined but never used.","line":3,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TrendingUp' is defined but never used.","line":3,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":60}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo, useState } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Trophy, Zap, Crown, ChevronRight, Star, TrendingUp } from 'lucide-react';\r\nimport { getTitleForLevel, getNextTitleForLevel } from '../../config/gamification';\r\nimport { cn } from '../../lib/utils'; // Assuming this exists\r\n\r\ninterface ProfessionalHeroProps {\r\n    onClick?: () => void;\r\n}\r\n\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nexport const ProfessionalHero: React.FC<ProfessionalHeroProps> = ({ onClick }) => {\r\n    const { gamification } = useStudy();\r\n    const { user } = useAuth();\r\n    // Default to level 1 if data is missing to prevent crashes\r\n    const level = gamification?.level || { level: 1, currentXp: 0, nextLevelXp: 500, totalXp: 0 };\r\n    const [isHovered, setIsHovered] = useState(false);\r\n\r\n    // Memoize expensive calculations\r\n    const { percentage, currentTitle, nextTitle, remainingXp } = useMemo(() => {\r\n        const pct = Math.min(100, Math.max(0, (level.currentXp / level.nextLevelXp) * 100));\r\n        return {\r\n            percentage: pct,\r\n            currentTitle: getTitleForLevel(level.level),\r\n            nextTitle: getNextTitleForLevel(level.level),\r\n            remainingXp: level.nextLevelXp - level.currentXp\r\n        };\r\n    }, [level.currentXp, level.nextLevelXp, level.level]);\r\n\r\n    return (\r\n        <div\r\n            onClick={onClick}\r\n            className={cn(\r\n                \"group relative w-full overflow-hidden rounded-[2rem] bg-slate-950 border border-slate-800/60 shadow-2xl transition-all duration-500 hover:border-blue-500/30 hover:shadow-blue-900/20\",\r\n                onClick && \"cursor-pointer\"\r\n            )}\r\n            onMouseEnter={() => setIsHovered(true)}\r\n            onMouseLeave={() => setIsHovered(false)}\r\n        >\r\n            {/* Optimized Background - CSS gradients instead of heavy images */}\r\n            <div className=\"absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-950 to-black\" />\r\n\r\n            {/* Subtle Noise (CSS-based if possible, or very light overlay) */}\r\n            <div className=\"absolute inset-0 opacity-[0.03] bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIi8+CjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiMwMDAiLz4KPC9zdmc+')] pointer-events-none\" />\r\n\r\n            {/* Ambient Lighting - Reduced blur radius for performance */}\r\n            <div className=\"absolute top-0 right-0 w-96 h-96 bg-blue-600/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none transition-opacity duration-700\" style={{ opacity: isHovered ? 0.2 : 0.1 }} />\r\n            <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-indigo-600/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2 pointer-events-none transition-opacity duration-700\" style={{ opacity: isHovered ? 0.2 : 0.1 }} />\r\n\r\n            <div className=\"relative z-10 p-8 flex flex-col md:flex-row items-center gap-8 md:gap-12\">\r\n\r\n                {/* 1. Identity Section */}\r\n                <div className=\"flex-1 flex items-center gap-6\">\r\n                    {/* 3D Glass Badge */}\r\n                    <div className=\"relative w-24 h-24 flex-shrink-0 perspective-1000\">\r\n                        <div className=\"w-full h-full rounded-2xl bg-gradient-to-br from-slate-800 to-slate-900 border border-white/10 shadow-xl flex items-center justify-center transform transition-transform duration-500 group-hover:rotate-y-12 overflow-hidden\">\r\n                            <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent rounded-2xl pointer-events-none z-20\" />\r\n\r\n                            {user?.avatar ? (\r\n                                <img\r\n                                    src={user.avatar}\r\n                                    alt=\"Profile\"\r\n                                    className=\"w-full h-full object-cover\"\r\n                                    fetchPriority=\"high\"\r\n                                    loading=\"eager\"\r\n                                    decoding=\"sync\"\r\n                                />\r\n                            ) : (\r\n                                <Trophy className=\"w-10 h-10 text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]\" />\r\n                            )}\r\n\r\n                            <div className=\"absolute -bottom-2 px-3 py-1 bg-slate-950 border border-slate-800 rounded-full text-[10px] font-bold text-white shadow-lg z-30\">\r\n                                Lvl {level.level}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col text-center md:text-left\">\r\n                        <div className=\"flex items-center gap-2 justify-center md:justify-start mb-1\">\r\n                            <span className=\"px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-widest bg-emerald-500/10 text-emerald-400 border border-emerald-500/20\">\r\n                                Patente Atual\r\n                            </span>\r\n                        </div>\r\n                        <h2 className=\"text-3xl font-black text-white tracking-tight mb-1\">\r\n                            {currentTitle}\r\n                        </h2>\r\n                        <p className=\"text-sm text-slate-400 max-w-[280px]\">\r\n                            Prxima patente: <span className=\"text-slate-200 font-semibold\">{nextTitle}</span>\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 2. Stats & Progress */}\r\n                <div className=\"flex-1 w-full md:w-auto bg-slate-900/40 rounded-2xl p-6 border border-white/5 backdrop-blur-sm\">\r\n                    <div className=\"flex items-end justify-between mb-4\">\r\n                        <div>\r\n                            <p className=\"text-xs font-bold text-slate-500 uppercase tracking-widest mb-1\">Total Experience</p>\r\n                            <div className=\"text-2xl font-mono font-bold text-white tracking-tight\">\r\n                                {level.currentXp.toLocaleString()} <span className=\"text-sm text-slate-600 font-normal\">/ {level.nextLevelXp.toLocaleString()} XP</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <p className=\"text-xs font-bold text-indigo-400 mb-1\">+{Math.round(percentage)}%</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* High-Performance Progress Bar */}\r\n                    <div className=\"relative h-2.5 w-full bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                        <div\r\n                            className=\"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-600 to-indigo-500 shadow-[0_0_10px_rgba(79,70,229,0.4)] transition-all duration-1000 ease-out\"\r\n                            style={{ width: `${percentage}%` }}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mt-4 flex items-center justify-between text-xs text-slate-500\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Zap className=\"w-3.5 h-3.5 text-yellow-500\" />\r\n                            <span>{remainingXp.toLocaleString()} XP to go</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\RetentionChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useMemo' is defined but never used.","line":1,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":27},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\RetentionChart.tsx:46:9\n  44 |\n  45 |     useEffect(() => {\n> 46 |         setData(generateData(timeRange === 'week' ? 7 : 14));\n     |         ^^^^^^^ Avoid calling setState() directly within an effect\n  47 |     }, [timeRange]);\n  48 |\n  49 |     return (","line":46,"column":9,"nodeType":null,"endLine":46,"endColumn":16}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect } from 'react';\r\nimport {\r\n    AreaChart,\r\n    Area,\r\n    XAxis,\r\n    YAxis,\r\n    CartesianGrid,\r\n    Tooltip,\r\n    ResponsiveContainer\r\n} from 'recharts';\r\nimport { format, subDays } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { Brain } from 'lucide-react';\r\n\r\n// Mock Data Generation for Visuals\r\n// In real app, this would query 'reviews' table for pass/fail rates per day\r\nconst generateData = (days: number) => {\r\n    const data: { date: string; fullDate: string; retention: number; reviews: number }[] = [];\r\n    const today = new Date();\r\n    let retentionBase = 85;\r\n\r\n    for (let i = days; i >= 0; i--) {\r\n        const date = subDays(today, i);\r\n        // Simulate realistic fluctuation\r\n        const randomFlux = (Math.random() - 0.5) * 5;\r\n        retentionBase = Math.min(100, Math.max(70, retentionBase + randomFlux));\r\n\r\n        data.push({\r\n            date: format(date, 'MMM dd', { locale: ptBR }),\r\n            fullDate: format(date, 'ddMMM yyyy', { locale: ptBR }),\r\n            retention: Math.round(retentionBase),\r\n            reviews: Math.floor(Math.random() * 20) + 5\r\n        });\r\n    }\r\n    return data;\r\n};\r\n\r\nexport const RetentionChart = () => {\r\n    const [timeRange, setTimeRange] = useState<'week' | 'month'>('week');\r\n\r\n\r\n\r\n    const [data, setData] = useState<{ date: string; fullDate: string; retention: number; reviews: number }[]>([]);\r\n\r\n    useEffect(() => {\r\n        setData(generateData(timeRange === 'week' ? 7 : 14));\r\n    }, [timeRange]);\r\n\r\n    return (\r\n        <div className=\"bg-slate-950/50 backdrop-blur-xl border border-white/10 rounded-[2rem] p-8 relative overflow-hidden shadow-2xl group transition-all duration-500 hover:border-purple-500/20\">\r\n            {/* Realistic Glossy Highlight */}\r\n            <div className=\"absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/5 to-transparent pointer-events-none\" />\r\n\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-8 relative z-10\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center text-purple-400 border border-white/5 shadow-inner\">\r\n                        <Brain className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-xl font-bold text-white tracking-tight\">Qualidade da Memria</h3>\r\n                        <p className=\"text-sm text-slate-400 font-medium\">ndice de reteno neural</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex bg-slate-900/80 rounded-xl p-1 border border-white/10 shadow-inner\">\r\n                    <button\r\n                        onClick={() => setTimeRange('week')}\r\n                        className={`px-4 py-1.5 rounded-lg text-xs font-bold transition-all duration-300 ${timeRange === 'week' ? 'bg-purple-500/20 text-purple-300 shadow-sm' : 'text-slate-500 hover:text-slate-300'}`}\r\n                    >\r\n                        7 DIAS\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setTimeRange('month')}\r\n                        className={`px-4 py-1.5 rounded-lg text-xs font-bold transition-all duration-300 ${timeRange === 'month' ? 'bg-purple-500/20 text-purple-300 shadow-sm' : 'text-slate-500 hover:text-slate-300'}`}\r\n                    >\r\n                        30 DIAS\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Chart */}\r\n            <div className=\"h-[280px] w-full relative z-10\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <AreaChart data={data} margin={{ top: 10, right: 10, left: -20, bottom: 0 }}>\r\n                        <defs>\r\n                            <linearGradient id=\"colorRetention\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                <stop offset=\"5%\" stopColor=\"#c084fc\" stopOpacity={0.4} /> {/* Purple-400 */}\r\n                                <stop offset=\"95%\" stopColor=\"#c084fc\" stopOpacity={0} />\r\n                            </linearGradient>\r\n                        </defs>\r\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.05)\" vertical={false} />\r\n                        <XAxis\r\n                            dataKey=\"date\"\r\n                            stroke=\"#64748b\"\r\n                            fontSize={11}\r\n                            tickLine={false}\r\n                            axisLine={false}\r\n                            dy={15}\r\n                            fontFamily=\"Inter, sans-serif\"\r\n                        />\r\n                        <YAxis\r\n                            stroke=\"#64748b\"\r\n                            fontSize={11}\r\n                            tickLine={false}\r\n                            axisLine={false}\r\n                            domain={[60, 100]}\r\n                            fontFamily=\"Inter, sans-serif\"\r\n                        />\r\n                        <Tooltip\r\n                            contentStyle={{\r\n                                backgroundColor: 'rgba(15, 23, 42, 0.9)',\r\n                                border: '1px solid rgba(255,255,255,0.1)',\r\n                                borderRadius: '16px',\r\n                                boxShadow: '0 10px 40px -10px rgba(0,0,0,0.5)',\r\n                                padding: '12px 16px',\r\n                                color: '#f8fafc'\r\n                            }}\r\n                            itemStyle={{ color: '#e2e8f0', fontSize: '13px', fontWeight: 'bold' }}\r\n                            labelStyle={{ color: '#94a3b8', fontSize: '11px', marginBottom: '8px', textTransform: 'uppercase', letterSpacing: '0.05em' }}\r\n                            cursor={{ stroke: '#c084fc', strokeWidth: 2, strokeDasharray: '4 4' }}\r\n                        />\r\n                        <Area\r\n                            type=\"monotone\"\r\n                            dataKey=\"retention\"\r\n                            stroke=\"#c084fc\"\r\n                            strokeWidth={4}\r\n                            fillOpacity={1}\r\n                            fill=\"url(#colorRetention)\"\r\n                        />\r\n                    </AreaChart>\r\n                </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Stat Footer */}\r\n            <div className=\"flex items-center gap-8 mt-8 pt-6 border-t border-white/5 relative z-10\">\r\n                <div>\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-purple-500 shadow-[0_0_10px_rgba(168,85,247,0.5)]\" />\r\n                        <span className=\"text-xs text-slate-400 uppercase tracking-widest font-bold\">Mdia Atual</span>\r\n                    </div>\r\n                    <div className=\"text-3xl font-black text-white flex items-baseline gap-2\">\r\n                        {Math.round(data[data.length - 1].retention)}%\r\n                        <span className=\"text-xs font-bold px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20\">+2.4%</span>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-slate-600\" />\r\n                        <span className=\"text-xs text-slate-400 uppercase tracking-widest font-bold\">Revises</span>\r\n                    </div>\r\n                    <div className=\"text-3xl font-black text-white\">\r\n                        {data.reduce((acc, cur) => acc + cur.reviews, 0)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Ambient Background Decoration */}\r\n            <div className=\"absolute -bottom-20 -right-20 w-80 h-80 bg-purple-600/10 rounded-full blur-[100px] pointer-events-none\" />\r\n            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none\" />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\SummaryModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[789,792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[789,792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[829,832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[829,832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isOpen' is defined but never used.","line":22,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":38}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\r\nimport { BookOpen, Target, Layout } from 'lucide-react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { differenceInDays } from 'date-fns';\r\n\r\nimport { ProjectsHeader } from './components/projects/ProjectsHeader';\r\nimport { ProjectsFilter } from './components/projects/ProjectsFilter';\r\nimport type { ProjectFilterType } from './components/projects/ProjectsFilter';\r\nimport { ThemeProjectCard } from './components/projects/ThemeProjectCard';\r\nimport { GoalProjectCard } from './components/projects/GoalProjectCard';\r\n\r\ninterface SummaryModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onOpenGoalModal: (type?: 'simple' | 'checklist' | 'habit') => void;\r\n    onOpenThemeModal: () => void;\r\n    onEditGoal: (goal: any) => void;\r\n    onEditTheme: (theme: any) => void;\r\n    onAddGoalToTheme: (themeId: string) => void;\r\n}\r\n\r\nexport const SummaryModal = ({ isOpen, onClose, onOpenGoalModal, onOpenThemeModal, onEditGoal, onEditTheme, onAddGoalToTheme }: SummaryModalProps) => {\r\n    const { goals, themes, deleteGoal, deleteTheme } = useStudy();\r\n    const [filter, setFilter] = React.useState<ProjectFilterType>('all');\r\n    const [expandedThemeId, setExpandedThemeId] = React.useState<string | null>(null);\r\n\r\n    // Transform Goals and Themes\r\n    const { themeProjects, orphanGoalProjects } = useMemo(() => {\r\n        // 1. Process Themes\r\n        const themeProjs = themes.map(t => {\r\n            const total = t.subthemes.length;\r\n            const completed = t.subthemes.filter(s => s.status === 'completed').length;\r\n            const progress = total > 0 ? (completed / total) * 100 : 0;\r\n            const daysLeft = t.deadline ? differenceInDays(new Date(t.deadline), new Date()) : null;\r\n\r\n            return {\r\n                id: t.id,\r\n                title: t.title,\r\n                type: 'Tema' as const,\r\n                progress,\r\n                deadline: t.deadline,\r\n                itemCount: t.subthemes.length,\r\n                daysLeft,\r\n                color: t.color || '#a855f7', // Purple\r\n                icon: <BookOpen className=\"w-5 h-5 text-purple-400\" />,\r\n                isExpanded: expandedThemeId === t.id\r\n            };\r\n        });\r\n\r\n        // 2. Process Goals (Checklists) - Find Orphans\r\n        const goalProjs = goals.filter(g => !g.relatedThemeId).map(g => {\r\n            const daysLeft = g.deadline ? differenceInDays(new Date(g.deadline), new Date()) : null;\r\n            return {\r\n                id: g.id,\r\n                title: g.title,\r\n                type: 'Meta' as const,\r\n                progress: g.progress,\r\n                deadline: g.deadline,\r\n                itemCount: g.checklist?.length || 0,\r\n                daysLeft,\r\n                color: g.color || '#10b981', // Emerald\r\n                icon: <Target className=\"w-5 h-5 text-emerald-400\" />,\r\n                relatedThemeTitle: undefined\r\n            };\r\n        });\r\n\r\n        // Filter Application\r\n        let filteredThemes = themeProjs.filter(p => {\r\n            const fullTheme = themes.find(t => t.id === p.id);\r\n            return fullTheme?.category === 'project';\r\n        });\r\n        let filteredGoals = goalProjs;\r\n\r\n        if (filter === 'completed') {\r\n            filteredThemes = themeProjs.filter(p => p.progress === 100);\r\n            filteredGoals = goalProjs.filter(p => p.progress === 100);\r\n        } else if (filter === 'overdue') {\r\n            filteredThemes = themeProjs.filter(p => p.daysLeft !== null && p.daysLeft < 0 && p.progress < 100);\r\n            filteredGoals = goalProjs.filter(p => p.daysLeft !== null && p.daysLeft < 0 && p.progress < 100);\r\n        } else if (filter === 'active') {\r\n            filteredThemes = themeProjs.filter(p => p.progress < 100 && (p.daysLeft === null || p.daysLeft >= 0));\r\n            filteredGoals = goalProjs.filter(p => p.progress < 100 && (p.daysLeft === null || p.daysLeft >= 0));\r\n        }\r\n\r\n        return { themeProjects: filteredThemes, orphanGoalProjects: filteredGoals };\r\n    }, [goals, themes, filter, expandedThemeId]);\r\n\r\n    // Helper to get linked projects for a theme\r\n    const getLinkedProjects = (themeId: string) => {\r\n        return goals.filter(g => g.relatedThemeId === themeId).map(g => {\r\n            const daysLeft = g.deadline ? differenceInDays(new Date(g.deadline), new Date()) : null;\r\n            return {\r\n                id: g.id,\r\n                title: g.title,\r\n                type: 'Meta' as const,\r\n                progress: g.progress,\r\n                deadline: g.deadline,\r\n                itemCount: g.checklist?.length || 0,\r\n                daysLeft,\r\n                color: g.color || '#10b981',\r\n                icon: <Target className=\"w-4 h-4 text-emerald-400\" />\r\n            };\r\n        });\r\n    };\r\n\r\n    const combinedList = [...themeProjects, ...orphanGoalProjects];\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200\">\r\n            <div className=\"bg-slate-900 border border-slate-800 rounded-3xl w-full max-w-3xl max-h-[85vh] flex flex-col shadow-2xl relative overflow-hidden\">\r\n\r\n                <ProjectsHeader\r\n                    onClose={onClose}\r\n                    onOpenGoalModal={onOpenGoalModal}\r\n                    onOpenThemeModal={onOpenThemeModal}\r\n                />\r\n\r\n                <ProjectsFilter filter={filter} setFilter={setFilter} />\r\n\r\n                {/* List Content */}\r\n                <div className=\"flex-1 overflow-y-auto custom-scrollbar p-6\">\r\n                    {combinedList.length === 0 ? (\r\n                        <div className=\"text-center py-20 text-slate-500\">\r\n                            <Layout className=\"w-16 h-16 mx-auto mb-4 opacity-20\" />\r\n                            <p>Nenhum projeto ativo.</p>\r\n                            <p className=\"text-sm text-slate-600\">Crie uma Meta ou Tema para comear.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col gap-4\">\r\n                            {/* Render Themes First (as containers) */}\r\n                            {themeProjects.map((theme) => (\r\n                                <ThemeProjectCard\r\n                                    key={theme.id}\r\n                                    theme={theme}\r\n                                    linkedProjects={getLinkedProjects(theme.id)}\r\n                                    isExpanded={!!theme.isExpanded}\r\n                                    onToggleExpand={() => setExpandedThemeId(theme.isExpanded ? null : theme.id)}\r\n                                    onEditTheme={(t) => {\r\n                                        const fullTheme = themes.find(ft => ft.id === t.id);\r\n                                        if (fullTheme) onEditTheme(fullTheme);\r\n                                    }}\r\n                                    onDeleteTheme={deleteTheme}\r\n                                    onAddGoalToTheme={onAddGoalToTheme}\r\n                                    allGoals={goals}\r\n                                    onEditGoal={onEditGoal}\r\n                                    onDeleteGoal={deleteGoal}\r\n                                />\r\n                            ))}\r\n\r\n                            {/* Divider if we have both */}\r\n                            {themeProjects.length > 0 && orphanGoalProjects.length > 0 && (\r\n                                <div className=\"flex items-center gap-4 py-2\">\r\n                                    <div className=\"h-px bg-white/5 flex-1\" />\r\n                                    <span className=\"text-xs font-bold text-slate-600 uppercase tracking-widest\">Outros Projetos</span>\r\n                                    <div className=\"h-px bg-white/5 flex-1\" />\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Render Orphan Projects (Grid) */}\r\n                            {orphanGoalProjects.length > 0 && (\r\n                                <div className=\"grid grid-cols-1 grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-4\">\r\n                                    {orphanGoalProjects.map((project) => (\r\n                                        <GoalProjectCard\r\n                                            key={project.id}\r\n                                            project={project}\r\n                                            onEdit={(p) => {\r\n                                                const fullGoal = goals.find(g => g.id === p.id);\r\n                                                if (fullGoal) onEditGoal(fullGoal);\r\n                                            }}\r\n                                            onDelete={deleteGoal}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\TodayMissionModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PlayCircle' is defined but never used.","line":6,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Loader2' is defined but never used.","line":6,"column":63,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Lock' is defined but never used.","line":6,"column":72,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":76},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronDown' is defined but never used.","line":6,"column":78,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":89},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cn' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":84,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":99,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":99,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleToday' is assigned a value but never used.","line":175,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":175,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleStopFocus' is assigned a value but never used.","line":209,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":209,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":402,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":402,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPeriodProgress' is assigned a value but never used.","line":430,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":430,"endColumn":28},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\TodayMissionModal.tsx:574:125\n  572 |                                     }\n  573 |\n> 574 |                                     const start = habit.startDate ? new Date(habit.startDate) : new Date(habit.createdAt || Date.now());\n      |                                                                                                                             ^^^^^^^^^^ Cannot call impure function\n  575 |                                     const todayDate = new Date();\n  576 |                                     const diffTime = Math.abs(todayDate.getTime() - start.getTime());\n  577 |                                     const expectedDays = Math.max(1, Math.ceil(diffTime / (1000 * 60 * 60 * 24)));","line":574,"column":125,"nodeType":null,"endLine":574,"endColumn":135},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\TodayMissionModal.tsx:584:135\n  582 |                                     if (habit.deadline) {\n  583 |                                         const end = parseLocalDate(habit.deadline);\n> 584 |                                         const start = habit.startDate ? parseLocalDate(habit.startDate) : new Date(habit.createdAt || Date.now());\n      |                                                                                                                                       ^^^^^^^^^^ Cannot call impure function\n  585 |                                         const now = new Date();\n  586 |\n  587 |                                         // Reset all to midnight for accurate day calculation","line":584,"column":135,"nodeType":null,"endLine":584,"endColumn":145}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Reorder, useDragControls } from 'framer-motion';\r\nimport { useLocalStorage } from '../../hooks/useLocalStorage';\r\nimport React from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { BrainCircuit, CheckSquare, Target, Flag, PlayCircle, Loader2, Lock, ChevronDown, ChevronLeft, ChevronRight, Calendar as CalendarIcon, GripVertical, Save } from 'lucide-react';\r\nimport { format, parseISO, isToday as isDateToday, addDays, subDays, differenceInCalendarDays } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { cn } from '../../lib/utils';\r\n// ... rest of imports\r\n\r\n// ... sortWithOrder helper ...\r\n\r\n// Draggable Item Wrapper\r\nconst DraggableMissionItem = ({ item, children }: { item: { id: string }, children: React.ReactNode }) => {\r\n    const dragControls = useDragControls();\r\n\r\n    return (\r\n        <Reorder.Item\r\n            value={item}\r\n            dragListener={false} // Disable default drag to use handle\r\n            dragControls={dragControls}\r\n            className=\"touch-none relative\"\r\n            style={{ listStyle: 'none' }} // Remove list dots\r\n        >\r\n            <div className=\"flex items-center gap-2\">\r\n                {/* Drag Handle */}\r\n                <div\r\n                    onPointerDown={(e) => dragControls.start(e)}\r\n                    className=\"cursor-grab active:cursor-grabbing p-1.5 -ml-2 text-slate-600 hover:text-slate-400 transition-colors touch-none select-none flex items-center justify-center shrink-0\"\r\n                >\r\n                    <GripVertical className=\"w-5 h-5\" />\r\n                </div>\r\n                {/* Content */}\r\n                <div className=\"flex-1 min-w-0\">\r\n                    {children}\r\n                </div>\r\n            </div>\r\n        </Reorder.Item>\r\n    );\r\n};\r\n\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { MissionCard } from './components/MissionCard';\r\nimport { parseLocalDate } from '../../utils/dateHelpers';\r\nimport type { Priority, Review, SessionLog, Subtheme, Task, Goal } from '../../types';\r\nimport { TaskDetailsModal } from '../tasks/components/TaskDetailsModal';\r\nimport { GoalDetailsModal } from '../goals/components/GoalDetailsModal';\r\nimport { StudyContentModal } from '../themes/components/StudyContentModal';\r\n\r\ninterface ReviewItem extends Subtheme {\r\n    dueReview: Review;\r\n    themeTitle: string;\r\n    priority?: Priority;\r\n    notificationTime?: string;\r\n    isProjectStep?: boolean;\r\n    mastery?: number;\r\n    deadline?: string;\r\n    type?: string;\r\n}\r\n\r\ninterface TodayMissionModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\n// ... rest of helpers ...\r\n\r\n// Helper to get session times\r\nconst getSessionTimes = (sessions: SessionLog[] | undefined, datePrefix: string) => {\r\n    if (!sessions || sessions.length === 0) return { start: null, end: null };\r\n    const todaysSessions = sessions.filter(s => s.start && s.start.startsWith(datePrefix));\r\n\r\n    if (todaysSessions.length === 0) return { start: null, end: null };\r\n\r\n    // Use the latest one\r\n    const lastSession = todaysSessions[todaysSessions.length - 1];\r\n\r\n    try {\r\n        return {\r\n            start: format(parseISO(lastSession.start), 'HH:mm'),\r\n            end: format(parseISO(lastSession.end), 'HH:mm')\r\n        };\r\n    } catch (e) {\r\n        return { start: null, end: null };\r\n    }\r\n};\r\n\r\nconst calculateEndTime = (startTime: string | null | undefined, durationMinutes: number | undefined) => {\r\n    if (!startTime) return null;\r\n    if (!durationMinutes) return startTime;\r\n\r\n    try {\r\n        const [hours, minutes] = startTime.split(':').map(Number);\r\n        const date = new Date();\r\n        date.setHours(hours, minutes, 0, 0);\r\n        date.setMinutes(date.getMinutes() + durationMinutes);\r\n        return format(date, 'HH:mm');\r\n    } catch (e) {\r\n        return startTime;\r\n    }\r\n};\r\n\r\n// Helper to sort items based on ID list\r\nconst sortWithOrder = <T extends { id: string }>(items: T[], order: string[]): T[] => {\r\n    if (!order || order.length === 0) return items;\r\n\r\n    // Create a map for O(1) lookup of order index\r\n    const orderMap = new Map(order.map((id, index) => [id, index]));\r\n\r\n    return [...items].sort((a, b) => {\r\n        const indexA = orderMap.get(a.id);\r\n        const indexB = orderMap.get(b.id);\r\n\r\n        // If both exist, sort by index\r\n        if (indexA !== undefined && indexB !== undefined) return indexA - indexB;\r\n\r\n        // If only one exists, the existing one comes first\r\n        if (indexA !== undefined) return -1;\r\n        if (indexB !== undefined) return 1;\r\n\r\n        // If neither exists, maintain original relative order (stable sort fallback) or simple compare\r\n        return 0;\r\n    });\r\n};\r\n\r\nconst priorityValue = (p?: Priority) => {\r\n    switch (p) {\r\n        case 'high': return 3;\r\n        case 'medium': return 2;\r\n        case 'low': return 1;\r\n        default: return 0;\r\n    }\r\n};\r\n\r\nconst PriorityIcon = ({ priority }: { priority?: Priority }) => {\r\n    if (!priority) return null;\r\n    const color = priority === 'high' ? 'text-red-500' : priority === 'medium' ? 'text-amber-500' : 'text-emerald-500';\r\n    return <Flag className={`w-3 h-3 ${color} fill-current`} />;\r\n};\r\n\r\nexport const TodayMissionModal: React.FC<TodayMissionModalProps> = ({ isOpen, onClose }) => {\r\n    const { themes, tasks, goals, startFocus, activeFocus, endFocus, toggleTask, toggleGoal, completeReview } = useStudy();\r\n    const { startFocusSession, resetTimer } = usePomodoroContext();\r\n    const isProcessingRef = React.useRef(false);\r\n    const [loadingItemId, setLoadingItemId] = React.useState<string | null>(null);\r\n\r\n    // --- DRAG AND DROP STATE ---\r\n    const [habitOrder, setHabitOrder] = useLocalStorage<string[]>('mission_habit_order', []);\r\n    const [reviewOrder, setReviewOrder] = useLocalStorage<string[]>('mission_review_order', []);\r\n    const [taskOrder, setTaskOrder] = useLocalStorage<string[]>('mission_task_order', []);\r\n\r\n    const [orderedHabits, setOrderedHabits] = React.useState<Goal[]>([]);\r\n    const [orderedReviews, setOrderedReviews] = React.useState<ReviewItem[]>([]);\r\n    const [orderedTasks, setOrderedTasks] = React.useState<Task[]>([]);\r\n\r\n    // State for selected date\r\n    const [selectedDate, setSelectedDate] = React.useState(new Date());\r\n    const today = format(selectedDate, 'yyyy-MM-dd'); // This represents the VIEWED date\r\n    const isToday = isDateToday(selectedDate);\r\n\r\n    // Strict Date Locking Logic\r\n    const realTodayStr = format(new Date(), 'yyyy-MM-dd');\r\n    const isFutureContext = today > realTodayStr;\r\n\r\n    // Navigation handlers\r\n    const handlePreviousDay = () => {\r\n        setSelectedDate(prev => subDays(prev, 1));\r\n    };\r\n\r\n    const handleNextDay = () => {\r\n        setSelectedDate(prev => addDays(prev, 1));\r\n    };\r\n\r\n    const handleToday = () => {\r\n        setSelectedDate(new Date());\r\n    };\r\n\r\n    const handleStartFocus = (id: string, type: 'task' | 'goal' | 'subtheme', title: string, duration?: number, reviewNumber?: number, reviewType?: 'review' | 'intro') => {\r\n        // Prevent clicking strict future items or rapid double clicks\r\n        if (isProcessingRef.current || loadingItemId || isFutureContext) return;\r\n\r\n        // If clicking the SAME item that is active, ignore (or maybe toggle? lets just ignore to prevent restart loop)\r\n        if (activeFocus?.id === id) return;\r\n\r\n        // If there is ANOTHER active focus, we implicitly switch (cancel previous)\r\n        if (activeFocus) {\r\n            // Optional: could ask confirmation, but for \"snappy\" feel, auto-switch is better or just overwrite.\r\n            // endFocus(false) cleans up previous state properly\r\n            endFocus(false);\r\n            resetTimer();\r\n        }\r\n\r\n        isProcessingRef.current = true;\r\n        setLoadingItemId(id);\r\n\r\n        startFocus(id, type, title, duration || 25, reviewNumber, reviewType);\r\n        startFocusSession(id, duration || 25);\r\n\r\n        // Clear loading status quickly (snappy feel) but keep debounce slightly\r\n        setTimeout(() => {\r\n            if (isProcessingRef.current) {\r\n                isProcessingRef.current = false;\r\n                setLoadingItemId(null);\r\n            }\r\n        }, 300);\r\n    };\r\n\r\n    const handleStopFocus = () => {\r\n        if (confirm('Deseja cancelar o foco atual?')) {\r\n            endFocus(false);\r\n            resetTimer();\r\n        }\r\n    };\r\n\r\n    // 1. Tasks - Show Pending OR Completed Today\r\n    const dueTasks = tasks\r\n        .filter(t => {\r\n            // Include ALL pending tasks\r\n            if (t.status === 'pending') {\r\n                if (t.date && t.date > today) return false;\r\n                if (t.startDate && t.startDate > today) return false;\r\n                return true;\r\n            }\r\n\r\n            // VISIBILITY CHECK: Only show if start date is within 3 days of REAL today\r\n            const taskDate = t.startDate || t.date;\r\n            if (taskDate) {\r\n                const daysUntilStart = differenceInCalendarDays(parseISO(taskDate), new Date());\r\n                if (daysUntilStart > 3) return false;\r\n            }\r\n\r\n            // Include completed tasks if they were done TODAY or were scheduled for TODAY\r\n            if (t.status === 'completed') {\r\n                const completedToday = t.completionHistory?.some((d: string) => d.startsWith(today));\r\n                if (completedToday) return true;\r\n                if (t.date === today) return true;\r\n                if (t.type === 'period' && t.endDate === today) return true;\r\n            }\r\n\r\n            return false;\r\n        })\r\n        .sort((a, b) => {\r\n            const isOverdueA = a.status === 'pending' && ((a.date && a.date < today) || (a.endDate && a.endDate < today));\r\n            const isOverdueB = b.status === 'pending' && ((b.date && b.date < today) || (b.endDate && b.endDate < today));\r\n\r\n            if (isOverdueA && !isOverdueB) return -1;\r\n            if (!isOverdueA && isOverdueB) return 1;\r\n\r\n            return priorityValue(b.priority) - priorityValue(a.priority);\r\n        });\r\n\r\n    // 2. Goals - Show ALL non-completed goals\r\n    const dayOfWeek = new Date().getDay();\r\n    const habits = goals\r\n        .filter(g => {\r\n            if (g.progress === 100) return false;\r\n\r\n            const habitStart = g.startDate || g.createdAt;\r\n            if (habitStart) {\r\n                let startObj = typeof habitStart === 'string' && habitStart.includes('T') === false ? parseISO(habitStart) : new Date(habitStart);\r\n                if (isNaN(startObj.getTime())) {\r\n                    startObj = new Date(habitStart);\r\n                }\r\n\r\n                if (!isNaN(startObj.getTime())) {\r\n                    const daysUntilStart = differenceInCalendarDays(startObj, new Date());\r\n                    if (daysUntilStart > 3) return false;\r\n                }\r\n            }\r\n\r\n            if (g.type === 'habit') {\r\n                if (g.recurrence && g.recurrence.length > 0) {\r\n                    return g.recurrence.includes(dayOfWeek);\r\n                }\r\n                return true;\r\n            }\r\n            return true;\r\n        })\r\n        .sort((a, b) => {\r\n            const isOverdueA = a.deadline && a.deadline < today;\r\n            const isOverdueB = b.deadline && b.deadline < today;\r\n\r\n            if (isOverdueA && !isOverdueB) return -1;\r\n            if (!isOverdueA && isOverdueB) return 1;\r\n\r\n            return priorityValue(b.priority) - priorityValue(a.priority);\r\n        });\r\n\r\n    // 3. Themes (SRS Reviews & Projects)\r\n    const dueReviews = themes.flatMap(t => {\r\n        if (t.category === 'project') {\r\n            const nextStep = t.subthemes.find(st => st.status !== 'completed');\r\n            if (nextStep) {\r\n                return [{\r\n                    ...nextStep,\r\n                    dueReview: { number: 1, date: today, status: 'pending' as const },\r\n                    themeTitle: t.title,\r\n                    priority: t.priority,\r\n                    notificationTime: t.notificationTime,\r\n                    isProjectStep: true\r\n                }];\r\n            }\r\n            return [];\r\n        }\r\n\r\n        const pendingSubthemes = t.subthemes.map(st => {\r\n            // Find review due today (pending) OR completed today\r\n            const due = st.reviews.find(r =>\r\n                (r.date <= today && r.status === 'pending') ||\r\n                (r.date === today && r.status === 'completed')\r\n            );\r\n\r\n            // Allow introductions that are today OR in the past if still in queue/pending status\r\n            const isIntroTodayOrOverdue = st.introductionDate && st.introductionDate <= today;\r\n\r\n            if (due) {\r\n                return { ...st, dueReview: due, themeTitle: t.title, priority: t.priority, notificationTime: t.notificationTime };\r\n            }\r\n\r\n            // Fallback for new items (Intro)\r\n            if (isIntroTodayOrOverdue && st.status !== 'completed' && !st.reviews.some(r => r.date === today && r.status === 'completed')) {\r\n                return {\r\n                    ...st,\r\n                    dueReview: { number: 0, date: today, status: 'pending' as const },\r\n                    themeTitle: t.title,\r\n                    priority: t.priority,\r\n                    notificationTime: t.notificationTime\r\n                };\r\n            }\r\n            return null;\r\n        }).filter((item): item is NonNullable<typeof item> => item !== null);\r\n\r\n        if (pendingSubthemes.length === 0 && t.subthemes.length > 0) {\r\n            const first = t.subthemes[0];\r\n            if (!first.introductionDate) {\r\n                return [{\r\n                    ...first,\r\n                    dueReview: { number: 0, date: today, status: 'pending' as const },\r\n                    themeTitle: t.title,\r\n                    priority: t.priority,\r\n                    notificationTime: t.notificationTime\r\n                }];\r\n            }\r\n        }\r\n\r\n        return pendingSubthemes.filter(item => {\r\n            const reviewDate = item.dueReview.date;\r\n            if (reviewDate) {\r\n                const daysUntilReview = differenceInCalendarDays(parseISO(reviewDate), new Date());\r\n                if (daysUntilReview > 3) return false;\r\n            }\r\n            return true;\r\n        });\r\n    })\r\n        .sort((a, b) => {\r\n            const isOverdueA = a.dueReview && a.dueReview.date < today;\r\n            const isOverdueB = b.dueReview && b.dueReview.date < today;\r\n\r\n            if (isOverdueA && !isOverdueB) return -1;\r\n            if (!isOverdueA && isOverdueB) return 1;\r\n\r\n            return priorityValue(b.priority) - priorityValue(a.priority);\r\n        });\r\n\r\n    // Deduplicate Reviews by ID to prevent multiple cards for same subtheme\r\n    const uniqueDueReviews = Array.from(new Map(dueReviews.map(item => [item.id, item])).values());\r\n\r\n    // Deduplicate Tasks\r\n    const uniqueDueTasks = Array.from(new Map(dueTasks.map(item => [item.id, item])).values());\r\n\r\n    const hasItems = uniqueDueTasks.length > 0 || habits.length > 0 || uniqueDueReviews.length > 0;\r\n\r\n    // --- SYNC & SORTING EFFECTS ---\r\n    React.useEffect(() => {\r\n        setOrderedHabits(sortWithOrder(habits, habitOrder));\r\n    }, [habits, habitOrder]);\r\n\r\n    React.useEffect(() => {\r\n        setOrderedReviews(sortWithOrder(uniqueDueReviews, reviewOrder));\r\n    }, [uniqueDueReviews, reviewOrder]);\r\n\r\n    React.useEffect(() => {\r\n        setOrderedTasks(sortWithOrder(uniqueDueTasks, taskOrder));\r\n    }, [uniqueDueTasks, taskOrder]);\r\n\r\n    const handleReorderHabits = (newOrder: Goal[]) => {\r\n        setOrderedHabits(newOrder);\r\n        setHabitOrder(newOrder.map(h => h.id));\r\n    };\r\n\r\n    const handleReorderReviews = (newOrder: ReviewItem[]) => {\r\n        setOrderedReviews(newOrder);\r\n        setReviewOrder(newOrder.map(r => r.id));\r\n    };\r\n\r\n    const handleReorderTasks = (newOrder: Task[]) => {\r\n        setOrderedTasks(newOrder);\r\n        setTaskOrder(newOrder.map(t => t.id));\r\n    };\r\n\r\n    const SectionBox = ({ title, icon: Icon, count, children }: { title: string; icon: React.ElementType; colorClass?: string; count: number; children: React.ReactNode }) => (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between px-1 border-l-2 border-slate-700 pl-3\">\r\n                <h3 className=\"text-xs font-bold uppercase tracking-widest text-slate-400\">\r\n                    {title}\r\n                </h3>\r\n                <div className=\"w-5 h-5 rounded-full bg-slate-800 flex items-center justify-center text-[10px] font-bold text-slate-400 border border-slate-700\">\r\n                    {count}\r\n                </div>\r\n            </div>\r\n            <div className=\"space-y-3\">\r\n                {children}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    // Calculate Progress\r\n    const todaysReviews = themes.flatMap(t =>\r\n        t.subthemes.flatMap(st => st.reviews.filter(r => r.date === today))\r\n    );\r\n\r\n    const totalReviewsCount = todaysReviews.length;\r\n    const completedReviewsCount = todaysReviews.filter(r => r.status === 'completed').length;\r\n\r\n    const score = totalReviewsCount > 0\r\n        ? Math.round((completedReviewsCount / totalReviewsCount) * 100)\r\n        : hasItems ? 0 : 100;\r\n\r\n    const getPeriodProgress = (item: Task | Goal, type: 'task' | 'goal') => {\r\n        if (type === 'task') {\r\n            if (item.type !== 'period' || !item.startDate || !item.endDate) return null;\r\n            const start = new Date(item.startDate);\r\n            const end = new Date(item.endDate);\r\n            const now = new Date();\r\n            const totalDays = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n            const currentDay = Math.max(1, Math.ceil((now.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n            const day = Math.min(currentDay, totalDays);\r\n            return `${day}/${totalDays}`;\r\n        }\r\n        if (type === 'goal') {\r\n            const goal = item as Goal;\r\n            if (!goal.deadline) return null;\r\n            const start = new Date(goal.createdAt || Date.now());\r\n            const end = new Date(goal.deadline);\r\n            const now = new Date();\r\n            const totalDays = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n            const currentDay = Math.max(1, Math.ceil((now.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n            const day = Math.min(currentDay, totalDays);\r\n            return totalDays > 1 ? `${day}/${totalDays}` : null;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    // --- COMPLETION SUMMARY STATE ---\r\n    const [completionItem, setCompletionItem] = React.useState<{\r\n        id: string;\r\n        title: string;\r\n        onConfirm: (summary: string) => void;\r\n    } | null>(null);\r\n    const [summaryText, setSummaryText] = React.useState('');\r\n\r\n    // --- DETAIL MODALS STATE ---\r\n    const [selectedTask, setSelectedTask] = React.useState<Task | null>(null);\r\n    const [selectedGoal, setSelectedGoal] = React.useState<Goal | null>(null);\r\n    const [selectedSubtheme, setSelectedSubtheme] = React.useState<Subtheme | null>(null);\r\n\r\n    const handleOpenDetails = (id: string, type: 'task' | 'goal' | 'subtheme') => {\r\n        if (type === 'task') {\r\n            const task = tasks.find(t => t.id === id);\r\n            if (task) setSelectedTask(task);\r\n        } else if (type === 'goal') {\r\n            const goal = goals.find(g => g.id === id);\r\n            if (goal) setSelectedGoal(goal);\r\n        } else if (type === 'subtheme') {\r\n            const subtheme = themes.flatMap(t => t.subthemes).find(st => st.id === id);\r\n            if (subtheme) setSelectedSubtheme(subtheme);\r\n        }\r\n    };\r\n\r\n    const requestCompletion = (id: string, title: string, onConfirm: (s: string) => void) => {\r\n        setCompletionItem({ id, title, onConfirm });\r\n        setSummaryText('');\r\n    };\r\n\r\n    const confirmCompletion = () => {\r\n        if (completionItem) {\r\n            completionItem.onConfirm(summaryText);\r\n            setCompletionItem(null);\r\n        }\r\n    };\r\n\r\n    const skipSummary = () => {\r\n        if (completionItem) {\r\n            completionItem.onConfirm(''); // Empty string = no summary (standard completion)\r\n            setCompletionItem(null);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\">\r\n            <div className=\"space-y-5 px-4 mt-6 relative min-h-[500px]\">\r\n                {/* Header Section */}\r\n                <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between px-2\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 rounded-xl bg-blue-500/10 border border-blue-500/20 flex items-center justify-center\">\r\n                                <Target className=\"w-5 h-5 text-blue-400\" />\r\n                            </div>\r\n                            <h2 className=\"text-xl font-bold text-white\">Sua Misso</h2>\r\n                        </div>\r\n                        <div className=\"flex flex-col items-end\">\r\n                            <span className=\"text-[10px] uppercase font-bold text-slate-500 tracking-wider\">Progresso</span>\r\n                            <span className=\"text-xl font-black text-blue-400\">{score}%</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between py-2 border-t border-white/5 border-b mb-6\">\r\n                        <button onClick={handlePreviousDay} className=\"p-2 text-slate-500 hover:text-white transition-colors\">\r\n                            <ChevronLeft className=\"w-5 h-5\" />\r\n                        </button>\r\n\r\n                        <div className=\"flex flex-col items-center\">\r\n                            <span className=\"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-0.5\">\r\n                                {isToday ? 'HOJE' : format(selectedDate, 'EEEE', { locale: ptBR })}\r\n                            </span>\r\n                            <div className=\"flex items-center gap-2 text-slate-200\">\r\n                                <CalendarIcon className=\"w-4 h-4 text-slate-400\" />\r\n                                <span className=\"font-bold text-lg capitalize\">{format(selectedDate, 'd \\'de\\' MMMM', { locale: ptBR })}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button onClick={handleNextDay} className=\"p-2 text-slate-500 hover:text-white transition-colors\">\r\n                            <ChevronRight className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"h-1.5 bg-slate-800 rounded-full overflow-hidden w-full mb-6\">\r\n                        <div\r\n                            className=\"h-full bg-gradient-to-r from-blue-600 to-emerald-400 transition-all duration-1000\"\r\n                            style={{ width: `${score}%` }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 1. Hbitos & Rotina */}\r\n                {orderedHabits.length > 0 && (\r\n                    <div className=\"border-t border-blue-500/10 pt-4\">\r\n                        <SectionBox title=\"HBITOS & ROTINA\" icon={Target} colorClass=\"text-orange-400\" count={orderedHabits.length}>\r\n                            <Reorder.Group axis=\"y\" values={orderedHabits} onReorder={handleReorderHabits} className=\"space-y-3\">\r\n                                {orderedHabits.map((habit) => {\r\n                                    const isCompletedToday = habit.completionHistory?.some((d: string) => d.startsWith(today));\r\n                                    const isItemOptimistic = completionItem?.id === habit.id;\r\n                                    const isChecked = isCompletedToday || habit.progress === 100 || isItemOptimistic;\r\n                                    const isBlocked = isFutureContext;\r\n                                    const sessionTimes = getSessionTimes(habit.sessions, today);\r\n\r\n                                    let daysElapsed: number | undefined;\r\n                                    let daysRemaining: number | undefined;\r\n\r\n                                    if (habit.completionHistory && habit.completionHistory.length > 0) {\r\n                                        daysElapsed = habit.completionHistory.length;\r\n                                    }\r\n\r\n                                    if (habit.deadline) {\r\n                                        const end = parseLocalDate(habit.deadline);\r\n                                        const now = new Date();\r\n                                        now.setHours(0, 0, 0, 0); // Reset to midnight\r\n                                        end.setHours(0, 0, 0, 0); // Reset to midnight\r\n                                        const totalDays = Math.max(0, Math.ceil((end.getTime() - now.getTime()) / (1000 * 60 * 60 * 24)));\r\n                                        daysRemaining = totalDays;\r\n                                    }\r\n\r\n                                    const start = habit.startDate ? new Date(habit.startDate) : new Date(habit.createdAt || Date.now());\r\n                                    const todayDate = new Date();\r\n                                    const diffTime = Math.abs(todayDate.getTime() - start.getTime());\r\n                                    const expectedDays = Math.max(1, Math.ceil(diffTime / (1000 * 60 * 60 * 24)));\r\n                                    const progressTotal = habit.deadline ? expectedDays : (habit.completionHistory?.length || 0) + 1;\r\n\r\n                                    let timeCurrent: number | undefined;\r\n                                    let timeTotal: number | undefined;\r\n                                    if (habit.deadline) {\r\n                                        const end = parseLocalDate(habit.deadline);\r\n                                        const start = habit.startDate ? parseLocalDate(habit.startDate) : new Date(habit.createdAt || Date.now());\r\n                                        const now = new Date();\r\n\r\n                                        // Reset all to midnight for accurate day calculation\r\n                                        end.setHours(0, 0, 0, 0);\r\n                                        start.setHours(0, 0, 0, 0);\r\n                                        now.setHours(0, 0, 0, 0);\r\n\r\n                                        timeTotal = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n                                        timeCurrent = Math.max(0, Math.min(timeTotal, Math.ceil((now.getTime() - start.getTime()) / (1000 * 60 * 60 * 24))));\r\n                                    }\r\n\r\n                                    return (\r\n                                        <DraggableMissionItem key={habit.id} item={habit}>\r\n                                            <MissionCard\r\n                                                id={habit.id}\r\n                                                title={habit.title}\r\n                                                icon={habit.icon || \"\"}\r\n                                                type=\"habit\"\r\n                                                isCompleted={isChecked}\r\n                                                isBlocked={isBlocked}\r\n                                                actualStartTime={isChecked ? sessionTimes.start : null}\r\n                                                actualEndTime={isChecked ? sessionTimes.end : null}\r\n                                                daysElapsed={daysElapsed}\r\n                                                daysRemaining={daysRemaining}\r\n                                                startDate={habit.startDate}\r\n                                                endDate={habit.deadline}\r\n                                                progressCurrent={habit.completionHistory?.length || 0}\r\n                                                progressTotal={progressTotal}\r\n                                                timeCurrent={timeCurrent}\r\n                                                timeTotal={timeTotal}\r\n                                                onFocus={() => handleStartFocus(habit.id, 'goal', habit.title, habit.durationMinutes)}\r\n                                                isActive={activeFocus?.id === habit.id}\r\n                                                isLoading={loadingItemId === habit.id}\r\n                                                onToggle={() => {\r\n                                                    const action = (s?: string) => {\r\n                                                        if (habit.type === 'habit') {\r\n                                                            toggleGoal(habit.id, today, s);\r\n                                                        } else {\r\n                                                            toggleGoal(habit.id, undefined, s);\r\n                                                        }\r\n                                                    };\r\n\r\n                                                    if (isChecked && !isItemOptimistic) {\r\n                                                        action();\r\n                                                    } else {\r\n                                                        requestCompletion(habit.id, habit.title, action);\r\n                                                    }\r\n                                                }}\r\n                                                onOpenDetails={() => handleOpenDetails(habit.id, 'goal')}\r\n                                            >\r\n                                                <PriorityIcon priority={habit.priority} />\r\n                                            </MissionCard>\r\n                                        </DraggableMissionItem>\r\n                                    );\r\n                                })}\r\n                            </Reorder.Group>\r\n                        </SectionBox>\r\n                    </div>\r\n                )}\r\n\r\n                {/* 2. Revises & Estudos */}\r\n                {orderedReviews.length > 0 && (\r\n                    <div className=\"border-t border-blue-500/10 pt-4\">\r\n                        <SectionBox title=\"REVISES & ESTUDOS\" icon={BrainCircuit} colorClass=\"text-emerald-400\" count={orderedReviews.length}>\r\n                            <Reorder.Group axis=\"y\" values={orderedReviews} onReorder={handleReorderReviews} className=\"space-y-3\">\r\n                                {orderedReviews.map((item: ReviewItem) => {\r\n                                    const reviewNum = item.dueReview.number || 0;\r\n                                    const level = Math.min(5, Math.floor(reviewNum / 2) + 1);\r\n                                    const domain = item.mastery ? Math.round(item.mastery * 100) : 0;\r\n                                    const sessionTimes = getSessionTimes(item.sessions, today);\r\n                                    const isItemOptimistic = completionItem?.id === item.id;\r\n                                    const isCompleted = item.dueReview.status === 'completed' || isItemOptimistic;\r\n\r\n                                    return (\r\n                                        <DraggableMissionItem key={item.id} item={item}>\r\n                                            <MissionCard\r\n                                                id={item.id}\r\n                                                title={item.title}\r\n                                                icon=\"\"\r\n                                                type=\"review\"\r\n                                                isCompleted={isCompleted}\r\n                                                isBlocked={isFutureContext}\r\n                                                actualStartTime={sessionTimes.start || item.notificationTime}\r\n                                                actualEndTime={(item.dueReview.status === 'completed' ? sessionTimes.end : null) || calculateEndTime(item.notificationTime, item.durationMinutes)}\r\n                                                level={`${level}/5`}\r\n                                                domain={domain}\r\n                                                startDate={item.introductionDate}\r\n                                                endDate={item.deadline}\r\n                                                progressCurrent={item.reviews.filter((r: Review) => r.status === 'completed').length}\r\n                                                progressTotal={item.reviews.length}\r\n                                                schedule={item.reviews}\r\n                                                onFocus={() => handleStartFocus(item.id, 'subtheme', item.title, item.durationMinutes, item.dueReview.number, (item.type as 'review' | 'intro') || 'review')}\r\n                                                isActive={activeFocus?.id === item.id}\r\n                                                isLoading={loadingItemId === item.id}\r\n                                                onToggle={() => {\r\n                                                    const action = (s?: string) => completeReview(item.id, item.dueReview.number, (item.type as 'review' | 'intro') || 'review', 'medium', s);\r\n                                                    if (isCompleted && !isItemOptimistic) {\r\n                                                        action();\r\n                                                    } else {\r\n                                                        requestCompletion(item.id, item.title, action);\r\n                                                    }\r\n                                                }}\r\n                                                onOpenDetails={() => handleOpenDetails(item.id, 'subtheme')}\r\n                                            >\r\n                                                <PriorityIcon priority={item.priority} />\r\n                                            </MissionCard>\r\n                                        </DraggableMissionItem>\r\n                                    );\r\n                                })}\r\n                            </Reorder.Group>\r\n                        </SectionBox>\r\n                    </div>\r\n                )}\r\n\r\n                {/* 3. Tarefas & Misses */}\r\n                {orderedTasks.length > 0 && (\r\n                    <div className=\"border-t border-blue-500/10 pt-4\">\r\n                        <SectionBox title=\"TAREFAS & MISSES\" icon={CheckSquare} colorClass=\"text-blue-400\" count={orderedTasks.length}>\r\n                            <Reorder.Group axis=\"y\" values={orderedTasks} onReorder={handleReorderTasks} className=\"space-y-3\">\r\n                                {orderedTasks.map((task) => {\r\n                                    const isCompletedToday = task.type === 'day' ? task.status === 'completed' : (task.completionHistory?.some((d: string) => d.startsWith(today)) ?? false);\r\n                                    const isItemOptimistic = completionItem?.id === task.id;\r\n                                    const isChecked = isCompletedToday || isItemOptimistic;\r\n                                    const isBlocked = isFutureContext;\r\n                                    const sessionTimes = getSessionTimes(task.sessions, today);\r\n\r\n                                    let timeCurrent: number | undefined;\r\n                                    let timeTotal: number | undefined;\r\n                                    if (task.type === 'period' && task.startDate && task.endDate) {\r\n                                        const start = new Date(task.startDate);\r\n                                        const end = new Date(task.endDate);\r\n                                        const now = new Date();\r\n                                        timeTotal = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n                                        timeCurrent = Math.max(0, Math.min(timeTotal, Math.ceil((now.getTime() - start.getTime()) / (1000 * 60 * 60 * 24))));\r\n                                    }\r\n\r\n                                    return (\r\n                                        <DraggableMissionItem key={task.id} item={task}>\r\n                                            <MissionCard\r\n                                                id={task.id}\r\n                                                title={task.title}\r\n                                                icon=\"\"\r\n                                                type=\"task\"\r\n                                                isCompleted={isChecked}\r\n                                                isBlocked={isBlocked}\r\n                                                actualStartTime={isChecked ? sessionTimes.start : task.notificationTime}\r\n                                                actualEndTime={isChecked ? sessionTimes.end : calculateEndTime(task.notificationTime, task.durationMinutes)}\r\n                                                startDate={task.startDate || task.date}\r\n                                                endDate={task.endDate || task.date}\r\n                                                progressCurrent={'progress' in task && task.progress ? task.progress.current : (task.status === 'completed' ? 1 : 0)}\r\n                                                progressTotal={'progress' in task && task.progress ? (task.progress.total || 1) : 1}\r\n                                                timeCurrent={timeCurrent}\r\n                                                timeTotal={timeTotal}\r\n                                                onFocus={() => handleStartFocus(task.id, 'task', task.title, task.durationMinutes)}\r\n                                                isActive={activeFocus?.id === task.id}\r\n                                                isLoading={loadingItemId === task.id}\r\n                                                onToggle={() => {\r\n                                                    const action = (s?: string) => toggleTask(task.id, today, s);\r\n                                                    if (isChecked && !isItemOptimistic) action();\r\n                                                    else requestCompletion(task.id, task.title, action);\r\n                                                }}\r\n                                                onOpenDetails={() => handleOpenDetails(task.id, 'task')}\r\n                                            >\r\n                                                <PriorityIcon priority={task.priority} />\r\n                                            </MissionCard>\r\n                                        </DraggableMissionItem>\r\n                                    );\r\n                                })}\r\n                            </Reorder.Group>\r\n                        </SectionBox>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Completion Modal Overlay */}\r\n                {completionItem && (\r\n                    <div className=\"absolute inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm rounded-[2rem] animate-in fade-in duration-200\">\r\n                        <div className=\"bg-slate-800 border border-slate-700 p-6 rounded-2xl w-full max-w-sm shadow-2xl relative animate-in zoom-in-95 duration-200\">\r\n                            <div className=\"flex items-center gap-3 mb-4\">\r\n                                <div className=\"p-2 bg-emerald-500/10 rounded-lg text-emerald-400\">\r\n                                    <CheckSquare className=\"w-5 h-5\" />\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"text-lg font-bold text-white\">Concluir Misso</h3>\r\n                                    <p className=\"text-xs text-slate-400 line-clamp-1\">{completionItem.title}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <p className=\"text-slate-300 text-sm mb-3\">O que voc aprendeu ou realizou?</p>\r\n\r\n                            <textarea\r\n                                value={summaryText}\r\n                                onChange={e => setSummaryText(e.target.value)}\r\n                                className=\"w-full h-24 bg-slate-900 border border-slate-700 rounded-xl p-3 text-white text-sm resize-none focus:ring-2 focus:ring-blue-500 outline-none mb-4 placeholder:text-slate-600\"\r\n                                placeholder=\"Adicione um resumo (opcional)...\"\r\n                                autoFocus\r\n                            />\r\n\r\n                            <div className=\"flex gap-3\">\r\n                                <button\r\n                                    onClick={skipSummary}\r\n                                    className=\"flex-1 py-3 text-slate-400 font-bold hover:text-white hover:bg-white/5 rounded-xl transition-colors text-sm\"\r\n                                >\r\n                                    Pular\r\n                                </button>\r\n                                <button\r\n                                    onClick={confirmCompletion}\r\n                                    className=\"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg shadow-blue-500/20 transition-all active:scale-95 flex items-center justify-center gap-2 text-sm\"\r\n                                >\r\n                                    <Save className=\"w-4 h-4\" />\r\n                                    Salvar\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Task Details Modal */}\r\n            <TaskDetailsModal\r\n                isOpen={!!selectedTask}\r\n                onClose={() => setSelectedTask(null)}\r\n                task={selectedTask}\r\n            />\r\n\r\n            {/* Goal Details Modal */}\r\n            <GoalDetailsModal\r\n                isOpen={!!selectedGoal}\r\n                onClose={() => setSelectedGoal(null)}\r\n                goal={selectedGoal}\r\n            />\r\n\r\n            {/* Subtheme Details Modal */}\r\n            <StudyContentModal\r\n                isOpen={!!selectedSubtheme}\r\n                onClose={() => setSelectedSubtheme(null)}\r\n                subtheme={selectedSubtheme!}\r\n            />\r\n        </Modal >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\TodayMissionWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\__tests__\\MissionItem.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\AchievementsSummaryWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cn' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3544,3547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3544,3547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Trophy, Star, Lock, ChevronRight } from 'lucide-react';\r\nimport { ACHIEVEMENTS_LIST } from '../../../config/gamification';\r\nimport type { Achievement } from '../../../types/gamification';\r\nimport * as Icons from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\n\r\ninterface AchievementsSummaryWidgetProps {\r\n    unlockedAchievements: Achievement[];\r\n    onNavigate: (tab: string) => void;\r\n}\r\n\r\nexport const AchievementsSummaryWidget: React.FC<AchievementsSummaryWidgetProps> = ({ unlockedAchievements, onNavigate }) => {\r\n    const totalCount = ACHIEVEMENTS_LIST.length;\r\n    const unlockedCount = unlockedAchievements.length;\r\n\r\n    // Get last 3 unlocked in reverse chronological order\r\n    const recentAchievements = [...unlockedAchievements]\r\n        .sort((a, b) => new Date(b.unlockedAt || 0).getTime() - new Date(a.unlockedAt || 0).getTime())\r\n        .slice(0, 3);\r\n\r\n    // Fill with locked if empty? No, just show what we have.\r\n\r\n    return (\r\n        <div className=\"bg-gradient-to-br from-slate-900/50 via-slate-900/40 to-slate-950/50 backdrop-blur-md border border-white/10 rounded-3xl p-5 shadow-2xl relative overflow-hidden group/achievements\">\r\n            {/* Ambient Lighting */}\r\n            <div className=\"absolute top-0 right-0 w-32 h-32 bg-yellow-500/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none\" />\r\n            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-yellow-500/60 via-orange-500/60 to-transparent opacity-60\" />\r\n\r\n            <div className=\"relative z-10\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"p-1.5 rounded-lg bg-yellow-500/10 ring-1 ring-yellow-500/20\">\r\n                            <Trophy className=\"w-4 h-4 text-yellow-500\" />\r\n                        </div>\r\n                        <h3 className=\"font-bold text-white text-base tracking-tight\">Conquistas</h3>\r\n                    </div>\r\n                    <span className=\"text-[10px] font-black text-yellow-500/80 bg-yellow-500/10 px-2 py-0.5 rounded border border-yellow-500/20\">\r\n                        {unlockedCount}/{totalCount}\r\n                    </span>\r\n                </div>\r\n\r\n                {/* Progress Bar (Radial or linear?) Let's go linear for a compact widget */}\r\n                <div className=\"mb-6\">\r\n                    <div className=\"flex justify-between text-[10px] text-slate-500 uppercase font-bold tracking-widest mb-1.5\">\r\n                        <span>Minhas Medalhas</span>\r\n                        <span>{Math.round((unlockedCount / totalCount) * 100)}%</span>\r\n                    </div>\r\n                    <div className=\"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden border border-white/5 p-[1px]\">\r\n                        <div\r\n                            className=\"h-full bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full transition-all duration-1000 shadow-[0_0_10px_rgba(234,179,8,0.3)]\"\r\n                            style={{ width: `${(unlockedCount / totalCount) * 100}%` }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Recent Unlocks List */}\r\n                <div className=\"space-y-3\">\r\n                    {recentAchievements.length > 0 ? (\r\n                        recentAchievements.map((achievement) => {\r\n                            const Icon = (Icons as any)[achievement.iconName] || Trophy;\r\n                            return (\r\n                                <div key={achievement.id} className=\"flex items-center gap-3 p-2 bg-slate-800/40 rounded-xl border border-white/5 hover:bg-slate-800/60 transition-colors\">\r\n                                    <div className=\"w-9 h-9 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center shrink-0 shadow-lg\">\r\n                                        <Icon className=\"w-5 h-5 text-white\" />\r\n                                    </div>\r\n                                    <div className=\"min-w-0\">\r\n                                        <p className=\"text-xs font-bold text-white truncate\">{achievement.title}</p>\r\n                                        <p className=\"text-[10px] text-slate-500 truncate\">{achievement.description}</p>\r\n                                    </div>\r\n                                    <Star className=\"w-3 h-3 text-yellow-500 ml-auto fill-yellow-500\" />\r\n                                </div>\r\n                            );\r\n                        })\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center py-4 bg-slate-800/20 rounded-2xl border border-dashed border-slate-700\">\r\n                            <Lock className=\"w-6 h-6 text-slate-600 mb-2\" />\r\n                            <p className=\"text-[10px] text-slate-500 font-medium\">Continue focado!</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* View All Button */}\r\n                <button\r\n                    onClick={() => onNavigate('analytics')}\r\n                    className=\"mt-4 w-full py-2.5 bg-slate-800/50 hover:bg-slate-800 border border-white/5 hover:border-white/10 rounded-xl text-[10px] font-bold text-slate-300 hover:text-white transition-all flex items-center justify-center gap-2 group/btn\"\r\n                >\r\n                    GALERIA DE TROFUS\r\n                    <ChevronRight className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\ActiveGoalsWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[174,177],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[174,177],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2021,2024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2021,2024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":109,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":112,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2091,2094],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2091,2094],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Target, ChevronRight, Clock } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ActiveGoalsWidgetProps {\r\n    goals: any[];\r\n    onNavigate: (tab: string) => void;\r\n}\r\n\r\nexport const ActiveGoalsWidget = ({ goals, onNavigate }: ActiveGoalsWidgetProps) => {\r\n    return (\r\n        <div className=\"bg-slate-900/40 backdrop-blur-md border border-white/5 rounded-3xl p-6 md:p-8 shadow-xl relative overflow-hidden h-full\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-6 relative z-10\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"p-2 rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400\">\r\n                        <Target className=\"w-5 h-5\" />\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold text-white\">Metas em Progresso</h3>\r\n                        <p className=\"text-slate-400 text-xs text-medium\">Continue avanando para manter o ritmo.</p>\r\n                    </div>\r\n                </div>\r\n                <button onClick={() => onNavigate('goals')} className=\"text-xs font-bold text-emerald-400 hover:text-emerald-300 flex items-center gap-1 transition-colors\">\r\n                    VER TODAS <ChevronRight className=\"w-3 h-3\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* List */}\r\n            {goals.length === 0 ? (\r\n                <div className=\"text-center py-12 border-2 border-dashed border-slate-800 rounded-2xl bg-slate-900/30\">\r\n                    <Target className=\"w-8 h-8 text-slate-600 mx-auto mb-3\" />\r\n                    <p className=\"text-slate-500\">Nenhuma meta ativa no momento.</p>\r\n                    <p className=\"text-xs text-slate-600 mt-1\">Crie uma nova meta para comear.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid grid-cols-1 gap-4\">\r\n                    {goals.filter((g: any) => g.progress < 100 && !g.relatedThemeId).slice(0, 3).map((goal: any) => (\r\n                        <div key={goal.id} className=\"group relative bg-slate-800/20 hover:bg-slate-800/50 border border-white/5 hover:border-emerald-500/30 rounded-2xl p-5 transition-all duration-300\">\r\n                            <div className=\"flex justify-between items-start mb-3 relative z-10\">\r\n                                <div className=\"flex flex-col\">\r\n                                    <h4 className=\"font-bold text-slate-200 group-hover:text-white transition-colors text-lg\">{goal.title}</h4>\r\n                                    {goal.deadline && (\r\n                                        <span className=\"text-xs text-slate-500 flex items-center gap-1 mt-1\">\r\n                                            <Clock className=\"w-3 h-3\" />\r\n                                            At {format(new Date(goal.deadline), 'dd MMM')}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <span className=\"text-xs font-bold text-slate-500 bg-slate-950/50 px-2 py-1 rounded-lg border border-slate-800 font-mono\">\r\n                                        {goal.progress}%\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"relative h-2.5 bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                                <div\r\n                                    className=\"absolute top-0 left-0 h-full bg-gradient-to-r from-emerald-600 to-teal-400 shadow-[0_0_10px_rgba(16,185,129,0.4)] transition-all duration-1000 ease-out\"\r\n                                    style={{ width: `${goal.progress}%` }}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\LeaderboardWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Trophy' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isTop3' is assigned a value but never used.","line":54,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":37}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Trophy, Medal, Crown, TrendingUp, Users } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\n\r\ninterface LeaderboardUser {\r\n    id: string;\r\n    name: string;\r\n    avatar?: string;\r\n    xp: number;\r\n    level: number;\r\n    isMe?: boolean;\r\n    trend: 'up' | 'down' | 'stable';\r\n}\r\n\r\ninterface LeaderboardWidgetProps {\r\n    userXp?: number;\r\n    userLevel?: number;\r\n}\r\n\r\nexport const LeaderboardWidget: React.FC<LeaderboardWidgetProps> = ({ userXp = 0, userLevel = 1 }) => {\r\n    // Mock Data for \"Global/Friend Rankings\" (Merged with real user data)\r\n    const competitors: LeaderboardUser[] = [\r\n        { id: '1', name: 'Alex M.', xp: 15420, level: 24, trend: 'up' as const },\r\n        { id: '2', name: 'Sarah Dr.', xp: 12850, level: 20, trend: 'stable' as const },\r\n        { id: 'me', name: 'Voc', xp: userXp, level: userLevel, isMe: true, trend: 'up' as const },\r\n        { id: '4', name: 'Gustavo K.', xp: 8200, level: 12, trend: 'down' as const },\r\n        { id: '5', name: 'Elena V.', xp: 7500, level: 11, trend: 'stable' as const },\r\n    ].sort((a, b) => b.xp - a.xp);\r\n\r\n    return (\r\n        <div className=\"bg-gradient-to-br from-slate-900/50 via-slate-900/40 to-slate-950/50 backdrop-blur-md border border-white/10 rounded-3xl p-5 shadow-2xl relative overflow-hidden group/leaderboard\">\r\n            {/* Ambient Lighting */}\r\n            <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-500/5 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none\" />\r\n            <div className=\"absolute bottom-0 left-0 w-32 h-32 bg-indigo-500/5 rounded-full blur-3xl -ml-16 -mb-16 pointer-events-none\" />\r\n\r\n            <div className=\"relative z-10\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-5\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"p-1.5 rounded-lg bg-indigo-500/10 ring-1 ring-indigo-500/20\">\r\n                            <Users className=\"w-4 h-4 text-indigo-400\" />\r\n                        </div>\r\n                        <h3 className=\"font-bold text-white text-base tracking-tight\">Ranking Global</h3>\r\n                    </div>\r\n                    <span className=\"text-[10px] font-black text-indigo-400 bg-indigo-500/10 px-2 py-0.5 rounded border border-indigo-500/20\">\r\n                        LIGA OURO\r\n                    </span>\r\n                </div>\r\n\r\n                {/* Rankings List */}\r\n                <div className=\"space-y-2\">\r\n                    {competitors.map((user, idx) => {\r\n                        const rank = idx + 1;\r\n                        const isTop3 = rank <= 3;\r\n\r\n                        return (\r\n                            <div\r\n                                key={user.id}\r\n                                className={cn(\r\n                                    \"flex items-center gap-3 p-2.5 rounded-2xl transition-all border\",\r\n                                    user.isMe\r\n                                        ? \"bg-indigo-500/10 border-indigo-500/30 scale-[1.02] shadow-lg shadow-indigo-500/10\"\r\n                                        : \"bg-slate-800/30 border-white/5 hover:border-white/10\"\r\n                                )}\r\n                            >\r\n                                {/* Rank Icon/Number */}\r\n                                <div className=\"w-6 flex justify-center shrink-0\">\r\n                                    {rank === 1 && <Crown className=\"w-4 h-4 text-yellow-500 fill-yellow-500\" />}\r\n                                    {rank === 2 && <Medal className=\"w-4 h-4 text-slate-300 fill-slate-300\" />}\r\n                                    {rank === 3 && <Medal className=\"w-4 h-4 text-amber-600 fill-amber-600\" />}\r\n                                    {rank > 3 && <span className=\"text-[10px] font-black text-slate-600\">{rank}</span>}\r\n                                </div>\r\n\r\n                                {/* Avatar */}\r\n                                <div className=\"w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center border border-white/10 shrink-0 overflow-hidden\">\r\n                                    <span className=\"text-[10px] font-bold text-white uppercase\">{user.name.substring(0, 2)}</span>\r\n                                </div>\r\n\r\n                                {/* Name & Level */}\r\n                                <div className=\"min-w-0 flex-1\">\r\n                                    <p className={cn(\r\n                                        \"text-xs font-bold truncate\",\r\n                                        user.isMe ? \"text-white\" : \"text-slate-300\"\r\n                                    )}>\r\n                                        {user.name}\r\n                                    </p>\r\n                                    <p className=\"text-[9px] text-slate-500 font-medium\">Nvel {user.level}</p>\r\n                                </div>\r\n\r\n                                {/* XP */}\r\n                                <div className=\"text-right\">\r\n                                    <p className=\"text-[10px] font-mono font-black text-white\">{user.xp.toLocaleString()}</p>\r\n                                    <p className=\"text-[8px] text-slate-600 font-bold tracking-tighter uppercase\">XP TOTAL</p>\r\n                                </div>\r\n\r\n                                {/* Trend */}\r\n                                <div className=\"ml-1\">\r\n                                    {user.trend === 'up' && <TrendingUp className=\"w-3 h-3 text-emerald-500\" />}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {/* View Full Ranking */}\r\n                <button className=\"mt-4 w-full py-2 text-[10px] font-black text-slate-500 hover:text-indigo-400 transition-colors uppercase tracking-widest border border-dashed border-slate-800 rounded-xl hover:bg-indigo-500/5 hover:border-indigo-500/20\">\r\n                    Ver Ranking Completo\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Play' is defined but never used.","line":2,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":2,"column":68,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":76},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'id' is defined but never used.","line":69,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'progressInfo' is defined but never used.","line":77,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'domainInfo' is defined but never used.","line":78,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'duration' is assigned a value but never used.","line":83,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'progressCurrent' is defined but never used.","line":86,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":86,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'progressTotal' is defined but never used.","line":87,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":18}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Lock, Play, CheckCircle2, Clock, CheckSquare, PlayCircle, Calendar, Loader2 } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport { format, isToday, isTomorrow, isYesterday } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\n\r\ninterface MissionCardProps {\r\n    id: string;\r\n    title: string;\r\n    icon: string;\r\n    type: 'habit' | 'review' | 'task';\r\n    isCompleted: boolean;\r\n    isBlocked: boolean;\r\n    actualStartTime?: string | null;\r\n    actualEndTime?: string | null;\r\n    progressInfo?: string;\r\n    domainInfo?: string;\r\n    level?: string;\r\n    domain?: number;\r\n    daysElapsed?: number;\r\n    daysRemaining?: number;\r\n    duration?: number; // Pomodoro duration in minutes\r\n    startDate?: string; // Format: YYYY-MM-DD\r\n    endDate?: string; // Format: YYYY-MM-DD\r\n    progressCurrent?: number; // How many completed\r\n    progressTotal?: number; // Total expected\r\n    timeCurrent?: number; // Days elapsed\r\n    timeTotal?: number; // Total days duration\r\n    schedule?: { number: number; date: string; status: 'completed' | 'pending' | 'projected' }[];\r\n    onFocus?: () => void;\r\n    onToggle?: () => void;\r\n    onOpenDetails?: () => void;\r\n    isActive?: boolean;\r\n    children?: React.ReactNode;\r\n    isLoading?: boolean;\r\n}\r\n\r\nconst colorSchemes = {\r\n    habit: {\r\n        gradient: 'from-slate-700 to-slate-600',\r\n        glow: 'shadow-orange-500/20',\r\n        text: 'text-orange-400',\r\n        border: 'border-slate-700/40',\r\n        bgHover: 'hover:bg-slate-800/50',\r\n        accent: 'bg-orange-500/20 border-orange-500/30',\r\n        bg: 'bg-gradient-to-br from-orange-500 to-amber-500 text-white shadow-lg shadow-orange-500/20'\r\n    },\r\n    review: {\r\n        gradient: 'from-slate-700 to-slate-600',\r\n        glow: 'shadow-emerald-500/20',\r\n        text: 'text-emerald-400',\r\n        border: 'border-slate-700/40',\r\n        bgHover: 'hover:bg-slate-800/50',\r\n        accent: 'bg-emerald-500/20 border-emerald-500/30',\r\n        bg: 'bg-gradient-to-br from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-500/20'\r\n    },\r\n    task: {\r\n        gradient: 'from-slate-700 to-slate-600',\r\n        glow: 'shadow-blue-500/20',\r\n        text: 'text-blue-400',\r\n        border: 'border-slate-700/40',\r\n        bgHover: 'hover:bg-slate-800/50',\r\n        accent: 'bg-blue-500/20 border-blue-500/30',\r\n        bg: 'bg-gradient-to-br from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/20'\r\n    }\r\n};\r\n\r\nexport const MissionCard: React.FC<MissionCardProps> = ({\r\n    id,\r\n    title,\r\n    icon,\r\n    type,\r\n    isCompleted,\r\n    isBlocked: propIsBlocked,\r\n    actualStartTime,\r\n    actualEndTime,\r\n    progressInfo,\r\n    domainInfo,\r\n    level,\r\n    domain,\r\n    daysElapsed,\r\n    daysRemaining,\r\n    duration = 25,\r\n    startDate,\r\n    endDate,\r\n    progressCurrent,\r\n    progressTotal,\r\n    timeCurrent,\r\n    timeTotal,\r\n    schedule,\r\n    onFocus,\r\n    onToggle,\r\n    onOpenDetails,\r\n    children,\r\n    isActive = false,\r\n    isLoading = false\r\n}) => {\r\n    const scheme = colorSchemes[type];\r\n    const isBlocked = propIsBlocked;\r\n\r\n    // Check if item is overdue\r\n    const now = new Date();\r\n    const isOverdue = !isCompleted && endDate && new Date(endDate + 'T23:59:59') < now;\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"relative group rounded-2xl p-4 transition-all duration-300\",\r\n                \"bg-[#0F172A] border\",\r\n                isActive\r\n                    ? \"border-rose-500/50 shadow-[0_0_15px_-3px_rgba(244,63,94,0.3)]\"\r\n                    : isOverdue\r\n                        ? \"border-red-500/70 bg-gradient-to-br from-red-900/20 to-orange-900/10 shadow-lg shadow-red-500/20\"\r\n                        : \"border-blue-900/30\",\r\n                isBlocked ? \"opacity-50 grayscale pointer-events-none select-none\" : isCompleted ? \"opacity-75 cursor-default border-emerald-500/20 bg-emerald-500/5 transition-none\" : \"hover:bg-slate-800/40 cursor-pointer\"\r\n            )}\r\n            onClick={onOpenDetails}\r\n        >\r\n            {/* Overdue glow effect */}\r\n            {isOverdue && !isCompleted && (\r\n                <div className=\"absolute top-0 right-0 p-12 bg-red-500/10 blur-[40px] rounded-full pointer-events-none animate-pulse\" />\r\n            )}\r\n            {/* Main Content Grid */}\r\n            <div className=\"flex items-start gap-4\">\r\n                {/* Icon Container */}\r\n                <div\r\n                    className={cn(\r\n                        \"w-12 h-12 rounded-xl flex items-center justify-center shrink-0\",\r\n                        isOverdue\r\n                            ? \"bg-gradient-to-br from-red-500 to-orange-600 shadow-lg shadow-red-500/30\"\r\n                            : scheme.bg,\r\n                        isBlocked ? \"bg-slate-800\" : \"\"\r\n                    )}\r\n                >\r\n                    <span className=\"text-2xl drop-shadow-md\">{icon}</span>\r\n                </div>\r\n\r\n                {/* Text Content */}\r\n                <div className=\"flex-1 min-w-0 pt-0.5\">\r\n                    <div className=\"flex items-center gap-2 mb-0.5\">\r\n                        {isOverdue && !isCompleted && (\r\n                            <span className=\"text-[8px] font-black uppercase tracking-wider px-1.5 py-0.5 rounded bg-red-500/20 text-red-400 border border-red-500/40 whitespace-nowrap animate-pulse\">\r\n                                 Atrasado\r\n                            </span>\r\n                        )}\r\n                        <h3 className={cn(\r\n                            \"text-base font-bold text-white truncate transition-colors flex-1\",\r\n                            isCompleted && \"line-through text-slate-500\",\r\n                            isOverdue && !isCompleted && \"text-red-400 font-extrabold\"\r\n                        )}>\r\n                            {title}\r\n                        </h3>\r\n                    </div>\r\n\r\n                    {/* Subtitle / Status */}\r\n                    {(actualStartTime || actualEndTime) && (\r\n                        <div className=\"inline-flex items-center gap-1.5 px-2 py-0.5 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-300 text-xs font-bold\">\r\n                            <Clock className=\"w-3 h-3\" />\r\n                            <span>\r\n                                {actualStartTime || '--:--'} - {actualEndTime || '--:--'}\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                    {!actualStartTime && (\r\n                        <p className={cn(\r\n                            \"text-xs font-bold uppercase tracking-wider\",\r\n                            isOverdue && !isCompleted ? \"text-red-500 animate-pulse\" : \"text-slate-500\"\r\n                        )}>\r\n                            {isOverdue && !isCompleted\r\n                                ? \"ATRASADO\"\r\n                                : (type === 'review' ? 'REVISAR AGORA' : 'PENDENTE')}\r\n                        </p>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Right Actions */}\r\n                <div className=\"flex items-center gap-2\" onClick={e => e.stopPropagation()}>\r\n                    {/* Play Button */}\r\n                    {!isCompleted && (\r\n                        isActive ? (\r\n                            <div className=\"h-8 px-3 rounded-full bg-rose-500/10 border border-rose-500/30 flex items-center justify-center gap-2 animate-pulse\">\r\n                                <Loader2 className=\"w-3.5 h-3.5 text-rose-400 animate-spin\" />\r\n                                <span className=\"text-[10px] font-bold text-rose-400 uppercase tracking-wider\">Focando</span>\r\n                            </div>\r\n                        ) : (\r\n                            <button\r\n                                className={cn(\r\n                                    \"w-8 h-8 rounded-full border border-slate-600 flex items-center justify-center transition-all group/btn\",\r\n                                    isLoading ? \"cursor-wait opacity-50 bg-slate-800\" : \"hover:bg-slate-700 hover:border-slate-500\"\r\n                                )}\r\n                                onClick={isLoading || isBlocked ? undefined : onFocus}\r\n                                disabled={isLoading || isBlocked}\r\n                            >\r\n                                {isLoading ? (\r\n                                    <Loader2 className=\"w-4 h-4 text-slate-400 animate-spin\" />\r\n                                ) : isBlocked ? (\r\n                                    <Lock className=\"w-4 h-4 text-slate-500\" />\r\n                                ) : (\r\n                                    <PlayCircle className=\"w-4 h-4 text-slate-400 group-hover/btn:text-white\" />\r\n                                )}\r\n                            </button>\r\n                        )\r\n                    )}\r\n                    {isCompleted && (\r\n                        <div className=\"w-8 h-8 rounded-full border border-emerald-500/30 bg-emerald-500/10 flex items-center justify-center\">\r\n                            <CheckCircle2 className=\"w-4 h-4 text-emerald-500\" />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Secondary Action (Stop or Details) */}\r\n                    {type === 'task' ? (\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); onToggle?.(); }}\r\n                            className=\"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center hover:bg-blue-500 transition-all border border-blue-400 group/btn\"\r\n                        >\r\n                            <CheckSquare className=\"w-4 h-4 text-white\" />\r\n                        </button>\r\n                    ) : (\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); onToggle?.(); }}\r\n                            className=\"w-8 h-8 rounded-full border border-slate-600 flex items-center justify-center hover:bg-slate-700 hover:border-slate-500 transition-all\"\r\n                        >\r\n                            {/* Checkbox style for non-tasks (Habits/Goals visual cue) */}\r\n                            <div className={cn(\"w-3 h-3 rounded-sm transition-colors\", isCompleted ? \"bg-emerald-500\" : \"bg-slate-400\")} />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Bottom Progress Section */}\r\n            <div className=\"mt-4 space-y-2\">\r\n                {/* Labels Row */}\r\n                <div className=\"flex justify-between items-center text-xs font-bold text-slate-400\">\r\n                    {level && (\r\n                        <span className=\"text-slate-300\">{type === 'review' ? `Nvel ${level}` : `${daysElapsed}/${timeTotal}`}</span>\r\n                    ) || (\r\n                            <span>{timeCurrent !== undefined && timeTotal ? `${timeCurrent}/${timeTotal}` : ''}</span>\r\n                        )}\r\n\r\n                    {type === 'review' && domain && (\r\n                        <span className=\"text-emerald-500\">{domain}% Domnio</span>\r\n                    ) || (daysRemaining !== undefined && (\r\n                        <span className=\"text-blue-400\">{daysRemaining} dias restantes</span>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Progress Bar */}\r\n                {type === 'review' ? (\r\n                    // Segmented Bar for Reviews\r\n                    <div className=\"flex gap-1 h-1.5\">\r\n                        {[1, 2, 3, 4, 5].map((seg) => {\r\n                            const currentLevel = parseInt(level?.split('/')[0] || '0');\r\n                            const reviewInfo = schedule?.find(s => s.number === seg);\r\n\r\n                            return (\r\n                                <div key={seg} className=\"relative group/tooltip flex-1 h-full\">\r\n                                    <div\r\n                                        className={cn(\r\n                                            \"w-full h-full rounded-full transition-all cursor-help\",\r\n                                            seg <= currentLevel ? \"bg-emerald-500\" : \"bg-slate-800\",\r\n                                            reviewInfo?.status === 'pending' && new Date(reviewInfo.date) <= new Date() ? \"bg-emerald-500/50\" : \"\"\r\n                                        )}\r\n                                    />\r\n                                    {/* Custom Premium Tooltip */}\r\n                                    <div className=\"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 hidden group-hover/tooltip:block z-[60] pointer-events-none min-w-[120px]\">\r\n                                        <div className=\"bg-slate-900/90 backdrop-blur-md text-white rounded-lg border border-slate-700/50 shadow-xl overflow-hidden animate-in fade-in zoom-in-95 duration-200\">\r\n                                            {/* Header */}\r\n                                            <div className={cn(\r\n                                                \"px-3 py-1.5 text-[10px] font-bold uppercase tracking-wider border-b border-slate-700/50\",\r\n                                                seg <= currentLevel ? \"bg-emerald-500/10 text-emerald-400\" : \"bg-slate-800/50 text-slate-400\"\r\n                                            )}>\r\n                                                Nvel {seg}\r\n                                            </div>\r\n\r\n                                            {/* Content */}\r\n                                            <div className=\"px-3 py-2 space-y-1\">\r\n                                                {reviewInfo ? (\r\n                                                    <>\r\n                                                        <div className=\"text-xs font-medium text-slate-200\">\r\n                                                            {(() => {\r\n                                                                try {\r\n                                                                    const d = new Date(reviewInfo.date + 'T00:00:00');\r\n                                                                    if (isToday(d)) return \"Hoje\";\r\n                                                                    if (isTomorrow(d)) return \"Amanh\";\r\n                                                                    if (isYesterday(d)) return \"Ontem\";\r\n                                                                    return format(d, \"d 'de' MMM\", { locale: ptBR });\r\n                                                                } catch {\r\n                                                                    return reviewInfo.date;\r\n                                                                }\r\n                                                            })()}\r\n                                                        </div>\r\n                                                        <div className={cn(\r\n                                                            \"text-[10px] uppercase font-bold\",\r\n                                                            reviewInfo.status === 'completed' ? \"text-emerald-400\" :\r\n                                                                (reviewInfo.status === 'pending' ? \"text-amber-400\" : \"text-slate-500\")\r\n                                                        )}>\r\n                                                            {reviewInfo.status === 'completed' ? 'Concludo' :\r\n                                                                (reviewInfo.status === 'pending' ? 'Pendente' : 'Futuro')}\r\n                                                        </div>\r\n                                                    </>\r\n                                                ) : (\r\n                                                    <span className=\"text-xs text-slate-500 italic\">No agendado</span>\r\n                                                )}\r\n                                            </div>\r\n\r\n                                            {/* Arrow */}\r\n                                            <div className=\"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-slate-900/90 border-r border-b border-slate-700/50 rotate-45 backdrop-blur-md\"></div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                ) : (\r\n                    // Linear Bar for others\r\n                    <div className=\"h-1.5 bg-slate-800 rounded-full overflow-hidden w-full relative\">\r\n                        <div\r\n                            className=\"h-full bg-blue-500 rounded-full\"\r\n                            style={{ width: timeCurrent && timeTotal ? `${(timeCurrent / timeTotal) * 100}%` : '0%' }}\r\n                        />\r\n                        {/* Optional marker if needed */}\r\n                        {timeCurrent && timeTotal && (\r\n                            <div\r\n                                className=\"absolute top-0 h-full w-2 bg-white rounded-full shadow-lg transform -translate-x-1/2\"\r\n                                style={{ left: `${(timeCurrent / timeTotal) * 100}%` }}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Dates below progress */}\r\n            {(startDate || endDate) && !isBlocked && (\r\n                <div className=\"flex items-center gap-3 text-[10px] text-slate-500 mt-3 font-medium border-t border-slate-800/50 pt-2\">\r\n                    {startDate && (\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <span className=\"uppercase text-[9px] font-bold text-slate-600\">Incio:</span>\r\n                            <span>{new Date(startDate + 'T00:00:00').toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</span>\r\n                        </div>\r\n                    )}\r\n                    {startDate && endDate && <span className=\"text-slate-700 mx-1\"></span>}\r\n                    {endDate && (\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <span className=\"uppercase text-[9px] font-bold text-slate-600\">Fim:</span>\r\n                            <span>{new Date(endDate + 'T00:00:00').toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}</span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionItem.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[331,334],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[331,334],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { PlayCircle, CheckSquare, Flame, BrainCircuit, Target, Clock as ClockIcon, Loader2, Lock } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport { format } from 'date-fns';\r\nimport { parseLocalDate } from '../../../utils/dateHelpers';\r\n\r\ninterface MissionItemProps {\r\n    item: any;\r\n    type: 'habit' | 'review' | 'task';\r\n    isDone: boolean;\r\n    onToggle: () => void;\r\n    onFocus: () => void;\r\n    activeFocusId?: string | null;\r\n    activeStartTime?: number;\r\n    isLocked?: boolean;\r\n    lockReason?: string;\r\n    scheduledTime?: string;\r\n    onSetTime?: (time: string) => void;\r\n    startedAt?: number;\r\n}\r\n\r\nexport const MissionItem = ({ item, type, isDone, onToggle, onFocus, activeFocusId, activeStartTime, isLocked, lockReason, scheduledTime, onSetTime, startedAt }: MissionItemProps) => {\r\n    const [isEditingTime, setIsEditingTime] = React.useState(false);\r\n\r\n    // Check if item is overdue\r\n    const now = new Date();\r\n    const itemDateStr = item.date || (item.deadline ? item.deadline.split('T')[0] : undefined);\r\n    const isOverdue = !isDone && itemDateStr && (() => {\r\n        const d = parseLocalDate(itemDateStr);\r\n        d.setHours(23, 59, 59, 999);\r\n        return d < now;\r\n    })();\r\n\r\n    // FIXED COLORS - with overdue highlight\r\n    const baseColor = isOverdue ? 'red' : (type === 'habit' ? 'emerald' : type === 'review' ? 'violet' : 'blue');\r\n    const borderColor = isDone ? `border-${baseColor}-500/50` : (isOverdue ? 'border-red-500/70' : 'border-slate-700/50');\r\n\r\n    const getIcon = () => {\r\n        if (type === 'habit') return <Flame className={cn(\"w-6 h-6 transition-all\", isDone ? \"text-white fill-emerald-200 animate-[bounce_1s_infinite]\" : (isOverdue ? \"text-red-400\" : \"text-white/80\"))} />;\r\n        if (type === 'review') return <BrainCircuit className={cn(\"w-6 h-6 transition-all\", isDone ? \"text-violet-100\" : (isOverdue ? \"text-red-400\" : \"text-white/80\"))} />;\r\n        return <Target className={cn(\"w-6 h-6 transition-all\", isDone ? \"text-blue-100\" : (isOverdue ? \"text-red-400\" : \"text-white/80\"))} />;\r\n    };\r\n\r\n    const getSubtitle = () => {\r\n        if (isDone) {\r\n            const startTimeStr = startedAt ? format(new Date(startedAt), 'HH:mm') : (activeStartTime ? format(new Date(activeStartTime), 'HH:mm') : null);\r\n            const endTimeStr = item.completedAt ? format(new Date(item.completedAt), 'HH:mm') : 'Concludo';\r\n            if (startTimeStr && item.completedAt) return `Incio: ${startTimeStr}  Fim: ${endTimeStr}`;\r\n            return endTimeStr;\r\n        }\r\n\r\n        // Active Focus Logic\r\n        if (activeFocusId === (item.subthemeId || item.id)) {\r\n            return activeStartTime ? `Iniciado s ${format(new Date(activeStartTime), 'HH:mm')}` : 'Em Foco...';\r\n        }\r\n\r\n        // Previously Started Logic\r\n        if (startedAt) return `Iniciado s ${format(new Date(startedAt), 'HH:mm')}`;\r\n\r\n        if (type === 'habit') return item.recurrence && item.recurrence.length > 0 ? 'Hbito Dirio' : 'Meta Recorrente';\r\n        if (type === 'review') return `Nvel ${item.reviewNumber || 1}/5`; // Simple subtitle for review\r\n\r\n        if (item.deadline) {\r\n            const now = new Date();\r\n            const deadline = parseLocalDate(item.deadline);\r\n            if (deadline < now && !isDone) return 'Atrasado';\r\n            return `Prazo: ${format(deadline, 'HH:mm')}`;\r\n        }\r\n        return 'Aguardando';\r\n    };\r\n\r\n    const mainTitle = type === 'review' ? item.themeTitle : (item.title || item.subthemeTitle);\r\n\r\n    return (\r\n        <div\r\n            onClick={() => {\r\n                if (isLocked) return;\r\n                onToggle();\r\n            }}\r\n            className={cn(\r\n                \"group relative overflow-hidden rounded-2xl border transition-colors duration-200 cursor-pointer select-none flex flex-col\",\r\n                isDone\r\n                    ? `bg-gradient-to-br from-${baseColor}-900/40 to-slate-900/80 ${borderColor}`\r\n                    : isOverdue\r\n                        ? \"bg-gradient-to-br from-red-900/30 to-orange-900/20 border-red-500/70 hover:bg-red-900/40 hover:border-red-500/90 shadow-lg shadow-red-500/20\"\r\n                        : \"bg-slate-900/40 border-slate-800 hover:bg-slate-800/80 hover:border-slate-700\"\r\n            )}\r\n        >\r\n            {/* Glow Effect */}\r\n            {isDone && (\r\n                <div className={`absolute top-0 right-0 p-16 bg-${baseColor}-500/10 blur-[50px] rounded-full pointer-events-none`} />\r\n            )}\r\n            {isOverdue && !isDone && (\r\n                <div className=\"absolute top-0 right-0 p-16 bg-red-500/15 blur-[50px] rounded-full pointer-events-none animate-pulse\" />\r\n            )}\r\n\r\n            <div className=\"relative p-4 z-10 flex flex-col gap-4\">\r\n                {/* TOP ROW: Icon + Content */}\r\n                <div className=\"flex items-start gap-4\">\r\n                    {/* Left: Icon / Image Box */}\r\n                    <div className={cn(\r\n                        \"w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg shrink-0 overflow-hidden relative\",\r\n                        isDone\r\n                            ? `bg-gradient-to-br from-${baseColor}-500 to-${baseColor}-600 shadow-${baseColor}-900/50 scale-105`\r\n                            : isOverdue\r\n                                ? \"bg-gradient-to-br from-red-500 to-orange-600 shadow-red-900/60 border border-red-400/30 pulse\"\r\n                                : `bg-${baseColor}-500/20 border border-white/5 group-hover:bg-${baseColor}-500/30`\r\n                    )}>\r\n                        {type === 'review' && item.imageUrl ? (\r\n                            <img src={item.imageUrl} alt={mainTitle} className=\"w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity\" />\r\n                        ) : (\r\n                            getIcon()\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Right: Text Content */}\r\n                    <div className=\"flex-1 min-w-0 flex flex-col justify-center min-h-[3.5rem]\">\r\n                        <div className=\"flex flex-col gap-1\">\r\n                            {/* Overdue Badge + Title */}\r\n                            <div className=\"flex items-center gap-2\">\r\n                                {isOverdue && (\r\n                                    <span className=\"text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded-md bg-red-500/20 text-red-400 border border-red-500/40 whitespace-nowrap animate-pulse\">\r\n                                         Atrasado\r\n                                    </span>\r\n                                )}\r\n                                <h4 className={cn(\r\n                                    \"text-base font-bold truncate transition-colors leading-tight flex-1\",\r\n                                    isDone\r\n                                        ? `text-${baseColor}-100`\r\n                                        : isOverdue\r\n                                            ? \"text-red-400 font-extrabold\"\r\n                                            : \"text-white\"\r\n                                )}>\r\n                                    {mainTitle}\r\n                                </h4>\r\n                            </div>\r\n\r\n                            {/* Subtitle / Status Tags */}\r\n                            <div className=\"flex flex-wrap items-center gap-2\">\r\n                                {activeFocusId === (item.subthemeId || item.id) && activeStartTime && (\r\n                                    <span className=\"text-[9px] font-mono text-blue-400 bg-blue-900/30 px-1.5 py-0.5 rounded border border-blue-500/30 whitespace-nowrap animate-pulse\">\r\n                                        {format(new Date(activeStartTime), 'HH:mm')}\r\n                                    </span>\r\n                                )}\r\n\r\n                                {/* Category Tag for Reviews */}\r\n                                {type === 'review' && (\r\n                                    <span className=\"text-[10px] text-violet-400 font-bold bg-violet-500/10 px-1.5 py-0.5 rounded border border-violet-500/10 truncate max-w-[150px]\">\r\n                                        {item.subthemeTitle}\r\n                                    </span>\r\n                                )}\r\n\r\n                                {/* Main Subtitle */}\r\n                                {isDone ? (\r\n                                    <span className={cn(\r\n                                        \"flex items-center gap-1 text-[10px] font-bold px-2 py-0.5 rounded-full border shadow-sm\",\r\n                                        `text-${baseColor}-300 bg-${baseColor}-950/40 border-${baseColor}-500/30`\r\n                                    )}>\r\n                                        <CheckSquare className=\"w-3 h-3\" />\r\n                                        {item.completedAt ? `Concludo s ${format(new Date(item.completedAt), 'HH:mm')}` : 'Concludo'}\r\n                                    </span>\r\n                                ) : (\r\n                                    <span className={cn(\r\n                                        \"text-[10px] uppercase tracking-wider font-bold truncate\",\r\n                                        getSubtitle().includes('Atrasado') ? \"text-red-400 font-bold animate-pulse\" : \"text-slate-500\"\r\n                                    )}>\r\n                                        {activeFocusId !== (item.subthemeId || item.id) && getSubtitle()}\r\n                                    </span>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* MIDDLE ROW: Progress (Conditional) */}\r\n                {(() => {\r\n                    if (type === 'habit' && item.deadline) {\r\n                        const start = parseLocalDate(item.createdAt || new Date());\r\n                        const end = parseLocalDate(item.deadline);\r\n                        const now = new Date();\r\n                        const totalDays = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n                        const daysLeft = Math.ceil((end.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\r\n                        const completedCount = item.completionHistory?.length || 0;\r\n                        const percent = Math.min(100, Math.round((completedCount / totalDays) * 100));\r\n                        const isLate = daysLeft < 0;\r\n\r\n                        return (\r\n                            <div className=\"w-full pl-0 md:pl-[4.5rem]\">\r\n                                <div className=\"flex items-center justify-between text-[9px] font-bold mb-1 opacity-80\">\r\n                                    <span className={cn(\"text-slate-500\", isDone && \"text-slate-400\")}>{completedCount}/{totalDays} dias</span>\r\n                                    <span className={cn(\"text-slate-500\", isLate ? \"text-red-400\" : \"text-blue-400\")}>{isLate ? 'Expirado' : `${daysLeft} dias restantes`}</span>\r\n                                </div>\r\n                                <div className=\"h-1 bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                                    <div className={cn(\"h-full rounded-full transition-all duration-500\", isDone ? \"bg-white\" : `bg-${baseColor}-500`)} style={{ width: `${percent}%` }} />\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    }\r\n                    if (type === 'review') {\r\n                        const current = item.currentReviewNum || 1;\r\n                        const percent = Math.min(100, Math.round(((current - 1) / 5) * 100));\r\n                        return (\r\n                            <div className=\"w-full pl-0 md:pl-[4.5rem]\">\r\n                                <div className=\"flex items-center justify-between text-[9px] font-bold mb-1\">\r\n                                    <span className=\"text-slate-500\">Nvel {current}/5</span>\r\n                                    <span className=\"text-violet-400\">{Math.min(100, percent + 20)}% Domnio</span>\r\n                                </div>\r\n                                <div className=\"flex gap-1 h-1.5\">\r\n                                    {[1, 2, 3, 4, 5].map(step => (\r\n                                        <div key={step} className={cn(\"flex-1 rounded-sm transition-all\", step < current ? \"bg-violet-500\" : step === current ? (isDone ? \"bg-violet-400\" : \"bg-violet-900/40 border border-violet-500/30\") : \"bg-slate-800\")} />\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    }\r\n                    if (type === 'task' && item.type === 'period' && item.startDate && item.endDate) {\r\n                        // ... Repetitive logic for period task progress ...\r\n                        const start = parseLocalDate(item.startDate);\r\n                        const end = parseLocalDate(item.endDate);\r\n                        const now = new Date();\r\n                        const totalDays = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)) + 1);\r\n                        const elapsedDays = Math.max(0, Math.ceil((now.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)) + 1);\r\n                        const daysLeft = Math.max(0, Math.ceil((end.getTime() - now.getTime()) / (1000 * 60 * 60 * 24)));\r\n                        const percent = Math.min(100, Math.round((elapsedDays / totalDays) * 100));\r\n                        const isLate = daysLeft < 0;\r\n                        return (\r\n                            <div className=\"w-full pl-0 md:pl-[4.5rem]\">\r\n                                <div className=\"flex items-center justify-between text-[9px] font-bold mb-0.5 opacity-80\">\r\n                                    <span className={cn(\"text-slate-400\", isDone && \"text-slate-200\")}>Dia {Math.min(elapsedDays, totalDays)}/{totalDays}</span>\r\n                                    <span className={cn(\"text-slate-500\", isLate ? \"text-red-400\" : \"text-blue-400\")}>{daysLeft === 0 ? 'ltimo dia' : isLate ? 'Atrasado' : `${daysLeft} dias`}</span>\r\n                                </div>\r\n                                <div className=\"h-1 bg-slate-950/50 rounded-full overflow-hidden border border-white/5\">\r\n                                    <div className={cn(\"h-full rounded-full transition-all duration-500\", isDone ? \"bg-white\" : `bg-${baseColor}-500`)} style={{ width: `${percent}%` }} />\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    }\r\n                    return null;\r\n                })()}\r\n\r\n                {/* BOTTOM ROW: Actions (Clock, Play, Check) */}\r\n                <div className=\"flex flex-wrap items-center justify-between gap-y-3 border-t border-white/5 pt-3 mt-1 pl-0 md:pl-[4.5rem]\">\r\n                    {/* Time Setting */}\r\n                    {onSetTime ? (\r\n                        <div className=\"flex-1 min-w-[80px]\">\r\n                            {isEditingTime ? (\r\n                                <input\r\n                                    type=\"time\"\r\n                                    className=\"bg-slate-950 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:outline-none focus:border-blue-500 w-full md:w-24\"\r\n                                    value={scheduledTime || ''}\r\n                                    onChange={(e) => onSetTime(e.target.value)}\r\n                                    onBlur={() => setIsEditingTime(false)}\r\n                                    autoFocus\r\n                                    onClick={(e) => e.stopPropagation()}\r\n                                />\r\n                            ) : (\r\n                                <button\r\n                                    onClick={(e) => { e.stopPropagation(); setIsEditingTime(true); }}\r\n                                    className={cn(\r\n                                        \"flex items-center gap-1.5 px-2 py-1.5 rounded-lg text-[10px] font-bold transition-all hover:bg-slate-800\",\r\n                                        scheduledTime ? \"text-indigo-300\" : \"text-slate-500\"\r\n                                    )}\r\n                                >\r\n                                    <ClockIcon className=\"w-3.5 h-3.5\" />\r\n                                    <span className=\"hidden sm:inline\">{scheduledTime || \"Definir Horrio\"}</span>\r\n                                    <span className=\"sm:hidden\">{scheduledTime || \"Horrio\"}</span>\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex-1\" />\r\n                    )}\r\n\r\n                    {/* Right Actions */}\r\n                    {/* Right Actions */}\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {isLocked ? (\r\n                            <div className=\"bg-slate-900 border border-slate-700 rounded-lg px-3 py-1.5 flex items-center gap-2 justify-center flex-1 md:flex-none\">\r\n                                <Lock className=\"w-3.5 h-3.5 text-slate-500\" />\r\n                                <span className=\"text-[10px] text-slate-500 font-bold uppercase tracking-wider\">\r\n                                    {lockReason && lockReason.includes(\"atual\") ? \"Agendado\" : (lockReason || \"Bloqueado\")}\r\n                                </span>\r\n                            </div>\r\n                        ) : (\r\n                            <>\r\n                                {activeFocusId === (item.id || item.subthemeId) ? (\r\n                                    <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold bg-rose-500/10 border border-rose-500/30 text-rose-400 animate-pulse flex-1 md:flex-none justify-center\">\r\n                                        <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\r\n                                        <span>Focando...</span>\r\n                                    </div>\r\n                                ) : !activeFocusId ? (\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); onFocus(); }}\r\n                                        className={cn(\r\n                                            \"flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border flex-1 md:flex-none justify-center\",\r\n                                            `border-slate-700 bg-slate-800 hover:bg-${baseColor}-500 hover:border-${baseColor}-400 hover:text-white text-slate-300`\r\n                                        )}\r\n                                        title=\"Iniciar\"\r\n                                    >\r\n                                        <PlayCircle className=\"w-3.5 h-3.5\" />\r\n                                        <span>Focar</span>\r\n                                    </button>\r\n                                ) : null}\r\n\r\n                                <button\r\n                                    onClick={(e) => { e.stopPropagation(); onToggle(); }}\r\n                                    disabled={!!activeFocusId && activeFocusId !== (item.id || item.subthemeId)}\r\n                                    className={cn(\r\n                                        \"flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border flex-1 md:flex-none justify-center\",\r\n                                        isDone\r\n                                            ? `bg-${baseColor}-500 border-${baseColor}-400 text-white shadow`\r\n                                            : !!activeFocusId && activeFocusId !== (item.id || item.subthemeId)\r\n                                                ? \"bg-slate-900 border-slate-800 text-slate-600 cursor-not-allowed opacity-50\"\r\n                                                : \"bg-slate-800 border-slate-700 text-slate-400 hover:border-emerald-500 hover:text-emerald-500\"\r\n                                    )}\r\n                                >\r\n                                    <CheckSquare className=\"w-3.5 h-3.5\" />\r\n                                    <span>\r\n                                        {isDone && item.completedAt\r\n                                            ? format(new Date(item.completedAt), 'HH:mm')\r\n                                            : (isDone ? 'Concludo' : 'Concluir')\r\n                                        }\r\n                                    </span>\r\n                                </button>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[590,593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[590,593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[614,617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[614,617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[636,639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[636,639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1053,1056],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1053,1056],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1111,1114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1111,1114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isCurrentDay' is defined but never used.","line":43,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2316,2319],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2316,2319],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2484,2487],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2484,2487],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2524,2527],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2524,2527],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3568,3571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3568,3571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":195,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9442,9445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9442,9445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":235,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12136,12139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12136,12139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Reorder } from 'framer-motion';\r\n\r\n\r\nimport { ChevronLeft, ChevronRight, ChevronUp, Calendar as CalendarIcon, Trophy } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport { format, isToday, addDays } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { MissionItem } from './MissionItem';\r\n\r\ninterface MissionListProps {\r\n    selectedDate: Date;\r\n    setSelectedDate: (d: Date) => void;\r\n    handlePrevDay: () => void;\r\n    handleNextDay: () => void;\r\n    onCollapse: () => void;\r\n\r\n    // Lists\r\n    allHabits: any[];\r\n    allReviews: any[];\r\n    allTasks: any[]; // Using any to avoid complex type import for now (should be fixed later)\r\n\r\n    // Logic\r\n    isCurrentDay: boolean;\r\n    dateStr: string;\r\n    hasOverdueItems: boolean;\r\n    dailySchedule: Record<string, string>;\r\n    missionProgress: Record<string, { startedAt?: number }>;\r\n    activeFocusId?: string;\r\n\r\n    // Handlers\r\n    handleSetTime: (id: string, time: string) => void;\r\n    handleFocusItem: (item: any, type: string) => void;\r\n    handleToggleItem: (item: any, type: string) => void;\r\n\r\n    // Stats\r\n    isAllDone: boolean;\r\n}\r\n\r\nexport const MissionList = ({\r\n    selectedDate, setSelectedDate, handlePrevDay, handleNextDay, onCollapse,\r\n    allHabits, allReviews, allTasks,\r\n    isCurrentDay, dateStr, hasOverdueItems, dailySchedule, missionProgress, activeFocusId,\r\n    handleSetTime, handleFocusItem, handleToggleItem,\r\n    isAllDone\r\n}: MissionListProps) => {\r\n    const [showCalendar, setShowCalendar] = useState(false);\r\n\r\n    // --- DRAG AND DROP PERSISTENCE LOGIC ---\r\n    // Single consolidated key: 'mission_list_order' -> { habit: [ids], review: [ids], task: [ids] }\r\n    const [itemOrder, setItemOrder] = useState<{ [key: string]: string[] }>(() => {\r\n        try {\r\n            return JSON.parse(localStorage.getItem('mission_list_order') || '{}');\r\n        } catch { return {}; }\r\n    });\r\n\r\n    const handleReorder = (type: string, newOrder: string[]) => {\r\n        const updated = { ...itemOrder, [type]: newOrder };\r\n        setItemOrder(updated);\r\n        localStorage.setItem('mission_list_order', JSON.stringify(updated));\r\n    };\r\n\r\n    // Helper to sort items based on persisted ID list + overdue priority\r\n    const sortItems = (items: any[], type: string) => {\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n\r\n        // Separate overdue and non-overdue items\r\n        const overdueItems: any[] = [];\r\n        const normalItems: any[] = [];\r\n\r\n        items.forEach(item => {\r\n            const itemDateStr = item.date || (item.deadline ? item.deadline.split('T')[0] : undefined);\r\n            const isDone = item.isDone || item.status === 'completed';\r\n            const isOverdue = !isDone && itemDateStr && itemDateStr < todayStr;\r\n\r\n            if (isOverdue) {\r\n                overdueItems.push({ ...item, isOverdue: true });\r\n            } else {\r\n                normalItems.push(item);\r\n            }\r\n        });\r\n\r\n        // Sort overdue items by date (oldest first)\r\n        overdueItems.sort((a, b) => {\r\n            const dateA = a.date || (a.deadline ? a.deadline.split('T')[0] : '9999-99-99');\r\n            const dateB = b.date || (b.deadline ? b.deadline.split('T')[0] : '9999-99-99');\r\n            return dateA.localeCompare(dateB);\r\n        });\r\n\r\n        // Sort normal items using persisted order\r\n        const order = itemOrder[type] || [];\r\n        const map = new Map(normalItems.map(i => [i.id || i.subthemeId, i]));\r\n        const sortedNormal: any[] = [];\r\n\r\n        // 1. Add items in explicit order\r\n        order.forEach(id => {\r\n            if (map.has(id)) {\r\n                sortedNormal.push(map.get(id));\r\n                map.delete(id);\r\n            }\r\n        });\r\n\r\n        // 2. Append new/remaining items (maintain original relative order)\r\n        normalItems.forEach(i => {\r\n            const id = i.id || i.subthemeId;\r\n            if (map.has(id)) {\r\n                sortedNormal.push(i);\r\n            }\r\n        });\r\n\r\n        // Return overdue items first, then normal items\r\n        return [...overdueItems, ...sortedNormal];\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Date Navigation & Calendar Toggle */}\r\n            <div className=\"px-4 py-3 bg-slate-900/30 border-b border-slate-800/50 flex items-center justify-between shrink-0\">\r\n                <button onClick={handlePrevDay} className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 transition-colors\"><ChevronLeft className=\"w-4 h-4\" /></button>\r\n\r\n                <div className=\"flex flex-col items-center cursor-pointer group\" onClick={() => setShowCalendar(!showCalendar)}>\r\n                    <span className=\"text-[10px] text-slate-500 font-bold uppercase tracking-widest group-hover:text-blue-400 transition-colors\">\r\n                        {isToday(selectedDate) ? 'Hoje' : format(selectedDate, 'EEEE', { locale: ptBR })}\r\n                    </span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <CalendarIcon className=\"w-3.5 h-3.5 text-slate-400 group-hover:text-blue-400 transition-colors\" />\r\n                        <span className=\"text-sm font-bold text-slate-200 group-hover:text-white transition-colors\">\r\n                            {format(selectedDate, \"d 'de' MMMM\", { locale: ptBR })}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-1\">\r\n                    <button onClick={handleNextDay} className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 transition-colors\"><ChevronRight className=\"w-4 h-4\" /></button>\r\n                    <button onClick={onCollapse} className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 transition-colors ml-1\" title=\"Minimizar\">\r\n                        <ChevronUp className=\"w-4 h-4\" />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Calendar Popover */}\r\n            {showCalendar && (\r\n                <div className=\"p-4 bg-slate-900 border-b border-slate-800 animate-in fade-in slide-in-from-top-2\">\r\n                    <div className=\"grid grid-cols-7 gap-1 text-center mb-2\">\r\n                        {['D', 'S', 'T', 'Q', 'Q', 'S', 'S'].map(d => <span key={d} className=\"text-[10px] text-slate-500 font-bold\">{d}</span>)}\r\n                    </div>\r\n                    <div className=\"grid grid-cols-7 gap-1\">\r\n                        {Array.from({ length: 14 }).map((_, i) => {\r\n                            const d = addDays(selectedDate, i - 7);\r\n                            const isSel = d.toDateString() === selectedDate.toDateString();\r\n                            return (\r\n                                <button\r\n                                    key={i}\r\n                                    onClick={() => { setSelectedDate(d); setShowCalendar(false); }}\r\n                                    className={cn(\r\n                                        \"h-8 rounded-lg text-xs font-bold flex items-center justify-center transition-all\",\r\n                                        isSel ? \"bg-slate-800 text-blue-400 ring-2 ring-blue-500 shadow-lg shadow-blue-500/20 scale-110 z-10\" : \"text-slate-400 hover:bg-slate-800 hover:text-slate-200\",\r\n                                        isToday(d) && !isSel && \"text-blue-400 font-extrabold\"\r\n                                    )}\r\n                                >\r\n                                    {format(d, 'd')}\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Scrollable List */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar max-h-[60vh] select-none\">\r\n                <div className=\"space-y-6\">\r\n                    {[\r\n                        { title: 'Hbitos & Rotina', rawItems: allHabits, type: 'habit' },\r\n                        { title: 'Revises & Estudos', rawItems: allReviews, type: 'review' },\r\n                        { title: 'Tarefas & Misses', rawItems: allTasks, type: 'task' }\r\n                    ].map(group => {\r\n                        if (group.rawItems.length === 0) return null;\r\n\r\n                        // Sort items for this render\r\n                        const sortedItems = sortItems(group.rawItems, group.type);\r\n\r\n                        return (\r\n                            <div key={group.title} className=\"space-y-3\">\r\n                                <h4 className=\"text-[10px] font-bold text-slate-500 uppercase tracking-widest pl-2 border-l-2 border-slate-800 flex items-center justify-between\">\r\n                                    {group.title}\r\n                                    <span className=\"text-[9px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full\">{group.rawItems.length}</span>\r\n                                </h4>\r\n\r\n                                <Reorder.Group\r\n                                    values={sortedItems.map(i => i.id || i.subthemeId)}\r\n                                    onReorder={(newOrder) => handleReorder(group.type, newOrder)}\r\n                                    className=\"space-y-4\"\r\n                                    axis=\"y\"\r\n                                >\r\n                                    {sortedItems.map((item: any) => {\r\n                                        const itemId = item.id || item.subthemeId;\r\n                                        const isDone = item.isDone || item.status === 'completed';\r\n\r\n                                        // ROBUST DATE CHECK V2 (date-fns)\r\n                                        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n                                        const isFutureContext = dateStr > todayStr;\r\n                                        const isGlobalLocked = isFutureContext;\r\n\r\n                                        const itemDateStr = item.date || (item.deadline ? item.deadline.split('T')[0] : undefined);\r\n                                        const isItemOverdue = !isDone && itemDateStr && itemDateStr < dateStr;\r\n\r\n                                        let isItemLocked = isGlobalLocked;\r\n                                        let lockReason = item.lockReason || (isGlobalLocked ? \"Agendado para o futuro\" : \"\");\r\n\r\n                                        if (!isItemLocked && hasOverdueItems && !isItemOverdue) {\r\n                                            isItemLocked = true;\r\n                                            lockReason = \"Prioridade: Conclua as atividades atrasadas primeiro!\";\r\n                                        }\r\n\r\n                                        if (itemDateStr && itemDateStr > todayStr) {\r\n                                            isItemLocked = true;\r\n                                            lockReason = `Agendado para ${format(new Date(itemDateStr + 'T00:00:00'), 'dd/MM')}`;\r\n                                        }\r\n\r\n                                        if (item.startDate && item.startDate > todayStr) {\r\n                                            isItemLocked = true;\r\n                                            lockReason = `Inicia em ${format(new Date(item.startDate + 'T00:00:00'), 'dd/MM')}`;\r\n                                        }\r\n\r\n                                        return (\r\n                                            <Reorder.Item\r\n                                                key={itemId}\r\n                                                value={itemId}\r\n                                                dragListener={true}\r\n                                                className=\"cursor-move touch-none\"\r\n                                                whileDrag={{ scale: 1.02, zIndex: 50 }}\r\n                                            >\r\n                                                <MissionItem\r\n                                                    item={item}\r\n                                                    type={group.type as any}\r\n                                                    isDone={isDone}\r\n                                                    onToggle={() => {\r\n                                                        if (isItemLocked) return;\r\n                                                        handleToggleItem(item, group.type);\r\n                                                    }}\r\n                                                    onFocus={() => {\r\n                                                        if (isItemLocked) return;\r\n                                                        handleFocusItem(item, group.type);\r\n                                                    }}\r\n                                                    activeFocusId={activeFocusId}\r\n                                                    activeStartTime={undefined}\r\n                                                    isLocked={isItemLocked}\r\n                                                    lockReason={lockReason}\r\n                                                    scheduledTime={dailySchedule[itemId]}\r\n                                                    onSetTime={(time) => handleSetTime(itemId, time)}\r\n                                                    startedAt={missionProgress[itemId]?.startedAt}\r\n                                                />\r\n                                            </Reorder.Item>\r\n                                        );\r\n                                    })}\r\n                                </Reorder.Group>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {isAllDone && (\r\n                    <div className=\"p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl text-center mt-6\">\r\n                        <div className=\"w-12 h-12 bg-emerald-500/20 text-emerald-400 rounded-full flex items-center justify-center mx-auto mb-2 animate-bounce\">\r\n                            <Trophy className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <h3 className=\"text-emerald-400 font-bold\">Misso Completa!</h3>\r\n                        <p className=\"text-emerald-500/70 text-xs text-center\">Voc dominou o dia.</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionPreviewWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isAllDone' is defined but never used.","line":12,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":66}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Target, ChevronRight, Clock, CheckCircle2 } from 'lucide-react';\r\n\r\ninterface MissionPreviewWidgetProps {\r\n    progressPercent: number;\r\n    isAllDone: boolean;\r\n    completedCount: number;\r\n    totalCount: number;\r\n    setIsMissionModalOpen: (isOpen: boolean) => void;\r\n}\r\n\r\nexport const MissionPreviewWidget = ({ progressPercent, isAllDone, completedCount, totalCount, setIsMissionModalOpen }: MissionPreviewWidgetProps) => {\r\n    const pendingCount = totalCount - completedCount;\r\n\r\n    return (\r\n        <div className=\"bg-gradient-to-br from-slate-900/50 via-slate-900/40 to-slate-950/50 backdrop-blur-md border border-white/10 rounded-3xl p-4 shadow-2xl relative overflow-hidden group/mission\">\r\n            {/* Gradient top bar */}\r\n            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-amber-500 via-blue-500 to-emerald-500 opacity-60\" />\r\n\r\n            {/* Ambient glow effects */}\r\n            <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none\" />\r\n            <div className=\"absolute bottom-0 left-0 w-32 h-32 bg-emerald-500/10 rounded-full blur-3xl -ml-16 -mb-16 pointer-events-none\" />\r\n\r\n            <div className=\"relative z-10\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"p-1.5 rounded-lg bg-gradient-to-br from-blue-500/20 to-indigo-500/20 ring-1 ring-blue-500/30\">\r\n                            <Target className=\"w-4 h-4 text-blue-400\" />\r\n                        </div>\r\n                        <h3 className=\"font-bold text-white text-base\">Sua Misso</h3>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => setIsMissionModalOpen(true)}\r\n                        className=\"text-[10px] font-bold text-blue-400 hover:text-blue-300 transition-colors uppercase tracking-wider px-2 py-1 rounded-lg hover:bg-blue-500/10\"\r\n                    >\r\n                        Abrir Tudo\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Progress Overview */}\r\n                <div className=\"mb-3 px-3 py-2 bg-slate-800/40 rounded-xl border border-white/5\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <span className=\"text-xs font-medium text-slate-300\">Progresso</span>\r\n                        <span className=\"text-xl font-bold text-white tabular-nums\">{progressPercent}%</span>\r\n                    </div>\r\n                    <div className=\"mt-1.5 h-1.5 bg-slate-900/60 rounded-full overflow-hidden ring-1 ring-white/5\">\r\n                        <div\r\n                            className=\"h-full bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full transition-all duration-1000 shadow-lg relative overflow-hidden\"\r\n                            style={{ width: `${progressPercent}%` }}\r\n                        >\r\n                            <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Mission Stats - Two Circles */}\r\n                <div\r\n                    onClick={() => setIsMissionModalOpen(true)}\r\n                    className=\"grid grid-cols-2 gap-3 cursor-pointer\"\r\n                >\r\n                    {/* Pending Activities Circle */}\r\n                    <div className=\"group relative bg-gradient-to-br from-slate-800/60 to-slate-900/40 rounded-2xl p-3 border border-white/5 hover:border-amber-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-amber-500/10\">\r\n                        <div className=\"flex flex-col items-center\">\r\n                            {/* Icon */}\r\n                            <div className=\"mb-2 p-1.5 rounded-lg bg-amber-500/10 ring-1 ring-amber-500/20 group-hover:ring-amber-500/40 transition-all\">\r\n                                <Clock className=\"w-4 h-4 text-amber-400\" />\r\n                            </div>\r\n\r\n                            {/* Circle */}\r\n                            <div className=\"relative w-16 h-16 mb-2\">\r\n                                <svg className=\"w-full h-full transform -rotate-90\">\r\n                                    <circle\r\n                                        cx=\"32\"\r\n                                        cy=\"32\"\r\n                                        r=\"28\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"5\"\r\n                                        fill=\"transparent\"\r\n                                        className=\"text-slate-800\"\r\n                                    />\r\n                                    <circle\r\n                                        cx=\"32\"\r\n                                        cy=\"32\"\r\n                                        r=\"28\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"5\"\r\n                                        fill=\"transparent\"\r\n                                        strokeDasharray={175.9}\r\n                                        strokeDashoffset={175.9 * (1 - (pendingCount / Math.max(totalCount, 1)))}\r\n                                        className=\"text-amber-500 drop-shadow-[0_0_10px_rgba(245,158,11,0.6)] transition-all duration-1000\"\r\n                                        strokeLinecap=\"round\"\r\n                                    />\r\n                                </svg>\r\n                                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                    <span className=\"text-xl font-bold text-amber-400 font-mono\">{pendingCount}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Label */}\r\n                            <p className=\"text-[10px] font-semibold text-amber-400 uppercase tracking-wide\">Pendentes</p>\r\n                            <p className=\"text-[9px] text-slate-500 mt-0.5\">Para fazer</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Completed Activities Circle */}\r\n                    <div className=\"group relative bg-gradient-to-br from-slate-800/60 to-slate-900/40 rounded-2xl p-3 border border-white/5 hover:border-emerald-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-emerald-500/10\">\r\n                        <div className=\"flex flex-col items-center\">\r\n                            {/* Icon */}\r\n                            <div className=\"mb-2 p-1.5 rounded-lg bg-emerald-500/10 ring-1 ring-emerald-500/20 group-hover:ring-emerald-500/40 transition-all\">\r\n                                <CheckCircle2 className=\"w-4 h-4 text-emerald-400\" />\r\n                            </div>\r\n\r\n                            {/* Circle */}\r\n                            <div className=\"relative w-16 h-16 mb-2\">\r\n                                <svg className=\"w-full h-full transform -rotate-90\">\r\n                                    <circle\r\n                                        cx=\"32\"\r\n                                        cy=\"32\"\r\n                                        r=\"28\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"5\"\r\n                                        fill=\"transparent\"\r\n                                        className=\"text-slate-800\"\r\n                                    />\r\n                                    <circle\r\n                                        cx=\"32\"\r\n                                        cy=\"32\"\r\n                                        r=\"28\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"5\"\r\n                                        fill=\"transparent\"\r\n                                        strokeDasharray={175.9}\r\n                                        strokeDashoffset={175.9 * (1 - (completedCount / Math.max(totalCount, 1)))}\r\n                                        className=\"text-emerald-500 drop-shadow-[0_0_10px_rgba(16,185,129,0.6)] transition-all duration-1000\"\r\n                                        strokeLinecap=\"round\"\r\n                                    />\r\n                                </svg>\r\n                                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                    <span className=\"text-xl font-bold text-emerald-400 font-mono\">{completedCount}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Label */}\r\n                            <p className=\"text-[10px] font-semibold text-emerald-400 uppercase tracking-wide\">Concludas</p>\r\n                            <p className=\"text-[9px] text-slate-500 mt-0.5\">Finalizadas</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* View Details Button */}\r\n                <button\r\n                    onClick={() => setIsMissionModalOpen(true)}\r\n                    className=\"mt-3 w-full py-2 text-xs text-blue-400 font-bold hover:text-blue-300 transition-all flex items-center justify-center gap-2 hover:bg-blue-500/5 rounded-xl group/btn\"\r\n                >\r\n                    VER DETALHES\r\n                    <ChevronRight className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\MissionSummary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\RealisticKPICard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\projects\\GoalProjectCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[89,92],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[89,92],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[114,117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[114,117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Trash2 } from 'lucide-react';\r\n\r\ninterface GoalProjectCardProps {\r\n    project: any;\r\n    onEdit: (goal: any) => void;\r\n    onDelete: (id: string) => void;\r\n}\r\n\r\nexport const GoalProjectCard = ({ project, onEdit, onDelete }: GoalProjectCardProps) => {\r\n    return (\r\n        <div\r\n            className=\"flex flex-col p-5 bg-slate-800/30 hover:bg-slate-800/50 border border-slate-800/50 hover:border-emerald-500/30 rounded-2xl transition-all group relative overflow-hidden cursor-pointer active:scale-[0.98]\"\r\n            onClick={() => onEdit(project)}\r\n        >\r\n            <div className=\"absolute bottom-0 left-0 h-1 bg-current opacity-20 transition-all duration-1000\" style={{ width: `${project.progress}%`, color: project.color }} />\r\n\r\n            <button\r\n                onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    onDelete(project.id);\r\n                }}\r\n                className=\"absolute top-4 right-4 p-2 bg-slate-900/90 hover:bg-red-600 text-slate-400 hover:text-white rounded-lg transition-all z-20 shadow-sm border border-white/5\"\r\n            >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n            </button>\r\n\r\n            <div className=\"flex items-center gap-3 mb-4\">\r\n                <div className=\"p-2.5 bg-slate-800 rounded-xl group-hover:scale-110 transition-transform\">\r\n                    {project.icon}\r\n                </div>\r\n                <div>\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"text-[10px] uppercase font-bold tracking-wider px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20\">Meta</span>\r\n                    </div>\r\n                    <h3 className=\"font-bold text-slate-200 line-clamp-1\">{project.title}</h3>\r\n                </div>\r\n            </div>\r\n            <div className=\"mt-auto flex justify-between text-xs text-slate-400\">\r\n                <span>{Math.round(project.progress)}% concludo</span>\r\n                <span>{project.itemCount} itens</span>\r\n            </div>\r\n        </div >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\projects\\LinkedProjectCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[320,323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[320,323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[340,343],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[340,343],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[365,368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[365,368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Target, Pencil, Trash2, Calendar } from 'lucide-react';\r\nimport { differenceInDays, format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { cn } from '../../../../lib/utils';\r\nimport { useConfirm } from '../../../../context/ConfirmContext';\r\n\r\ninterface LinkedProjectCardProps {\r\n    goal: any;\r\n    fullGoal: any;\r\n    onEdit: (goal: any) => void;\r\n    onDelete: (id: string) => void;\r\n}\r\n\r\nexport const LinkedProjectCard = ({ goal, fullGoal, onEdit, onDelete }: LinkedProjectCardProps) => {\r\n    const { confirm } = useConfirm();\r\n    // Helper to parse YYYY-MM-DD as Local Midnight (avoiding UTC timezone issues)\r\n    const parseLocalDate = (dateStr: string): Date => {\r\n        if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateStr)) {\r\n            const [y, m, d] = dateStr.split('-').map(Number);\r\n            return new Date(y, m - 1, d); // Local Midnight\r\n        }\r\n        return new Date(dateStr);\r\n    };\r\n\r\n    // Logic for time calculations (same as original modal)\r\n    let timeProgress = 0;\r\n    let timeLabel = \"\";\r\n\r\n    if (fullGoal?.startDate && fullGoal?.deadline) {\r\n        const start = parseLocalDate(fullGoal.startDate).getTime();\r\n        const end = parseLocalDate(fullGoal.deadline).getTime();\r\n        const now = new Date().getTime();\r\n        const total = end - start;\r\n        const elapsed = now - start;\r\n\r\n        if (total > 0) {\r\n            timeProgress = Math.min(100, Math.max(0, (elapsed / total) * 100));\r\n        }\r\n\r\n        const daysTotal = differenceInDays(parseLocalDate(fullGoal.deadline), parseLocalDate(fullGoal.startDate));\r\n        const daysPassed = differenceInDays(new Date(), parseLocalDate(fullGoal.startDate));\r\n        timeLabel = `${Math.max(0, daysPassed)}/${daysTotal} dias`;\r\n    } else if (fullGoal?.createdAt && fullGoal?.deadline) {\r\n        const start = fullGoal.createdAt;\r\n        const end = parseLocalDate(fullGoal.deadline).getTime();\r\n        const now = new Date().getTime();\r\n        const total = end - start;\r\n        const elapsed = now - start;\r\n        timeProgress = Math.min(100, Math.max(0, (elapsed / total) * 100));\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col gap-2 p-3 bg-slate-900 rounded-xl border border-white/5 hover:border-emerald-500/30 group hover:bg-slate-800/80 transition-all relative overflow-hidden\">\r\n            {/* Header Row */}\r\n            <div className=\"flex justify-between items-start z-10\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"p-2 bg-emerald-500/10 rounded-lg text-emerald-400\">\r\n                        <Target className=\"w-4 h-4\" />\r\n                    </div>\r\n                    <div>\r\n                        <h5 className=\"font-bold text-slate-300 text-sm truncate group-hover:text-white transition-colors\">{goal.title}</h5>\r\n                        <div className=\"flex items-center gap-2 mt-0.5 text-[10px] text-slate-500\">\r\n                            <span>{goal.itemCount} itens</span>\r\n                            <span></span>\r\n                            <span>{Math.round(goal.progress)}% concludo</span>\r\n                        </div>\r\n                        {/* Start and Deadline Dates */}\r\n                        {(fullGoal?.startDate || fullGoal?.deadline) && (\r\n                            <div className=\"flex items-center gap-3 mt-1.5 text-[10px]\">\r\n                                {fullGoal?.startDate && (\r\n                                    <div className=\"flex items-center gap-1 text-slate-500\">\r\n                                        <Calendar className=\"w-3 h-3\" />\r\n                                        <span>Incio: <span className=\"text-slate-400\">{format(parseLocalDate(fullGoal.startDate), \"dd MMM yyyy\", { locale: ptBR })}</span></span>\r\n                                    </div>\r\n                                )}\r\n                                {fullGoal?.deadline && (\r\n                                    <div className=\"flex items-center gap-1 text-slate-500\">\r\n                                        <Calendar className=\"w-3 h-3\" />\r\n                                        <span>Concluso: <span className={cn(\r\n                                            differenceInDays(parseLocalDate(fullGoal.deadline), new Date()) < 0\r\n                                                ? \"text-red-400\"\r\n                                                : differenceInDays(parseLocalDate(fullGoal.deadline), new Date()) <= 7\r\n                                                    ? \"text-amber-400\"\r\n                                                    : \"text-emerald-400\"\r\n                                        )}>{format(parseLocalDate(fullGoal.deadline), \"dd MMM yyyy\", { locale: ptBR })}</span></span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Action Buttons */}\r\n                <div className=\"flex items-center gap-1\">\r\n                    <button\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            if (fullGoal) onEdit(fullGoal);\r\n                        }}\r\n                        className=\"p-1.5 text-slate-400 hover:text-blue-400 hover:bg-blue-500/10 rounded-md transition-colors\"\r\n                        title=\"Editar Projeto\"\r\n                    >\r\n                        <Pencil className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button\r\n                        onClick={async (e) => {\r\n                            e.stopPropagation();\r\n                            const confirmed = await confirm({\r\n                                title: 'Excluir Projeto',\r\n                                message: `Tem certeza que deseja excluir o projeto \"${goal.title}\"?`,\r\n                                confirmText: 'Excluir',\r\n                                cancelText: 'Cancelar',\r\n                                isDangerous: true\r\n                            });\r\n                            if (confirmed) onDelete(goal.id);\r\n                        }}\r\n                        className=\"p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-md transition-colors\"\r\n                        title=\"Excluir Projeto\"\r\n                    >\r\n                        <Trash2 className=\"w-4 h-4\" />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Progress Bars Container */}\r\n            <div className=\"mt-2 space-y-2 z-10\">\r\n                {/* Task Completion Progress */}\r\n                <div className=\"flex flex-col gap-1\">\r\n                    <div className=\"flex justify-between text-[10px] font-bold text-slate-500 uppercase tracking-wider\">\r\n                        <span>Concluso</span>\r\n                        <span>{Math.round(goal.progress)}%</span>\r\n                    </div>\r\n                    <div className=\"h-1.5 bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                        <div\r\n                            className=\"h-full bg-emerald-500 transition-all\"\r\n                            style={{ width: `${goal.progress}%` }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Time Progress (Only if timeLabel exists) */}\r\n                {timeLabel && (\r\n                    <div className=\"flex flex-col gap-1\">\r\n                        <div className=\"flex justify-between text-[10px] font-bold text-slate-500 uppercase tracking-wider\">\r\n                            <span>Tempo Restante</span>\r\n                            <div className=\"flex gap-1\">\r\n                                {fullGoal?.deadline && (\r\n                                    <span className={cn(\r\n                                        \"px-1.5 rounded text-[9px]\",\r\n                                        differenceInDays(parseLocalDate(fullGoal.deadline), new Date()) < 0\r\n                                            ? \"bg-red-500/20 text-red-400\"\r\n                                            : \"bg-blue-500/20 text-blue-400\"\r\n                                    )}>\r\n                                        {differenceInDays(parseLocalDate(fullGoal.deadline), new Date()) < 0 ? \"Atrasado\" : `${differenceInDays(parseLocalDate(fullGoal.deadline), new Date())} dias`}\r\n                                    </span>\r\n                                )}\r\n                                <span className=\"text-slate-400 text-[9px]\">({timeLabel})</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"h-1.5 bg-slate-950 rounded-full overflow-hidden border border-white/5\">\r\n                            <div\r\n                                className=\"h-full bg-blue-500/50 transition-all\"\r\n                                style={{ width: `${timeProgress}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\projects\\ProjectsFilter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\projects\\ProjectsHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\components\\projects\\ThemeProjectCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[226,229],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[226,229],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[252,255],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[252,255],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[344,347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[344,347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[492,495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[492,495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[577,580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[577,580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Trash2, Pencil, Plus } from 'lucide-react';\r\nimport { useConfirm } from '../../../../context/ConfirmContext';\r\nimport { LinkedProjectCard } from './LinkedProjectCard';\r\n\r\ninterface ThemeProjectCardProps {\r\n    theme: any;\r\n    linkedProjects: any[];\r\n    isExpanded: boolean;\r\n    onToggleExpand: () => void;\r\n    onEditTheme: (theme: any) => void;\r\n    onDeleteTheme: (id: string) => void;\r\n    onAddGoalToTheme: (themeId: string) => void;\r\n\r\n    // For linked logic\r\n    allGoals: any[]; // Need full goals to pass to linked card logic logic\r\n    onEditGoal: (goal: any) => void;\r\n    onDeleteGoal: (id: string) => void;\r\n}\r\n\r\nexport const ThemeProjectCard = ({\r\n    theme, linkedProjects, isExpanded, onToggleExpand,\r\n    onEditTheme, onDeleteTheme, onAddGoalToTheme,\r\n    allGoals, onEditGoal, onDeleteGoal\r\n}: ThemeProjectCardProps) => {\r\n    const { confirm } = useConfirm();\r\n    return (\r\n        <div className={`flex flex-col bg-slate-800/30 border rounded-2xl transition-all duration-300 ${isExpanded ? 'border-indigo-500/30 bg-slate-800/50' : 'border-slate-800/50 hover:bg-slate-800/50'}`}>\r\n            {/* Theme Header Card */}\r\n            <div className=\"relative flex p-5 cursor-pointer group\" onClick={onToggleExpand}>\r\n                {!isExpanded && (\r\n                    <div className=\"absolute bottom-0 left-0 h-1 bg-current opacity-20 transition-all duration-1000 rounded-b-2xl\" style={{ width: `${theme.progress}%`, color: theme.color }} />\r\n                )}\r\n\r\n                {/* Theme Action Buttons */}\r\n                <div className=\"absolute top-4 right-4 flex items-center gap-2\">\r\n                    <button\r\n                        onClick={(e) => { e.stopPropagation(); onEditTheme(theme); }}\r\n                        className=\"p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-lg transition-colors border border-transparent hover:border-white/5\"\r\n                        title=\"Editar Detalhes do Tema\"\r\n                    >\r\n                        <Pencil className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button\r\n                        onClick={async (e) => {\r\n                            e.stopPropagation();\r\n                            const confirmed = await confirm({\r\n                                title: 'Excluir Tema',\r\n                                message: `Tem certeza que deseja excluir o tema \"${theme.title}\" e todos os projetos vinculados?`,\r\n                                confirmText: 'Excluir Tudo',\r\n                                cancelText: 'Cancelar',\r\n                                isDangerous: true\r\n                            });\r\n                            if (confirmed) onDeleteTheme(theme.id);\r\n                        }}\r\n                        className=\"p-2 text-slate-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors border border-transparent hover:border-red-500/20\"\r\n                    >\r\n                        <Trash2 className=\"w-4 h-4\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Theme Content */}\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"p-3 bg-slate-800 rounded-xl shadow-lg border border-white/5 relative group-hover:scale-110 transition-transform\">\r\n                        {theme.icon}\r\n                        {linkedProjects.length > 0 && (\r\n                            <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center text-[10px] font-bold text-slate-900 border-2 border-slate-900\">\r\n                                {linkedProjects.length}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                            <span className=\"text-[10px] uppercase font-bold tracking-wider px-2 py-0.5 rounded-full bg-purple-500/10 text-purple-400 border border-purple-500/20\">\r\n                                Tema\r\n                            </span>\r\n                        </div>\r\n                        <h3 className=\"font-bold text-slate-200 text-lg\">{theme.title}</h3>\r\n                        <div className=\"text-xs text-slate-500 mt-0.5\">\r\n                            {theme.itemCount} mdulos de estudo\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Expanded Content (Nested Projects) */}\r\n            {isExpanded && (\r\n                <div className=\"border-t border-white/5 bg-slate-950/20 p-4 animate-in slide-in-from-top-2 duration-200\">\r\n                    <div className=\"flex items-center justify-between mb-3 px-1\">\r\n                        <h4 className=\"text-xs font-bold text-slate-400 uppercase tracking-wider\">Projetos neste Tema</h4>\r\n                        <button onClick={() => onAddGoalToTheme(theme.id)} className=\"text-xs flex items-center gap-1.5 text-blue-400 hover:text-blue-300 font-bold px-2 py-1 rounded-lg hover:bg-blue-500/10 transition-colors\">\r\n                            <Plus className=\"w-3.5 h-3.5\" /> Adicionar Projeto\r\n                        </button>\r\n                    </div>\r\n\r\n                    {linkedProjects.length === 0 ? (\r\n                        <div className=\"text-center py-6 border border-dashed border-slate-800 rounded-xl bg-slate-900/20\">\r\n                            <p className=\"text-xs text-slate-500 mb-2\">Nenhum projeto vinculado.</p>\r\n                            <button onClick={() => onAddGoalToTheme(theme.id)} className=\"text-xs text-blue-400 hover:underline\">Criar primeiro projeto</button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-1 grid-cols-[repeat(auto-fill,minmax(280px,1fr))] gap-3\">\r\n                            {linkedProjects.map(goal => (\r\n                                <LinkedProjectCard\r\n                                    key={goal.id}\r\n                                    goal={goal}\r\n                                    fullGoal={allGoals.find(g => g.id === goal.id)}\r\n                                    onEdit={onEditGoal}\r\n                                    onDelete={onDeleteGoal}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\hooks\\useMissionLogic.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\hooks\\useMissionLogic.ts:29:19\n  27 |         const savedSchedule = localStorage.getItem(`daily_schedule_${dateStr}`);\n  28 |         if (savedSchedule) {\n> 29 |             try { setDailySchedule(JSON.parse(savedSchedule)); } catch (e) { console.error(\"Failed to parse daily schedule\", e); }\n     |                   ^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  30 |         } else {\n  31 |             setDailySchedule({});\n  32 |         }","line":29,"column":19,"nodeType":null,"endLine":29,"endColumn":35},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\dashboard\\hooks\\useMissionLogic.ts:56:17\n  54 |                 const now = Date.now();\n  55 |                 const newProgress = { ...missionProgress, [id]: { ...missionProgress[id], startedAt: now } };\n> 56 |                 setMissionProgress(newProgress);\n     |                 ^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  57 |                 localStorage.setItem(`mission_progress_${dateStr}`, JSON.stringify(newProgress));\n  58 |             }\n  59 |         }","line":56,"column":17,"nodeType":null,"endLine":56,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":134,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6020,6023],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6020,6023],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isCompletedToday' is assigned a value but never used.","line":179,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":255,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11228,11231],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11228,11231],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":255,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11248,11251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11248,11251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":255,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":255,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11270,11273],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11270,11273],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12262,12265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12262,12265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12282,12285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12282,12285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12304,12307],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12304,12307],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12386,12389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12386,12389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12406,12409],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12406,12409],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12428,12431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12428,12431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'overdueTasks' is assigned a value but never used.","line":299,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":299,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":303,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13755,13758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13755,13758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":311,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":311,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14029,14032],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14029,14032],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":329,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":329,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14843,14846],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14843,14846],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from 'react';\r\nimport { useStudy } from '../../../context/StudyContext'; // Correct relative path\r\nimport { usePomodoroContext } from '../../../context/PomodoroContext';\r\nimport { format, addDays, isToday } from 'date-fns';\r\nimport { useToast } from '../../../context/ToastContext';\r\n\r\nexport const useMissionLogic = () => {\r\n    const { themes, tasks, goals, startFocus, activeFocus, toggleTask, toggleGoal, toggleGoalItem, completeReview } = useStudy();\r\n    const { startFocusSession } = usePomodoroContext();\r\n    const { showToast } = useToast();\r\n\r\n    // Date Navigation State\r\n    const [selectedDate, setSelectedDate] = useState(new Date());\r\n    const dateStr = format(selectedDate, 'yyyy-MM-dd');\r\n    const isCurrentDay = isToday(selectedDate);\r\n    const dayOfWeek = selectedDate.getDay();\r\n\r\n    const handlePrevDay = () => setSelectedDate(prev => addDays(prev, -1));\r\n    const handleNextDay = () => setSelectedDate(prev => addDays(prev, 1));\r\n\r\n    // --- Daily Schedule Logic (Local Storage) ---\r\n    const [dailySchedule, setDailySchedule] = useState<Record<string, string>>({});\r\n    // --- Start Time Persistence (Local Storage) ---\r\n    const [missionProgress, setMissionProgress] = useState<Record<string, { startedAt?: number }>>({});\r\n\r\n    useEffect(() => {\r\n        const savedSchedule = localStorage.getItem(`daily_schedule_${dateStr}`);\r\n        if (savedSchedule) {\r\n            try { setDailySchedule(JSON.parse(savedSchedule)); } catch (e) { console.error(\"Failed to parse daily schedule\", e); }\r\n        } else {\r\n            setDailySchedule({});\r\n        }\r\n\r\n        const savedProgress = localStorage.getItem(`mission_progress_${dateStr}`);\r\n        if (savedProgress) {\r\n            try { setMissionProgress(JSON.parse(savedProgress)); } catch (e) { console.error(\"Failed to parse mission progress\", e); }\r\n        } else {\r\n            setMissionProgress({});\r\n        }\r\n    }, [dateStr]);\r\n\r\n    const handleSetTime = (id: string, time: string) => {\r\n        const newSchedule = { ...dailySchedule, [id]: time };\r\n        if (!time) delete newSchedule[id];\r\n        setDailySchedule(newSchedule);\r\n        localStorage.setItem(`daily_schedule_${dateStr}`, JSON.stringify(newSchedule));\r\n    };\r\n\r\n    // Track Start Time when Active Focus changes\r\n    useEffect(() => {\r\n        if (activeFocus && activeFocus.id) {\r\n            const id = activeFocus.id;\r\n            if (!missionProgress[id]?.startedAt) {\r\n                const now = Date.now();\r\n                const newProgress = { ...missionProgress, [id]: { ...missionProgress[id], startedAt: now } };\r\n                setMissionProgress(newProgress);\r\n                localStorage.setItem(`mission_progress_${dateStr}`, JSON.stringify(newProgress));\r\n            }\r\n        }\r\n    }, [activeFocus, missionProgress, dateStr]);\r\n\r\n    // --- DATA FILTERING ---\r\n\r\n    const allData = useMemo(() => {\r\n        // ... Logic from TodayMissionWidget ...\r\n\r\n        // 1. REVIEWS & INTROS\r\n        const reviewsOfInterest = themes.flatMap(t =>\r\n            t.subthemes.flatMap(st => {\r\n                return st.reviews\r\n                    .filter(r => {\r\n                        if (isCurrentDay) {\r\n                            if (r.status === 'pending' && r.date <= dateStr) return true;\r\n                            if (r.completedAt) {\r\n                                const completedDate = format(new Date(r.completedAt), 'yyyy-MM-dd');\r\n                                if (completedDate === dateStr) return true;\r\n                            }\r\n                            return false;\r\n                        }\r\n                        if (r.date === dateStr) return true;\r\n                        if (r.completedAt) {\r\n                            const completedDate = format(new Date(r.completedAt), 'yyyy-MM-dd');\r\n                            if (completedDate === dateStr) return true;\r\n                        }\r\n                        return false;\r\n                    })\r\n                    .map(r => ({\r\n                        ...r,\r\n                        subthemeId: st.id,\r\n                        themeTitle: t.title,\r\n                        subthemeTitle: st.title,\r\n                        reviewNumber: r.number,\r\n                        type: 'review',\r\n                        completedAt: r.completedAt,\r\n                        color: t.color,\r\n                        imageUrl: t.imageUrl,\r\n                        currentReviewNum: r.number,\r\n                        totalReviews: st.reviews.length,\r\n                        completedReviewCount: st.reviews.filter(rev => rev.status === 'completed').length,\r\n                        subthemeReviews: st.reviews\r\n                    }));\r\n            })\r\n        );\r\n\r\n        const introsOfInterest = themes.flatMap(t =>\r\n            t.subthemes\r\n                .filter(st => st.introductionDate === dateStr)\r\n                .map(st => ({\r\n                    number: 0,\r\n                    date: st.introductionDate!,\r\n                    status: st.status === 'active' ? 'completed' : 'pending',\r\n                    subthemeId: st.id,\r\n                    themeTitle: t.title,\r\n                    subthemeTitle: st.title,\r\n                    reviewNumber: 0,\r\n                    type: 'intro',\r\n                    subthemeReviews: st.reviews,\r\n                    color: t.color\r\n                }))\r\n        );\r\n\r\n        const activeSubthemes = themes.flatMap(t =>\r\n            t.subthemes.filter(st => st.status === 'active').map(st => ({\r\n                ...st, themeTitle: t.title, color: t.color, imageUrl: t.imageUrl\r\n            }))\r\n        );\r\n\r\n        // \"Active but not reviewed today\" Logic\r\n        const activeSubthemesWithoutReview = activeSubthemes.filter(st =>\r\n            !reviewsOfInterest.some(r => r.subthemeId === st.id)\r\n        ).map(st => {\r\n            let isLocked = false;\r\n            let lockReason = \"\";\r\n            const nextReview = st.reviews.find((r: any) => r.status === 'pending');\r\n            const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n\r\n            if (nextReview && nextReview.date > todayStr) {\r\n                isLocked = true;\r\n                lockReason = `Prxima reviso: ${format(new Date(nextReview.date), 'dd/MM')}`;\r\n            }\r\n\r\n            return {\r\n                ...st,\r\n                subthemeId: st.id,\r\n                subthemeTitle: st.title,\r\n                type: 'review',\r\n                status: 'active',\r\n                currentReviewNum: 0,\r\n                reviewNumber: 0,\r\n                isLocked,\r\n                lockReason\r\n            };\r\n        });\r\n\r\n        const allReviews = [...introsOfInterest, ...reviewsOfInterest.map(r => {\r\n            const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n            let isLocked = false;\r\n            let lockReason = \"\";\r\n            if (r.date > todayStr) {\r\n                isLocked = true;\r\n                lockReason = `Agendado para ${format(new Date(r.date), 'dd/MM')}`;\r\n            }\r\n            return { ...r, isLocked, lockReason };\r\n        }), ...activeSubthemesWithoutReview].sort((a, b) => {\r\n            if (a.status === 'completed' && b.status === 'pending') return 1;\r\n            if (a.status === 'pending' && b.status === 'completed') return -1;\r\n            return 0;\r\n        });\r\n\r\n        // 2. TASKS\r\n        const todaysTasks = tasks.filter(t => {\r\n            const taskCreationDay = new Date(t.createdAt).setHours(0, 0, 0, 0);\r\n            const targetDateObj = new Date(dateStr + 'T00:00:00');\r\n            if (targetDateObj.getTime() < taskCreationDay) return false;\r\n\r\n            if (t.type === 'day') {\r\n                const isOverdue = !!t.date && t.date < dateStr;\r\n                const isPendingOverdue = isCurrentDay && isOverdue && !t.status.includes('completed');\r\n                const isCompletedToday = isOverdue && t.completionHistory && t.completionHistory.some(h => h.startsWith(dateStr));\r\n                return (t.date === dateStr) || isPendingOverdue || (t.completionHistory && t.completionHistory.some(h => h.startsWith(dateStr)));\r\n            }\r\n            if (t.type === 'recurring' && t.recurrence) {\r\n                if (t.endDate && dateStr > t.endDate) return false;\r\n                return t.recurrence.includes(dayOfWeek);\r\n            }\r\n            if (t.type === 'period' && t.startDate && t.endDate) {\r\n                return dateStr >= t.startDate && dateStr <= t.endDate;\r\n            }\r\n            return false;\r\n        }).map(t => {\r\n            let isDone = t.status === 'completed';\r\n            let completedAt: string | undefined = undefined;\r\n            if (t.completionHistory) {\r\n                const entry = t.completionHistory.find(h => h.startsWith(dateStr));\r\n                if (entry) {\r\n                    isDone = true;\r\n                    completedAt = entry;\r\n                }\r\n            }\r\n            return { ...t, isDone, completedAt };\r\n        });\r\n\r\n        // 3. HABITS & GOALS\r\n        const todaysHabits = goals.filter(g => {\r\n            if (g.createdAt) {\r\n                const goalCreationDay = new Date(g.createdAt).setHours(0, 0, 0, 0);\r\n                const targetDateObj = new Date(dateStr + 'T00:00:00');\r\n                if (targetDateObj.getTime() < goalCreationDay) return false;\r\n            }\r\n            if (g.type === 'habit') {\r\n                if (g.deadline && dateStr > g.deadline) return false;\r\n                if (g.recurrence && g.recurrence.length > 0) return g.recurrence.includes(dayOfWeek);\r\n                return true;\r\n            }\r\n            if (g.deadline === dateStr) return true;\r\n            return false;\r\n        }).map(g => {\r\n            let isDone = false;\r\n            let completedAt: string | undefined = undefined;\r\n            if (g.completionHistory) {\r\n                const entry = g.completionHistory.find(h => h.startsWith(dateStr));\r\n                if (entry) {\r\n                    isDone = true;\r\n                    completedAt = entry;\r\n                }\r\n            } else if (g.type !== 'habit') {\r\n                isDone = g.progress === 100;\r\n            }\r\n            return { ...g, isDone, completedAt };\r\n        });\r\n\r\n        const todaysSteps = goals.flatMap(g => {\r\n            if (!g.checklist) return [];\r\n            return g.checklist.filter(item => {\r\n                if (!item.deadline) return false;\r\n                const itemDeadline = item.deadline.split('T')[0];\r\n                if (isCurrentDay) {\r\n                    if (item.completed) return itemDeadline === dateStr;\r\n                    return itemDeadline <= dateStr;\r\n                }\r\n                return itemDeadline === dateStr;\r\n            }).map(item => ({\r\n                ...item,\r\n                id: item.id,\r\n                title: `${item.title} (${g.title})`,\r\n                goalId: g.id,\r\n                isDone: item.completed,\r\n                type: 'step',\r\n                color: g.color,\r\n                priority: g.priority || 'medium'\r\n            }));\r\n        });\r\n\r\n        const allTasks = [...todaysTasks, ...todaysSteps].map(t => {\r\n            const taskDateStr = (t as any).date || ((t as any).deadline ? (t as any).deadline.split('T')[0] : undefined);\r\n            const isOverdue = !t.isDone && taskDateStr && taskDateStr < dateStr;\r\n            return { ...t, isOverdue };\r\n        }).sort((a, b) => {\r\n            // 1. Overdue items first (not done)\r\n            if (a.isOverdue && !b.isOverdue) return -1;\r\n            if (!a.isOverdue && b.isOverdue) return 1;\r\n\r\n            // 2. Then incomplete before complete\r\n            if (a.isDone && !b.isDone) return 1;\r\n            if (!a.isDone && b.isDone) return -1;\r\n\r\n            // 3. Among overdue or among normal, sort by priority\r\n            const pMap: Record<string, number> = { high: 3, medium: 2, low: 1 };\r\n            const pA = a.priority ? pMap[a.priority as string] : 1;\r\n            const pB = b.priority ? pMap[b.priority as string] : 1;\r\n\r\n            if (pA !== pB) return pB - pA;\r\n\r\n            // 4. Finally, for overdue items, oldest first\r\n            if (a.isOverdue && b.isOverdue) {\r\n                const dateA = (a as any).date || ((a as any).deadline ? (a as any).deadline.split('T')[0] : '9999-99-99');\r\n                const dateB = (b as any).date || ((b as any).deadline ? (b as any).deadline.split('T')[0] : '9999-99-99');\r\n                return dateA.localeCompare(dateB);\r\n            }\r\n\r\n            return 0;\r\n        });\r\n\r\n        return { allHabits: todaysHabits, allReviews, allTasks, todaysTasks, todaysSteps }; // Return sub-lists if needed\r\n    }, [themes, tasks, goals, dateStr, isCurrentDay, dayOfWeek]);\r\n\r\n    // Stats\r\n    const totalCount = allData.allReviews.length + allData.allTasks.length + allData.allHabits.length;\r\n    const completedCount =\r\n        allData.allReviews.filter(r => r.status === 'completed').length +\r\n        allData.allTasks.filter(t => t.isDone).length +\r\n        allData.allHabits.filter(g => g.isDone).length;\r\n\r\n    const progressPercent = totalCount === 0 ? 0 : Math.round((completedCount / totalCount) * 100);\r\n    const isAllDone = totalCount > 0 && completedCount === totalCount;\r\n\r\n    // Overdue Check\r\n    const hasOverdueItems = useMemo(() => {\r\n        const overdueTasks = tasks.filter(t => t.type === 'day' && t.date && t.date < dateStr && t.status !== 'completed'); // Simplified check\r\n        // Ideally we re-use the exact filtered lists logic but simplified.\r\n        // Actually, we can check 'allTasks' for items that are overdue.\r\n        // 'allTasks' includes overdue tasks if in 'Today' mode.\r\n        return allData.allTasks.some((t: any) => {\r\n            const tDate = t.date || (t.deadline ? t.deadline.split('T')[0] : undefined);\r\n            return !t.isDone && tDate && tDate < dateStr;\r\n        });\r\n    }, [allData.allTasks, dateStr, tasks]);\r\n\r\n\r\n    // Handlers\r\n    const handleFocusItem = (item: any, groupType: string) => {\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        if (dateStr > todayStr) {\r\n            showToast(\"Voc no pode focar em atividades agendadas para o futuro!\", \"error\");\r\n            return;\r\n        }\r\n\r\n        // Shared Focus Logic\r\n        const focusType = groupType === 'habit' ? 'goal' : groupType === 'review' ? 'subtheme' : 'task';\r\n        const id = item.id || item.subthemeId;\r\n        const duration = item.durationMinutes || 25;\r\n        const parentId = item.goalId;\r\n\r\n        startFocus(id, focusType, item.title || item.subthemeTitle || item.themeTitle, duration, item.reviewNumber, item.type, parentId);\r\n        startFocusSession(id, duration);\r\n    };\r\n\r\n    const handleToggleItem = (item: any, groupType: string) => {\r\n        const id = item.id || item.subthemeId;\r\n\r\n        if (groupType === 'task') {\r\n            if (item.type === 'step') {\r\n                toggleGoalItem(item.goalId, id, dateStr);\r\n            } else {\r\n                toggleTask(id, dateStr);\r\n            }\r\n        } else if (groupType === 'habit') {\r\n            toggleGoal(id, dateStr);\r\n        } else if (groupType === 'review') {\r\n            const difficulty = 'medium'; // Default difficulty for quick toggle\r\n            completeReview(id, item.reviewNumber, item.type, difficulty);\r\n        }\r\n    };\r\n\r\n    return {\r\n        // Date\r\n        selectedDate,\r\n        setSelectedDate,\r\n        handlePrevDay,\r\n        handleNextDay,\r\n        isCurrentDay,\r\n        dateStr,\r\n\r\n        // Data\r\n        allHabits: allData.allHabits,\r\n        allReviews: allData.allReviews,\r\n        allTasks: allData.allTasks,\r\n\r\n        // Stats\r\n        totalCount,\r\n        completedCount,\r\n        progressPercent,\r\n        isAllDone,\r\n        hasOverdueItems,\r\n\r\n        // State & Actions\r\n        dailySchedule,\r\n        handleSetTime,\r\n        missionProgress,\r\n\r\n        // Handlers\r\n        handleFocusItem,\r\n        handleToggleItem\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\debug\\SyncDebugWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":2,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":6,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'XCircle' is defined but never used.","line":6,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'readData' is assigned a value but never used.","line":33,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'themeError' is assigned a value but never used.","line":88,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":125,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":125,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5188,5191],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5188,5191],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { Button } from '../../components/ui/Button';\r\nimport { RefreshCw, AlertTriangle, CheckCircle, XCircle } from 'lucide-react';\r\n\r\nexport const SyncDebugWidget: React.FC = () => {\r\n    const { user } = useAuth();\r\n    const [status, setStatus] = useState<'idle' | 'testing' | 'success' | 'failure'>('idle');\r\n    const [logs, setLogs] = useState<string[]>([]);\r\n\r\n    const addLog = (msg: string, type: 'info' | 'error' | 'success' = 'info') => {\r\n        const timestamp = new Date().toLocaleTimeString();\r\n        setLogs(prev => [`[${timestamp}] ${type.toUpperCase()}: ${msg}`, ...prev]);\r\n    };\r\n\r\n    const runDiagnostics = async () => {\r\n        setStatus('testing');\r\n        setLogs([]);\r\n        addLog(\"Iniciando diagnstico...\", 'info');\r\n\r\n        if (!user) {\r\n            addLog(\"ERRO: Usurio no autenticado no AuthContext.\", 'error');\r\n            setStatus('failure');\r\n            return;\r\n        }\r\n        addLog(`Usurio detectado: ${user.email} (${user.id})`, 'success');\r\n\r\n        try {\r\n            // Test 1: Connection & Read\r\n            addLog(\"Teste 1: Conexo e Leitura (Tasks)...\", 'info');\r\n            const { data: readData, error: readError } = await supabase\r\n                .from('tasks')\r\n                .select('id')\r\n                .limit(1);\r\n\r\n            if (readError) {\r\n                addLog(`FALHA LEITURA: ${readError.message} (Code: ${readError.code})`, 'error');\r\n                if (readError.code === 'PGRST301') addLog(\"Dica: Row Level Security (RLS) pode estar bloqueando.\", 'info');\r\n                throw readError;\r\n            }\r\n            addLog(\"Leitura OK.\", 'success');\r\n\r\n            // Test 2: Write Task\r\n            addLog(\"Teste 2: Escrita (Tasks)...\", 'info');\r\n            const dummyId = crypto.randomUUID();\r\n            const { error: taskError } = await supabase.from('tasks').insert({\r\n                id: dummyId,\r\n                title: 'DIAGNOSTIC_TASK_' + Date.now(),\r\n                user_id: user.id,\r\n                created_at: new Date().toISOString(),\r\n                status: 'pending',\r\n                priority: 'low',\r\n                type: 'day'\r\n            });\r\n            if (taskError) {\r\n                addLog(`FALHA TASKS: ${taskError.message}`, 'error');\r\n                throw taskError;\r\n            } else {\r\n                await supabase.from('tasks').delete().eq('id', dummyId);\r\n                addLog(\"Tasks OK.\", 'success');\r\n            }\r\n\r\n            // Test 3: Write Goal\r\n            addLog(\"Teste 3: Escrita (Goals)...\", 'info');\r\n            const goalId = crypto.randomUUID();\r\n            const { error: goalError } = await supabase.from('goals').insert({\r\n                id: goalId,\r\n                title: 'DIAGNOSTIC_GOAL',\r\n                user_id: user.id,\r\n                created_at: new Date().toISOString(),\r\n                type: 'simple',\r\n                category: 'test',\r\n                progress: 0\r\n            });\r\n            if (goalError) {\r\n                addLog(`FALHA GOALS: ${goalError.message}`, 'error');\r\n                // Don't throw, try next\r\n            } else {\r\n                await supabase.from('goals').delete().eq('id', goalId);\r\n                addLog(\"Goals OK.\", 'success');\r\n            }\r\n\r\n            // Test 4: Write Theme\r\n            addLog(\"Teste 4: Escrita (Themes)...\", 'info');\r\n            const themeId = crypto.randomUUID();\r\n            const { error: themeError } = await supabase.from('themes').insert({\r\n                id: themeId,\r\n                title: 'DIAGNOSTIC_THEME',\r\n                user_id: user.id,\r\n                created_at: new Date().toISOString(),\r\n                color: '#000000'\r\n            });\r\n            // Test 5: Write Subtheme\r\n            addLog(\"Teste 5: Escrita (Subthemes)...\", 'info');\r\n            const subId = crypto.randomUUID();\r\n            // Need a valid parent theme for FK constraint? \r\n            // If we use the previous themeId... but we deleted it.\r\n            // Let's create a temporary theme just for this test\r\n            const tempThemeId = crypto.randomUUID();\r\n            await supabase.from('themes').insert({ id: tempThemeId, title: 'TEMP_PARENT', user_id: user.id, color: '#000' });\r\n\r\n            const { error: subError } = await supabase.from('subthemes').insert({\r\n                id: subId,\r\n                theme_id: tempThemeId,\r\n                title: 'DIAGNOSTIC_SUBTHEME',\r\n                status: 'queue'\r\n                // user_id removed\r\n            });\r\n\r\n            if (subError) {\r\n                addLog(`FALHA SUBTHEMES: ${subError.message}`, 'error');\r\n            } else {\r\n                addLog(\"Subthemes OK.\", 'success');\r\n            }\r\n            // Cleanup All\r\n            await supabase.from('subthemes').delete().eq('id', subId);\r\n            await supabase.from('themes').delete().eq('id', tempThemeId);\r\n\r\n\r\n            addLog(\"Diagnstico Completo: TUDO VERDE! \", 'success');\r\n            setStatus('success');\r\n\r\n        } catch (e: any) {\r\n            setStatus('failure');\r\n            addLog(`Diagnstico finalizado com ERROS.`, 'error');\r\n        }\r\n    };\r\n\r\n    const forceReset = () => {\r\n        localStorage.removeItem('sync_queue_v1');\r\n        localStorage.removeItem('sync_queue_v2'); // Just in case\r\n        window.location.reload();\r\n    };\r\n\r\n    if (import.meta.env.PROD) return null; // Safety\r\n\r\n    return (\r\n        <div className=\"fixed bottom-4 right-4 z-50 p-4 bg-slate-900 border border-slate-700 rounded-lg shadow-2xl w-96 max-h-[500px] overflow-hidden flex flex-col\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n                <h3 className=\"text-white font-bold flex items-center gap-2\">\r\n                    <AlertTriangle className=\"w-4 h-4 text-amber-500\" /> Diagnstico de Sync\r\n                </h3>\r\n                <div className=\"flex gap-2\">\r\n                    <Button size=\"sm\" variant=\"ghost\" onClick={forceReset} className=\"text-red-400 hover:text-red-300\">\r\n                        <AlertTriangle className=\"w-3 h-3 mr-1\" /> Resetar\r\n                    </Button>\r\n                    <Button size=\"sm\" onClick={runDiagnostics} disabled={status === 'testing'}>\r\n                        {status === 'testing' ? <RefreshCw className=\"w-3 h-3 animate-spin\" /> : 'Testar Agora'}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div className=\"flex-1 overflow-y-auto bg-black/50 p-2 rounded text-xs font-mono space-y-1 h-64\">\r\n                {logs.length === 0 && <span className=\"text-slate-500\">Aguardando execuo...</span>}\r\n                {logs.map((log, i) => (\r\n                    <div key={i} className={\r\n                        log.includes('INFO') ? 'text-blue-300' :\r\n                            log.includes('SUCCESS') ? 'text-emerald-300' :\r\n                                log.includes('ERROR') ? 'text-red-400 font-bold' : 'text-slate-300'\r\n                    }>\r\n                        {log}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {status === 'failure' && (\r\n                <div className=\"mt-2 p-2 bg-red-500/10 border border-red-500/20 rounded text-red-200 text-xs\">\r\n                    Por favor, tire um print desta tela e me mostre os erros em vermelho.\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\forms\\AddTaskModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Select' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addDays' is defined but never used.","line":7,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3300,3303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3300,3303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3332,3335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3332,3335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3950,3953],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3950,3953],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4173,4176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4173,4176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4632,4635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4632,4635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4697,4700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4697,4700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":156,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8374,8377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8374,8377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":188,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":188,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10489,10492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10489,10492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":200,"column":125,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":128,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11533,11536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11533,11536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { Input } from '../../components/ui/Input';\r\nimport { Select } from '../../components/ui/Select';\r\nimport { Button } from '../../components/ui/Button';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { format, addDays, addMonths } from 'date-fns';\r\nimport { DaySelector } from '../../components/forms/DaySelector';\r\nimport { ImageUpload } from '../../components/forms/ImageUpload';\r\nimport { ColorPicker } from '../../components/forms/ColorPicker';\r\nimport { PrioritySelector } from '../../components/forms/PrioritySelector';\r\nimport { DurationStepper } from '../../components/forms/DurationStepper';\r\nimport { DatePicker } from '../../components/ui/DatePicker';\r\nimport type { Task } from '../../types';\r\n\r\ninterface AddTaskModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    taskToEdit?: Task; // Optional prop for edit mode\r\n}\r\n\r\nexport const AddTaskModal: React.FC<AddTaskModalProps> = ({ isOpen, onClose, taskToEdit }) => {\r\n    const { addTask, updateTask, themes, tasks, goals, addGoal } = useStudy();\r\n\r\n    const usedColors = [\r\n        ...themes.map(t => t.color),\r\n        ...tasks.map(t => t.color),\r\n        ...goals.map(g => g.color)\r\n    ].filter(Boolean) as string[];\r\n\r\n    // Initialize state properly when modal opens/changes\r\n    const [title, setTitle] = useState(taskToEdit?.title || '');\r\n    const [priority, setPriority] = useState(taskToEdit?.priority || 'medium');\r\n    const [type, setType] = useState(taskToEdit?.type || 'day');\r\n    const [date, setDate] = useState(taskToEdit?.date || format(new Date(), 'yyyy-MM-dd'));\r\n    const [startDate, setStartDate] = useState(taskToEdit?.startDate || format(new Date(), 'yyyy-MM-dd'));\r\n    const [endDate, setEndDate] = useState(taskToEdit?.endDate || '');\r\n    const [recurrence, setRecurrence] = useState<number[]>(taskToEdit?.recurrence || []);\r\n    const [icon, setIcon] = useState(taskToEdit?.icon || '');\r\n    const [color, setColor] = useState(taskToEdit?.color || '');\r\n    const [imageUrl, setImageUrl] = useState(taskToEdit?.imageUrl || '');\r\n    const [duration, setDuration] = useState(taskToEdit?.durationMinutes?.toString() || '');\r\n\r\n    // Reset or Set values when taskToEdit changes\r\n    React.useEffect(() => {\r\n        if (isOpen) {\r\n            setTitle(taskToEdit?.title || '');\r\n            setPriority(taskToEdit?.priority || 'medium');\r\n            setType(taskToEdit?.type || 'day');\r\n            setDate(taskToEdit?.date || format(new Date(), 'yyyy-MM-dd'));\r\n            setStartDate(taskToEdit?.startDate || format(new Date(), 'yyyy-MM-dd'));\r\n            setEndDate(taskToEdit?.endDate || '');\r\n            setRecurrence(taskToEdit?.recurrence || []);\r\n            setIcon(taskToEdit?.icon || '');\r\n            setColor(taskToEdit?.color || '');\r\n            setImageUrl(taskToEdit?.imageUrl || '');\r\n            setDuration(taskToEdit?.durationMinutes?.toString() || '');\r\n        }\r\n    }, [isOpen, taskToEdit]);\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!title) return;\r\n\r\n        const taskData = {\r\n            title,\r\n            status: taskToEdit?.status || 'pending',\r\n            priority: priority as any,\r\n            type: type as any,\r\n            date: type === 'day' ? date : undefined,\r\n            startDate: type === 'period' ? startDate : undefined,\r\n            endDate: (type === 'period' || type === 'recurring') ? endDate : undefined,\r\n            recurrence: type === 'recurring' ? recurrence : undefined,\r\n            icon: icon || undefined,\r\n            color: color || undefined,\r\n            imageUrl: imageUrl || undefined,\r\n            durationMinutes: duration ? parseInt(duration) : undefined\r\n        };\r\n\r\n        if (taskToEdit) {\r\n            updateTask(taskToEdit.id, taskData);\r\n        } else {\r\n            if ((type as any) === 'goal') {\r\n                const goalData = {\r\n                    title,\r\n                    type: 'simple',\r\n                    category: 'Geral', // Default category\r\n                    priority: priority as any,\r\n                    startDate: startDate || format(new Date(), 'yyyy-MM-dd'),\r\n                    deadline: endDate || format(addMonths(new Date(), 1), 'yyyy-MM-dd'),\r\n                    icon: icon || undefined,\r\n                    color: color || undefined,\r\n                    imageUrl: imageUrl || undefined,\r\n                    durationMinutes: duration ? parseInt(duration) : undefined\r\n                };\r\n                addGoal(goalData as any);\r\n            } else {\r\n                addTask(taskData as any);\r\n            }\r\n        }\r\n\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\" maxWidth=\"xl\">\r\n            <div className=\"relative overflow-hidden p-5 sm:p-6\">\r\n                {/* Subtle Background Ambiance */}\r\n                <div className=\"absolute top-[-20%] right-[-20%] w-[400px] h-[400px] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none\" />\r\n                <div className=\"absolute bottom-[-20%] left-[-20%] w-[300px] h-[300px] bg-indigo-600/5 rounded-full blur-[80px] pointer-events-none\" />\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none\" />\r\n\r\n                <form onSubmit={handleSubmit} className=\"relative z-10 font-sans\">\r\n\r\n                    {/* Header Row */}\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-xl border border-white/5 flex items-center justify-center shadow-inner\">\r\n                                <span className=\"text-xl\"></span>\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-lg font-bold text-white tracking-tight leading-none\">\r\n                                    {taskToEdit ? \"Editar Misso\" : \"Nova Misso\"}\r\n                                </h2>\r\n                                <p className=\"text-[11px] text-slate-500 font-medium px-0.5\">Defina seu prximo objetivo</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-5 px-6\">\r\n                        {/* Main Input */}\r\n                        <div className=\"relative group\">\r\n                            <div className=\"absolute -inset-0.5 bg-gradient-to-r from-blue-500/20 to-indigo-500/20 rounded-xl opacity-0 group-focus-within:opacity-100 blur transition duration-500\" />\r\n                            <input\r\n                                placeholder=\"Digite o nome da misso...\"\r\n                                value={title}\r\n                                onChange={e => setTitle(e.target.value)}\r\n                                autoFocus\r\n                                className=\"relative w-full bg-slate-950/80 text-white placeholder-slate-600 border border-white/5 rounded-xl px-4 py-3 text-base font-medium focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all shadow-sm\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Frequency Selector (Tabs Style) */}\r\n                        <div className=\"bg-slate-950/60 p-1 rounded-xl border border-white/5 flex gap-1\">\r\n                            {[\r\n                                { value: 'day', label: 'Hoje', icon: '' },\r\n                                { value: 'period', label: 'Ciclo', icon: '' },\r\n                                { value: 'recurring', label: 'Rotina', icon: '' },\r\n                                { value: 'goal', label: 'Meta', icon: '' },\r\n                            ].map((opt) => (\r\n                                <button\r\n                                    key={opt.value}\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n                                        setType(opt.value as any);\r\n                                        if (opt.value === 'day') setDate(todayStr);\r\n                                        if (opt.value === 'period' || opt.value === 'goal') setStartDate(todayStr);\r\n                                    }}\r\n                                    className={`\r\n                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase tracking-wide transition-all flex items-center justify-center gap-2\r\n                                        ${type === opt.value\r\n                                            ? 'bg-blue-600/10 text-blue-400 shadow-sm border border-blue-500/20'\r\n                                            : 'text-slate-500 hover:text-slate-300 hover:bg-white/5 border border-transparent'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <span className=\"text-sm\">{opt.icon}</span>\r\n                                    {opt.label}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {/* Date & Details Container */}\r\n                        <div className=\"bg-slate-900/40 rounded-xl border border-white/5 p-4 space-y-4\">\r\n                            {/* Dynamic Date Fields */}\r\n                            <div>\r\n                                {type === 'day' && (\r\n                                    <div className=\"animate-in fade-in zoom-in-95 duration-200 grid grid-cols-[auto_1fr] gap-4 items-center\">\r\n                                        <label className=\"text-xs font-medium text-slate-400\">Data:</label>\r\n                                        <DatePicker\r\n                                            value={date}\r\n                                            onChange={setDate}\r\n                                            className=\"w-full\"\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n                                {(type === 'period' || (type as any) === 'goal') && (\r\n                                    <div className=\"animate-in fade-in zoom-in-95 duration-200 space-y-3\">\r\n                                        <div className=\"flex gap-3\">\r\n                                            <div className=\"flex-1 space-y-1\">\r\n                                                <label className=\"text-[10px] uppercase font-bold text-slate-500\">Incio</label>\r\n                                                <DatePicker\r\n                                                    value={startDate}\r\n                                                    onChange={setStartDate}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"flex items-end pb-3 opacity-30 text-slate-400\"></div>\r\n                                            <div className=\"flex-1 space-y-1\">\r\n                                                <label className=\"text-[10px] uppercase font-bold text-slate-500\">{(type as any) === 'goal' ? 'Prazo' : 'Fim'}</label>\r\n                                                <DatePicker\r\n                                                    value={endDate}\r\n                                                    onChange={setEndDate}\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                                {/* Period/Cycle/Goal Dates */}\r\n                                {type === 'recurring' && (\r\n                                    <div className=\"animate-in fade-in zoom-in-95 duration-200 space-y-3\">\r\n                                        {type === 'recurring' && (\r\n                                            <DaySelector selectedDays={recurrence} onChange={setRecurrence} />\r\n                                        )}\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 shrink-0\">At:</label>\r\n                                            <div className=\"flex-1\">\r\n                                                <DatePicker\r\n                                                    value={endDate}\r\n                                                    onChange={setEndDate}\r\n                                                    placeholder=\"Sem data final\"\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Quick Deadlines */}\r\n                            <div className=\"flex items-center gap-2 overflow-x-auto pb-1\">\r\n                                <span className=\"text-[10px] font-bold text-slate-500 uppercase shrink-0\">Prazos:</span>\r\n                                {[\r\n                                    { label: '+1 Ms', months: 1 },\r\n                                    { label: '+3 Meses', months: 3 },\r\n                                    { label: '+6 Meses', months: 6 },\r\n                                    { label: '+1 Ano', months: 12 },\r\n                                ].map((opt) => (\r\n                                    <button\r\n                                        key={opt.label}\r\n                                        type=\"button\"\r\n                                        onClick={() => {\r\n                                            const baseDate = new Date();\r\n                                            const targetDate = addMonths(baseDate, opt.months);\r\n                                            const formatted = format(targetDate, 'yyyy-MM-dd');\r\n\r\n                                            if (type === 'day') setDate(formatted);\r\n                                            else setEndDate(formatted);\r\n                                        }}\r\n                                        className=\"h-7 px-2.5 rounded bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-medium text-slate-400 hover:text-white transition-colors whitespace-nowrap\"\r\n                                    >\r\n                                        {opt.label}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"h-px bg-white/5 w-full my-4\" />\r\n\r\n                            {/* Attributes Grid */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div className=\"space-y-1\">\r\n                                    <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Durao (Min)</label>\r\n                                    <div className=\"bg-slate-950/50 rounded-lg border border-white/5 p-0.5\">\r\n                                        <DurationStepper value={duration} onChange={setDuration} step={15} />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"space-y-1\">\r\n                                    <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Prioridade</label>\r\n                                    <PrioritySelector value={priority} onChange={setPriority} />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-[60px_1fr] gap-4\">\r\n                                <div className=\"space-y-1\">\r\n                                    <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">cone</label>\r\n                                    <div className=\"relative\">\r\n                                        <Input\r\n                                            value={icon}\r\n                                            onChange={e => setIcon(e.target.value)}\r\n                                            className=\"text-center h-10 bg-slate-950/50 border-white/5 text-lg\"\r\n                                            placeholder=\"\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"space-y-1\">\r\n                                    <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Cor</label>\r\n                                    <ColorPicker\r\n                                        value={color}\r\n                                        onChange={setColor}\r\n                                        disabledColors={taskToEdit ? usedColors.filter(c => c !== taskToEdit.color) : usedColors}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Image */}\r\n                        <div className=\"bg-slate-900/20 rounded-xl\">\r\n                            <ImageUpload label=\"Capa da Misso (Opcional)\" value={imageUrl} onChange={setImageUrl} />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Footer Actions */}\r\n                    <div className=\"flex items-center justify-end gap-3 pt-4 border-t border-white/5 mt-6 px-6\">\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"ghost\"\r\n                            onClick={onClose}\r\n                            className=\"text-slate-400 hover:text-white text-xs h-9 px-4\"\r\n                        >\r\n                            Cancelar\r\n                        </Button>\r\n                        <Button\r\n                            type=\"submit\"\r\n                            className=\"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-500/20 text-xs font-bold uppercase tracking-wide h-9 px-6 rounded-lg transition-all active:scale-95\"\r\n                        >\r\n                            {taskToEdit ? \"Salvar\" : \"Criar Misso\"}\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\AchievementsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[94,97],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[94,97],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Trophy } from 'lucide-react';\r\n\r\ninterface AchievementsTabProps {\r\n    achievements: any[];\r\n}\r\n\r\nexport const AchievementsTab = ({ achievements }: AchievementsTabProps) => {\r\n    return (\r\n        <div className=\"grid grid-cols-2 gap-3 max-h-[400px] overflow-y-auto custom-scrollbar pr-2\">\r\n            {achievements.length === 0 ? (\r\n                <div className=\"col-span-2 text-center py-10 text-slate-500\">\r\n                    <Trophy className=\"w-12 h-12 mx-auto mb-2 opacity-20\" />\r\n                    <p>Nenhuma conquista desbloqueada ainda.</p>\r\n                    <p className=\"text-xs\">Continue estudando para ganhar!</p>\r\n                </div>\r\n            ) : (\r\n                achievements.map((ach) => (\r\n                    <div key={ach.id} className=\"bg-slate-900/50 p-4 rounded-xl border border-yellow-500/20 flex flex-col items-center text-center gap-2\">\r\n                        <div className=\"w-12 h-12 bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-full flex items-center justify-center border border-yellow-500/30\">\r\n                            <Trophy className=\"w-6 h-6 text-yellow-500\" />\r\n                        </div>\r\n                        <div>\r\n                            <h4 className=\"font-bold text-white text-sm\">{ach.title}</h4>\r\n                            <p className=\"text-[10px] text-slate-400 leading-tight\">{ach.description}</p>\r\n                        </div>\r\n                    </div>\r\n                ))\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\DailyRewardModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":5,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useGamification } from '../../context/GamificationContext';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { Button } from '../../components/ui/Button';\r\nimport { Flame, Gift, X } from 'lucide-react';\r\nimport confetti from 'canvas-confetti';\r\n\r\nexport const DailyRewardModal: React.FC = () => {\r\n    const { gamification, awardXP } = useGamification();\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!gamification.streak) return; // Wait for load\r\n\r\n        const today = new Date().toISOString().split('T')[0];\r\n        const lastLogin = gamification.streak.lastLoginDate;\r\n        const claimedKey = `daily_reward_${today}`;\r\n        const isClaimed = localStorage.getItem(claimedKey);\r\n\r\n        // Verify if streak is active for today and not claimed\r\n        if (lastLogin === today && !isClaimed) {\r\n            // Small delay to ensure UI is ready and it's not jarring\r\n            const timer = setTimeout(() => setIsOpen(true), 1500);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [gamification.streak]);\r\n\r\n    const handleClaim = () => {\r\n        confetti({\r\n            particleCount: 100,\r\n            spread: 70,\r\n            origin: { y: 0.6 },\r\n            colors: ['#F59E0B', '#EF4444', '#10B981']\r\n        });\r\n\r\n        awardXP(50);\r\n\r\n        const today = new Date().toISOString().split('T')[0];\r\n        localStorage.setItem(`daily_reward_${today}`, 'true');\r\n        setIsOpen(false);\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={() => { }} title=\"\" maxWidth=\"sm\">\r\n            <div className=\"relative p-6 pt-10 pb-8 flex flex-col items-center text-center overflow-hidden\">\r\n                {/* Background Effects */}\r\n                <div className=\"absolute inset-0 bg-gradient-to-br from-slate-900 to-slate-950\" />\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 mix-blend-overlay pointer-events-none\" />\r\n                <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-orange-500/10 rounded-full blur-[80px] pointer-events-none animate-pulse\" />\r\n\r\n                <div className=\"relative z-10 flex flex-col items-center gap-4\">\r\n                    <div className=\"w-20 h-20 bg-gradient-to-br from-orange-400 to-red-600 rounded-3xl flex items-center justify-center shadow-2xl shadow-orange-500/30 ring-4 ring-orange-500/20 rotate-3 animate-bounce-slow\">\r\n                        <Flame className=\"w-10 h-10 text-white fill-white drop-shadow-md\" />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1 mt-2\">\r\n                        <h2 className=\"text-2xl font-black text-white tracking-tight\">\r\n                            Ofensiva em Chamas!\r\n                        </h2>\r\n                        <p className=\"text-slate-400 font-medium\">\r\n                            Voc entrou por <span className=\"text-orange-400 font-bold text-lg\">{gamification.streak.current} dias</span> seguidos.\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"bg-slate-800/50 p-4 rounded-xl border border-white/5 w-full mt-2\">\r\n                        <div className=\"flex items-center justify-between mb-1\">\r\n                            <span className=\"text-xs font-bold text-slate-500 uppercase tracking-wider\">Recompensa Diria</span>\r\n                            <Gift className=\"w-4 h-4 text-emerald-400\" />\r\n                        </div>\r\n                        <div className=\"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-green-500\">\r\n                            +50 XP\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Button\r\n                        size=\"lg\"\r\n                        onClick={handleClaim}\r\n                        className=\"w-full mt-4 bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-400 hover:to-red-500 border-none shadow-lg shadow-orange-900/20 group\"\r\n                    >\r\n                        <span className=\"font-bold text-white group-hover:scale-105 transition-transform\">Resgatar Recompensa</span>\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\GamificationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\LeaderboardTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":2,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":16,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":19},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\LeaderboardTab.tsx:20:9\n  18 |     // Simulate fetch\n  19 |     useEffect(() => {\n> 20 |         setLoading(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |         setTimeout(() => setLoading(false), 800);\n  22 |     }, []);\n  23 |","line":20,"column":9,"nodeType":null,"endLine":20,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { Trophy, Medal, User, Crown } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\n// Mock Data for now (replace with Supabase query later)\r\nconst MOCK_LEADERBOARD = [\r\n    { id: '1', name: 'Mestre Jedi', xp: 12500, level: 42, avatar: 'M' },\r\n    { id: '2', name: 'Padawan Focado', xp: 8900, level: 25, avatar: 'P' },\r\n    { id: '3', name: 'Viajante do Tempo', xp: 7200, level: 18, avatar: 'V' },\r\n    { id: '4', name: 'Estudante Pro', xp: 6500, level: 15, avatar: 'E' },\r\n    { id: '5', name: 'Novato Curioso', xp: 3200, level: 8, avatar: 'N' },\r\n];\r\n\r\nexport const LeaderboardTab = () => {\r\n    // const { user } = useAuth(); // If we want to highlight current user\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Simulate fetch\r\n    useEffect(() => {\r\n        setLoading(true);\r\n        setTimeout(() => setLoading(false), 800);\r\n    }, []);\r\n\r\n    const getRankIcon = (index: number) => {\r\n        if (index === 0) return <Crown className=\"w-5 h-5 text-yellow-400 drop-shadow-[0_0_8px_rgba(250,204,21,0.6)]\" />;\r\n        if (index === 1) return <Medal className=\"w-5 h-5 text-slate-300\" />;\r\n        if (index === 2) return <Medal className=\"w-5 h-5 text-amber-600\" />;\r\n        return <span className=\"text-slate-500 font-bold ml-1.5\">{index + 1}</span>;\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"bg-slate-900/50 rounded-2xl p-4 border border-white/5\">\r\n                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2\">\r\n                    <Trophy className=\"w-4 h-4 text-yellow-500\" />\r\n                    Top 5 Global\r\n                </h3>\r\n\r\n                <div className=\"space-y-2\">\r\n                    {MOCK_LEADERBOARD.map((player, index) => (\r\n                        <motion.div\r\n                            key={player.id}\r\n                            initial={{ opacity: 0, x: -20 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            transition={{ delay: index * 0.1 }}\r\n                            className={`flex items-center gap-4 p-3 rounded-xl border transition-all ${index === 0\r\n                                    ? 'bg-gradient-to-r from-yellow-500/10 to-transparent border-yellow-500/20 shadow-[0_0_15px_rgba(234,179,8,0.1)]'\r\n                                    : 'bg-white/5 border-white/5 hover:bg-white/10'\r\n                                }`}\r\n                        >\r\n                            <div className=\"w-8 flex justify-center\">\r\n                                {getRankIcon(index)}\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center gap-3 flex-1\">\r\n                                <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs shadow-inner ring-2 ${index === 0 ? 'bg-yellow-600 ring-yellow-500/50 text-white' : 'bg-slate-700 ring-white/10 text-slate-300'\r\n                                    }`}>\r\n                                    {player.avatar}\r\n                                </div>\r\n                                <div>\r\n                                    <div className={`text-sm font-bold ${index === 0 ? 'text-yellow-100' : 'text-slate-200'}`}>\r\n                                        {player.name}\r\n                                    </div>\r\n                                    <div className=\"text-[10px] text-slate-500 font-medium\">\r\n                                        Nvel {player.level}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"text-right\">\r\n                                <div className=\"text-sm font-bold text-slate-100 font-mono\">\r\n                                    {player.xp.toLocaleString()}\r\n                                </div>\r\n                                <div className=\"text-[10px] text-slate-500 uppercase tracking-wider font-bold\">XP</div>\r\n                            </div>\r\n                        </motion.div>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"mt-4 p-3 rounded-xl bg-blue-500/10 border border-blue-500/20 text-center\">\r\n                    <p className=\"text-xs text-blue-300\">\r\n                        Voc est no top <strong>15%</strong> dos estudantes essa semana!\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\OverviewTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\XPTableTab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\gamification\\achievements.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[362,365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[362,365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[568,571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[568,571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[791,794],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[791,794],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1014,1017],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1014,1017],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1279,1282],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1279,1282],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1494,1497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1494,1497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// import { Achievement } from '../../types';\r\n// import { Trophy, Zap, Clock, BookOpen, Target, Flame } from 'lucide-react';\r\n\r\nexport const ACHIEVEMENTS_LIST = [\r\n    {\r\n        id: 'first_steps',\r\n        title: 'Primeiros Passos',\r\n        description: 'Alcance o Nvel 2.',\r\n        icon: 'Trophy', // Mapped to Lucide icon name\r\n        condition: (stats: any) => stats.level >= 2\r\n    },\r\n    {\r\n        id: 'scholar_novice',\r\n        title: 'Estudioso',\r\n        description: 'Complete 10 revises SRS.',\r\n        icon: 'BookOpen',\r\n        condition: (stats: any) => stats.reviewsCompleted >= 10\r\n    },\r\n    {\r\n        id: 'focus_master',\r\n        title: 'Foco Laser',\r\n        description: 'Acumule 100 minutos de foco total.',\r\n        icon: 'Clock',\r\n        condition: (stats: any) => stats.totalFocusMinutes >= 100\r\n    },\r\n    {\r\n        id: 'task_slayer',\r\n        title: 'Matador de Tarefas',\r\n        description: 'Conclua 20 tarefas.',\r\n        icon: 'CheckSquare',\r\n        condition: (stats: any) => stats.tasksCompleted >= 20\r\n    },\r\n    {\r\n        id: 'goal_getter',\r\n        title: 'Visionrio',\r\n        description: 'Conclua uma Meta do tipo \"Hbito\" 7 dias seguidos (Simulado por 7 concluses).',\r\n        icon: 'Target',\r\n        condition: (stats: any) => stats.habitsCompleted >= 7\r\n    },\r\n    {\r\n        id: 'high_roller',\r\n        title: 'High Roller',\r\n        description: 'Ganhe 1000 XP em um nico dia.',\r\n        icon: 'Zap',\r\n        condition: (stats: any) => stats.dailyXp >= 1000\r\n    }\r\n];\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\components\\AddGoalModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Target' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Target, Trash2 } from 'lucide-react';\r\nimport { Modal } from '../../../components/ui/Modal';\r\nimport { Input } from '../../../components/ui/Input';\r\nimport { Button } from '../../../components/ui/Button';\r\nimport { ImageUpload } from '../../../components/forms/ImageUpload';\r\nimport { ColorPicker } from '../../../components/forms/ColorPicker';\r\nimport { PrioritySelector } from '../../../components/forms/PrioritySelector';\r\nimport { DurationStepper } from '../../../components/forms/DurationStepper';\r\nimport type { Goal } from '../../../types';\r\n\r\nimport { useGoalFormLogic } from '../hooks/useGoalFormLogic';\r\nimport { GoalTypeSelector } from './GoalTypeSelector';\r\nimport { ChecklistBuilder } from './ChecklistBuilder';\r\nimport { ScheduleFields } from './ScheduleFields';\r\n\r\ninterface AddGoalModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    goalToEdit?: Goal;\r\n    defaultThemeId?: string;\r\n    defaultType?: 'simple' | 'checklist' | 'habit';\r\n}\r\n\r\nexport const AddGoalModal: React.FC<AddGoalModalProps> = (props) => {\r\n    const {\r\n        title, setTitle,\r\n        type, setType,\r\n        category, setCategory,\r\n        priority, setPriority,\r\n        relatedThemeId, setRelatedThemeId,\r\n        startDate, setStartDate,\r\n        deadline, setDeadline,\r\n        recurrence, setRecurrence,\r\n        icon, setIcon,\r\n        color, setColor,\r\n        imageUrl, setImageUrl,\r\n        duration, setDuration,\r\n        checklist, setChecklist,\r\n        usedColors,\r\n        themes,\r\n        handleSubmit,\r\n        handleDelete,\r\n        recalculateSchedule\r\n    } = useGoalFormLogic(props);\r\n\r\n    const { isOpen, onClose, goalToEdit, defaultThemeId } = props;\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\" maxWidth=\"xl\">\r\n            <div className=\"relative overflow-hidden p-5 sm:p-6\">\r\n                {/* Subtle Background Ambiance */}\r\n                <div className=\"absolute top-[-20%] right-[-20%] w-[400px] h-[400px] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none\" />\r\n                <div className=\"absolute bottom-[-20%] left-[-20%] w-[300px] h-[300px] bg-indigo-600/5 rounded-full blur-[80px] pointer-events-none\" />\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none\" />\r\n\r\n                <form onSubmit={handleSubmit} className=\"relative z-10 font-sans\">\r\n\r\n                    {/* Header Row */}\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-xl border border-white/5 flex items-center justify-center shadow-inner\">\r\n                                <span className=\"text-xl\"></span>\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-lg font-bold text-white tracking-tight leading-none\">\r\n                                    {goalToEdit ? \"Editar Meta\" : \"Nova Meta\"}\r\n                                </h2>\r\n                                <p className=\"text-[11px] text-slate-500 font-medium px-0.5\">Defina seus objetivos futuros</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-5 px-6\">\r\n                        {/* Main Input */}\r\n                        <div className=\"relative group\">\r\n                            <div className=\"absolute -inset-0.5 bg-gradient-to-r from-blue-500/20 to-indigo-500/20 rounded-xl opacity-0 group-focus-within:opacity-100 blur transition duration-500\" />\r\n                            <input\r\n                                placeholder=\"Digite o nome da meta...\"\r\n                                value={title}\r\n                                onChange={e => setTitle(e.target.value)}\r\n                                autoFocus\r\n                                className=\"relative w-full bg-slate-950/80 text-white placeholder-slate-600 border border-white/5 rounded-xl px-4 py-3 text-base font-medium focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all shadow-sm\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Type Selector (Tabs Style) */}\r\n                        <GoalTypeSelector type={type} onChange={setType} />\r\n\r\n                        {/* Checklist Builder */}\r\n                        {type === 'checklist' && (\r\n                            <div className=\"mt-4\">\r\n                                <ChecklistBuilder\r\n                                    checklist={checklist}\r\n                                    onChange={setChecklist}\r\n                                    startDate={startDate}\r\n                                    recalculateSchedule={recalculateSchedule}\r\n                                    setDeadline={setDeadline}\r\n                                />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Type Specific Container */}\r\n                    <div className=\"px-6 space-y-4\">\r\n                        {/* Schedule Fields */}\r\n                        <ScheduleFields\r\n                            type={type}\r\n                            startDate={startDate}\r\n                            deadline={deadline}\r\n                            recurrence={recurrence}\r\n                            onStartDateChange={setStartDate}\r\n                            onDeadlineChange={setDeadline}\r\n                            onRecurrenceChange={setRecurrence}\r\n                        />\r\n\r\n                        <div className=\"h-px bg-white/5 w-full my-2\" />\r\n\r\n                        {/* Attributes Grid */}\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Durao (Min)</label>\r\n                                <div className=\"bg-slate-950/50 rounded-lg border border-white/5 p-0.5\">\r\n                                    <DurationStepper value={duration} onChange={setDuration} step={1} min={0} />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Prioridade</label>\r\n                                <PrioritySelector value={priority} onChange={setPriority} />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Vincular a Tema (Opcional)</label>\r\n                            <select\r\n                                value={relatedThemeId}\r\n                                onChange={e => setRelatedThemeId(e.target.value)}\r\n                                disabled={!!defaultThemeId && !goalToEdit}\r\n                                className={`w-full bg-slate-950/50 border border-white/5 h-9 rounded-lg text-xs px-2 outline-none focus:border-blue-500/50 text-slate-300 ${!!defaultThemeId && !goalToEdit ? 'opacity-60 cursor-not-allowed font-bold text-blue-400' : ''}`}\r\n                            >\r\n                                <option value=\"\">Sem vnculo</option>\r\n                                {themes.map(t => (\r\n                                    <option key={t.id} value={t.id}>{t.title}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Categoria</label>\r\n                            <Input\r\n                                value={category}\r\n                                onChange={e => setCategory(e.target.value)}\r\n                                placeholder=\"Ex: Estudos, Sade, Finanas...\"\r\n                                className=\"bg-slate-950/50 border-white/5 h-9 text-xs\"\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-[60px_1fr] gap-4\">\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">cone</label>\r\n                                <div className=\"relative\">\r\n                                    <Input\r\n                                        value={icon}\r\n                                        onChange={e => setIcon(e.target.value)}\r\n                                        className=\"text-center h-10 bg-slate-950/50 border-white/5 text-lg\"\r\n                                        placeholder=\"\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                                <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Cor</label>\r\n                                <ColorPicker\r\n                                    value={color}\r\n                                    onChange={setColor}\r\n                                    disabledColors={goalToEdit ? usedColors.filter(c => c !== goalToEdit.color) : usedColors}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Image */}\r\n                    <div className=\"bg-slate-900/20 rounded-xl mt-5 px-6\">\r\n                        <ImageUpload label=\"Capa do Card (Opcional)\" value={imageUrl} onChange={setImageUrl} />\r\n                    </div>\r\n\r\n                    {/* Footer Actions */}\r\n                    <div className=\"flex items-center justify-between gap-3 pt-4 border-t border-white/5 mt-6 px-6\">\r\n                        {goalToEdit && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleDelete}\r\n                                className=\"flex items-center gap-2 px-3 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors text-xs font-bold uppercase tracking-wide\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                                Excluir\r\n                            </button>\r\n                        )}\r\n                        <div className=\"flex items-center gap-3 ml-auto\">\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"ghost\"\r\n                                onClick={onClose}\r\n                                className=\"text-slate-400 hover:text-white text-xs h-9 px-4\"\r\n                            >\r\n                                Cancelar\r\n                            </Button>\r\n                            <Button\r\n                                type=\"submit\"\r\n                                className=\"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-500/20 text-xs font-bold uppercase tracking-wide h-9 px-6 rounded-lg transition-all active:scale-95\"\r\n                            >\r\n                                {goalToEdit ? \"Salvar\" : \"Criar Meta\"}\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </div >\r\n        </Modal >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\components\\ChecklistBuilder.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[561,564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[561,564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[606,609],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[606,609],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Trash2, GripVertical } from 'lucide-react';\r\nimport { Input } from '../../../components/ui/Input';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ChecklistItem {\r\n    id: string;\r\n    title: string;\r\n    estimatedTime: string;\r\n    completed: boolean;\r\n    durationDays: number;\r\n    startDate?: string;\r\n    deadline?: string;\r\n}\r\n\r\ninterface ChecklistBuilderProps {\r\n    checklist: ChecklistItem[];\r\n    onChange: (items: ChecklistItem[]) => void;\r\n    startDate: string;\r\n    recalculateSchedule: (items: any[], baseStart: string) => { updatedItems: any[]; finalDate: string };\r\n    setDeadline: (date: string) => void;\r\n}\r\n\r\nexport const ChecklistBuilder: React.FC<ChecklistBuilderProps> = ({\r\n    checklist,\r\n    onChange,\r\n    startDate,\r\n    recalculateSchedule,\r\n    setDeadline\r\n}) => {\r\n    // Helper to parse YYYY-MM-DD as Local Midnight (avoiding UTC timezone issues)\r\n    const parseLocalDate = (dateStr: string): Date => {\r\n        if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateStr)) {\r\n            const [y, m, d] = dateStr.split('-').map(Number);\r\n            return new Date(y, m - 1, d); // Local Midnight\r\n        }\r\n        return new Date(dateStr);\r\n    };\r\n\r\n    const [newItemTitle, setNewItemTitle] = useState('');\r\n    const [newItemTime, setNewItemTime] = useState('');\r\n    const [draggedIndex, setDraggedIndex] = useState<number | null>(null);\r\n    const [dragOverIndex, setDragOverIndex] = useState<number | null>(null);\r\n\r\n    const handleAddItem = () => {\r\n        if (!newItemTitle) return;\r\n\r\n        const newItem = {\r\n            id: Math.random().toString(36).substr(2, 9),\r\n            title: newItemTitle,\r\n            estimatedTime: newItemTime || '1',\r\n            completed: false,\r\n            durationDays: parseInt(newItemTime || '1')\r\n        };\r\n\r\n        const newChecklist = [...checklist, newItem];\r\n        const { updatedItems, finalDate } = recalculateSchedule(newChecklist, startDate);\r\n\r\n        onChange(updatedItems);\r\n        if (finalDate) setDeadline(finalDate);\r\n\r\n        setNewItemTitle('');\r\n        setNewItemTime('');\r\n    };\r\n\r\n    const handleRemoveItem = (index: number) => {\r\n        const newChecklist = checklist.filter((_, i) => i !== index);\r\n        const scheduled = recalculateSchedule(newChecklist, startDate);\r\n        onChange(scheduled.updatedItems);\r\n        if (scheduled.finalDate) setDeadline(scheduled.finalDate);\r\n    };\r\n\r\n    const handleDragStart = (e: React.DragEvent, index: number) => {\r\n        setDraggedIndex(index);\r\n        e.dataTransfer.effectAllowed = 'move';\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent, index: number) => {\r\n        e.preventDefault();\r\n        setDragOverIndex(index);\r\n    };\r\n\r\n    const handleDragEnd = () => {\r\n        setDraggedIndex(null);\r\n        setDragOverIndex(null);\r\n    };\r\n\r\n    const handleDrop = (e: React.DragEvent, targetIndex: number) => {\r\n        e.preventDefault();\r\n\r\n        if (draggedIndex === null || draggedIndex === targetIndex) {\r\n            handleDragEnd();\r\n            return;\r\n        }\r\n\r\n        const reordered = [...checklist];\r\n        const [moved] = reordered.splice(draggedIndex, 1);\r\n        reordered.splice(targetIndex, 0, moved);\r\n\r\n        const { updatedItems, finalDate } = recalculateSchedule(reordered, startDate);\r\n        onChange(updatedItems);\r\n        if (finalDate) setDeadline(finalDate);\r\n\r\n        handleDragEnd();\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-slate-900/40 rounded-xl border border-white/5 p-4 space-y-4\">\r\n            <div className=\"animate-in fade-in zoom-in-95 duration-200 space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Etapas ({checklist.length}) - Sequenciais</label>\r\n                </div>\r\n\r\n                <div className=\"space-y-2 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar\">\r\n                    {checklist.map((item, index) => {\r\n                        const isDragging = draggedIndex === index;\r\n                        const isDragOver = dragOverIndex === index;\r\n\r\n                        return (\r\n                            <div\r\n                                key={index}\r\n                                draggable\r\n                                onDragStart={(e) => handleDragStart(e, index)}\r\n                                onDragOver={(e) => handleDragOver(e, index)}\r\n                                onDragEnd={handleDragEnd}\r\n                                onDrop={(e) => handleDrop(e, index)}\r\n                                className={`flex gap-2 items-center bg-slate-950/50 p-2 rounded-lg group border transition-all cursor-grab active:cursor-grabbing ${isDragging\r\n                                        ? 'opacity-40 border-blue-500/50'\r\n                                        : isDragOver\r\n                                            ? 'border-blue-500 shadow-lg shadow-blue-500/20'\r\n                                            : 'border-white/5 hover:border-white/10'\r\n                                    }`}\r\n                            >\r\n                                <div className=\"text-slate-500 opacity-50 group-hover:opacity-100 transition-opacity cursor-grab active:cursor-grabbing\" title=\"Arrastar para reordenar\">\r\n                                    <GripVertical className=\"w-4 h-4\" />\r\n                                </div>\r\n                                <span className=\"text-xs text-slate-500 w-5 text-center font-mono\">{index + 1}</span>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"text-sm text-slate-300 truncate\">{item.title}</div>\r\n                                    <div className=\"flex gap-3 text-[10px] text-slate-500 mt-0.5\">\r\n                                        {item.estimatedTime && <span className=\"flex items-center gap-1\"> {item.estimatedTime} dias</span>}\r\n                                        {item.startDate && item.deadline && (\r\n                                            <span className=\"flex items-center gap-1 text-blue-400\">\r\n                                                 {format(parseLocalDate(item.startDate), 'dd/MM')}  {format(parseLocalDate(item.deadline), 'dd/MM')}\r\n                                            </span>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => handleRemoveItem(index)}\r\n                                        className=\"text-slate-600 hover:text-red-400 p-1.5 transition-colors\"\r\n                                        title=\"Remover Item\"\r\n                                    >\r\n                                        <Trash2 className=\"w-3.5 h-3.5\" />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n\r\n                    <div className=\"grid grid-cols-[1fr_70px_50px] gap-2 items-end pt-1\">\r\n                        <div className=\"space-y-1\">\r\n                            <Input\r\n                                value={newItemTitle}\r\n                                onChange={e => setNewItemTitle(e.target.value)}\r\n                                placeholder=\"Nova etapa...\"\r\n                                className=\"bg-slate-950/30 border-white/5 h-9 text-xs\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                            <Input\r\n                                value={newItemTime}\r\n                                onChange={e => {\r\n                                    const val = parseInt(e.target.value);\r\n                                    if (val < 1) return;\r\n                                    setNewItemTime(e.target.value);\r\n                                }}\r\n                                placeholder=\"Dias\"\r\n                                type=\"number\"\r\n                                min={1}\r\n                                className=\"bg-slate-950/30 border-white/5 h-9 text-xs text-center\"\r\n                                title=\"Durao em dias\"\r\n                            />\r\n                        </div>\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={handleAddItem}\r\n                            className=\"h-9 w-9 flex items-center justify-center bg-blue-600/20 hover:bg-blue-600 text-blue-400 hover:text-white rounded-lg transition-all border border-blue-600/20 hover:shadow-lg hover:shadow-blue-500/20 mb-[1px]\"\r\n                        >\r\n                            <span className=\"text-lg leading-none mb-0.5\">+</span>\r\n                        </button>\r\n                    </div>\r\n\r\n                    <p className=\"text-[10px] text-slate-500 pl-1 italic\">\r\n                        * As etapas so agendadas sequencialmente em dias.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\components\\GoalDetailsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'toggleGoal' is assigned a value but never used.","line":17,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Target, CheckCircle2, Clock, Calendar, Trophy, ArrowRight, Activity } from 'lucide-react';\r\nimport { Modal } from '../../../components/ui/Modal';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Goal } from '../../../types';\r\nimport SummaryTimeline from '../../../components/ui/SummaryTimeline';\r\n\r\ninterface GoalDetailsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    goal: Goal | null;\r\n}\r\n\r\nexport const GoalDetailsModal: React.FC<GoalDetailsModalProps> = ({ isOpen, onClose, goal }) => {\r\n    const { toggleGoal, toggleGoalItem } = useStudy();\r\n\r\n    if (!goal) return null;\r\n\r\n    const isCompleted = goal.progress === 100;\r\n    const isHabit = goal.type === 'habit';\r\n    const isChecklist = goal.type === 'checklist';\r\n\r\n    const colorScheme = isCompleted\r\n        ? {\r\n            text: 'text-emerald-400',\r\n            bg: 'bg-emerald-500/10',\r\n            border: 'border-emerald-500/20',\r\n            gradient: 'from-emerald-600 to-emerald-400'\r\n        }\r\n        : {\r\n            text: 'text-blue-400',\r\n            bg: 'bg-blue-500/10',\r\n            border: 'border-blue-500/20',\r\n            gradient: 'from-blue-600 to-purple-600'\r\n        };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\" maxWidth=\"2xl\">\r\n            <div className=\"relative overflow-hidden p-6 sm:p-8\">\r\n                {/* Background Decoration */}\r\n                <div className=\"absolute top-[-10%] right-[-10%] w-[300px] h-[300px] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none\" />\r\n                <div className=\"absolute bottom-[-10%] left-[-10%] w-[250px] h-[250px] bg-purple-600/5 rounded-full blur-[80px] pointer-events-none\" />\r\n\r\n                <div className=\"relative z-10 flex flex-col gap-8\">\r\n                    {/* Header: Icon, Title, Category */}\r\n                    <div className=\"flex items-start gap-6\">\r\n                        <div className={cn(\r\n                            \"w-20 h-20 rounded-3xl flex items-center justify-center shrink-0 shadow-2xl border-2\",\r\n                            \"bg-gradient-to-br\",\r\n                            isCompleted ? \"from-emerald-600 to-emerald-500 border-emerald-400/50\" : \"from-blue-600 to-purple-600 border-blue-400/50\"\r\n                        )}>\r\n                            <div className=\"absolute inset-0 rounded-3xl bg-gradient-to-b from-white/20 to-transparent\" />\r\n                            {goal.icon ? (\r\n                                <span className=\"text-4xl drop-shadow-lg\">{goal.icon}</span>\r\n                            ) : (\r\n                                <Target className=\"w-10 h-10 text-white drop-shadow-lg\" />\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                                <span className={cn(\r\n                                    \"px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border\",\r\n                                    colorScheme.bg, colorScheme.text, colorScheme.border\r\n                                )}>\r\n                                    {goal.category || (isHabit ? 'HBITO' : 'META')}\r\n                                </span>\r\n                                <span className=\"px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest bg-slate-800 text-slate-400 border border-white/5\">\r\n                                    {isHabit ? 'Repetitivo' : isChecklist ? 'Sequencial' : 'Simples'}\r\n                                </span>\r\n                            </div>\r\n                            <h2 className=\"text-3xl font-black text-white leading-tight break-words\">\r\n                                {goal.title}\r\n                            </h2>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Progress Bar Display */}\r\n                    <div className=\"bg-slate-900/40 rounded-3xl p-6 border border-white/5 shadow-inner\">\r\n                        <div className=\"flex justify-between items-end mb-4\">\r\n                            <div className=\"space-y-1\">\r\n                                <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2\">\r\n                                    <Trophy className=\"w-3 h-3\" /> Progresso Geral\r\n                                </span>\r\n                                <div className=\"text-4xl font-black text-white\">\r\n                                    {Math.round(goal.progress)}%\r\n                                </div>\r\n                            </div>\r\n                            {goal.deadline && (\r\n                                <div className=\"text-right space-y-1\">\r\n                                    <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center justify-end gap-2\">\r\n                                        Prazo <Calendar className=\"w-3 h-3\" />\r\n                                    </span>\r\n                                    <div className=\"text-sm font-bold text-slate-300\">\r\n                                        {format(new Date(goal.deadline), 'dd/MM/yyyy')}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"h-4 bg-slate-950/80 rounded-full p-1 border border-white/5 shadow-inner\">\r\n                            <div\r\n                                className={cn(\r\n                                    \"h-full rounded-full transition-all duration-1000 ease-out shadow-lg\",\r\n                                    \"bg-gradient-to-r\",\r\n                                    colorScheme.gradient\r\n                                )}\r\n                                style={{ width: `${goal.progress}%` }}\r\n                            >\r\n                                <div className=\"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent rounded-full\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Checklist Content */}\r\n                    {isChecklist && goal.checklist && (\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 px-1\">\r\n                                <Activity className=\"w-4 h-4\" /> Etapas do Projeto\r\n                            </h3>\r\n                            <div className=\"grid gap-3\">\r\n                                {goal.checklist.sort((a, b) => a.order - b.order).map((item, idx) => (\r\n                                    <div\r\n                                        key={item.id}\r\n                                        onClick={() => toggleGoalItem(goal.id, item.id)}\r\n                                        className={cn(\r\n                                            \"group flex items-center gap-4 p-4 rounded-2xl border transition-all cursor-pointer\",\r\n                                            item.completed\r\n                                                ? \"bg-emerald-500/5 border-emerald-500/20 opacity-70\"\r\n                                                : \"bg-slate-900/60 border-white/5 hover:border-blue-500/30 hover:bg-slate-800/60 shadow-lg\"\r\n                                        )}\r\n                                    >\r\n                                        <div className={cn(\r\n                                            \"w-10 h-10 rounded-xl flex items-center justify-center transition-all\",\r\n                                            item.completed\r\n                                                ? \"bg-emerald-500 text-white\"\r\n                                                : \"bg-slate-800 text-slate-500 group-hover:bg-blue-500/20 group-hover:text-blue-400\"\r\n                                        )}>\r\n                                            {item.completed ? <CheckCircle2 className=\"w-6 h-6\" /> : <span className=\"font-black text-lg\">{idx + 1}</span>}\r\n                                        </div>\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <div className={cn(\r\n                                                \"font-bold text-sm transition-all\",\r\n                                                item.completed ? \"text-slate-400 line-through\" : \"text-white\"\r\n                                            )}>\r\n                                                {item.title}\r\n                                            </div>\r\n                                            <div className=\"flex items-center gap-3 mt-1\">\r\n                                                {item.durationDays > 0 && (\r\n                                                    <span className=\"text-[10px] font-bold text-slate-500 flex items-center gap-1\">\r\n                                                        <Clock className=\"w-2.5 h-2.5\" /> {item.durationDays} dias\r\n                                                    </span>\r\n                                                )}\r\n                                                {item.deadline && (\r\n                                                    <span className=\"text-[10px] font-bold text-blue-400 flex items-center gap-1\">\r\n                                                        <Calendar className=\"w-2.5 h-2.5\" /> {format(new Date(item.deadline), 'dd/MM')}\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                        <ArrowRight className={cn(\r\n                                            \"w-4 h-4 transition-all transform group-hover:translate-x-1\",\r\n                                            item.completed ? \"text-emerald-500/40\" : \"text-slate-600 group-hover:text-blue-400\"\r\n                                        )} />\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Habit History Content */}\r\n                    {isHabit && (\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 px-1\">\r\n                                <Clock className=\"w-4 h-4\" /> Histrico Recente\r\n                            </h3>\r\n                            <div className=\"bg-slate-900/40 rounded-3xl p-6 border border-white/5\">\r\n                                <div className=\"flex flex-wrap gap-2\">\r\n                                    {/* Show last 14 days logic */}\r\n                                    {Array.from({ length: 14 }).map((_, i) => {\r\n                                        const d = new Date();\r\n                                        d.setDate(d.getDate() - (13 - i));\r\n                                        const dateStr = format(d, 'yyyy-MM-dd');\r\n                                        const isDone = goal.completionHistory?.some(h => h.startsWith(dateStr));\r\n\r\n                                        return (\r\n                                            <div\r\n                                                key={i}\r\n                                                className={cn(\r\n                                                    \"w-8 h-8 rounded-lg flex items-center justify-center text-[10px] font-bold transition-all\",\r\n                                                    isDone\r\n                                                        ? \"bg-emerald-500 text-white shadow-lg shadow-emerald-500/20\"\r\n                                                        : \"bg-slate-800 text-slate-600 border border-white/5\"\r\n                                                )}\r\n                                                title={format(d, 'dd/MM/yyyy')}\r\n                                            >\r\n                                                {format(d, 'd')}\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                </div>\r\n                                <p className=\"text-[10px] text-slate-500 mt-4 text-center\">\r\n                                    Visualizando os ltimos 14 dias de consistncia.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Stats or Additional Info */}\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Incio</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2\">\r\n                                <Calendar className=\"w-4 h-4 text-blue-400\" />\r\n                                {goal.startDate ? format(new Date(goal.startDate), 'dd/MM/yyyy') : format(new Date(goal.createdAt), 'dd/MM/yyyy')}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Esforo Total</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2\">\r\n                                <Clock className=\"w-4 h-4 text-purple-400\" />\r\n                                {Math.floor((goal.timeSpent || 0) / 60)}h {(goal.timeSpent || 0) % 60}m\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Summary Timeline - Histrico Detalhado */}\r\n                    {goal.summaries && goal.summaries.length > 0 && (\r\n                        <div className=\"space-y-4\">\r\n                            <SummaryTimeline\r\n                                summaries={goal.summaries}\r\n                                title=\"Histrico da Meta\"\r\n                                maxItems={5}\r\n                                showEmptyState={false}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Bottom Action */}\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"w-full h-14 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl font-black text-white uppercase tracking-widest transition-all shadow-xl active:scale-[0.98]\"\r\n                    >\r\n                        Fechar Detalhes\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\components\\GoalTypeSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[783,786],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[783,786],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\ninterface GoalTypeSelectorProps {\r\n    type: 'simple' | 'checklist' | 'habit';\r\n    onChange: (type: 'simple' | 'checklist' | 'habit') => void;\r\n}\r\n\r\nexport const GoalTypeSelector: React.FC<GoalTypeSelectorProps> = ({ type, onChange }) => {\r\n    return (\r\n        <div className=\"bg-slate-950/60 p-1 rounded-xl border border-white/5 flex gap-1\">\r\n            {[\r\n                { value: 'simple', label: 'Simples', icon: '' },\r\n                { value: 'checklist', label: 'Checklist', icon: '' },\r\n                { value: 'habit', label: 'Hbito', icon: '' },\r\n            ].map((opt) => (\r\n                <button\r\n                    key={opt.value}\r\n                    type=\"button\"\r\n                    onClick={() => onChange(opt.value as any)}\r\n                    className={`\r\n                        flex-1 py-2 px-3 rounded-lg text-xs font-bold uppercase tracking-wide transition-all flex items-center justify-center gap-2\r\n                        ${type === opt.value\r\n                            ? 'bg-blue-600/10 text-blue-400 shadow-sm border border-blue-500/20'\r\n                            : 'text-slate-500 hover:text-slate-300 hover:bg-white/5 border border-transparent'\r\n                        }\r\n                    `}\r\n                >\r\n                    <span className=\"text-sm\">{opt.icon}</span>\r\n                    {opt.label}\r\n                </button>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\components\\ScheduleFields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\hooks\\useGoalFormLogic.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[755,758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[755,758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1295,1298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1295,1298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\hooks\\useGoalFormLogic.ts:40:13\n  38 |     useEffect(() => {\n  39 |         if (isOpen) {\n> 40 |             setTitle(goalToEdit?.title || '');\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  41 |             setType(goalToEdit?.type || defaultType || 'simple');\n  42 |             setCategory(goalToEdit?.category || '');\n  43 |             setPriority(goalToEdit?.priority || 'medium');","line":40,"column":13,"nodeType":null,"endLine":40,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3401,3404],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3401,3404],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\goals\\hooks\\useGoalFormLogic.ts:109:17\n  107 |\n  108 |             if (currentLastString !== newLastString) {\n> 109 |                 setChecklist(updatedItems);\n      |                 ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  110 |                 if (finalDate) setDeadline(finalDate);\n  111 |             }\n  112 |         }","line":109,"column":17,"nodeType":null,"endLine":109,"endColumn":29},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'checklist', 'recalculateSchedule', and 'type'. Either include them or remove the dependency array.","line":113,"column":8,"nodeType":"ArrayExpression","endLine":113,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [checklist, recalculateSchedule, startDate, type]","fix":{"range":[4854,4865],"text":"[checklist, recalculateSchedule, startDate, type]"}}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { format, addDays } from 'date-fns';\r\nimport type { Goal } from '../../../types';\r\n\r\ninterface UseGoalFormLogicProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    goalToEdit?: Goal;\r\n    defaultThemeId?: string;\r\n    defaultType?: 'simple' | 'checklist' | 'habit';\r\n}\r\n\r\nexport const useGoalFormLogic = ({ isOpen, onClose, goalToEdit, defaultThemeId, defaultType }: UseGoalFormLogicProps) => {\r\n    const [title, setTitle] = useState('');\r\n    const [type, setType] = useState<'simple' | 'checklist' | 'habit'>(defaultType || 'simple');\r\n    const [category, setCategory] = useState('');\r\n    const [priority, setPriority] = useState<any>(goalToEdit?.priority || 'medium');\r\n    const [relatedThemeId, setRelatedThemeId] = useState('');\r\n    const [startDate, setStartDate] = useState(format(new Date(), 'yyyy-MM-dd'));\r\n    const [deadline, setDeadline] = useState('');\r\n    const [recurrence, setRecurrence] = useState<number[]>([]);\r\n    const [icon, setIcon] = useState('');\r\n    const [color, setColor] = useState('');\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    const [duration, setDuration] = useState('');\r\n    const [checklist, setChecklist] = useState<any[]>(goalToEdit?.checklist || []);\r\n\r\n    const { addGoal, updateGoal, deleteGoal, themes, tasks, goals } = useStudy();\r\n\r\n    const usedColors = [\r\n        ...themes.map(t => t.color),\r\n        ...tasks.map(t => t.color),\r\n        ...goals.map(g => g.color)\r\n    ].filter(Boolean) as string[];\r\n\r\n    // Reset or Set values when goalToEdit changes\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setTitle(goalToEdit?.title || '');\r\n            setType(goalToEdit?.type || defaultType || 'simple');\r\n            setCategory(goalToEdit?.category || '');\r\n            setPriority(goalToEdit?.priority || 'medium');\r\n            setRelatedThemeId(goalToEdit?.relatedThemeId || defaultThemeId || '');\r\n            setStartDate(goalToEdit?.startDate || format(new Date(), 'yyyy-MM-dd'));\r\n            setDeadline(goalToEdit?.deadline || '');\r\n            setRecurrence(goalToEdit?.recurrence || []);\r\n            setIcon(goalToEdit?.icon || '');\r\n            setColor(goalToEdit?.color || '');\r\n            setImageUrl(goalToEdit?.imageUrl || '');\r\n            setDuration(goalToEdit?.durationMinutes?.toString() || '');\r\n            setChecklist(goalToEdit?.checklist || []);\r\n\r\n            // If creating a NEW Habit, default recurrence to include Today\r\n            const isNewItem = !goalToEdit;\r\n            const currentType = (goalToEdit?.type || defaultType || 'simple');\r\n\r\n            if (isNewItem && currentType === 'habit') {\r\n                const todayDow = new Date().getDay();\r\n                setRecurrence([todayDow]);\r\n            }\r\n        }\r\n    }, [isOpen, goalToEdit, defaultThemeId, defaultType]);\r\n\r\n    // Helper to parse YYYY-MM-DD as Local Midnight (avoiding UTC timezone issues)\r\n    const parseLocalDate = (dateStr: string): Date => {\r\n        if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateStr)) {\r\n            const [y, m, d] = dateStr.split('-').map(Number);\r\n            return new Date(y, m - 1, d); // Local Midnight\r\n        }\r\n        return new Date(dateStr);\r\n    };\r\n\r\n    // Recalculate dates for all items based on sequence\r\n    const recalculateSchedule = (items: any[], baseStart: string) => {\r\n        let currentDate = parseLocalDate(baseStart);\r\n\r\n        const updatedItems = items.map((item, index) => {\r\n            const durationDays = parseInt(item.estimatedTime || '1') || 1;\r\n            const start = new Date(currentDate);\r\n            const end = addDays(start, durationDays);\r\n\r\n            const itemWithDates = {\r\n                ...item,\r\n                startDate: format(start, 'yyyy-MM-dd'),\r\n                deadline: format(end, 'yyyy-MM-dd'),\r\n                order: index\r\n            };\r\n\r\n            currentDate = end;\r\n            return itemWithDates;\r\n        });\r\n\r\n        const finalDate = updatedItems.length > 0\r\n            ? updatedItems[updatedItems.length - 1].deadline\r\n            : '';\r\n\r\n        return { updatedItems, finalDate };\r\n    };\r\n\r\n    // Update schedule when Start Date changes\r\n    useEffect(() => {\r\n        if (type === 'checklist' && checklist.length > 0 && startDate) {\r\n            const { updatedItems, finalDate } = recalculateSchedule(checklist, startDate);\r\n            const currentLastString = JSON.stringify(checklist.map(i => i.startDate + i.deadline));\r\n            const newLastString = JSON.stringify(updatedItems.map(i => i.startDate + i.deadline));\r\n\r\n            if (currentLastString !== newLastString) {\r\n                setChecklist(updatedItems);\r\n                if (finalDate) setDeadline(finalDate);\r\n            }\r\n        }\r\n    }, [startDate]);\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (!startDate) return;\r\n\r\n        let finalChecklist = checklist;\r\n        let finalDeadline = deadline;\r\n\r\n        if (type === 'checklist') {\r\n            const result = recalculateSchedule(checklist, startDate);\r\n            finalChecklist = result.updatedItems;\r\n            finalDeadline = result.finalDate || deadline;\r\n        }\r\n\r\n        if (!finalDeadline) return;\r\n\r\n        const goalData = {\r\n            title,\r\n            type,\r\n            category,\r\n            priority,\r\n            startDate,\r\n            deadline: finalDeadline,\r\n            recurrence: type === 'habit' ? recurrence : undefined,\r\n            relatedThemeId: relatedThemeId || undefined,\r\n            icon: icon || undefined,\r\n            color: color || undefined,\r\n            imageUrl: imageUrl || undefined,\r\n            durationMinutes: duration ? parseInt(duration) : undefined,\r\n            checklist: type === 'checklist' ? finalChecklist : undefined\r\n        };\r\n\r\n        if (goalToEdit) {\r\n            updateGoal(goalToEdit.id, goalData);\r\n        } else {\r\n            addGoal(goalData);\r\n        }\r\n\r\n        onClose();\r\n    };\r\n\r\n    const handleDelete = () => {\r\n        if (goalToEdit && window.confirm('Tem certeza que deseja excluir esta meta?')) {\r\n            deleteGoal(goalToEdit.id);\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return {\r\n        // State\r\n        title, setTitle,\r\n        type, setType,\r\n        category, setCategory,\r\n        priority, setPriority,\r\n        relatedThemeId, setRelatedThemeId,\r\n        startDate, setStartDate,\r\n        deadline, setDeadline,\r\n        recurrence, setRecurrence,\r\n        icon, setIcon,\r\n        color, setColor,\r\n        imageUrl, setImageUrl,\r\n        duration, setDuration,\r\n        checklist, setChecklist,\r\n\r\n        // Derived\r\n        usedColors,\r\n        themes,\r\n\r\n        // Actions\r\n        handleSubmit,\r\n        handleDelete,\r\n        recalculateSchedule\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\lists\\GoalList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useRef' is defined but never used.","line":1,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CARD_HEIGHT' is assigned a value but never used.","line":44,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MIN_COL_WIDTH' is assigned a value but never used.","line":45,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GAP' is assigned a value but never used.","line":46,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":14}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useConfirm } from '../../context/ConfirmContext';\r\nimport { Target, Pencil, Trash2, Clock, CheckCircle2, Play, Lock } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { parseLocalDate } from '../../utils/dateHelpers';\r\nimport { AddGoalModal } from '../goals/components/AddGoalModal';\r\nimport { GoalDetailsModal } from '../goals/components/GoalDetailsModal';\r\nimport type { Goal } from '../../types';\r\nimport { cn } from '../../lib/utils';\r\n\r\nexport const GoalList = () => {\r\n    const { goals, toggleGoal, deleteGoal, startFocus } = useStudy();\r\n    const { startFocusSession } = usePomodoroContext();\r\n    const { confirm } = useConfirm();\r\n    const [editingGoal, setEditingGoal] = useState<Goal | undefined>(undefined);\r\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n    const [selectedGoalForDetails, setSelectedGoalForDetails] = useState<Goal | null>(null);\r\n    const [isDetailsModalOpen, setIsDetailsModalOpen] = useState(false);\r\n    const [selectedCategory, setSelectedCategory] = useState<string>('Todos');\r\n\r\n    const handleCloseEditModal = () => {\r\n        setEditingGoal(undefined);\r\n        setIsEditModalOpen(false);\r\n    };\r\n\r\n    const handleEditGoal = (goal: Goal) => {\r\n        setEditingGoal(goal);\r\n        setIsEditModalOpen(true);\r\n    };\r\n\r\n    const handleOpenDetails = (goal: Goal) => {\r\n        setSelectedGoalForDetails(goal);\r\n        setIsDetailsModalOpen(true);\r\n    };\r\n\r\n    const handleCloseDetails = () => {\r\n        setSelectedGoalForDetails(null);\r\n        setIsDetailsModalOpen(false);\r\n    };\r\n\r\n    // Card dimensions - Premium layout\r\n    const CARD_HEIGHT = 340;\r\n    const MIN_COL_WIDTH = 340;\r\n    const GAP = 24;\r\n\r\n    const filteredGoals = goals.filter(g => {\r\n        if (g.relatedThemeId) return false;\r\n        const cat = g.category || (g.type === 'habit' ? 'Hbitos' : 'Geral');\r\n        return selectedCategory === 'Todos' || cat === selectedCategory;\r\n    });\r\n\r\n    const categories = ['Todos', ...Array.from(new Set(goals.filter(g => !g.relatedThemeId).map(g => g.category || (g.type === 'habit' ? 'Hbitos' : 'Geral'))))];\r\n\r\n    // Premium Goal Card PRO - Ultra Modern Design\r\n    const GoalCard = ({ goal }: { goal: Goal }) => {\r\n        const isCompleted = goal.progress === 100;\r\n\r\n        // Dynamic Color System - Unique colors per category (no repeats unless same category)\r\n        const getColors = () => {\r\n            if (isCompleted) return {\r\n                bg: 'bg-emerald-950/30',\r\n                border: 'border-emerald-500/30',\r\n                glow: 'shadow-[0_0_50px_-12px_rgba(16,185,129,0.3)]',\r\n                accent: 'text-emerald-400',\r\n                gradient: 'from-emerald-500 to-emerald-700',\r\n                button: 'bg-emerald-500 text-white shadow-emerald-500/40'\r\n            };\r\n\r\n            // Pool of 12 distinct color themes\r\n            const colorPool = [\r\n                { // Blue\r\n                    bg: 'bg-blue-950/30', border: 'border-blue-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(59,130,246,0.3)]', accent: 'text-blue-400',\r\n                    gradient: 'from-blue-500 to-indigo-600', button: 'bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-blue-500/40'\r\n                },\r\n                { // Rose\r\n                    bg: 'bg-rose-950/30', border: 'border-rose-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(244,63,94,0.3)]', accent: 'text-rose-400',\r\n                    gradient: 'from-rose-500 to-pink-600', button: 'bg-gradient-to-r from-rose-500 to-pink-600 text-white shadow-rose-500/40'\r\n                },\r\n                { // Orange\r\n                    bg: 'bg-orange-950/30', border: 'border-orange-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(249,115,22,0.3)]', accent: 'text-orange-400',\r\n                    gradient: 'from-orange-500 to-amber-600', button: 'bg-gradient-to-r from-orange-500 to-amber-600 text-white shadow-orange-500/40'\r\n                },\r\n                { // Cyan\r\n                    bg: 'bg-cyan-950/30', border: 'border-cyan-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(6,182,212,0.3)]', accent: 'text-cyan-400',\r\n                    gradient: 'from-cyan-500 to-teal-600', button: 'bg-gradient-to-r from-cyan-500 to-teal-600 text-white shadow-cyan-500/40'\r\n                },\r\n                { // Violet\r\n                    bg: 'bg-violet-950/30', border: 'border-violet-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(139,92,246,0.3)]', accent: 'text-violet-400',\r\n                    gradient: 'from-violet-500 to-purple-600', button: 'bg-gradient-to-r from-violet-500 to-purple-600 text-white shadow-violet-500/40'\r\n                },\r\n                { // Lime\r\n                    bg: 'bg-lime-950/30', border: 'border-lime-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(132,204,22,0.3)]', accent: 'text-lime-400',\r\n                    gradient: 'from-lime-500 to-green-600', button: 'bg-gradient-to-r from-lime-500 to-green-600 text-white shadow-lime-500/40'\r\n                },\r\n                { // Amber\r\n                    bg: 'bg-amber-950/30', border: 'border-amber-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(245,158,11,0.3)]', accent: 'text-amber-400',\r\n                    gradient: 'from-amber-500 to-yellow-600', button: 'bg-gradient-to-r from-amber-500 to-yellow-600 text-white shadow-amber-500/40'\r\n                },\r\n                { // Pink\r\n                    bg: 'bg-pink-950/30', border: 'border-pink-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(236,72,153,0.3)]', accent: 'text-pink-400',\r\n                    gradient: 'from-pink-500 to-fuchsia-600', button: 'bg-gradient-to-r from-pink-500 to-fuchsia-600 text-white shadow-pink-500/40'\r\n                },\r\n                { // Teal\r\n                    bg: 'bg-teal-950/30', border: 'border-teal-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(20,184,166,0.3)]', accent: 'text-teal-400',\r\n                    gradient: 'from-teal-500 to-emerald-600', button: 'bg-gradient-to-r from-teal-500 to-emerald-600 text-white shadow-teal-500/40'\r\n                },\r\n                { // Indigo\r\n                    bg: 'bg-indigo-950/30', border: 'border-indigo-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(99,102,241,0.3)]', accent: 'text-indigo-400',\r\n                    gradient: 'from-indigo-500 to-blue-600', button: 'bg-gradient-to-r from-indigo-500 to-blue-600 text-white shadow-indigo-500/40'\r\n                },\r\n                { // Red\r\n                    bg: 'bg-red-950/30', border: 'border-red-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(239,68,68,0.3)]', accent: 'text-red-400',\r\n                    gradient: 'from-red-500 to-rose-600', button: 'bg-gradient-to-r from-red-500 to-rose-600 text-white shadow-red-500/40'\r\n                },\r\n                { // Sky\r\n                    bg: 'bg-sky-950/30', border: 'border-sky-500/30',\r\n                    glow: 'shadow-[0_0_40px_-10px_rgba(14,165,233,0.3)]', accent: 'text-sky-400',\r\n                    gradient: 'from-sky-500 to-blue-600', button: 'bg-gradient-to-r from-sky-500 to-blue-600 text-white shadow-sky-500/40'\r\n                }\r\n            ];\r\n\r\n            // Hash function to get consistent index from category name\r\n            const hashCategory = (str: string): number => {\r\n                let hash = 0;\r\n                const s = str.toLowerCase().trim();\r\n                for (let i = 0; i < s.length; i++) {\r\n                    const char = s.charCodeAt(i);\r\n                    hash = ((hash << 5) - hash) + char;\r\n                    hash = hash & hash; // Convert to 32bit integer\r\n                }\r\n                return Math.abs(hash);\r\n            };\r\n\r\n            const category = goal.category || goal.type || 'geral';\r\n            const colorIndex = hashCategory(category) % colorPool.length;\r\n\r\n            return colorPool[colorIndex];\r\n        };\r\n\r\n        const theme = getColors();\r\n\r\n        // Date-based locking logic\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        const isFuture = !!(goal.startDate && goal.startDate > todayStr);\r\n        const lockReason = isFuture ? `Agendado para ${format(new Date(goal.startDate + 'T00:00:00'), 'dd/MM')}` : \"\";\r\n\r\n        return (\r\n            <div className=\"h-full relative\">\r\n                {/* Card Container */}\r\n                <div\r\n                    className={cn(\r\n                        \"relative h-full flex flex-col rounded-[1.5rem] overflow-hidden transition-all duration-500\",\r\n                        \"border backdrop-blur-3xl\",\r\n                        theme.bg, theme.border, theme.glow\r\n                    )}\r\n                >\r\n                    {/* Background Noise/Texture */}\r\n                    <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none mix-blend-overlay\" />\r\n\r\n\r\n\r\n\r\n\r\n                    {/* CONTENT AREA */}\r\n                    <div className=\"flex-1 p-4 flex flex-col relative z-20\">\r\n\r\n                        {/* HEADER: Icon & Title */}\r\n                        <div className=\"flex items-start gap-3 mb-2\">\r\n                            <div className={cn(\r\n                                \"w-10 h-10 rounded-lg flex items-center justify-center shrink-0 shadow-md relative overflow-hidden\",\r\n                                \"bg-gradient-to-br border border-white/10\",\r\n                                theme.gradient\r\n                            )}>\r\n                                {/* Inner Shine */}\r\n                                <div className=\"absolute inset-0 bg-gradient-to-tr from-transparent via-white/20 to-transparent opacity-60\" />\r\n                                <div className=\"relative z-10 text-lg\">\r\n                                    {goal.icon || <Target className=\"w-5 h-5 text-white\" />}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex-1 min-w-0\">\r\n                                <h3 className=\"text-sm font-bold text-white leading-tight tracking-tight line-clamp-1 mb-1\">\r\n                                    {goal.title}\r\n                                </h3>\r\n                                {/* Meta Tags */}\r\n                                <div className=\"flex flex-wrap items-center gap-1.5\">\r\n                                    <span className={cn(\r\n                                        \"text-[9px] font-bold uppercase tracking-wide px-2 py-0.5 rounded border bg-white/5\",\r\n                                        theme.border, theme.accent\r\n                                    )}>\r\n                                        {goal.category || (goal.type === 'habit' ? 'Hbito' : 'Meta')}\r\n                                    </span>\r\n                                    {goal.deadline && (\r\n                                        <span className=\"text-[10px] font-medium text-slate-400 flex items-center gap-1\">\r\n                                            <Clock className=\"w-3 h-3\" />\r\n                                            {format(parseLocalDate(goal.deadline), 'dd/MM')}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* ACTIONS - Static & Organized */}\r\n                            <div className=\"flex items-center gap-1.5 ml-auto shrink-0 self-start\">\r\n                                <button\r\n                                    onClick={(e) => { e.stopPropagation(); handleEditGoal(goal); }}\r\n                                    className=\"w-7 h-7 flex items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700 text-slate-300 hover:text-white border border-slate-600/50 transition-colors duration-300\"\r\n                                    title=\"Editar\"\r\n                                >\r\n                                    <Pencil className=\"w-3 h-3\" />\r\n                                </button>\r\n                                <button\r\n                                    onClick={async (e) => {\r\n                                        e.stopPropagation();\r\n                                        const confirmed = await confirm({\r\n                                            title: 'Excluir Meta',\r\n                                            message: `Excluir \"${goal.title}\"?`,\r\n                                            confirmText: 'Excluir',\r\n                                            isDangerous: true\r\n                                        });\r\n                                        if (confirmed) deleteGoal(goal.id);\r\n                                    }}\r\n                                    className=\"w-7 h-7 flex items-center justify-center rounded-md bg-slate-800/80 hover:bg-red-900/50 text-slate-300 hover:text-red-400 border border-slate-600/50 transition-colors duration-300\"\r\n                                    title=\"Excluir\"\r\n                                >\r\n                                    <Trash2 className=\"w-3 h-3\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* MIDDLE: Progress */}\r\n                        <div className=\"mt-auto space-y-2\">\r\n                            <div className=\"flex justify-between items-end\">\r\n                                <span className=\"text-[10px] font-semibold text-slate-500 uppercase tracking-wider\">Progresso</span>\r\n                                <div className=\"flex items-baseline gap-0.5\">\r\n                                    <span className={cn(\"text-2xl font-black tracking-tighter\", theme.accent)}>\r\n                                        {goal.progress}\r\n                                    </span>\r\n                                    <span className=\"text-sm font-bold text-slate-600\">%</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Ultra Bar */}\r\n                            <div className=\"h-4 bg-slate-950/50 rounded-full p-1 shadow-inner border border-white/5\">\r\n                                <div\r\n                                    className={cn(\r\n                                        \"h-full rounded-full relative overflow-hidden transition-all duration-1000 ease-out\",\r\n                                        theme.gradient\r\n                                    )}\r\n                                    style={{ width: `${Math.max(goal.progress, 5)}%` }} // Min width for visibility\r\n                                >\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-[shimmer_8s_infinite]\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* BOTTOM: Actions */}\r\n                        <div className=\"mt-3 flex items-center gap-2\">\r\n                            <button\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    if (goal.type === 'habit') {\r\n                                        const isDone = goal.completionHistory?.some((d: string) => d.startsWith(format(new Date(), 'yyyy-MM-dd')));\r\n                                        if (!isDone) toggleGoal(goal.id);\r\n                                    } else {\r\n                                        handleOpenDetails(goal);\r\n                                    }\r\n                                }}\r\n                                className={cn(\r\n                                    \"flex-1 rounded-lg font-bold text-[10px] uppercase tracking-wide transition-all active:scale-95 border border-white/5 hover:bg-white/5 hover:border-white/10 text-slate-300 flex items-center justify-center gap-1.5 h-10\",\r\n                                    goal.type === 'habit' ? 'bg-slate-800/50' : 'bg-transparent'\r\n                                )}\r\n                            >\r\n                                {goal.type === 'habit' ? (\r\n                                    <>\r\n                                        {isFuture ? <Lock className=\"w-4 h-4\" /> : <CheckCircle2 className=\"w-4 h-4\" />}\r\n                                        <span>{isFuture ? \"Bloqueado\" : \"Concluir\"}</span>\r\n                                    </>\r\n                                ) : 'Detalhes'}\r\n                            </button>\r\n\r\n                            <button\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    if (isFuture) return;\r\n                                    const duration = goal.durationMinutes || 25;\r\n                                    startFocus(goal.id, 'goal', goal.title, duration);\r\n                                    startFocusSession(goal.id, duration);\r\n                                }}\r\n                                disabled={isFuture}\r\n                                className={cn(\r\n                                    \"w-10 h-10 rounded-lg flex items-center justify-center shadow-lg transition-all active:scale-95\",\r\n                                    isFuture\r\n                                        ? \"bg-slate-800 border border-slate-700 text-slate-600 cursor-not-allowed\"\r\n                                        : theme.button\r\n                                )}\r\n                                title={isFuture ? lockReason : \"Iniciar Foco\"}\r\n                            >\r\n                                {isFuture ? <Lock className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4 fill-current ml-0.5\" />}\r\n                            </button>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 w-full pt-8 relative pb-20\">\r\n            {/* Ambient Background Glows */}\r\n            <div className=\"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] bg-blue-500/10 rounded-full blur-[120px] pointer-events-none\" />\r\n            <div className=\"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] bg-emerald-500/10 rounded-full blur-[120px] pointer-events-none\" />\r\n\r\n            {/* Header Section */}\r\n            <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 px-6 relative z-10\">\r\n                <div className=\"space-y-2\">\r\n                    <h2 className=\"text-4xl md:text-5xl font-black text-white tracking-tighter text-glow drop-shadow-xl\">Minhas Metas</h2>\r\n                    <p className=\"text-slate-400 text-sm font-medium tracking-wide\">Transforme seus sonhos em realidade.</p>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={() => setIsEditModalOpen(true)}\r\n                    className=\"px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 text-white rounded-2xl font-bold shadow-xl shadow-blue-900/30 active:scale-95 transition-all flex items-center gap-3 ring-1 ring-white/10 backdrop-blur-md\"\r\n                >\r\n                    <span className=\"text-2xl leading-none font-light pb-0.5\">+</span>\r\n                    Nova Meta\r\n                </button>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            {goals.length > 0 && (\r\n                <div className=\"flex items-center gap-3 overflow-x-auto pb-4 scrollbar-hide px-6 relative z-10\">\r\n                    {categories.map(cat => (\r\n                        <button\r\n                            key={cat}\r\n                            onClick={() => setSelectedCategory(cat)}\r\n                            className={cn(\r\n                                \"px-6 py-3 rounded-2xl text-xs font-bold uppercase tracking-wider transition-all border backdrop-blur-md shadow-lg\",\r\n                                selectedCategory === cat\r\n                                    ? \"bg-blue-600/20 border-blue-500/50 text-blue-200 shadow-blue-900/20 active-glow\"\r\n                                    : \"bg-slate-900/40 border-white/5 text-slate-500 hover:bg-slate-800/40 hover:text-slate-300\"\r\n                            )}\r\n                        >\r\n                            {cat}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"relative px-2 z-10\">\r\n                {filteredGoals.length === 0 ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-[500px] text-center px-4\">\r\n                        <div className=\"w-32 h-32 bg-slate-900/30 backdrop-blur-md rounded-full flex items-center justify-center mb-8 ring-1 ring-white/10 shadow-2xl relative overflow-hidden\">\r\n                            <div className=\"absolute inset-0 bg-gradient-to-tr from-white/5 to-transparent skew-x-12 opacity-50\" />\r\n                            <Target className=\"w-12 h-12 text-slate-600 drop-shadow-lg\" />\r\n                        </div>\r\n                        <h3 className=\"text-3xl font-bold text-white mb-3 text-glow\">Nenhuma meta encontrada</h3>\r\n                        <p className=\"text-slate-400 max-w-sm mb-10 leading-relaxed\">No encontramos metas nesta categoria. Que tal criar algo novo?</p>\r\n                        <button onClick={() => setIsEditModalOpen(true)} className=\"px-10 py-4 bg-white/5 hover:bg-white/10 border border-white/10 text-white rounded-2xl font-bold transition-all shadow-lg backdrop-blur-sm\">\r\n                            Criar Nova Meta\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"p-4\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\r\n                            {filteredGoals.map((goal) => (\r\n                                <div key={goal.id} className=\"h-[200px]\">\r\n                                    <GoalCard goal={goal} />\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <AddGoalModal\r\n                isOpen={isEditModalOpen}\r\n                onClose={handleCloseEditModal}\r\n                goalToEdit={editingGoal}\r\n            />\r\n\r\n            <GoalDetailsModal\r\n                isOpen={isDetailsModalOpen}\r\n                onClose={handleCloseDetails}\r\n                goal={selectedGoalForDetails}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\lists\\ProjectList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\lists\\TaskList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'toggleTask' is assigned a value but never used.","line":14,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'toggleGoalItem' is assigned a value but never used.","line":14,"column":63,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startAudio' is assigned a value but never used.","line":16,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1324,1327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1324,1327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getItemSize' is assigned a value but never used.","line":65,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":22}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useMemo, useEffect } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useAudio } from '../../context/AudioContext';\r\nimport { useConfirm } from '../../context/ConfirmContext';\r\nimport { CheckSquare, Pencil, Trash2, Play, Lock, Target } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { parseLocalDate } from '../../utils/dateHelpers';\r\nimport { AddTaskModal } from '../forms/AddTaskModal';\r\nimport { TaskDetailsModal } from '../tasks/components/TaskDetailsModal';\r\nimport type { Task } from '../../types';\r\n\r\nexport const TaskList = () => {\r\n    const { tasks, toggleTask, deleteTask, startFocus, goals, toggleGoalItem } = useStudy();\r\n    const { startFocusSession, linkedItemId, isActive } = usePomodoroContext();\r\n    const { startAudio } = useAudio();\r\n    const { confirm } = useConfirm();\r\n    const [editingTask, setEditingTask] = useState<Task | undefined>(undefined);\r\n    const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n    const [selectedDetailedTask, setSelectedDetailedTask] = useState<Task | null>(null);\r\n\r\n    // We need a ref to the list to reset cache when tasks change (if using VariableSizeList with index-based size)\r\n    const listRef = useRef<any>(null);\r\n\r\n    // Sort tasks: Newest first (by createdAt)\r\n    const sortedItems = useMemo(() => {\r\n        // Flatten Goal Steps\r\n        const steps = goals.flatMap(g =>\r\n            (g.checklist || []).map(item => ({\r\n                ...item,\r\n                id: item.id,\r\n                title: `${item.title} (${g.title})`, // Contextual title\r\n                status: item.completed ? 'completed' : 'pending',\r\n                createdAt: g.createdAt || 0, // Fallback to goal creation\r\n                type: 'step', // Internal type\r\n                goalId: g.id, // Reference to parent\r\n                priority: g.priority,\r\n                imageUrl: undefined, // Steps don't have images usually\r\n                color: g.color, // Inherit goal color\r\n                date: item.deadline, // Map deadline to date\r\n                durationMinutes: 25 // Default duration\r\n            }))\r\n        );\r\n\r\n        const all = [...tasks, ...steps];\r\n\r\n        return all.sort((a, b) => {\r\n            // Sort by status (pending first) then by date\r\n            if (a.status === 'pending' && b.status === 'completed') return -1;\r\n            if (a.status === 'completed' && b.status === 'pending') return 1;\r\n\r\n            const timeA = a.createdAt || 0;\r\n            const timeB = b.createdAt || 0;\r\n            return timeB - timeA;\r\n        });\r\n    }, [tasks, goals]);\r\n\r\n    // Reset list cache when tasks change to ensure correct heights map\r\n    useEffect(() => {\r\n        if (listRef.current) {\r\n            listRef.current.resetAfterIndex(0);\r\n        }\r\n    }, [sortedItems]);\r\n\r\n    const getItemSize = (index: number) => {\r\n        const item = sortedItems[index];\r\n        if (!item) return 0;\r\n        // Base height ~110px + Image height ~96px (h-24) + margin\r\n        return item.imageUrl ? 230 : 130;\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 h-full flex flex-col pt-6 overflow-hidden\">\r\n            <div className=\"flex items-center justify-between shrink-0 mb-4 px-4\">\r\n                <h2 className=\"text-2xl font-bold text-slate-100\">Minhas Tarefas</h2>\r\n                <button\r\n                    onClick={() => setIsAddModalOpen(true)}\r\n                    className=\"group relative px-4 py-2 bg-slate-900 rounded-lg font-bold text-white shadow-lg hover:scale-[1.02] active:scale-95 transition-all duration-300 overflow-hidden ring-1 ring-white/10\"\r\n                >\r\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 opacity-80 group-hover:opacity-100 transition-opacity\" />\r\n                    <span className=\"relative flex items-center gap-1.5 text-sm\">\r\n                        <span className=\"text-lg leading-none font-light mb-0.5\">+</span>\r\n                        Nova Tarefa\r\n                    </span>\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"flex-1 min-h-0 relative px-4\">\r\n                {sortedItems.length === 0 ? (\r\n                    <div className=\"glass-card text-center py-20 rounded-3xl relative overflow-hidden group border border-slate-800/50 border-dashed bg-slate-900/30\">\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center mx-auto mb-4 ring-1 ring-white/10 shadow-xl shadow-black/20 group-hover:scale-110 transition-transform duration-500\">\r\n                                <CheckSquare className=\"w-8 h-8 text-slate-500 group-hover:text-blue-400 transition-colors\" />\r\n                            </div>\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">Tudo em dia!</h3>\r\n                            <p className=\"text-slate-500 max-w-xs mx-auto mb-6 text-sm\">Nenhuma tarefa pendente. Aproveite para adicionar novos objetivos.</p>\r\n                            <button\r\n                                onClick={() => setIsAddModalOpen(true)}\r\n                                className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white rounded-lg font-bold transition-all hover:scale-105 shadow-lg shadow-blue-500/25 ring-1 ring-white/20 text-sm\"\r\n                            >\r\n                                Criar Primeira Tarefa\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"h-full overflow-y-auto custom-scrollbar pb-20\">\r\n                        {sortedItems.map((item, index) => {\r\n                            const isLinked = linkedItemId === item.id;\r\n                            const isLocked = isLinked && isActive;\r\n                            const isStep = item.type === 'step';\r\n\r\n                            // Date-based locking\r\n                            const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n                            const itemDate = item.date || (item.startDate ? item.startDate.split('T')[0] : undefined);\r\n                            const isFuture = !!(itemDate && itemDate > todayStr);\r\n\r\n                            // Find first pending task\r\n                            const firstPendingIndex = sortedItems.findIndex(t => t.status === 'pending');\r\n                            const isFirstPending = index === firstPendingIndex && item.status === 'pending';\r\n                            const isBlocked = !!((item.status === 'pending' && !isFirstPending) || isFuture);\r\n                            const lockReason = isFuture ? `Agendado para ${format(parseLocalDate(itemDate || todayStr), 'dd/MM')}` : \"Complete a tarefa anterior primeiro\";\r\n\r\n                            return (\r\n                                <div key={item.id} style={{ height: item.imageUrl ? 230 : 130, marginBottom: 12 }} className=\"px-1 pr-4\">\r\n                                    <div\r\n                                        style={{ '--hover-color': item.color || '#3b82f6' } as React.CSSProperties}\r\n                                        className={`h-full border rounded-xl overflow-hidden transition-colors transition-shadow duration-300 group flex flex-col ${isBlocked\r\n                                            ? 'bg-slate-900/30 border-slate-800/30 opacity-60'\r\n                                            : isLinked\r\n                                                ? 'bg-slate-900 border-rose-500/50 shadow-lg shadow-rose-900/10'\r\n                                                : 'bg-slate-900 border-slate-800 hover:border-[var(--hover-color)]'\r\n                                            }`}\r\n                                    >\r\n                                        {item.imageUrl && (\r\n                                            <div className=\"h-24 w-full relative bg-slate-800 shrink-0\">\r\n                                                <img src={item.imageUrl} alt={item.title} className=\"w-full h-full object-cover\" />\r\n                                            </div>\r\n                                        )}\r\n                                        <div className=\"flex items-center gap-4 p-4 flex-1\">\r\n                                            <button\r\n                                                onClick={() => {\r\n                                                    return;\r\n                                                }}\r\n                                                disabled={true}\r\n                                                className={`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors shrink-0 ${isBlocked\r\n                                                    ? 'border-slate-600 bg-slate-800/50 cursor-not-allowed'\r\n                                                    : isLocked\r\n                                                        ? 'border-rose-500/50 bg-rose-500/10 cursor-not-allowed'\r\n                                                        : item.status === 'completed'\r\n                                                            ? 'bg-emerald-500 border-emerald-500 cursor-not-allowed'\r\n                                                            : (() => {\r\n                                                                const today = format(new Date(), 'yyyy-MM-dd');\r\n                                                                const isDoneToday = item.completionHistory?.some((d: string) => d.startsWith(today));\r\n                                                                return isDoneToday\r\n                                                                    ? 'bg-emerald-500/20 border-emerald-500/50 cursor-not-allowed'\r\n                                                                    : 'border-slate-500 hover:border-emerald-500 cursor-default';\r\n                                                            })()\r\n                                                    }`}\r\n                                                title={isBlocked ? lockReason : isLocked ? \"Conclua o Pomodoro primeiro!\" : \"Utilize o Pomodoro para concluir\"}\r\n                                            >\r\n                                                {isBlocked ? (\r\n                                                    <Lock className=\"w-3 h-3 text-slate-500\" />\r\n                                                ) : isLocked ? (\r\n                                                    <Lock className=\"w-3 h-3 text-rose-500\" />\r\n                                                ) : (\r\n                                                    (item.status === 'completed' || item.completionHistory?.some((d: string) => d.startsWith(format(new Date(), 'yyyy-MM-dd')))) && <CheckSquare className=\"w-4 h-4 text-white\" />\r\n                                                )}\r\n                                            </button>\r\n\r\n                                            <div className=\"flex-1 min-w-0\" onClick={() => !isStep && setSelectedDetailedTask(item as Task)}>\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    {isStep && <Target className=\"w-3 h-3 text-slate-500\" />}\r\n                                                    <p className={`font-medium truncate ${isBlocked\r\n                                                        ? 'text-slate-600'\r\n                                                        : item.status === 'completed'\r\n                                                            ? 'text-slate-500 line-through'\r\n                                                            : (item.date && parseLocalDate(item.date) < new Date(new Date().setHours(0, 0, 0, 0)))\r\n                                                                ? 'text-red-400'\r\n                                                                : 'text-slate-200 cursor-pointer hover:underline'\r\n                                                        }`}>\r\n                                                        {item.title}\r\n                                                    </p>\r\n                                                </div>\r\n\r\n                                                {(item.type === 'period' || item.type === 'recurring') && 'progress' in item && item.progress && (\r\n                                                    <div className=\"mt-2 space-y-1\">\r\n                                                        <div className=\"flex justify-between items-center text-[10px]\">\r\n                                                            <span className=\"text-slate-500 font-bold uppercase tracking-wider\">Progresso</span>\r\n                                                            <span className=\"text-slate-400 font-bold\">\r\n                                                                {item.progress.current}/{item.progress.total}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                        <div className=\"h-1.5 bg-slate-900 rounded-full overflow-hidden\">\r\n                                                            <div\r\n                                                                className=\"h-full bg-gradient-to-r from-blue-600 to-purple-600 rounded-full transition-all duration-500\"\r\n                                                                style={{ width: `${Math.min(100, (item.progress.current / item.progress.total) * 100)}%` }}\r\n                                                            />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n\r\n                                                <div className=\"flex gap-2 text-xs text-slate-500 mt-1 flex-wrap\">\r\n                                                    {isBlocked && (\r\n                                                        <span className=\"flex items-center gap-1 px-2 py-0.5 bg-slate-800/50 text-slate-600 rounded font-medium shrink-0\">\r\n                                                            <Lock className=\"w-3 h-3\" />\r\n                                                            Bloqueada\r\n                                                        </span>\r\n                                                    )}\r\n                                                    <span className={`capitalize px-2 py-0.5 rounded font-medium shrink-0 ${item.priority === 'high' ? 'bg-red-500/20 text-red-400' :\r\n                                                        item.priority === 'medium' ? 'bg-amber-500/20 text-amber-400' :\r\n                                                            'bg-slate-800 text-slate-400'\r\n                                                        }`}>\r\n                                                        {item.priority === 'high' ? 'Alta' : item.priority === 'medium' ? 'Mdia' : 'Baixa'}\r\n                                                    </span>\r\n                                                    <span className=\"capitalize px-2 py-0.5 bg-slate-800 rounded shrink-0\">\r\n                                                        {item.type === 'day' ? 'Dia' : item.type === 'period' ? 'Perodo' : item.type === 'recurring' ? 'Recorrente' : 'Meta'}\r\n                                                    </span>\r\n                                                    {item.type === 'period' && item.startDate && (\r\n                                                        <span className=\"shrink-0 text-slate-400\">\r\n                                                            Incio: {format(parseLocalDate(item.startDate), 'dd/MM/yyyy')}\r\n                                                        </span>\r\n                                                    )}\r\n                                                    {item.type === 'period' && item.endDate && (\r\n                                                        <span className={`shrink-0 ${parseLocalDate(item.endDate) < new Date(new Date().setHours(0, 0, 0, 0)) ? 'text-red-400 font-bold animate-pulse' : 'text-slate-400'}`}>\r\n                                                            Fim: {format(parseLocalDate(item.endDate), 'dd/MM/yyyy')}\r\n                                                        </span>\r\n                                                    )}\r\n                                                    {item.type === 'day' && item.date && (\r\n                                                        <span className={`shrink-0 ${!item.status && parseLocalDate(item.date) < new Date(new Date().setHours(0, 0, 0, 0)) ? 'text-red-400 font-bold animate-pulse' : ''}`}>\r\n                                                            {isBlocked ? 'Incio: ' : ''}{format(parseLocalDate(item.date), 'dd/MM/yyyy')}\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"flex gap-2 items-center shrink-0\">\r\n                                                <button\r\n                                                    onClick={() => {\r\n                                                        if (isBlocked) return;\r\n\r\n                                                        // PRIORIDADE MXIMA: Bloqueio de dias futuros\r\n                                                        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n                                                        const itemDate = item.date || (item.startDate ? item.startDate.split('T')[0] : undefined);\r\n                                                        if (itemDate && itemDate > todayStr) return;\r\n\r\n                                                        const duration = item.durationMinutes || 25;\r\n                                                        if (isStep && item.goalId) {\r\n                                                            startFocus(item.id, 'goal', item.title, duration, undefined, undefined, item.goalId);\r\n                                                        } else {\r\n                                                            startFocus(item.id, 'task', item.title, duration);\r\n                                                        }\r\n                                                        startFocusSession(item.id, duration);\r\n                                                    }}\r\n                                                    disabled={isBlocked}\r\n                                                    className={`w-8 h-8 rounded-full border flex items-center justify-center transition-all ${isBlocked\r\n                                                        ? 'bg-slate-800/30 border-slate-700/30 text-slate-600 cursor-not-allowed'\r\n                                                        : isLinked && isActive\r\n                                                            ? 'bg-rose-500/20 border-rose-500/50 text-rose-400'\r\n                                                            : 'bg-slate-800/50 border-slate-700 text-slate-400 hover:text-white hover:bg-blue-600 hover:border-blue-500'\r\n                                                        }`}\r\n                                                    title={isBlocked ? lockReason : \"Iniciar Foco\"}\r\n                                                >\r\n                                                    <Play className={`w-3.5 h-3.5 fill-current`} />\r\n                                                </button>\r\n\r\n                                                <div className=\"w-px h-4 bg-slate-800 mx-1\" />\r\n\r\n                                                {!isStep && !isBlocked && (\r\n                                                    <>\r\n                                                        <button\r\n                                                            onClick={() => setEditingTask(item as Task)}\r\n                                                            className=\"p-2 text-slate-400 hover:text-blue-400 hover:bg-slate-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 relative z-20\"\r\n                                                        >\r\n                                                            <Pencil className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={async () => {\r\n                                                                const confirmed = await confirm({\r\n                                                                    title: 'Excluir Tarefa',\r\n                                                                    message: `Tem certeza que deseja excluir \"${item.title}\"?`,\r\n                                                                    confirmText: 'Excluir',\r\n                                                                    cancelText: 'Cancelar',\r\n                                                                    isDangerous: true\r\n                                                                });\r\n                                                                if (confirmed) deleteTask(item.id);\r\n                                                            }}\r\n                                                            className=\"p-2 text-slate-400 hover:text-red-400 hover:bg-slate-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 relative z-20\"\r\n                                                        >\r\n                                                            <Trash2 className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                    </>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Modals */}\r\n            <AddTaskModal\r\n                isOpen={!!editingTask || isAddModalOpen}\r\n                onClose={() => {\r\n                    setEditingTask(undefined);\r\n                    setIsAddModalOpen(false);\r\n                }}\r\n                taskToEdit={editingTask}\r\n            />\r\n\r\n            <TaskDetailsModal\r\n                isOpen={!!selectedDetailedTask}\r\n                onClose={() => setSelectedDetailedTask(null)}\r\n                task={selectedDetailedTask}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\lists\\ThemeList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addDays' is defined but never used.","line":5,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Modal' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1213,1216],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1213,1216],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Cell' is assigned a value but never used.","line":40,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1949,1952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1949,1952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7886,7889],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7886,7889],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'NotesEditorWrapper' is assigned a value but never used.","line":164,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":164,"endColumn":25}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Layers } from 'lucide-react';\r\nimport { format, addDays } from 'date-fns';\r\nimport { AddThemeModal } from '../themes/components/AddThemeModal';\r\nimport { Modal } from '../../components/ui/Modal';\r\nimport { RichTextEditor } from '../../components/ui/RichTextEditor';\r\nimport type { Theme } from '../../types';\r\nimport { ThemeCard } from '../themes/components/ThemeCard';\r\nimport { useSRSLogic } from '../../hooks/useSRSLogic';\r\nimport { StudyContentModal } from '../themes/components/StudyContentModal';\r\n\r\ninterface ThemeListProps {\r\n    forceCategory?: 'project' | 'study';\r\n    defaultCategory?: 'project' | 'study';\r\n}\r\n\r\nexport const ThemeList = ({ forceCategory, defaultCategory }: ThemeListProps = {}) => {\r\n    const { themes, deleteTheme, updateSubthemeContent, unlockedSubthemes, completeReview } = useStudy();\r\n    const { calculateQueuedDates, getThemeCompletionDate } = useSRSLogic();\r\n    const [editingTheme, setEditingTheme] = useState<Theme | undefined>(undefined);\r\n    const [selectedSubthemeForNotes, setSelectedSubthemeForNotes] = useState<any>(null);\r\n\r\n    const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n\r\n    const [searchParams] = useSearchParams();\r\n    // Use forceCategory prop if provided, otherwise use query param\r\n    const categoryFilter = forceCategory || searchParams.get('category');\r\n\r\n    // Filter themes based on category\r\n    // If category='project', show ONLY projects. Otherwise, show study themes (exclude projects)\r\n    const visibleThemes = categoryFilter === 'project'\r\n        ? themes.filter(t => t.category === 'project')\r\n        : themes.filter(t => t.category !== 'project');\r\n\r\n    // Queue Logic\r\n    const queuedSubthemesMap = calculateQueuedDates(visibleThemes);\r\n\r\n    const Cell = ({ columnIndex, rowIndex, style, data }: any) => {\r\n        const { themes, columnCount, onEdit, onDelete, getCompletion, ...rest } = data;\r\n        const index = rowIndex * columnCount + columnIndex;\r\n\r\n        if (index >= themes.length) {\r\n            return null;\r\n        }\r\n\r\n        const theme = themes[index];\r\n\r\n        return (\r\n            <div style={{ ...style, padding: '12px' }}>\r\n                <ThemeCard\r\n                    theme={theme}\r\n                    completionDate={getCompletion(theme)}\r\n                    onEdit={() => onEdit(theme)}\r\n                    onDelete={() => onDelete(theme.id)}\r\n                    {...rest}\r\n                />\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"h-[calc(100vh-6rem)] flex flex-col gap-6 pb-4\">\r\n            {/* Header with Glow */}\r\n            <div className=\"shrink-0 relative flex flex-col md:flex-row md:items-end justify-between gap-4 px-1\">\r\n                <div className=\"absolute -top-10 -left-10 w-64 h-64 bg-blue-500/20 rounded-full blur-[100px] -z-10 pointer-events-none\" />\r\n                <div>\r\n                    <h2 className=\"text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-slate-200 to-slate-500 mb-2\">\r\n                        {categoryFilter === 'project' ? 'Meus Projetos' : 'Meus Mundos de Estudo'}\r\n                    </h2>\r\n                    <p className=\"text-slate-400 max-w-2xl\">\r\n                        {categoryFilter === 'project'\r\n                            ? 'Organize e acompanhe seus projetos e objetivos prticos.'\r\n                            : 'Gerencie suas trilhas de conhecimento e acompanhe o progresso de cada universo.'}\r\n                    </p>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={() => setIsAddModalOpen(true)}\r\n                    className=\"group relative px-6 py-3 bg-slate-900 rounded-xl font-bold text-white shadow-xl hover:scale-[1.02] active:scale-95 transition-all duration-300 overflow-hidden ring-1 ring-white/10 shrink-0\"\r\n                >\r\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 opacity-80 group-hover:opacity-100 transition-opacity\" />\r\n                    <span className=\"relative flex items-center gap-2\">\r\n                        <span className=\"text-xl leading-none font-light mb-0.5\">+</span>\r\n                        Novo Tema\r\n                    </span>\r\n                </button>\r\n            </div>\r\n\r\n            {/* List with AutoSizer */}\r\n            <div className=\"flex-1 min-h-0\">\r\n                {visibleThemes.length === 0 ? (\r\n                    <div className=\"glass-card text-center py-20 rounded-3xl relative overflow-hidden group\">\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"w-20 h-20 bg-slate-800/50 rounded-full flex items-center justify-center mx-auto mb-6 ring-1 ring-white/10 shadow-xl shadow-black/20 group-hover:scale-110 transition-transform duration-500\">\r\n                                <Layers className=\"w-10 h-10 text-slate-500 group-hover:text-blue-400 transition-colors\" />\r\n                            </div>\r\n                            <h3 className=\"text-2xl font-bold text-white mb-2\">Seu Universo est Vazio</h3>\r\n                            <p className=\"text-slate-400 max-w-md mx-auto mb-8 text-lg\">Crie seu primeiro tema de estudos para comear a organizar seu conhecimento.</p>\r\n                            <button\r\n                                onClick={() => setIsAddModalOpen(true)}\r\n                                className=\"px-8 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white rounded-xl font-bold transition-all hover:scale-105 shadow-lg shadow-blue-500/25 ring-1 ring-white/20\"\r\n                            >\r\n                                Criar Primeiro Tema\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-20\">\r\n                        {visibleThemes.map(theme => (\r\n                            <ThemeCard\r\n                                key={theme.id}\r\n                                theme={theme}\r\n                                completionDate={getThemeCompletionDate(theme, queuedSubthemesMap)}\r\n                                onEdit={() => setEditingTheme(theme)}\r\n                                onDelete={() => deleteTheme(theme.id)}\r\n                                onOpenNotes={setSelectedSubthemeForNotes}\r\n                                queuedSubthemesMap={queuedSubthemesMap}\r\n                                unlockedSubthemes={unlockedSubthemes}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <AddThemeModal\r\n                isOpen={!!editingTheme || isAddModalOpen}\r\n                onClose={() => {\r\n                    setEditingTheme(undefined);\r\n                    setIsAddModalOpen(false);\r\n                }}\r\n                themeToEdit={editingTheme}\r\n                defaultCategory={defaultCategory}\r\n            />\r\n\r\n            {/* Study Content Modal (New Comprehensive Version) */}\r\n            <StudyContentModal\r\n                isOpen={!!selectedSubthemeForNotes}\r\n                onClose={() => setSelectedSubthemeForNotes(null)}\r\n                subtheme={selectedSubthemeForNotes}\r\n                onSave={(content) => {\r\n                    // 1. Save Content\r\n                    updateSubthemeContent(selectedSubthemeForNotes.id, content);\r\n\r\n                    // 2. Check for PENDING reviews due today or earlier\r\n                    const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n                    const pendingReview = selectedSubthemeForNotes.reviews.find((r: any) =>\r\n                        r.status === 'pending' && r.date <= todayStr\r\n                    );\r\n\r\n                    if (pendingReview) {\r\n                        completeReview(selectedSubthemeForNotes.id, pendingReview.number);\r\n                    }\r\n\r\n                    setSelectedSubthemeForNotes(null);\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\n// Wrapper for Editor state\r\nconst NotesEditorWrapper = ({ initialContent, onSave }: { initialContent: string, onSave: (c: string) => void }) => {\r\n    const [content, setContent] = useState(initialContent || '');\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <RichTextEditor content={content} onChange={setContent} />\r\n            <div className=\"flex justify-end gap-2\">\r\n                <button onClick={() => onSave(content)} className=\"bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg font-bold text-sm\">Salvar Contedo</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\onboarding\\OnboardingModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":3,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BookOpen' is defined but never used.","line":3,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Check' is defined but never used.","line":3,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useStudy' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":18}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Sparkles, ArrowRight, User, BookOpen, Check } from 'lucide-react';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { useStudy } from '../../context/StudyContext';\r\n\r\ninterface OnboardingModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport const OnboardingModal: React.FC<OnboardingModalProps> = ({ isOpen, onClose }) => {\r\n    const { user, updateProfile } = useAuth();\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n    const handleFinalize = async () => {\r\n        setIsSubmitting(true);\r\n        // If name is still generic, set it to something better or just use email part\r\n        if (user?.name === 'User' || !user?.name) {\r\n            const defaultName = user?.email?.split('@')[0] || 'Estudante';\r\n            await updateProfile({ display_name: defaultName });\r\n        }\r\n\r\n        // Mark as dismissed in localStorage to avoid re-triggering just because it's empty\r\n        localStorage.setItem('onboarding_dismissed', 'true');\r\n\r\n        onClose();\r\n        setIsSubmitting(false);\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    className=\"absolute inset-0 bg-slate-950/90 backdrop-blur-xl\"\r\n                />\r\n\r\n                <motion.div\r\n                    initial={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                    animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                    exit={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                    className=\"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-3xl shadow-2xl overflow-hidden\"\r\n                >\r\n                    {/* Background Effects */}\r\n                    <div className=\"absolute top-0 left-0 w-full h-1/2 bg-blue-600/10 blur-[50px] pointer-events-none\" />\r\n\r\n                    <div className=\"p-8 relative z-10 text-center space-y-6\">\r\n                        <div className=\"w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl mx-auto flex items-center justify-center shadow-lg shadow-blue-500/30\">\r\n                            <Sparkles className=\"w-10 h-10 text-white\" />\r\n                        </div>\r\n\r\n                        <div>\r\n                            <h2 className=\"text-2xl font-black text-white mb-2\">Bem-vindo ao Reviso <span className=\"text-blue-400\">PRO</span></h2>\r\n                            <p className=\"text-slate-400\">Sua jornada para a maestria nos estudos comea aqui. Explore sua dashboard e comece a criar suas misses.</p>\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={handleFinalize}\r\n                            disabled={isSubmitting}\r\n                            className=\"w-full py-4 bg-white text-slate-950 font-bold rounded-xl hover:scale-[1.02] transition-transform flex items-center justify-center gap-2 disabled:opacity-50\"\r\n                        >\r\n                            {isSubmitting ? 'Iniciando...' : 'Comear Agora'} <ArrowRight className=\"w-4 h-4\" />\r\n                        </button>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n        </AnimatePresence>\r\n    );\r\n};\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\pomodoro\\FocusSoundsPlayer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Pause' is defined but never used.","line":3,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":63}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Howl } from 'howler';\r\nimport { Volume2, VolumeX, CloudRain, Wind, Radio, Play, Pause } from 'lucide-react';\r\nimport { cn } from '../../lib/utils';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst SOUNDS = [\r\n    { id: 'rain', label: 'Chuva', icon: CloudRain, src: 'https://assets.mixkit.co/sfx/preview/mixkit-light-rain-loop-1253.mp3', color: 'text-blue-400' },\r\n    { id: 'white', label: 'Rudo Branco', icon: Radio, src: 'https://assets.mixkit.co/sfx/preview/mixkit-white-noise-1262.mp3', color: 'text-slate-400' },\r\n    { id: 'wind', label: 'Vento', icon: Wind, src: 'https://assets.mixkit.co/sfx/preview/mixkit-wind-through-trees-1224.mp3', color: 'text-emerald-400' },\r\n];\r\n\r\nexport const FocusSoundsPlayer = () => {\r\n    const [currentSound, setCurrentSound] = useState<string | null>(null);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [volume, setVolume] = useState(0.5);\r\n    const [howl, setHowl] = useState<Howl | null>(null);\r\n    const [isExpanded, setIsExpanded] = useState(false);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            if (howl) howl.unload();\r\n        };\r\n    }, [howl]);\r\n\r\n    const toggleSound = (soundId: string) => {\r\n        if (currentSound === soundId && isPlaying) {\r\n            howl?.pause();\r\n            setIsPlaying(false);\r\n            return;\r\n        }\r\n\r\n        if (howl) {\r\n            howl.stop();\r\n        }\r\n\r\n        const sound = SOUNDS.find(s => s.id === soundId);\r\n        if (sound) {\r\n            const newHowl = new Howl({\r\n                src: [sound.src],\r\n                html5: true,\r\n                loop: true,\r\n                volume: volume,\r\n            });\r\n            newHowl.play();\r\n            setHowl(newHowl);\r\n            setCurrentSound(soundId);\r\n            setIsPlaying(true);\r\n        }\r\n    };\r\n\r\n    const handleVolumeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const newVol = parseFloat(e.target.value);\r\n        setVolume(newVol);\r\n        if (howl) howl.volume(newVol);\r\n    };\r\n\r\n    const activeSound = SOUNDS.find(s => s.id === currentSound);\r\n\r\n    return (\r\n        <div className=\"relative\">\r\n            {/* Minimized / Trigger */}\r\n            <button\r\n                onClick={() => setIsExpanded(!isExpanded)}\r\n                className={cn(\r\n                    \"flex items-center gap-2 px-3 py-2 rounded-xl transition-all border\",\r\n                    isPlaying\r\n                        ? \"bg-indigo-500/20 text-indigo-300 border-indigo-500/30 shadow-[0_0_15px_rgba(99,102,241,0.2)]\"\r\n                        : \"bg-slate-800/50 text-slate-400 border-white/5 hover:bg-white/10\"\r\n                )}\r\n            >\r\n                {isPlaying ? <Volume2 className=\"w-4 h-4\" /> : <VolumeX className=\"w-4 h-4\" />}\r\n                <span className=\"text-xs font-bold uppercase tracking-wider hidden md:inline\">\r\n                    {isPlaying ? activeSound?.label : \"Sons\"}\r\n                </span>\r\n            </button>\r\n\r\n            {/* Expanded Menu */}\r\n            <AnimatePresence>\r\n                {isExpanded && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                        exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                        className=\"absolute bottom-full right-0 mb-3 w-64 bg-slate-950/90 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-2xl p-4 z-50 ring-1 ring-white/5\"\r\n                    >\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                            <h4 className=\"text-xs font-bold text-slate-400 uppercase tracking-widest\">Ambiente</h4>\r\n                            {isPlaying && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <span className=\"w-0.5 h-2 bg-indigo-500 animate-[bounce_1s_infinite]\" />\r\n                                    <span className=\"w-0.5 h-3 bg-indigo-500 animate-[bounce_1.2s_infinite]\" />\r\n                                    <span className=\"w-0.5 h-2 bg-indigo-500 animate-[bounce_0.8s_infinite]\" />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2 mb-4\">\r\n                            {SOUNDS.map(sound => (\r\n                                <button\r\n                                    key={sound.id}\r\n                                    onClick={() => toggleSound(sound.id)}\r\n                                    className={cn(\r\n                                        \"w-full flex items-center justify-between p-2 rounded-xl transition-all border\",\r\n                                        currentSound === sound.id && isPlaying\r\n                                            ? \"bg-indigo-600/20 border-indigo-500/30 shadow-inner\"\r\n                                            : \"bg-white/5 border-transparent hover:bg-white/10\"\r\n                                    )}\r\n                                >\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <div className={cn(\"p-1.5 rounded-lg\", currentSound === sound.id && isPlaying ? \"bg-indigo-500 text-white\" : \"bg-slate-800 text-slate-400\")}>\r\n                                            <sound.icon className=\"w-4 h-4\" />\r\n                                        </div>\r\n                                        <span className={cn(\"text-xs font-bold\", currentSound === sound.id && isPlaying ? \"text-indigo-200\" : \"text-slate-300\")}>\r\n                                            {sound.label}\r\n                                        </span>\r\n                                    </div>\r\n                                    {currentSound === sound.id && isPlaying && <Play className=\"w-3 h-3 text-indigo-400 fill-current\" />}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n\r\n                        {/* Volume Slider */}\r\n                        <div className=\"flex items-center gap-3 px-1\">\r\n                            <Volume2 className=\"w-3 h-3 text-slate-500\" />\r\n                            <input\r\n                                type=\"range\"\r\n                                min=\"0\"\r\n                                max=\"1\"\r\n                                step=\"0.01\"\r\n                                value={volume}\r\n                                onChange={handleVolumeChange}\r\n                                className=\"w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-indigo-500 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:shadow-[0_0_8px_rgba(99,102,241,0.5)]\"\r\n                            />\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\pomodoro\\PomodoroWidget.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useRef' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isMinimized' is assigned a value but never used.","line":64,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isDragging' is assigned a value but never used.","line":65,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setIsDragging' is assigned a value but never used.","line":65,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":37},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\pomodoro\\PomodoroWidget.tsx:82:13\n  80 |         // Only show validate if we have an active focus AND timer is finished AND we were in focus mode\n  81 |         if (timeLeft === 0 && mode === 'focus' && activeFocus) {\n> 82 |             setShowValidate(true);\n     |             ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  83 |             setValidationStep('validate'); // Start at validation step\n  84 |             setIsMinimized(false); // Force open\n  85 |         } else if (timeLeft !== 0) {","line":82,"column":13,"nodeType":null,"endLine":82,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":231,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11108,11111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11108,11111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useRef, useEffect, useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { useAudio } from '../../context/AudioContext'; // Added\r\nimport { useConfirm } from '../../context/ConfirmContext';\r\nimport { Play, Pause, SkipForward, RefreshCw, Timer, X, Volume2, CloudRain, Zap, Waves, CheckCircle2 } from 'lucide-react'; // Added icons\r\nimport { cn } from '../../lib/utils';\r\n\r\nexport const PomodoroWidget = () => {\r\n    const {\r\n        mode,\r\n        timeLeft,\r\n        isActive,\r\n        cycles,\r\n        linkedItemId,\r\n        toggleTimer,\r\n        resetTimer,\r\n        skipTimer,\r\n        isWidgetVisible,\r\n        closeWidget,\r\n        settings\r\n    } = usePomodoroContext();\r\n\r\n    const { endFocus, activeFocus, completeReview, toggleTask, toggleGoal, toggleGoalItem } = useStudy();\r\n    const { isPlaying: isAudioPlaying, togglePlay: toggleAudio, volume, setVolume, currentSound, setSound } = useAudio();\r\n    const { confirm: confirmAction } = useConfirm();\r\n\r\n    const handleClose = async () => {\r\n        if (linkedItemId || activeFocus) {\r\n            const confirmed = await confirmAction({ message: 'Deseja cancelar o foco atual?', isDangerous: true });\r\n            if (!confirmed) {\r\n                return;\r\n            }\r\n            endFocus(false);\r\n            resetTimer();\r\n        }\r\n        closeWidget();\r\n    };\r\n\r\n    const formatTime = (seconds: number) => {\r\n        const m = Math.floor(seconds / 60);\r\n        const s = seconds % 60;\r\n        return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    const getModeLabel = () => {\r\n        switch (mode) {\r\n            case 'focus': return 'Foco';\r\n            case 'shortBreak': return 'Pausa Curta';\r\n            case 'longBreak': return 'Pausa Longa';\r\n        }\r\n    };\r\n\r\n    const getModeColor = () => {\r\n        switch (mode) {\r\n            case 'focus': return 'from-rose-500 to-red-600 border-rose-500/20 shadow-rose-900/20';\r\n            case 'shortBreak': return 'from-emerald-500 to-green-600 border-emerald-500/20 shadow-emerald-900/20';\r\n            case 'longBreak': return 'from-blue-500 to-indigo-600 border-blue-500/20 shadow-blue-900/20';\r\n        }\r\n    };\r\n\r\n    // State for minimizing\r\n    const [isMinimized, setIsMinimized] = useState(true);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [showValidate, setShowValidate] = useState(false);\r\n    const [validationStep, setValidationStep] = useState<'validate' | 'summary'>('validate'); // New step state\r\n    const [showSoundPanel, setShowSoundPanel] = useState(false);\r\n    const [summaryText, setSummaryText] = useState('');\r\n\r\n    const getModeDuration = () => {\r\n        if (mode === 'focus') return settings.focusDuration * 60;\r\n        if (mode === 'shortBreak') return settings.shortBreakDuration * 60;\r\n        return settings.longBreakDuration * 60;\r\n    };\r\n    const circleProgress = (timeLeft / getModeDuration()) * 100;\r\n\r\n    // Effect: Detect Focus End for Validation\r\n    useEffect(() => {\r\n        // Only show validate if we have an active focus AND timer is finished AND we were in focus mode\r\n        if (timeLeft === 0 && mode === 'focus' && activeFocus) {\r\n            setShowValidate(true);\r\n            setValidationStep('validate'); // Start at validation step\r\n            setIsMinimized(false); // Force open\r\n        } else if (timeLeft !== 0) {\r\n            // Clear validation state if timer is not 0 (e.g. reset)\r\n            setShowValidate(false);\r\n            setSummaryText('');\r\n        }\r\n    }, [timeLeft, mode, activeFocus]);\r\n\r\n    const handleConfirmValidation = () => {\r\n        setValidationStep('summary');\r\n    };\r\n\r\n    const handleFinalizeSession = async () => {\r\n        if (!activeFocus) return;\r\n\r\n        try {\r\n            // Identify if something was written (passed to completion functions)\r\n            if (activeFocus.type === 'subtheme') {\r\n                if (activeFocus.reviewNumber !== undefined) {\r\n                    await completeReview(activeFocus.id, activeFocus.reviewNumber, activeFocus.reviewType || 'review', 'medium', summaryText);\r\n                }\r\n            } else if (activeFocus.type === 'task') {\r\n                toggleTask(activeFocus.id, undefined, summaryText);\r\n            } else if (activeFocus.type === 'goal') {\r\n                if (activeFocus.parentId) {\r\n                    toggleGoalItem(activeFocus.parentId, activeFocus.id, undefined, summaryText);\r\n                } else {\r\n                    toggleGoal(activeFocus.id, undefined, summaryText);\r\n                }\r\n            }\r\n\r\n            // Cleanup: No new pomodoro should appear\r\n            setShowValidate(false);\r\n            endFocus(true, summaryText); // StudyContext cleanup\r\n            resetTimer();   // Reset time to default\r\n            closeWidget();  // Close widget entirely\r\n\r\n            // Reset local states\r\n            setSummaryText('');\r\n            setValidationStep('validate');\r\n        } catch (error) {\r\n            console.error(\"Failed to validate:\", error);\r\n        }\r\n    };\r\n\r\n    if (!isWidgetVisible) return null;\r\n\r\n    return (\r\n        <>\r\n            {/* Focus Mode Overlay - Always when widget is visible (Expanded) */}\r\n            {isWidgetVisible && (\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-[9990]\"\r\n                    onClick={handleClose}\r\n                />\r\n            )}\r\n\r\n            <div className=\"fixed inset-0 z-[9999] pointer-events-none flex items-center justify-center\">\r\n                <motion.div\r\n                    layout\r\n                    initial={{ scale: 0.9, opacity: 0 }}\r\n                    animate={{ scale: 1, opacity: 1 }}\r\n                    exit={{ scale: 0.9, opacity: 0 }}\r\n                    className={cn(\r\n                        \"pointer-events-auto relative flex flex-col items-center\",\r\n                        \"w-[90vw] max-w-sm md:w-96 rounded-[2.5rem] p-6 md:p-8 shadow-2xl backdrop-blur-2xl border cursor-default overflow-hidden transition-colors duration-500\",\r\n                        // Always extended view styles\r\n                        \"bg-slate-900/95 border-white/5\",\r\n                        \"text-white\",\r\n                        getModeColor().replace('from-', 'border-')\r\n                    )}\r\n                    style={{\r\n                        boxShadow: mode === 'focus' ? '0 0 100px -10px rgba(244, 63, 94, 0.4)' :\r\n                            mode === 'shortBreak' ? '0 10px 40px -10px rgba(16, 185, 129, 0.2)' :\r\n                                '0 10px 40px -10px rgba(59, 130, 246, 0.2)'\r\n                    }}\r\n                >\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between w-full mb-8 mt-2\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <div className={cn(\r\n                                \"p-2 rounded-xl bg-white/5\",\r\n                                mode === 'focus' ? 'text-rose-400' :\r\n                                    mode === 'shortBreak' ? 'text-emerald-400' : 'text-blue-400'\r\n                            )}>\r\n                                <Timer className=\"w-4 h-4\" />\r\n                            </div>\r\n                            <span className=\"text-xs font-black uppercase tracking-[0.2em] select-none text-slate-400\">\r\n                                {getModeLabel()}\r\n                            </span>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-2\">\r\n                            <button\r\n                                onClick={() => setShowSoundPanel(!showSoundPanel)}\r\n                                className={cn(\r\n                                    \"p-2 transition-all rounded-xl hover:bg-white/5\",\r\n                                    isAudioPlaying ? \"text-blue-400 bg-blue-500/10\" : \"text-slate-500 hover:text-white\"\r\n                                )}\r\n                                title=\"Sons de Foco\"\r\n                            >\r\n                                <Volume2 className=\"w-5 h-5\" />\r\n                            </button>\r\n                            <button\r\n                                onClick={handleClose}\r\n                                className=\"p-2 text-slate-500 hover:text-white transition-all rounded-xl hover:bg-white/5\"\r\n                                title=\"Minimizar (Fechar Widget)\"\r\n                            >\r\n                                <X className=\"w-5 h-5\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Check if Sound Panel is open */}\r\n                    {showSoundPanel ? (\r\n                        <div className=\"w-full h-56 mb-10 overflow-hidden flex flex-col gap-4\">\r\n                            {/* ... Sound Panel Content ... */}\r\n                            <div className=\"flex items-center justify-between px-2\">\r\n                                <span className=\"text-sm font-bold text-slate-400 uppercase tracking-wider\">Ambiente</span>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Volume2 className=\"w-4 h-4 text-slate-500\" />\r\n                                    <input\r\n                                        type=\"range\"\r\n                                        min=\"0\" max=\"1\" step=\"0.05\"\r\n                                        value={volume}\r\n                                        onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                                        className=\"w-24 accent-blue-500 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-3 mt-2\">\r\n                                {[\r\n                                    { id: 'white', label: 'Rudo Branco', icon: Zap },\r\n                                    { id: 'pink', label: 'Rudo Rosa', icon: Waves },\r\n                                    { id: 'brown', label: 'Rudo Marrom', icon: Volume2 },\r\n                                    { id: 'rain', label: 'Chuva', icon: CloudRain },\r\n                                ].map((sound) => (\r\n                                    <button\r\n                                        key={sound.id}\r\n                                        onClick={() => {\r\n                                            if (currentSound === sound.id && isAudioPlaying) {\r\n                                                toggleAudio();\r\n                                            } else {\r\n                                                setSound(sound.id as any);\r\n                                                if (!isAudioPlaying) toggleAudio();\r\n                                            }\r\n                                        }}\r\n                                        className={cn(\r\n                                            \"flex flex-col items-center justify-center p-4 rounded-2xl border transition-all duration-300\",\r\n                                            currentSound === sound.id && isAudioPlaying\r\n                                                ? \"bg-blue-500/20 border-blue-500/50 text-white\"\r\n                                                : \"bg-slate-800/50 border-white/5 text-slate-400 hover:bg-white/5 hover:text-slate-200\"\r\n                                        )}\r\n                                    >\r\n                                        <sound.icon className={cn(\"w-6 h-6 mb-2\", currentSound === sound.id && isAudioPlaying && \"animate-pulse\")} />\r\n                                        <span className=\"text-xs font-bold\">{sound.label}</span>\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : showValidate ? (\r\n                        validationStep === 'validate' ? (\r\n                            /* Step 1: Validation Button Only */\r\n                            <div className=\"w-full h-auto min-h-[14rem] mb-6 flex flex-col items-center justify-center animate-in fade-in zoom-in-95 duration-300\">\r\n                                <div className=\"text-center mb-8\">\r\n                                    <div className=\"w-20 h-20 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce\">\r\n                                        <CheckCircle2 className=\"w-10 h-10 text-emerald-500\" />\r\n                                    </div>\r\n                                    <h3 className=\"text-2xl font-bold text-white mb-2\">Foco Finalizado!</h3>\r\n                                    <p className=\"text-slate-400\">Excelente trabalho. Vamos registrar?</p>\r\n                                </div>\r\n\r\n                                <button\r\n                                    onClick={handleConfirmValidation}\r\n                                    className=\"w-full py-4 bg-emerald-500 hover:bg-emerald-600 active:bg-emerald-700 text-white font-bold rounded-2xl transition-all shadow-lg shadow-emerald-500/20 flex items-center justify-center gap-2 group\"\r\n                                >\r\n                                    <span>Validar Sesso</span>\r\n                                    <CheckCircle2 className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n                                </button>\r\n                            </div>\r\n                        ) : (\r\n                            /* Step 2: Summary Input */\r\n                            <div className=\"w-full h-auto min-h-[14rem] mb-6 flex flex-col animate-in fade-in slide-in-from-right-4 duration-300\">\r\n                                <div className=\"text-center mb-4\">\r\n                                    <h3 className=\"text-xl font-bold text-white mb-1\">Resumo da Sesso </h3>\r\n                                    <p className=\"text-sm text-slate-400\">O que voc aprendeu ou realizou?</p>\r\n                                </div>\r\n\r\n                                <textarea\r\n                                    value={summaryText}\r\n                                    onChange={(e) => setSummaryText(e.target.value)}\r\n                                    placeholder=\"Escreva aqui seu resumo...\"\r\n                                    className=\"w-full flex-1 bg-slate-800/50 border border-slate-700/50 rounded-xl p-4 text-sm text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 resize-none mb-4\"\r\n                                    autoFocus\r\n                                />\r\n\r\n                                <button\r\n                                    onClick={handleFinalizeSession}\r\n                                    className=\"w-full py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold rounded-xl transition-colors shadow-lg shadow-blue-500/20 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <CheckCircle2 className=\"w-5 h-5\" />\r\n                                    <span>Salvar & Concluir</span>\r\n                                </button>\r\n                            </div>\r\n                        )\r\n                    ) : (\r\n                        /* Progress Circle Large */\r\n                        <div\r\n                            onClick={toggleTimer}\r\n                            className=\"relative w-56 h-56 mx-auto mb-10 flex items-center justify-center cursor-pointer group hover:scale-105 transition-transform\"\r\n                        >\r\n                            <svg className=\"absolute inset-0 w-full h-full -rotate-90\">\r\n                                <circle\r\n                                    cx=\"112\" cy=\"112\" r=\"100\"\r\n                                    className=\"fill-none stroke-slate-800/50\"\r\n                                    strokeWidth=\"8\"\r\n                                />\r\n                                <motion.circle\r\n                                    cx=\"112\" cy=\"112\" r=\"100\"\r\n                                    className={cn(\r\n                                        \"fill-none stroke-current\",\r\n                                        mode === 'focus' ? \"text-rose-500\" :\r\n                                            mode === 'shortBreak' ? \"text-emerald-500\" : \"text-blue-500\"\r\n                                    )}\r\n                                    strokeWidth=\"8\"\r\n                                    strokeDasharray=\"628\" // 2 * PI * 100\r\n                                    animate={{ strokeDashoffset: 628 - (628 * (1 - circleProgress / 100)) }}\r\n                                    strokeLinecap=\"round\"\r\n                                    transition={{ duration: 1, ease: \"linear\" }}\r\n                                />\r\n                            </svg>\r\n\r\n                            <div className=\"text-center z-10 select-none\">\r\n                                <div className={cn(\r\n                                    \"text-6xl font-mono font-black tracking-tighter tabular-nums\",\r\n                                    mode === 'focus' ? 'text-white' :\r\n                                        mode === 'shortBreak' ? 'text-emerald-500' : 'text-blue-500'\r\n                                )}>\r\n                                    {formatTime(timeLeft)}\r\n                                </div>\r\n                                <div className=\"flex justify-center gap-1.5 mt-6\">\r\n                                    {[...Array(4)].map((_, i) => (\r\n                                        <div\r\n                                            key={i}\r\n                                            className={cn(\r\n                                                \"w-2 h-2 rounded-full transition-colors\",\r\n                                                i < (cycles % 4) ? \"bg-blue-400\" : \"bg-slate-700\"\r\n                                            )}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Controls */}\r\n                    {!showValidate && (\r\n                        <div className=\"flex flex-col gap-4 mb-4\">\r\n                            <div className=\"flex items-center justify-center gap-6\">\r\n                                <button\r\n                                    onClick={resetTimer}\r\n                                    className=\"p-4 rounded-2xl hover:bg-white/5 text-slate-400 hover:text-white transition-all active:scale-90\"\r\n                                >\r\n                                    <RefreshCw className=\"w-6 h-6\" />\r\n                                </button>\r\n\r\n                                <button\r\n                                    onClick={toggleTimer}\r\n                                    className={cn(\r\n                                        \"w-20 h-20 flex items-center justify-center rounded-[2rem] shadow-2xl transition-all active:scale-95 text-white\",\r\n                                        \"bg-gradient-to-br\",\r\n                                        mode === 'focus' ? \"from-rose-500 to-rose-600 shadow-rose-500/30\" :\r\n                                            mode === 'shortBreak' ? \"from-emerald-500 to-emerald-600 shadow-emerald-500/30\" :\r\n                                                \"from-blue-500 to-blue-600 shadow-blue-500/30\"\r\n                                    )}\r\n                                >\r\n                                    {isActive ? <Pause className=\"w-8 h-8 fill-white\" /> : <Play className=\"w-8 h-8 fill-white ml-2\" />}\r\n                                </button>\r\n\r\n                                <button\r\n                                    onClick={skipTimer}\r\n                                    className=\"p-4 rounded-2xl hover:bg-white/5 text-slate-400 hover:text-white transition-all active:scale-90\"\r\n                                >\r\n                                    <SkipForward className=\"w-6 h-6\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </motion.div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\settings\\Settings.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\settings\\Settings.tsx:29:36\n  27 |\n  28 |     useEffect(() => {\n> 29 |         if (profile?.display_name) setDisplayName(profile.display_name);\n     |                                    ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  30 |         if (profile?.avatar_url) setAvatarUrl(profile.avatar_url);\n  31 |         if (settings) {\n  32 |             setFocusDuration(settings.focusDuration);","line":29,"column":36,"nodeType":null,"endLine":29,"endColumn":50}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { usePomodoroContext } from '../../context/PomodoroContext';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { User, Timer, Save, Trash2, ShieldAlert, RefreshCw } from 'lucide-react';\r\nimport { Card } from '../../components/ui/Card';\r\nimport { ConfirmationModal } from '../../components/ui/ConfirmationModal';\r\n\r\nimport { ImageUpload } from '../../components/forms/ImageUpload';\r\n\r\nexport const Settings = () => {\r\n    const { user, profile, updateProfile } = useAuth();\r\n    const { settings, updateSettings } = usePomodoroContext();\r\n    const { resetAccount, resetGamification, themes, tasks, goals, gamification: studyGamification, zenMode } = useStudy();\r\n\r\n    // Local state for form inputs\r\n    const [displayName, setDisplayName] = useState('');\r\n    const [avatarUrl, setAvatarUrl] = useState('');\r\n    const [focusDuration, setFocusDuration] = useState(25);\r\n    const [shortBreak, setShortBreak] = useState(5);\r\n    const [longBreak, setLongBreak] = useState(15);\r\n    const [strictMode, setStrictMode] = useState(false);\r\n    const [isSaved, setIsSaved] = useState(false);\r\n    const [isDangerModalOpen, setIsDangerModalOpen] = useState(false);\r\n    const [isResetGamificationModalOpen, setIsResetGamificationModalOpen] = useState(false);\r\n\r\n\r\n    useEffect(() => {\r\n        if (profile?.display_name) setDisplayName(profile.display_name);\r\n        if (profile?.avatar_url) setAvatarUrl(profile.avatar_url);\r\n        if (settings) {\r\n            setFocusDuration(settings.focusDuration);\r\n            setShortBreak(settings.shortBreakDuration);\r\n            setLongBreak(settings.longBreakDuration);\r\n            setStrictMode(settings.strictMode || false);\r\n        }\r\n    }, [profile, settings]);\r\n\r\n    const handleSaveProfile = async () => {\r\n        await updateProfile({\r\n            display_name: displayName,\r\n            avatar_url: avatarUrl\r\n        });\r\n        setIsSaved(true);\r\n        setTimeout(() => setIsSaved(false), 2000);\r\n    };\r\n\r\n    const handleSaveTimer = () => {\r\n        updateSettings({\r\n            focusDuration,\r\n            shortBreakDuration: shortBreak,\r\n            longBreakDuration: longBreak,\r\n            strictMode\r\n        });\r\n        setIsSaved(true);\r\n        setTimeout(() => setIsSaved(false), 2000);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 max-w-4xl mx-auto pb-20 fade-in\">\r\n            <header className=\"mb-8\">\r\n                <h1 className=\"text-3xl font-black text-white tracking-tight\">Configuraes</h1>\r\n                <p className=\"text-slate-400 mt-1\">Personalize sua experincia de estudos.</p>\r\n            </header>\r\n\r\n            {/* Profile Section */}\r\n            <section className=\"space-y-4\">\r\n                <h2 className=\"text-lg font-bold text-slate-200 flex items-center gap-2\">\r\n                    <User className=\"w-5 h-5 text-blue-400\" />\r\n                    Perfil\r\n                </h2>\r\n                <Card className=\"bg-slate-900/50 border-slate-800\">\r\n                    <div className=\"flex flex-col md:flex-row gap-8 items-start\">\r\n                        {/* 1. Avatar Column */}\r\n                        <div className=\"flex flex-col items-center gap-3 shrink-0 mx-auto md:mx-0\">\r\n                            <div className=\"relative group\">\r\n                                <div className=\"w-24 h-24 rounded-full overflow-hidden border-2 border-slate-700 shadow-xl bg-slate-800\">\r\n                                    {profile?.avatar_url || avatarUrl ? (\r\n                                        <img\r\n                                            src={avatarUrl || profile?.avatar_url}\r\n                                            alt=\"Profile\"\r\n                                            className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\r\n                                        />\r\n                                    ) : (\r\n                                        <div className=\"w-full h-full flex items-center justify-center text-3xl font-bold text-slate-500\">\r\n                                            {displayName ? displayName[0].toUpperCase() : user?.email?.[0].toUpperCase()}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                {/* Overlay for Upload */}\r\n                                <div className=\"absolute inset-0 rounded-full bg-black/60 opacity-0 group-hover:opacity-100 transition-all flex items-center justify-center backdrop-blur-sm cursor-pointer border-2 border-white/20\">\r\n                                    <ImageUpload value={avatarUrl} onChange={setAvatarUrl} />\r\n                                </div>\r\n                            </div>\r\n                            <span className=\"text-[10px] uppercase font-bold text-slate-500 tracking-wider\">Foto de Perfil</span>\r\n                        </div>\r\n\r\n                        {/* 2. Info Column */}\r\n                        <div className=\"flex-1 space-y-5 w-full\">\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                                <div className=\"space-y-1.5\">\r\n                                    <label className=\"text-xs font-bold text-slate-500 uppercase flex items-center gap-2\">\r\n                                        Nome de Exibio\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={displayName}\r\n                                        onChange={(e) => setDisplayName(e.target.value)}\r\n                                        className=\"bg-slate-950 border border-slate-700 rounded-lg px-4 py-2.5 text-white w-full focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 focus:outline-none transition-all\"\r\n                                        placeholder=\"Como voc quer ser chamado?\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"space-y-1.5 opacity-60 pointer-events-none select-none\">\r\n                                    <label className=\"text-xs font-bold text-slate-500 uppercase flex items-center gap-2\">\r\n                                        Email (No editvel)\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={user?.email}\r\n                                        readOnly\r\n                                        className=\"bg-slate-900/50 border border-slate-800 rounded-lg px-4 py-2.5 text-slate-400 w-full cursor-not-allowed\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-end pt-2\">\r\n                                <button\r\n                                    onClick={handleSaveProfile}\r\n                                    disabled={!displayName.trim()}\r\n                                    className=\"bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-2.5 rounded-lg font-bold text-sm transition-all flex items-center gap-2 shadow-lg shadow-blue-500/20 active:translate-y-0.5\"\r\n                                >\r\n                                    <Save className=\"w-4 h-4\" />\r\n                                    Salvar Alteraes\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            </section>\r\n\r\n            {/* Timer Section */}\r\n            <section className=\"space-y-4\">\r\n                <h2 className=\"text-lg font-bold text-slate-200 flex items-center gap-2\">\r\n                    <Timer className=\"w-5 h-5 text-amber-400\" />\r\n                    Foco & Pomodoro\r\n                </h2>\r\n                <Card className=\"bg-slate-900/50 border-slate-800\">\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-slate-500 uppercase block mb-2\">Foco (min)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={focusDuration}\r\n                                onChange={(e) => setFocusDuration(Number(e.target.value))}\r\n                                className=\"bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white w-full font-mono text-lg focus:border-amber-500 focus:outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-slate-500 uppercase block mb-2\">Pausa Curta (min)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={shortBreak}\r\n                                onChange={(e) => setShortBreak(Number(e.target.value))}\r\n                                className=\"bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white w-full font-mono text-lg focus:border-amber-500 focus:outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-slate-500 uppercase block mb-2\">Pausa Longa (min)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={longBreak}\r\n                                onChange={(e) => setLongBreak(Number(e.target.value))}\r\n                                className=\"bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-white w-full font-mono text-lg focus:border-amber-500 focus:outline-none\"\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"text-xs font-bold text-slate-500 uppercase block mb-2\">Modo Strict</label>\r\n                            <div className=\"flex items-center gap-3 mt-2\">\r\n                                <button\r\n                                    onClick={() => setStrictMode(!strictMode)}\r\n                                    className={`w-12 h-6 rounded-full p-1 transition-colors ${strictMode ? 'bg-amber-600' : 'bg-slate-700'}`}\r\n                                >\r\n                                    <div className={`w-4 h-4 bg-white rounded-full transition-transform ${strictMode ? 'translate-x-6' : 'translate-x-0'}`} />\r\n                                </button>\r\n                                <span className=\"text-xs text-slate-400\">\r\n                                    {strictMode ? 'Ativado (Esconde Menu)' : 'Desativado'}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"mt-6 flex justify-end\">\r\n                        <button\r\n                            onClick={handleSaveTimer}\r\n                            className=\"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold transition-all flex items-center gap-2\"\r\n                        >\r\n                            <Save className=\"w-4 h-4\" />\r\n                            Atualizar Timer\r\n                        </button>\r\n                    </div>\r\n                </Card>\r\n            </section>\r\n\r\n            {/* Data Management Section */}\r\n            <section className=\"space-y-4\">\r\n                <h2 className=\"text-lg font-bold text-slate-200 flex items-center gap-2\">\r\n                    <Save className=\"w-5 h-5 text-emerald-400\" />\r\n                    Dados e Backup\r\n                </h2>\r\n                <Card className=\"bg-slate-900/50 border-slate-800\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <h3 className=\"font-bold text-slate-200\">Exportar Dados (JSON)</h3>\r\n                            <p className=\"text-xs text-slate-500 mt-1\">Baixe uma cpia completa dos seus temas, tarefas e progresso.</p>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => {\r\n                                const data = {\r\n                                    timestamp: new Date().toISOString(),\r\n                                    profile,\r\n                                    settings,\r\n                                    // Use Live Context Data (Source of Truth)\r\n                                    themes,\r\n                                    tasks,\r\n                                    goals,\r\n                                    gamification: studyGamification,\r\n                                    zenMode\r\n                                };\r\n\r\n                                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n                                const url = URL.createObjectURL(blob);\r\n                                const a = document.createElement('a');\r\n                                a.href = url;\r\n                                a.download = `study-panel-backup-${new Date().toISOString().split('T')[0]}.json`;\r\n                                document.body.appendChild(a);\r\n                                a.click();\r\n                                document.body.removeChild(a);\r\n                                URL.revokeObjectURL(url);\r\n                            }}\r\n                            className=\"bg-emerald-950 hover:bg-emerald-900 text-emerald-400 border border-emerald-800 px-4 py-2 rounded-lg font-bold text-sm transition-all flex items-center gap-2\"\r\n                        >\r\n                            <Save className=\"w-4 h-4\" />\r\n                            Baixar Backup\r\n                        </button>\r\n                    </div>\r\n                </Card>\r\n            </section>\r\n\r\n            {/* Danger Zone */}\r\n            <section className=\"space-y-4 opacity-80 hover:opacity-100 transition-opacity\">\r\n                <h2 className=\"text-lg font-bold text-red-400 flex items-center gap-2\">\r\n                    <ShieldAlert className=\"w-5 h-5\" />\r\n                    Zona de Perigo\r\n                </h2>\r\n                <Card className=\"bg-red-950/10 border-red-900/30 border-dashed\">\r\n                    <div className=\"flex flex-col gap-6\">\r\n                        {/* Reset Gamification */}\r\n                        <div className=\"flex items-center justify-between pb-6 border-b border-red-900/30\">\r\n                            <div>\r\n                                <h3 className=\"font-bold text-red-200\">Resetar Gamificao</h3>\r\n                                <p className=\"text-xs text-red-300/60 mt-1\">\r\n                                    Zera seu Nvel, XP e Conquistas, mas <span className=\"text-red-300 font-bold\">MANTM</span> seus temas e tarefas.\r\n                                </p>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setIsResetGamificationModalOpen(true)}\r\n                                className=\"bg-red-950 hover:bg-red-900 text-red-400 border border-red-800 px-4 py-2 rounded-lg font-bold text-sm transition-all flex items-center gap-2\"\r\n                            >\r\n                                <RefreshCw className=\"w-4 h-4\" />\r\n                                Resetar XP\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Reset All */}\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <h3 className=\"font-bold text-red-200\">Zerar Tudo (Comear do Zero)</h3>\r\n                                <p className=\"text-xs text-red-300/60 mt-1\">\r\n                                    Apaga permanentemente: <span className=\"font-bold text-red-400\">Metas, Calendrio e Tarefas</span>.\r\n                                </p>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => setIsDangerModalOpen(true)}\r\n                                className=\"bg-red-950 hover:bg-red-900 text-red-400 border border-red-800 px-4 py-2 rounded-lg font-bold text-sm transition-all flex items-center gap-2\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                                Zerar Tudo\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            </section>\r\n\r\n            {isSaved && (\r\n                <div className=\"fixed bottom-8 right-8 bg-emerald-500 text-white px-6 py-3 rounded-xl shadow-lg shadow-emerald-500/20 font-bold animate-in slide-in-from-bottom-5 fade-in\">\r\n                    Alteraes salvas!\r\n                </div>\r\n            )}\r\n\r\n            <ConfirmationModal\r\n                isOpen={isDangerModalOpen}\r\n                onClose={() => setIsDangerModalOpen(false)}\r\n                onConfirm={() => {\r\n                    resetAccount();\r\n                    setIsDangerModalOpen(false);\r\n                }}\r\n                title=\"Zerar Tudo?\"\r\n                description=\"Voc est prestes a apagar TODAS as suas Metas, Itens do Calendrio e Tarefas. Esta ao  irreversvel. Tem certeza que deseja recomear do zero?\"\r\n                confirmText=\"Sim, Zerar Tudo\"\r\n                type=\"danger\"\r\n            />\r\n\r\n            <ConfirmationModal\r\n                isOpen={isResetGamificationModalOpen}\r\n                onClose={() => setIsResetGamificationModalOpen(false)}\r\n                onConfirm={async () => {\r\n                    await resetGamification();\r\n                    setIsResetGamificationModalOpen(false);\r\n                }}\r\n                title=\"Resetar Apenas Gamificao?\"\r\n                description=\"Voc voltar para o Nvel 1 com 0 XP. Suas conquistas sero bloqueadas novamente. Seus temas e tarefas NO sero apagados.\"\r\n                confirmText=\"Sim, Zerar meu XP\"\r\n                type=\"danger\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\study\\StudySession.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[627,630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[627,630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\study\\StudySession.tsx:39:13\n  37 |\n  38 |         if (found) {\n> 39 |             setSubtheme(found);\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  40 |             setThemeColor(color);\n  41 |         }\n  42 |     }, [subthemeId, themes]);","line":39,"column":13,"nodeType":null,"endLine":39,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'grade' is defined but never used.","line":48,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":37}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Flashcard } from './components/Flashcard';\r\nimport { StudyControls } from './components/StudyControls';\r\nimport { ArrowLeft, Loader2, Award } from 'lucide-react';\r\n\r\ninterface StudySessionProps {\r\n    subthemeId: string;\r\n    onExit: () => void;\r\n}\r\n\r\nexport const StudySession: React.FC<StudySessionProps> = ({ subthemeId, onExit }) => {\r\n    const { themes, completeReview } = useStudy();\r\n\r\n    // State\r\n    const [isFlipped, setIsFlipped] = useState(false);\r\n    const [subtheme, setSubtheme] = useState<any>(null);\r\n    const [themeColor, setThemeColor] = useState('#3b82f6');\r\n    const [isCompleted, setIsCompleted] = useState(false);\r\n\r\n    // Load Subtheme\r\n    useEffect(() => {\r\n        if (!subthemeId || themes.length === 0) return;\r\n\r\n        // Find subs in themes\r\n        let found = null;\r\n        let color = '#3b82f6';\r\n\r\n        for (const t of themes) {\r\n            const s = t.subthemes.find(sub => sub.id === subthemeId);\r\n            if (s) {\r\n                found = s;\r\n                color = t.color || '#3b82f6';\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (found) {\r\n            setSubtheme(found);\r\n            setThemeColor(color);\r\n        }\r\n    }, [subthemeId, themes]);\r\n\r\n    const handleFlip = () => {\r\n        setIsFlipped(!isFlipped);\r\n    };\r\n\r\n    const handleGrade = async (grade: 'bad' | 'hard' | 'good' | 'easy') => {\r\n        if (!subtheme) return;\r\n\r\n        // In future: pass grade to algorithm\r\n        await completeReview(subtheme.id, subtheme.reviews, 'review');\r\n\r\n        setIsCompleted(true);\r\n        // Delay to exit\r\n        setTimeout(() => {\r\n            onExit();\r\n        }, 1500);\r\n    };\r\n\r\n    if (!subtheme) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen bg-slate-950\">\r\n                <Loader2 className=\"w-8 h-8 text-blue-500 animate-spin\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (isCompleted) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center h-screen bg-slate-950 animate-in fade-in duration-500 relative z-50\">\r\n                <div className=\"w-24 h-24 bg-emerald-500/20 rounded-full flex items-center justify-center mb-6 ring-4 ring-emerald-500/10 animate-bounce\">\r\n                    <Award className=\"w-12 h-12 text-emerald-400\" />\r\n                </div>\r\n                <h2 className=\"text-3xl font-bold text-white mb-2\">Excelente!</h2>\r\n                <p className=\"text-slate-400\">Reviso concluda com sucesso.</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] flex flex-col h-screen bg-slate-950 relative overflow-hidden animate-in zoom-in-95 duration-300\">\r\n            {/* Zen Background */}\r\n            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 mix-blend-overlay pointer-events-none\" />\r\n            <div\r\n                className=\"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] blur-[120px] opacity-20 pointer-events-none transition-colors duration-1000\"\r\n                style={{ backgroundColor: themeColor }}\r\n            />\r\n\r\n            {/* Header */}\r\n            <header className=\"flex items-center justify-between p-6 relative z-10\">\r\n                <button\r\n                    onClick={onExit}\r\n                    className=\"p-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-xl transition-all\"\r\n                >\r\n                    <ArrowLeft className=\"w-6 h-6\" />\r\n                </button>\r\n                <div className=\"flex flex-col items-center\">\r\n                    <span className=\"text-xs font-bold text-slate-500 uppercase tracking-widest\">Reviso</span>\r\n                </div>\r\n                <div className=\"w-10\" />\r\n            </header>\r\n\r\n            {/* Main Stage */}\r\n            <main className=\"flex-1 flex flex-col items-center justify-center p-6 relative z-10 pb-20\">\r\n                <Flashcard\r\n                    frontContent={subtheme.title}\r\n                    backContent={subtheme.text_content || \"Sem descrio disponvel para estudo.\"}\r\n                    isFlipped={isFlipped}\r\n                    onFlip={handleFlip}\r\n                />\r\n            </main>\r\n\r\n            {/* Controls */}\r\n            <footer className=\"fixed bottom-0 w-full p-8 pb-12 flex justify-center bg-gradient-to-t from-slate-950 via-slate-950/90 to-transparent pointer-events-none\">\r\n                <div className=\"pointer-events-auto\">\r\n                    <StudyControls\r\n                        isVisible={isFlipped}\r\n                        onGrade={handleGrade}\r\n                    />\r\n                </div>\r\n            </footer>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\study\\components\\Flashcard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { cn } from '../../../lib/utils'; // Assuming global utils path\r\n\r\ninterface FlashcardProps {\r\n    frontContent: string;\r\n    backContent: string;\r\n    isFlipped: boolean;\r\n    onFlip: () => void;\r\n}\r\n\r\nexport const Flashcard: React.FC<FlashcardProps> = ({ frontContent, backContent, isFlipped, onFlip }) => {\r\n    return (\r\n        <div\r\n            className=\"perspective-1000 w-full max-w-2xl h-96 cursor-pointer group\"\r\n            onClick={onFlip}\r\n        >\r\n            <div className={cn(\r\n                \"relative w-full h-full transition-all duration-500 transform-style-3d\",\r\n                isFlipped ? \"rotate-y-180\" : \"\"\r\n            )}>\r\n                {/* Front */}\r\n                <div className=\"absolute w-full h-full backface-hidden\">\r\n                    <div className=\"w-full h-full bg-slate-900 border-2 border-slate-700/50 rounded-3xl flex flex-col items-center justify-center p-8 shadow-2xl hover:border-slate-600 transition-colors\">\r\n                        <span className=\"text-sm font-bold text-slate-500 uppercase tracking-[0.2em] mb-4\">Pergunta</span>\r\n                        <h2 className=\"text-3xl md:text-4xl font-bold text-center text-slate-100 leading-tight\">\r\n                            {frontContent}\r\n                        </h2>\r\n                        <span className=\"absolute bottom-8 text-xs text-slate-600 animate-pulse\">Toque para virar</span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Back */}\r\n                <div className=\"absolute w-full h-full backface-hidden rotate-y-180\">\r\n                    <div className=\"w-full h-full bg-gradient-to-br from-blue-900/40 to-slate-900 border-2 border-blue-500/30 rounded-3xl flex flex-col items-center justify-center p-8 shadow-[0_0_30px_rgba(59,130,246,0.1)]\">\r\n                        <span className=\"text-sm font-bold text-blue-400 uppercase tracking-[0.2em] mb-4\">Resposta</span>\r\n                        <div\r\n                            className=\"text-xl md:text-2xl text-center text-slate-200 leading-relaxed overflow-y-auto max-h-full custom-scrollbar prose prose-invert\"\r\n                            dangerouslySetInnerHTML={{ __html: backContent }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\study\\components\\StudyControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\summaries\\SummariesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Sparkles' is defined but never used.","line":2,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\r\nimport { FileText, Sparkles, Calendar as CalendarIcon, Filter } from 'lucide-react';\r\nimport { useStudy } from '../../context/StudyContext';\r\nimport { Timeline } from '../../components/timeline';\r\nimport type { SummaryEntry } from '../../types';\r\n\r\nexport const SummariesPage: React.FC = () => {\r\n    const { goals, themes, tasks } = useStudy();\r\n    const [filterType, setFilterType] = React.useState<SummaryEntry['type'] | 'all'>('all');\r\n    const [searchTerm, setSearchTerm] = React.useState('');\r\n\r\n    // Collect all summaries from all sources\r\n    const allSummaries = useMemo(() => {\r\n        const summaries: SummaryEntry[] = [];\r\n\r\n        // From Tasks\r\n        tasks.forEach(task => {\r\n            if (task.summaries && task.summaries.length > 0) {\r\n                summaries.push(...task.summaries);\r\n            }\r\n        });\r\n\r\n        // From Goals\r\n        goals.forEach(goal => {\r\n            if (goal.summaries && goal.summaries.length > 0) {\r\n                summaries.push(...goal.summaries);\r\n            }\r\n        });\r\n\r\n        // From Themes/Subthemes\r\n        themes.forEach(theme => {\r\n            if (theme.summaries && theme.summaries.length > 0) {\r\n                summaries.push(...theme.summaries);\r\n            }\r\n            theme.subthemes.forEach(subtheme => {\r\n                if (subtheme.summaries && subtheme.summaries.length > 0) {\r\n                    summaries.push(...subtheme.summaries);\r\n                }\r\n            });\r\n        });\r\n\r\n        // Sort by timestamp (most recent first)\r\n        return summaries.sort((a, b) =>\r\n            new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\r\n        );\r\n    }, [tasks, goals, themes]);\r\n\r\n    // Filter summaries\r\n    const filteredSummaries = useMemo(() => {\r\n        let filtered = allSummaries;\r\n\r\n        // Filter by type\r\n        if (filterType !== 'all') {\r\n            filtered = filtered.filter(s => s.type === filterType);\r\n        }\r\n\r\n        // Filter by search term\r\n        if (searchTerm.trim()) {\r\n            const term = searchTerm.toLowerCase();\r\n            filtered = filtered.filter(s =>\r\n                s.title?.toLowerCase().includes(term) ||\r\n                s.description?.toLowerCase().includes(term)\r\n            );\r\n        }\r\n\r\n        return filtered;\r\n    }, [allSummaries, filterType, searchTerm]);\r\n\r\n    // Count by type\r\n    const counts = useMemo(() => {\r\n        return {\r\n            all: allSummaries.length,\r\n            review: allSummaries.filter(s => s.type === 'review').length,\r\n            goal: allSummaries.filter(s => s.type === 'goal' || s.type === 'progress').length,\r\n            session: allSummaries.filter(s => s.type === 'session').length,\r\n            completion: allSummaries.filter(s => s.type === 'completion').length,\r\n            note: allSummaries.filter(s => s.type === 'note').length,\r\n        };\r\n    }, [allSummaries]);\r\n\r\n    const filterButtons = [\r\n        { type: 'all' as const, label: 'Todos', color: 'from-slate-500 to-slate-600', bgColor: 'bg-slate-500/10', borderColor: 'border-slate-500/30' },\r\n        { type: 'review' as const, label: 'Revises', color: 'from-purple-500 to-purple-600', bgColor: 'bg-purple-500/10', borderColor: 'border-purple-500/30' },\r\n        { type: 'goal' as const, label: 'Metas', color: 'from-blue-500 to-blue-600', bgColor: 'bg-blue-500/10', borderColor: 'border-blue-500/30' },\r\n        { type: 'session' as const, label: 'Foco', color: 'from-orange-500 to-orange-600', bgColor: 'bg-orange-500/10', borderColor: 'border-orange-500/30' },\r\n        { type: 'completion' as const, label: 'Concluses', color: 'from-green-500 to-green-600', bgColor: 'bg-green-500/10', borderColor: 'border-green-500/30' },\r\n        { type: 'note' as const, label: 'Notas', color: 'from-yellow-500 to-yellow-600', bgColor: 'bg-yellow-500/10', borderColor: 'border-yellow-500/30' },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"w-full min-h-screen relative overflow-hidden pb-12\">\r\n            {/* Animated Background */}\r\n            <div className=\"absolute inset-0 opacity-30 pointer-events-none\">\r\n                <div className=\"absolute top-0 -left-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob\" />\r\n                <div className=\"absolute top-0 -right-4 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000\" />\r\n                <div className=\"absolute -bottom-8 left-20 w-96 h-96 bg-orange-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000\" />\r\n            </div>\r\n\r\n            <div className=\"relative z-10 max-w-7xl mx-auto\">\r\n                {/* Header */}\r\n                <div className=\"mb-8\">\r\n                    <div className=\"flex items-center gap-3 mb-6\">\r\n                        <div className=\"w-12 h-12 rounded-2xl bg-gradient-to-br from-purple-500/20 to-blue-500/20 border border-purple-500/30 flex items-center justify-center backdrop-blur-xl shadow-lg shadow-purple-900/20\">\r\n                            <FileText className=\"w-6 h-6 text-purple-400 drop-shadow-[0_0_8px_rgba(168,85,247,0.5)]\" />\r\n                        </div>\r\n                        <div>\r\n                            <h1 className=\"text-3xl md:text-4xl font-bold bg-gradient-to-r from-white via-purple-200 to-blue-200 bg-clip-text text-transparent\">\r\n                                Resumos & Histrico\r\n                            </h1>\r\n                            <p className=\"text-slate-400 text-sm md:text-base\">\r\n                                Acompanhe todas as suas atividades e conquistas\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Stats */}\r\n                    <div className=\"bg-slate-800/40 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 mb-6 shadow-2xl\">\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4\">\r\n                            {filterButtons.map((btn) => {\r\n                                const count = counts[btn.type as keyof typeof counts] || 0;\r\n                                const isActive = filterType === btn.type;\r\n\r\n                                return (\r\n                                    <button\r\n                                        key={btn.type}\r\n                                        onClick={() => setFilterType(btn.type)}\r\n                                        className={`\r\n                                            relative p-4 rounded-xl border transition-all duration-300\r\n                                            ${isActive\r\n                                                ? `${btn.bgColor} ${btn.borderColor} scale-105`\r\n                                                : 'bg-slate-900/40 border-white/5 hover:bg-slate-800/60'\r\n                                            }\r\n                                        `}\r\n                                    >\r\n                                        {isActive && (\r\n                                            <div className={`absolute inset-0 bg-gradient-to-r ${btn.color} opacity-10 rounded-xl`} />\r\n                                        )}\r\n                                        <div className=\"relative\">\r\n                                            <div className={`\r\n                                                text-2xl font-bold mb-1\r\n                                                ${isActive ? 'bg-gradient-to-r ' + btn.color + ' bg-clip-text text-transparent' : 'text-slate-300'}\r\n                                            `}>\r\n                                                {count}\r\n                                            </div>\r\n                                            <div className={`text-xs font-medium ${isActive ? 'text-white' : 'text-slate-500'}`}>\r\n                                                {btn.label}\r\n                                            </div>\r\n                                        </div>\r\n                                    </button>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Search */}\r\n                    <div className=\"relative\">\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Buscar em resumos...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                            className=\"w-full bg-slate-800/40 backdrop-blur-xl border border-slate-700/50 rounded-xl py-3 px-4 pl-12 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50 transition-all\"\r\n                        />\r\n                        <Filter className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500\" />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Timeline */}\r\n                <div className=\"bg-slate-800/40 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-8 shadow-2xl\">\r\n                    <div className=\"flex items-center gap-3 mb-8\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500/20 to-blue-500/20 flex items-center justify-center\">\r\n                            <CalendarIcon className=\"w-5 h-5 text-purple-400\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-xl font-bold text-white\">Timeline de Atividades</h2>\r\n                            <p className=\"text-sm text-slate-400\">\r\n                                {filteredSummaries.length > 0\r\n                                    ? `${filteredSummaries.length} ${filteredSummaries.length === 1 ? 'evento encontrado' : 'eventos encontrados'}`\r\n                                    : 'Nenhum evento encontrado'\r\n                                }\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Timeline\r\n                        items={filteredSummaries}\r\n                        emptyMessage={searchTerm ? 'Nenhum resultado encontrado' : 'Suas atividades aparecero aqui automaticamente'}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Custom Styles */}\r\n            <style>{`\r\n                @keyframes blob {\r\n                    0%, 100% { transform: translate(0, 0) scale(1); }\r\n                    25% { transform: translate(20px, -50px) scale(1.1); }\r\n                    50% { transform: translate(-20px, 20px) scale(0.9); }\r\n                    75% { transform: translate(50px, 50px) scale(1.05); }\r\n                }\r\n                .animate-blob {\r\n                    animation: blob 7s infinite;\r\n                }\r\n                .animation-delay-2000 {\r\n                    animation-delay: 2s;\r\n                }\r\n                .animation-delay-4000 {\r\n                    animation-delay: 4s;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\tasks\\components\\TaskDetailsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ptBR' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { CheckSquare, Clock, Calendar, Trophy, PlayCircle, Activity, FileText } from 'lucide-react';\r\nimport { Modal } from '../../../components/ui/Modal';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Task } from '../../../types';\r\nimport SummaryTimeline from '../../../components/ui/SummaryTimeline';\r\nimport { usePomodoroContext } from '../../../context/PomodoroContext';\r\n\r\ninterface TaskDetailsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    task: Task | null;\r\n}\r\n\r\nexport const TaskDetailsModal: React.FC<TaskDetailsModalProps> = ({ isOpen, onClose, task }) => {\r\n    const { startFocus } = useStudy();\r\n    const { startFocusSession } = usePomodoroContext();\r\n\r\n    if (!task) return null;\r\n\r\n    const isCompleted = task.status === 'completed';\r\n    const isPeriod = task.type === 'period';\r\n    const isRecurring = task.type === 'recurring';\r\n\r\n    const colorScheme = isCompleted\r\n        ? {\r\n            text: 'text-emerald-400',\r\n            bg: 'bg-emerald-500/10',\r\n            border: 'border-emerald-500/20',\r\n            gradient: 'from-emerald-600 to-emerald-400'\r\n        }\r\n        : {\r\n            text: 'text-blue-400',\r\n            bg: 'bg-blue-500/10',\r\n            border: 'border-blue-500/20',\r\n            gradient: 'from-blue-600 to-indigo-600'\r\n        };\r\n\r\n    const handleStartFocus = () => {\r\n        const duration = task.durationMinutes || 25;\r\n        startFocus(task.id, 'task', task.title, duration);\r\n        startFocusSession(task.id, duration);\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\" maxWidth=\"2xl\">\r\n            <div className=\"relative overflow-hidden p-6 sm:p-8\">\r\n                {/* Background Decoration */}\r\n                <div className=\"absolute top-[-10%] right-[-10%] w-[300px] h-[300px] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none\" />\r\n                <div className=\"absolute bottom-[-10%] left-[-10%] w-[250px] h-[250px] bg-indigo-600/5 rounded-full blur-[80px] pointer-events-none\" />\r\n\r\n                <div className=\"relative z-10 flex flex-col gap-8\">\r\n                    {/* Header: Icon, Title, Category */}\r\n                    <div className=\"flex items-start gap-6\">\r\n                        <div className={cn(\r\n                            \"w-20 h-20 rounded-3xl flex items-center justify-center shrink-0 shadow-2xl border-2 relative overflow-hidden\",\r\n                            \"bg-gradient-to-br\",\r\n                            isCompleted ? \"from-emerald-600 to-emerald-500 border-emerald-400/50\" : \"from-blue-600 to-indigo-600 border-blue-400/50\"\r\n                        )}>\r\n                            <div className=\"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent\" />\r\n                            {task.icon ? (\r\n                                <span className=\"text-4xl drop-shadow-lg relative z-10\">{task.icon}</span>\r\n                            ) : (\r\n                                <CheckSquare className=\"w-10 h-10 text-white drop-shadow-lg relative z-10\" />\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                                <span className={cn(\r\n                                    \"px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border\",\r\n                                    colorScheme.bg, colorScheme.text, colorScheme.border\r\n                                )}>\r\n                                    TAREFA\r\n                                </span>\r\n                                <span className=\"px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest bg-slate-800 text-slate-400 border border-white/5\">\r\n                                    {task.type === 'day' ? 'NICA' : isPeriod ? 'PERODO' : 'RECORRENTE'}\r\n                                </span>\r\n                                <span className={cn(\r\n                                    \"px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border\",\r\n                                    task.priority === 'high' ? 'bg-red-500/10 text-red-400 border-red-500/20' :\r\n                                        task.priority === 'medium' ? 'bg-amber-500/10 text-amber-400 border-amber-500/20' :\r\n                                            'bg-emerald-500/10 text-emerald-400 border-emerald-500/20'\r\n                                )}>\r\n                                    {task.priority === 'high' ? 'ALTA' : task.priority === 'medium' ? 'MDIA' : 'BAIXA'}\r\n                                </span>\r\n                            </div>\r\n                            <h2 className=\"text-3xl font-black text-white leading-tight break-words\">\r\n                                {task.title}\r\n                            </h2>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Progress Bar Display (for Period/Recurring) */}\r\n                    {(isPeriod || isRecurring) && task.progress && (\r\n                        <div className=\"bg-slate-900/40 rounded-3xl p-6 border border-white/5 shadow-inner\">\r\n                            <div className=\"flex justify-between items-end mb-4\">\r\n                                <div className=\"space-y-1\">\r\n                                    <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2\">\r\n                                        <Trophy className=\"w-3 h-3\" /> Progresso da Misso\r\n                                    </span>\r\n                                    <div className=\"text-4xl font-black text-white\">\r\n                                        {task.progress.current}/{task.progress.total}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-right space-y-1\">\r\n                                    <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center justify-end gap-2\">\r\n                                        Status Atual\r\n                                    </span>\r\n                                    <div className={cn(\r\n                                        \"text-sm font-bold\",\r\n                                        isCompleted ? \"text-emerald-400\" : \"text-blue-400\"\r\n                                    )}>\r\n                                        {isCompleted ? 'Finalizado' : 'Em Andamento'}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"h-4 bg-slate-950/80 rounded-full p-1 border border-white/5 shadow-inner relative overflow-hidden\">\r\n                                <div\r\n                                    className={cn(\r\n                                        \"h-full rounded-full transition-all duration-1000 ease-out shadow-lg\",\r\n                                        \"bg-gradient-to-r\",\r\n                                        colorScheme.gradient\r\n                                    )}\r\n                                    style={{ width: `${Math.min(100, (task.progress.current / task.progress.total) * 100)}%` }}\r\n                                >\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent rounded-full\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Main Stats */}\r\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Incio</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2 text-sm\">\r\n                                <Calendar className=\"w-4 h-4 text-blue-400\" />\r\n                                {task.startDate || task.date ? format(new Date((task.startDate || task.date) + 'T00:00:00'), 'dd/MM/yy') : '--/--/--'}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Prazo</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2 text-sm\">\r\n                                <Calendar className=\"w-4 h-4 text-rose-400\" />\r\n                                {task.endDate || task.date ? format(new Date((task.endDate || task.date) + 'T00:00:00'), 'dd/MM/yy') : '--/--/--'}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Durao</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2 text-sm\">\r\n                                <Clock className=\"w-4 h-4 text-amber-400\" />\r\n                                {task.durationMinutes || 25} min\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-slate-900/40 rounded-2xl p-4 border border-white/5\">\r\n                            <span className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2\">Total Gasto</span>\r\n                            <div className=\"text-white font-bold flex items-center gap-2 text-sm\">\r\n                                <Activity className=\"w-4 h-4 text-emerald-400\" />\r\n                                {Math.floor((task.timeSpent || 0) / 60)}h {(task.timeSpent || 0) % 60}m\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Description or Current Summary Note */}\r\n                    <div className=\"bg-slate-900/40 rounded-3xl p-6 border border-white/5 space-y-4\">\r\n                        <h3 className=\"text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 px-1\">\r\n                            <FileText className=\"w-4 h-4\" /> Notas da Tarefa\r\n                        </h3>\r\n                        <div className=\"text-slate-300 text-sm leading-relaxed italic bg-slate-950/50 p-4 rounded-xl border border-white/5\">\r\n                            {task.summary || \"Nenhuma nota especfica para esta tarefa ainda.\"}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Summary Timeline - Histrico Detalhado */}\r\n                    {task.summaries && task.summaries.length > 0 && (\r\n                        <div className=\"space-y-4\">\r\n                            <SummaryTimeline\r\n                                summaries={task.summaries}\r\n                                title=\"Histrico de Execuo\"\r\n                                maxItems={5}\r\n                                showEmptyState={false}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Bottom Action */}\r\n                    <div className=\"flex gap-4\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"flex-1 h-14 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl font-black text-white uppercase tracking-widest transition-all shadow-xl active:scale-[0.98]\"\r\n                        >\r\n                            Fechar\r\n                        </button>\r\n                        {!isCompleted && (\r\n                            <button\r\n                                onClick={handleStartFocus}\r\n                                className=\"flex-[2] h-14 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 border border-blue-400/20 rounded-2xl font-black text-white uppercase tracking-widest transition-all shadow-xl shadow-blue-500/20 flex items-center justify-center gap-3 active:scale-[0.98]\"\r\n                            >\r\n                                <PlayCircle className=\"w-6 h-6\" />\r\n                                Iniciar Foco\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\themes\\components\\AddThemeModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3015,3018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3015,3018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3247,3250],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3247,3250],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3299,3302],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3299,3302],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":163,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6879,6882],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6879,6882],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { format } from 'date-fns';\r\nimport { Modal } from '../../../components/ui/Modal';\r\nimport { Input } from '../../../components/ui/Input';\r\nimport { Button } from '../../../components/ui/Button';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { Plus, Trash2, ArrowDownUp } from 'lucide-react';\r\nimport { ImageUpload } from '../../../components/forms/ImageUpload';\r\nimport { ColorPicker } from '../../../components/forms/ColorPicker';\r\nimport { PrioritySelector } from '../../../components/forms/PrioritySelector';\r\nimport { DurationStepper } from '../../../components/forms/DurationStepper';\r\nimport { DatePicker } from '../../../components/ui/DatePicker';\r\nimport type { Theme } from '../../../types';\r\n\r\ninterface AddThemeModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    themeToEdit?: Theme;\r\n    defaultCategory?: 'study' | 'project'; // NEW\r\n}\r\n\r\ntype Difficulty = 'beginner' | 'intermediate' | 'advanced' | 'module';\r\n\r\nconst DIFFICULTY_ORDER: Record<Difficulty, number> = {\r\n    beginner: 2,\r\n    intermediate: 3,\r\n    advanced: 4,\r\n    module: 1\r\n};\r\n\r\nconst DIFFICULTY_COLORS: Record<Difficulty, string> = {\r\n    beginner: 'text-emerald-400',\r\n    intermediate: 'text-amber-400',\r\n    advanced: 'text-rose-400',\r\n    module: 'text-slate-400 font-bold'\r\n};\r\n\r\nexport const AddThemeModal: React.FC<AddThemeModalProps> = ({ isOpen, onClose, themeToEdit, defaultCategory = 'study' }) => {\r\n    const { addTheme, updateTheme, deleteTheme, tasks, goals, themes } = useStudy();\r\n\r\n    // Calculate globally used colors to prevent duplicates in calendar\r\n    const usedColors = [\r\n        ...themes.map(t => t.color),\r\n        ...tasks.map(t => t.color),\r\n        ...goals.map(g => g.color)\r\n    ].filter(Boolean) as string[];\r\n\r\n    const [title, setTitle] = useState('');\r\n    const [subtitle, setSubtitle] = useState('');\r\n\r\n    const [subthemes, setSubthemes] = useState<{ title: string; duration: string; difficulty: Difficulty }[]>([\r\n        { title: '', duration: '15', difficulty: 'beginner' }\r\n    ]);\r\n\r\n    const [icon, setIcon] = useState('');\r\n    const [color, setColor] = useState('');\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    const [priority, setPriority] = useState<'low' | 'medium' | 'high'>(themeToEdit?.priority || 'medium');\r\n    const [startDate, setStartDate] = useState(format(new Date(), 'yyyy-MM-dd'));\r\n    const [notificationTime, setNotificationTime] = useState(''); // NEW\r\n    const [category, setCategory] = useState<'study' | 'project'>(themeToEdit?.category || defaultCategory); // State for category\r\n\r\n    const [isAdvancedMode, setIsAdvancedMode] = useState(false);\r\n\r\n    // Initial State Reset\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            if (themeToEdit) {\r\n                // If editing, likely want to see details\r\n                setIsAdvancedMode(true);\r\n                setTitle(themeToEdit.title);\r\n                setSubtitle((themeToEdit as any).subtitle || '');\r\n                setSubthemes(themeToEdit.subthemes.map(s => ({\r\n                    title: s.title,\r\n                    duration: s.durationMinutes?.toString() || '15',\r\n                    difficulty: (s as any).difficulty || 'beginner'\r\n                } as any)));\r\n                setIcon(themeToEdit.icon || '');\r\n                setColor(themeToEdit.color || '');\r\n                setImageUrl(themeToEdit.imageUrl || '');\r\n                setPriority(themeToEdit.priority || 'medium');\r\n                setStartDate(themeToEdit.startDate || format(new Date(), 'yyyy-MM-dd'));\r\n                setCategory(themeToEdit.category || 'study'); // Fallback to 'study' if undefined\r\n                setNotificationTime(themeToEdit.notificationTime || ''); // Set Notification Time\r\n            } else {\r\n                // New Theme -> Simple Mode by default\r\n                setIsAdvancedMode(false);\r\n                setTitle('');\r\n                setSubtitle('');\r\n                setSubthemes([\r\n                    { title: '', duration: '15', difficulty: 'beginner' }\r\n                ]);\r\n                setIcon('');\r\n                setColor('');\r\n                setImageUrl('');\r\n                setPriority('medium');\r\n                setStartDate(format(new Date(), 'yyyy-MM-dd'));\r\n                setCategory(defaultCategory); // Use default prop\r\n                setNotificationTime(''); // Reset Notification Time\r\n            }\r\n        }\r\n    }, [isOpen, themeToEdit, defaultCategory]);\r\n\r\n    const handleAddSubtheme = () => {\r\n        const lastItem = subthemes.length > 0 ? subthemes[subthemes.length - 1] : null;\r\n        const lastDifficulty = lastItem ? lastItem.difficulty : 'beginner';\r\n        const lastDuration = lastItem ? lastItem.duration : '15'; // Inherit duration\r\n        setSubthemes([...subthemes, { title: '', duration: lastDuration, difficulty: lastDifficulty }]);\r\n    };\r\n\r\n    const handleRemoveSubtheme = (index: number) => {\r\n        setSubthemes(subthemes.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const handleChangeSubtheme = (index: number, field: 'title' | 'duration' | 'difficulty', value: string) => {\r\n        const newSubthemes = [...subthemes];\r\n        newSubthemes[index] = { ...newSubthemes[index], [field]: value };\r\n        setSubthemes(newSubthemes);\r\n    };\r\n\r\n    const autoSortSubthemes = () => {\r\n        const sorted = [...subthemes].sort((a, b) => {\r\n            const diffA = DIFFICULTY_ORDER[a.difficulty];\r\n            const diffB = DIFFICULTY_ORDER[b.difficulty];\r\n            return diffA - diffB;\r\n        });\r\n        setSubthemes(sorted);\r\n    };\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        const validSubthemes = subthemes.filter(s => s.title.trim());\r\n\r\n        // Validation: Title and Start Date are strictly required.\r\n        if (!title || !startDate) return;\r\n\r\n        const formattedSubthemes = validSubthemes.map(s => ({\r\n            title: s.title,\r\n            duration: s.duration ? parseInt(s.duration) : undefined,\r\n            difficulty: s.difficulty\r\n        }));\r\n\r\n        // Assign Random Color if not set\r\n        const finalColor = color || ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'][Math.floor(Math.random() * 6)];\r\n        // Default Icon if not set\r\n        const finalIcon = icon || '';\r\n\r\n        const themeData = {\r\n            title,\r\n            subtitle,\r\n            icon: finalIcon,\r\n            imageUrl: imageUrl || undefined,\r\n            color: finalColor,\r\n            priority,\r\n            startDate,\r\n            category, // Add category to data\r\n            notificationTime // Include notificationTime\r\n        };\r\n\r\n        if (themeToEdit) {\r\n            updateTheme(themeToEdit.id, themeData);\r\n        } else {\r\n            (addTheme as any)(\r\n                title,\r\n                formattedSubthemes,\r\n                {\r\n                    icon: finalIcon,\r\n                    imageUrl: imageUrl || undefined,\r\n                    color: finalColor,\r\n                    priority,\r\n                    startDate,\r\n                    subtitle,\r\n                    category, // Pass category explicitly\r\n                    notificationTime\r\n                }\r\n            );\r\n        }\r\n\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"\" maxWidth=\"xl\">\r\n            <div className=\"relative overflow-hidden p-5 sm:p-6\">\r\n                {/* Subtle Background Ambiance */}\r\n                <div className=\"absolute top-[-20%] right-[-20%] w-[400px] h-[400px] bg-blue-600/5 rounded-full blur-[100px] pointer-events-none\" />\r\n                <div className=\"absolute bottom-[-20%] left-[-20%] w-[300px] h-[300px] bg-indigo-600/5 rounded-full blur-[80px] pointer-events-none\" />\r\n                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none\" />\r\n\r\n                <form onSubmit={handleSubmit} className=\"relative z-10 font-sans\">\r\n                    {/* Header Row */}\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 rounded-xl border border-white/5 flex items-center justify-center shadow-inner\">\r\n                                <span className=\"text-xl\"></span>\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-lg font-bold text-white tracking-tight leading-none\">\r\n                                    {themeToEdit ? \"Editar Tema\" : \"Novo Tema\"}\r\n                                </h2>\r\n                                <p className=\"text-[11px] text-slate-500 font-medium px-0.5\">Organize seus estudos</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-5 px-6\">\r\n                        {/* Main Inputs (Always Visible) */}\r\n                        <div className=\"space-y-3\">\r\n                            <div className=\"relative group\">\r\n                                <div className=\"absolute -inset-0.5 bg-gradient-to-r from-blue-500/20 to-indigo-500/20 rounded-xl opacity-0 group-focus-within:opacity-100 blur transition duration-500\" />\r\n                                <input\r\n                                    placeholder=\"Nome do Tema (Ex: React Native)...\"\r\n                                    value={title}\r\n                                    onChange={e => setTitle(e.target.value)}\r\n                                    autoFocus\r\n                                    className=\"relative w-full bg-slate-950/80 text-white placeholder-slate-600 border border-white/5 rounded-xl px-4 py-3 text-base font-medium focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all shadow-sm\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Simple Mode Toggle hint or subtitle input in expanded */}\r\n                            {isAdvancedMode && (\r\n                                <Input\r\n                                    placeholder=\"Subttulo ou descrio breve...\"\r\n                                    value={subtitle}\r\n                                    onChange={e => setSubtitle(e.target.value)}\r\n                                    className=\"bg-slate-950/50 border-white/5 text-sm h-10 animate-in fade-in slide-in-from-top-1\"\r\n                                />\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Advanced Sections Toggle */}\r\n                        {!isAdvancedMode && !themeToEdit && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => setIsAdvancedMode(true)}\r\n                                className=\"w-full py-2 flex items-center justify-center gap-2 text-xs font-bold text-slate-500 hover:text-blue-400 transition-colors group\"\r\n                            >\r\n                                <Plus className=\"w-3 h-3 group-hover:scale-110 transition-transform\" />\r\n                                Adicionar Detalhes (Capa, cone, Trilha)\r\n                            </button>\r\n                        )}\r\n\r\n\r\n                        {/* Details Container (Collapsible) */}\r\n                        {isAdvancedMode && (\r\n                            <div className=\"space-y-4 animate-in fade-in slide-in-from-top-2 duration-300\">\r\n                                <div className=\"bg-slate-900/40 rounded-xl border border-white/5 p-4 space-y-4\">\r\n\r\n                                    {/* Priority & Category */}\r\n                                    <div className=\"grid grid-cols-2 gap-4\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Prioridade</label>\r\n                                            <PrioritySelector value={priority} onChange={setPriority} />\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Tipo</label>\r\n                                            <select\r\n                                                value={category}\r\n                                                onChange={(e) => setCategory(e.target.value as 'study' | 'project')}\r\n                                                className=\"w-full h-9 bg-slate-950/50 border border-white/5 rounded-lg text-xs px-3 focus:border-blue-500/50 outline-none transition-all\"\r\n                                            >\r\n                                                <option value=\"study\">Tema</option>\r\n                                                <option value=\"project\">Projeto</option>\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n\r\n\r\n                                    {/* Dates & Notification Grid */}\r\n                                    <div className=\"grid grid-cols-2 gap-4\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Incio da Trilha</label>\r\n                                            <DatePicker\r\n                                                value={startDate}\r\n                                                onChange={setStartDate}\r\n                                                placeholder=\"Incio\"\r\n                                                className=\"w-full\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Horrio (Notificao)</label>\r\n                                            <input\r\n                                                type=\"time\"\r\n                                                value={notificationTime}\r\n                                                onChange={(e) => setNotificationTime(e.target.value)}\r\n                                                className=\"w-full h-9 bg-slate-950/50 border border-white/5 rounded-lg text-xs px-3 focus:border-blue-500/50 outline-none transition-all text-white placeholder-slate-600\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"h-px bg-white/5 w-full\" />\r\n\r\n                                    {/* Subthemes (Study Track) */}\r\n                                    <div className=\"space-y-3\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Trilha de Estudo</label>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={autoSortSubthemes}\r\n                                                className=\"text-[10px] text-blue-400 hover:text-blue-300 flex items-center gap-1 transition-colors\"\r\n                                                title=\"Ordenar por Dificuldade\"\r\n                                            >\r\n                                                <ArrowDownUp className=\"w-3 h-3\" />\r\n                                                Ordenar\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        <div className=\"space-y-2 max-h-[250px] overflow-y-auto pr-2 custom-scrollbar\">\r\n                                            {(() => {\r\n                                                let itemCounter = 0;\r\n                                                return subthemes.map((st, index) => {\r\n                                                    const isModule = st.difficulty === 'module';\r\n                                                    if (isModule) {\r\n                                                        itemCounter = 0;\r\n                                                    } else {\r\n                                                        itemCounter++;\r\n                                                    }\r\n\r\n                                                    return (\r\n                                                        <div key={index} className={`flex gap-2 items-start p-2 rounded-lg border transition-all group ${isModule ? 'bg-slate-800/60 border-slate-700/50' : 'bg-slate-950/30 border-white/5 hover:border-white/10'}`}>\r\n                                                            <span className={`text-[10px] font-mono mt-2.5 w-5 text-right ${isModule ? 'text-blue-400 font-bold' : 'text-slate-600'}`}>\r\n                                                                {isModule ? '#' : `${itemCounter}.`}\r\n                                                            </span>\r\n                                                            <div className=\"flex-1 space-y-2\">\r\n                                                                <div className=\"flex gap-2\">\r\n                                                                    <Input\r\n                                                                        className={`flex-1 h-8 text-xs ${isModule ? 'font-bold text-blue-100 border-blue-500/20 focus:border-blue-500/50 bg-blue-900/10' : 'bg-slate-950/30 border-white/5'}`}\r\n                                                                        placeholder={isModule ? \"Nome do Mdulo...\" : `Tpico...`}\r\n                                                                        value={st.title}\r\n                                                                        onChange={e => handleChangeSubtheme(index, 'title', e.target.value)}\r\n                                                                    />\r\n                                                                    <select\r\n                                                                        value={st.difficulty}\r\n                                                                        onChange={(e) => handleChangeSubtheme(index, 'difficulty', e.target.value as Difficulty)}\r\n                                                                        className={`h-8 rounded-lg bg-slate-950/50 border border-white/5 text-[10px] px-2 outline-none focus:border-blue-500/50 cursor-pointer transition-colors w-24 ${DIFFICULTY_COLORS[st.difficulty]}`}\r\n                                                                    >\r\n                                                                        <option value=\"beginner\">Iniciante</option>\r\n                                                                        <option value=\"intermediate\">Intermedirio</option>\r\n                                                                        <option value=\"advanced\">Avanado</option>\r\n                                                                        <option value=\"module\"> Mdulo</option>\r\n                                                                    </select>\r\n                                                                </div>\r\n                                                                {!isModule && (\r\n                                                                    <div className=\"flex items-center gap-2 pl-1\">\r\n                                                                        <div className=\"bg-slate-950/50 rounded-md border border-white/5 p-0.5 scale-90 origin-left\">\r\n                                                                            <DurationStepper\r\n                                                                                value={st.duration}\r\n                                                                                onChange={(val) => handleChangeSubtheme(index, 'duration', val)}\r\n                                                                                step={1}\r\n                                                                                min={0}\r\n                                                                            />\r\n                                                                        </div>\r\n                                                                        <span className=\"text-[10px] text-slate-600\">minutos estim.</span>\r\n                                                                    </div>\r\n                                                                )}\r\n                                                            </div>\r\n                                                            {subthemes.length > 1 && (\r\n                                                                <button\r\n                                                                    type=\"button\"\r\n                                                                    onClick={() => handleRemoveSubtheme(index)}\r\n                                                                    className=\"p-1.5 mt-0.5 text-slate-600 hover:text-red-400 rounded-lg transition-colors opacity-0 group-hover:opacity-100\"\r\n                                                                >\r\n                                                                    <Trash2 className=\"w-3.5 h-3.5\" />\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    );\r\n                                                });\r\n                                            })()}\r\n                                        </div>\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"secondary\"\r\n                                            size=\"sm\"\r\n                                            onClick={handleAddSubtheme}\r\n                                            className=\"w-full border border-dashed border-slate-700 bg-slate-900/20 hover:bg-slate-800 text-xs h-8 text-slate-400 hover:text-white\"\r\n                                        >\r\n                                            <Plus className=\"w-3 h-3 mr-2\" />\r\n                                            Adicionar Tpico\r\n                                        </Button>\r\n                                    </div>\r\n\r\n                                    <div className=\"grid grid-cols-[60px_1fr] gap-4 pt-2\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">cone</label>\r\n                                            <div className=\"relative\">\r\n                                                <Input\r\n                                                    value={icon}\r\n                                                    onChange={e => setIcon(e.target.value)}\r\n                                                    className=\"text-center h-10 bg-slate-950/50 border-white/5 text-lg\"\r\n                                                    placeholder=\"\"\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"space-y-1\">\r\n                                            <label className=\"text-[10px] uppercase font-bold text-slate-500 pl-1\">Cor</label>\r\n                                            <ColorPicker\r\n                                                value={color}\r\n                                                onChange={setColor}\r\n                                                disabledColors={themeToEdit ? usedColors.filter(c => c !== themeToEdit.color) : usedColors}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Image */}\r\n                                <div className=\"bg-slate-900/20 rounded-xl\">\r\n                                    <ImageUpload label=\"Capa do Card (Opcional)\" value={imageUrl} onChange={setImageUrl} />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Footer Actions */}\r\n                    <div className=\"flex items-center justify-between gap-3 pt-4 border-t border-white/5 mt-6 px-6\">\r\n                        {themeToEdit && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => {\r\n                                    deleteTheme(themeToEdit.id);\r\n                                    onClose();\r\n                                }}\r\n                                className=\"flex items-center gap-2 px-3 py-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors text-xs font-bold uppercase tracking-wide\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                                Excluir\r\n                            </button>\r\n                        )}\r\n                        <div className=\"flex items-center gap-3 ml-auto\">\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"ghost\"\r\n                                onClick={onClose}\r\n                                className=\"text-slate-400 hover:text-white text-xs h-9 px-4\"\r\n                            >\r\n                                Cancelar\r\n                            </Button>\r\n                            <Button\r\n                                type=\"submit\"\r\n                                className=\"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-500/20 text-xs font-bold uppercase tracking-wide h-9 px-6 rounded-lg transition-all active:scale-95\"\r\n                            >\r\n                                {themeToEdit ? \"Salvar\" : \"Criar Tema\"}\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\themes\\components\\StudyContentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'format' is defined but never used.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ptBR' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":187,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10820,10823],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10820,10823],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, BookOpen, Save, Clock, Brain, History, Sparkles, Maximize2 } from 'lucide-react';\r\nimport { RichTextEditor } from '../../../components/ui/RichTextEditor';\r\nimport { Modal } from '../../../components/ui/Modal';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Subtheme } from '../../../types';\r\nimport { format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport SummaryTimeline from '../../../components/ui/SummaryTimeline';\r\n\r\ninterface StudyContentModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    subtheme: Subtheme | null;\r\n    onSave: (content: string) => void;\r\n}\r\n\r\nexport const StudyContentModal: React.FC<StudyContentModalProps> = ({ isOpen, onClose, subtheme, onSave }) => {\r\n    const [content, setContent] = useState(subtheme?.text_content || '');\r\n    const [activeTab, setActiveTab] = useState<'content' | 'history'>('content');\r\n    const [isFullscreen, setIsFullscreen] = useState(false);\r\n\r\n    // Update internal content when subtheme changes\r\n    React.useEffect(() => {\r\n        if (subtheme) {\r\n            setContent(subtheme.text_content || '');\r\n        }\r\n    }, [subtheme]);\r\n\r\n    if (!subtheme) return null;\r\n\r\n    const timeSpentH = Math.floor((subtheme.timeSpent || 0) / 60);\r\n    const timeSpentM = (subtheme.timeSpent || 0) % 60;\r\n\r\n    return (\r\n        <Modal\r\n            isOpen={isOpen}\r\n            onClose={onClose}\r\n            title={null} // Custom Header\r\n            maxWidth={isFullscreen ? 'full' : '3xl'}\r\n            padding={false}\r\n            className={cn(\"transition-all duration-500\", isFullscreen ? \"h-[95vh]\" : \"h-[85vh]\")}\r\n        >\r\n            <div className=\"flex flex-col h-full bg-slate-950 overflow-hidden rounded-2xl border border-white/5 shadow-2xl\">\r\n                {/* Custom Header */}\r\n                <div className=\"p-6 border-b border-white/5 bg-slate-900/40 relative overflow-hidden shrink-0\">\r\n                    <div className=\"absolute top-0 right-0 w-64 h-full bg-blue-500/5 blur-3xl rounded-full pointer-events-none\" />\r\n\r\n                    <div className=\"flex items-start justify-between relative z-10\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                                <BookOpen className=\"w-6 h-6 text-white\" />\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-xl font-bold text-white tracking-tight\">{subtheme.title}</h2>\r\n                                <div className=\"flex items-center gap-3 mt-1\">\r\n                                    <span className=\"flex items-center gap-1 text-[10px] font-bold text-slate-500 uppercase tracking-widest\">\r\n                                        <Clock className=\"w-3 h-3\" />\r\n                                        {timeSpentH}h {timeSpentM}m de Estudo\r\n                                    </span>\r\n                                    <span className=\"w-1 h-1 bg-slate-800 rounded-full\" />\r\n                                    <span className=\"flex items-center gap-1 text-[10px] font-bold text-blue-400 uppercase tracking-widest\">\r\n                                        <Brain className=\"w-3 h-3\" />\r\n                                        SRS Nvel {subtheme.reviews.filter(r => r.status === 'completed').length}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"p-2 hover:bg-white/5 rounded-xl text-slate-500 hover:text-white transition-all\"\r\n                        >\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Tabs */}\r\n                    <div className=\"flex gap-1 mt-6 p-1 bg-black/40 rounded-xl w-fit border border-white/5\">\r\n                        <button\r\n                            onClick={() => setActiveTab('content')}\r\n                            className={cn(\r\n                                \"flex items-center gap-2 px-4 py-1.5 rounded-lg text-xs font-bold transition-all\",\r\n                                activeTab === 'content' ? \"bg-slate-800 text-white shadow-lg\" : \"text-slate-500 hover:text-slate-300\"\r\n                            )}\r\n                        >\r\n                            <FileTextIcon className=\"w-3.5 h-3.5\" />\r\n                            Contedo Principal\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setActiveTab('history')}\r\n                            className={cn(\r\n                                \"flex items-center gap-2 px-4 py-1.5 rounded-lg text-xs font-bold transition-all\",\r\n                                activeTab === 'history' ? \"bg-slate-800 text-white shadow-lg\" : \"text-slate-500 hover:text-slate-300\"\r\n                            )}\r\n                        >\r\n                            <History className=\"w-3.5 h-3.5\" />\r\n                            Dirio & Resumos\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Content Area */}\r\n                <div className=\"flex-1 overflow-y-auto p-6 custom-scrollbar\">\r\n                    <AnimatePresence mode=\"wait\">\r\n                        {activeTab === 'content' ? (\r\n                            <motion.div\r\n                                key=\"content\"\r\n                                initial={{ opacity: 0, y: 10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                exit={{ opacity: 0, y: -10 }}\r\n                                className=\"space-y-6\"\r\n                            >\r\n                                <div className=\"flex items-center justify-between mb-2\">\r\n                                    <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-widest\">Anotaes do Mdulo</h3>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <button className=\"flex items-center gap-1.5 px-3 py-1.5 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 rounded-lg text-[10px] font-bold uppercase transition-all border border-indigo-500/20\">\r\n                                            <Sparkles className=\"w-3 h-3\" />\r\n                                            Gerar com IA\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <RichTextEditor\r\n                                    content={content}\r\n                                    onChange={setContent}\r\n                                />\r\n\r\n                                <div className=\"bg-slate-900/30 border border-white/5 rounded-2xl p-4 flex items-center gap-4\">\r\n                                    <div className=\"p-2 rounded-lg bg-emerald-500/10 text-emerald-500\">\r\n                                        <Maximize2 className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <p className=\"text-xs font-bold text-white\">Modo de Leitura Focado</p>\r\n                                        <p className=\"text-[10px] text-slate-500\">Expanda para estudar sem distraes.</p>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => setIsFullscreen(!isFullscreen)}\r\n                                        className=\"px-3 py-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-[10px] font-bold\"\r\n                                    >\r\n                                        {isFullscreen ? 'REDUZIR' : 'ABRIR'}\r\n                                    </button>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : (\r\n                            <motion.div\r\n                                key=\"history\"\r\n                                initial={{ opacity: 0, y: 10 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                exit={{ opacity: 0, y: -10 }}\r\n                                className=\"space-y-4\"\r\n                            >\r\n                                {(!subtheme.summaries || subtheme.summaries.length === 0) && (!subtheme.reviews || subtheme.reviews.filter(r => r.status === 'completed').length === 0) ? (\r\n                                    <div className=\"text-center py-20 bg-slate-900/20 rounded-[2rem] border border-dashed border-slate-800\">\r\n                                        <History className=\"w-12 h-12 text-slate-700 mx-auto mb-4\" />\r\n                                        <p className=\"text-slate-500 font-medium\">Nenhum resumo disponvel ainda.</p>\r\n                                        <p className=\"text-xs text-slate-600 mt-1\">Conclua uma reviso para registrar seus aprendizados.</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <SummaryTimeline summaries={subtheme.summaries || []} title=\"Histrico de Estudos\" />\r\n                                )}\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                {activeTab === 'content' && (\r\n                    <div className=\"p-4 border-t border-white/5 bg-slate-900/40 shrink-0 flex items-center justify-between\">\r\n                        <p className=\"text-[10px] text-slate-500 font-medium italic\">\r\n                            Alt + S para salvar rapidamente\r\n                        </p>\r\n                        <button\r\n                            onClick={() => onSave(content)}\r\n                            className=\"group relative flex items-center gap-2 px-6 py-2.5 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold text-sm shadow-lg shadow-emerald-500/20 transition-all hover:scale-[1.02] active:scale-95\"\r\n                        >\r\n                            <Save className=\"w-4 h-4\" />\r\n                            Salvar Alteraes\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nconst FileTextIcon = (props: any) => (\r\n    <svg\r\n        {...props}\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"24\"\r\n        height=\"24\"\r\n        viewBox=\"0 0 24 24\"\r\n        fill=\"none\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n    >\r\n        <path d=\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\" /><path d=\"M14 2v4a2 2 0 0 0 2 2h4\" /><path d=\"M10 9H8\" /><path d=\"M16 13H8\" /><path d=\"M16 17H8\" />\r\n    </svg>\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\themes\\components\\SubthemeItem.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'themeColor' is defined but never used.","line":20,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startAudio' is assigned a value but never used.","line":26,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7648,7651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7648,7651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":208,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11682,11685],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11682,11685],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":210,"column":126,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":129,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11915,11918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11915,11918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef } from 'react';\r\nimport { useStudy } from '../../../context/StudyContext';\r\nimport { usePomodoroContext } from '../../../context/PomodoroContext';\r\nimport { useAudio } from '../../../context/AudioContext';\r\nimport { Play, FileText, ChevronDown, BookOpen, Lock } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Subtheme, Review } from '../../../types';\r\nimport { useSRSLogic } from '../../../hooks/useSRSLogic';\r\nimport { SummaryHistoryModal } from './SummaryHistoryModal';\r\n\r\ninterface SubthemeItemProps {\r\n    sub: Subtheme;\r\n    themeColor: string;\r\n    projectedStart?: string;\r\n    onOpenNotes: (sub: Subtheme) => void;\r\n    unlockedSubthemes: string[];\r\n}\r\n\r\nexport const SubthemeItem = ({ sub, themeColor, projectedStart, onOpenNotes, unlockedSubthemes }: SubthemeItemProps) => {\r\n    const [isExpanded, setIsExpanded] = useState(false);\r\n    const [isStarting, setIsStarting] = useState(false);\r\n    const clickLockRef = useRef(false); // Synchronous lock for rapid clicks\r\n    const { startFocus } = useStudy();\r\n    const { startFocusSession, isActive } = usePomodoroContext();\r\n    const { startAudio } = useAudio();\r\n    const { generateProjectedReviews } = useSRSLogic();\r\n\r\n    // Strict Summary Unlock Logic\r\n    const isUnlocked = unlockedSubthemes && unlockedSubthemes.includes(sub.id);\r\n\r\n    // Determines items to show\r\n    let displayReviews = [...sub.reviews];\r\n    const isProjectedView = sub.status === 'queue' && projectedStart && displayReviews.length === 0;\r\n\r\n    if (isProjectedView && projectedStart) {\r\n        displayReviews = generateProjectedReviews(projectedStart);\r\n    }\r\n    const sortedReviews = displayReviews.sort((a: Review, b: Review) => new Date(a.date).getTime() - new Date(b.date).getTime());\r\n\r\n    // Status Config\r\n    const statusConfig: Record<string, { color: string; bg: string; border: string; icon: string; label: string }> = {\r\n        active: { color: 'text-emerald-400', bg: 'bg-emerald-500/10', border: 'border-emerald-500/20', icon: '', label: 'Ativo' },\r\n        completed: { color: 'text-blue-400', bg: 'bg-blue-500/10', border: 'border-blue-500/20', icon: '', label: 'Concludo' },\r\n        queue: { color: 'text-slate-400', bg: 'bg-slate-800/50', border: 'border-slate-700/50', icon: '', label: 'Fila' },\r\n    };\r\n    const status = statusConfig[sub.status as string] || statusConfig.queue;\r\n\r\n    const [isSummaryOpen, setIsSummaryOpen] = useState(false);\r\n\r\n    // ... existing statusConfig ...\r\n\r\n    const isModule = sub.difficulty === 'module';\r\n\r\n    if (isModule) {\r\n        // ... module render ...\r\n        return (\r\n            <div className=\"relative py-2 flex items-center justify-center overflow-hidden\">\r\n                <div className=\"absolute inset-0 flex items-center\">\r\n                    <div className=\"w-full border-t border-slate-800/50\"></div>\r\n                </div>\r\n                <span className=\"relative bg-slate-950 px-3 text-[10px] font-black uppercase tracking-[0.2em] text-slate-600\">\r\n                    {sub.title}\r\n                </span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className={cn(\r\n                \"rounded-xl transition-all duration-300 border group/item overflow-hidden\",\r\n                isExpanded ? \"bg-slate-900 border-slate-700 shadow-xl\" : \"bg-slate-900/40 border-slate-800/50 hover:bg-slate-900/60 hover:border-slate-700/50\"\r\n            )}>\r\n                <div\r\n                    onClick={() => setIsExpanded(!isExpanded)}\r\n                    className=\"p-3 flex items-center gap-3 cursor-pointer select-none\"\r\n                >\r\n                    {/* Status Dot */}\r\n                    <div className={cn(\"w-2 h-2 rounded-full shadow-[0_0_8px]\", status.bg.replace('bg-', 'bg-').replace('/10', ''))}\r\n                        style={{ backgroundColor: status.color.replace('text-', ''), boxShadow: `0 0 8px currentColor` }}\r\n                    />\r\n\r\n                    <span className={cn(\r\n                        \"flex-1 text-sm font-medium transition-colors truncate\",\r\n                        isExpanded ? \"text-white\" : \"text-slate-400 group-hover:item:text-slate-200\",\r\n                        sub.status === 'completed' && \"line-through opacity-50 text-slate-600\"\r\n                    )}>\r\n                        {sub.title}\r\n                    </span>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {/* Summary History Button (New) */}\r\n                        <button\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                setIsSummaryOpen(true);\r\n                            }}\r\n                            className={cn(\r\n                                \"w-7 h-7 flex items-center justify-center rounded-lg border transition-all\",\r\n                                \"bg-slate-800 border-slate-700 text-slate-500 hover:bg-indigo-500/20 hover:text-indigo-300 hover:border-indigo-500/30\"\r\n                            )}\r\n                            title=\"Dirio de Aprendizado / Resumos\"\r\n                        >\r\n                            <BookOpen className=\"w-3.5 h-3.5 fill-current\" />\r\n                        </button>\r\n\r\n                        {/* Edit Content / Notes Button */}\r\n                        <button\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                if (isUnlocked) onOpenNotes(sub);\r\n                            }}\r\n                            disabled={!isUnlocked}\r\n                            className={cn(\r\n                                \"w-7 h-7 flex items-center justify-center rounded-lg border transition-all\",\r\n                                !isUnlocked\r\n                                    ? \"bg-slate-800/50 border-slate-700/50 text-slate-600 cursor-not-allowed opacity-50\"\r\n                                    : sub.text_content\r\n                                        ? \"bg-indigo-500/10 border-indigo-500/30 text-indigo-400 hover:bg-indigo-500 hover:text-white\"\r\n                                        : \"bg-slate-800 border-slate-700 text-slate-500 hover:bg-indigo-500/20 hover:text-indigo-300 hover:border-indigo-500/30\"\r\n                            )}\r\n                            title={isUnlocked ? \"Anotaes do Contedo\" : \"Complete um Pomodoro hoje para liberar o contedo\"}\r\n                        >\r\n                            <FileText className=\"w-3.5 h-3.5 fill-current\" />\r\n                        </button>\r\n\r\n                        {/* Play Button for Subtheme */}\r\n                        {(() => {\r\n                            // Determine availability\r\n                            let isLocked = false;\r\n                            let lockReason = \"\";\r\n                            const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n\r\n                            if (sub.status === 'completed') {\r\n                                isLocked = true;\r\n                                lockReason = \"Tema concludo! Parabns!\";\r\n                            } else if (sub.status === 'queue') {\r\n                                isLocked = true;\r\n                                lockReason = \"Este mdulo ainda no foi iniciado.\";\r\n                                if (projectedStart) lockReason += ` Previso: ${format(new Date(projectedStart), 'dd/MM')}`;\r\n                            } else if (sub.status === 'active') {\r\n                                const nextReview = sub.reviews.find((r: any) => r.status === 'pending');\r\n                                if (!nextReview) {\r\n                                    isLocked = true;\r\n                                    lockReason = \"Sem revises pendentes.\";\r\n                                } else if (nextReview.date > todayStr) {\r\n                                    isLocked = true;\r\n                                    lockReason = `Prxima reviso agendada para ${format(new Date(nextReview.date), 'dd/MM')}`;\r\n                                }\r\n                            }\r\n\r\n                            return (\r\n                                <button\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        // Critical: Check Ref (sync) AND State (async) AND Context (global)\r\n                                        if (isLocked || isStarting || isActive || clickLockRef.current) return;\r\n\r\n                                        // Set strict locks\r\n                                        clickLockRef.current = true;\r\n                                        setIsStarting(true);\r\n\r\n                                        startFocus(sub.id, 'subtheme', sub.title, 25);\r\n                                        startFocusSession(sub.id, 25);\r\n                                        // DISABLED: Auto-start audio\r\n                                        // startAudio();\r\n\r\n                                        // Reset after delay\r\n                                        setTimeout(() => {\r\n                                            setIsStarting(false);\r\n                                            clickLockRef.current = false;\r\n                                        }, 2000);\r\n                                    }}\r\n                                    disabled={isLocked || isStarting || isActive}\r\n                                    className={cn(\r\n                                        \"w-7 h-7 flex items-center justify-center rounded-lg border transition-all relative group/playbtn\",\r\n                                        isLocked || isStarting || isActive\r\n                                            ? \"bg-slate-800/50 border-slate-700/50 text-slate-600 cursor-not-allowed\"\r\n                                            : \"bg-slate-800 hover:bg-emerald-600 border-slate-700 hover:border-emerald-500 text-slate-400 hover:text-white\"\r\n                                    )}\r\n                                    title={isActive ? \"Foco em andamento\" : (isLocked ? lockReason : \"Focar neste Tema\")}\r\n                                >\r\n                                    {isLocked ? (\r\n                                        <Lock className=\"w-3 h-3 text-slate-600\" />\r\n                                    ) : (\r\n                                        <Play className=\"w-3 h-3 fill-current\" />\r\n                                    )}\r\n                                </button>\r\n                            );\r\n                        })()}\r\n\r\n                        <ChevronDown className={cn(\"w-4 h-4 text-slate-600 transition-transform duration-300\", isExpanded && \"rotate-180 text-white\")} />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Expanded Content */}\r\n                {isExpanded && (\r\n                    <div className=\"px-3 pb-3 border-t border-slate-800/50 animate-in slide-in-from-top-2 duration-200\">\r\n                        <div className=\"mt-2 grid gap-1\">\r\n                            {sortedReviews.length === 0 ? (\r\n                                <p className=\"text-[10px] text-slate-600 italic text-center py-2\">Sem revises agendadas.</p>\r\n                            ) : (\r\n                                <div className=\"relative\">\r\n                                    {/* Timeline Line (Visual Only) */}\r\n                                    <div className=\"absolute left-3 top-2 bottom-2 w-px bg-slate-800/50\" />\r\n\r\n                                    {sortedReviews.map((rev: any, idx: number) => {\r\n                                        const isDone = rev.status === 'completed';\r\n                                        const isNext = !isDone && !rev.isProjected && rev.number === (sortedReviews.find((r: any) => r.status === 'pending')?.number || 0);\r\n\r\n                                        return (\r\n                                            <div key={idx} className=\"relative flex items-center gap-3 py-1.5 pl-1 group/rev\">\r\n                                                {/* Dot on Timeline */}\r\n                                                <div className={cn(\r\n                                                    \"relative z-10 w-4 h-4 rounded-full border-2 flex items-center justify-center text-[8px] font-bold transition-all\",\r\n                                                    isDone\r\n                                                        ? \"bg-slate-900 border-emerald-500 text-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.2)]\"\r\n                                                        : isNext\r\n                                                            ? \"bg-blue-500 border-blue-400 text-white animate-pulse shadow-[0_0_10px_rgba(59,130,246,0.5)]\"\r\n                                                            : \"bg-slate-900 border-slate-700 text-slate-600\"\r\n                                                )}>\r\n                                                    {isDone ? '' : rev.number}\r\n                                                </div>\r\n\r\n                                                <div className=\"flex-1 flex items-center justify-between text-xs p-1.5 rounded-lg hover:bg-slate-800/50 transition-colors\">\r\n                                                    <span className={cn(\"font-mono\", isDone ? \"text-emerald-400\" : isNext ? \"text-blue-300\" : \"text-slate-500\")}>\r\n                                                        {format(new Date(rev.date), 'dd/MM/yyyy')}\r\n                                                    </span>\r\n                                                    <span className={cn(\"text-[10px] font-bold uppercase\",\r\n                                                        isDone ? \"text-emerald-500\" :\r\n                                                            rev.isProjected ? \"text-slate-700 italic\" :\r\n                                                                isNext ? \"text-blue-400\" : \"text-amber-500/50\"\r\n                                                    )}>\r\n                                                        {rev.isProjected ? 'Estimado' : isDone ? 'Feito' : isNext ? 'Prximo' : 'Pendente'}\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <SummaryHistoryModal\r\n                isOpen={isSummaryOpen}\r\n                onClose={() => setIsSummaryOpen(false)}\r\n                subtheme={sub}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\themes\\components\\SummaryHistoryModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Quote' is defined but never used.","line":3,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":3,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'format' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ptBR' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cn' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":12}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, BookOpen, Quote, Calendar } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Subtheme } from '../../../types';\r\nimport SummaryTimeline from '../../../components/ui/SummaryTimeline';\r\n\r\ninterface SummaryHistoryModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    subtheme: Subtheme;\r\n}\r\n\r\nexport const SummaryHistoryModal: React.FC<SummaryHistoryModalProps> = ({ isOpen, onClose, subtheme }) => {\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {isOpen && (\r\n                <>\r\n                    {/* Backdrop */}\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9998]\"\r\n                        onClick={onClose}\r\n                    />\r\n\r\n                    {/* Modal Content */}\r\n                    <div className=\"fixed inset-0 z-[9999] flex items-center justify-center p-4 pointer-events-none\">\r\n                        <motion.div\r\n                            initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                            animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                            exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n                            className=\"bg-slate-900 border border-slate-800 rounded-2xl w-full max-w-lg shadow-2xl pointer-events-auto flex flex-col max-h-[85vh]\"\r\n                        >\r\n                            {/* Header */}\r\n                            <div className=\"p-6 border-b border-slate-800 flex items-start justify-between bg-slate-900/50 rounded-t-2xl\">\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 text-indigo-400 mb-1\">\r\n                                        <BookOpen className=\"w-5 h-5\" />\r\n                                        <span className=\"text-xs font-bold uppercase tracking-widest\">Dirio de Aprendizado</span>\r\n                                    </div>\r\n                                    <h2 className=\"text-xl font-bold text-white\">{subtheme.title}</h2>\r\n                                </div>\r\n                                <button\r\n                                    onClick={onClose}\r\n                                    className=\"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-colors\"\r\n                                >\r\n                                    <X className=\"w-5 h-5\" />\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Scrollable Content */}\r\n                            <div className=\"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent\">\r\n                                <SummaryTimeline\r\n                                    summaries={subtheme.summaries || []}\r\n                                    title=\"Histrico de Reviso\"\r\n                                    showEmptyState={true}\r\n                                />\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                </>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\features\\themes\\components\\ThemeCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'completionDate' is defined but never used.","line":16,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":50}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { BrainCircuit, Pencil, Trash2 } from 'lucide-react';\r\nimport { cn } from '../../../lib/utils';\r\nimport type { Theme, Subtheme } from '../../../types';\r\nimport { SubthemeItem } from './SubthemeItem';\r\n\r\ninterface ThemeCardProps {\r\n    theme: Theme;\r\n    completionDate: string | null;\r\n    queuedSubthemesMap: Map<string, string>;\r\n    onEdit: () => void;\r\n    onDelete: () => void;\r\n    onOpenNotes: (sub: Subtheme) => void;\r\n    unlockedSubthemes: string[];\r\n}\r\n\r\nexport const ThemeCard = ({ theme, completionDate, queuedSubthemesMap, onEdit, onDelete, onOpenNotes, unlockedSubthemes }: ThemeCardProps) => {\r\n    const themeColor = theme.color || '#3b82f6';\r\n\r\n    // Calculate Progress\r\n    const totalSubs = theme.subthemes.length;\r\n    const completedSubs = theme.subthemes.filter((s: Subtheme) => s.status === 'completed').length;\r\n    const progress = totalSubs === 0 ? 0 : (completedSubs / totalSubs) * 100;\r\n\r\n    return (\r\n        <div className=\"group relative w-full h-full flex flex-col\">\r\n            {/* Main Card Structure */}\r\n            <div className=\"relative flex-1 bg-[#0f111a] rounded-[2rem] border border-white/5 overflow-hidden transition-all duration-300 hover:border-white/10 hover:shadow-2xl hover:shadow-black/50 hover:translate-y-[-2px]\">\r\n\r\n                {/* Ambient Background Gradient (restored \"Design de Antes\" feel) */}\r\n                <div\r\n                    className=\"absolute inset-0 opacity-20 pointer-events-none\"\r\n                    style={{\r\n                        background: `radial-gradient(circle at top left, ${themeColor}, transparent 70%)`\r\n                    }}\r\n                />\r\n\r\n                {/* Header Content (The screenshot part) */}\r\n                <div className=\"relative p-6 z-10\">\r\n                    <div className=\"flex items-start gap-4\">\r\n                        <div className=\"flex items-center gap-5 flex-1 min-w-0\">\r\n                            {/* Icon Box */}\r\n                            <div\r\n                                className=\"w-16 h-16 rounded-2xl border border-white/10 flex items-center justify-center shrink-0 bg-gradient-to-br from-white/5 to-white/0 shadow-lg\"\r\n                                style={{ boxShadow: `0 8px 32px -8px ${themeColor}40` }}\r\n                            >\r\n                                {theme.imageUrl ? (\r\n                                    <img\r\n                                        src={theme.imageUrl}\r\n                                        alt={theme.title}\r\n                                        className=\"w-full h-full object-cover rounded-2xl opacity-90\"\r\n                                    />\r\n                                ) : (\r\n                                    <div className=\"text-white/90 transform group-hover:scale-110 transition-transform duration-500\">\r\n                                        {theme.icon ? (\r\n                                            <span className=\"text-3xl filter drop-shadow-md\">{theme.icon}</span>\r\n                                        ) : (\r\n                                            <BrainCircuit className=\"w-8 h-8\" />\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Title & Badge */}\r\n                            <div className=\"flex-1 min-w-0\">\r\n                                <h3 className=\"text-2xl font-bold text-white tracking-tight leading-tight mb-2 drop-shadow-sm truncate\">\r\n                                    {theme.title}\r\n                                </h3>\r\n                                <div className=\"flex items-center gap-2 flex-wrap\">\r\n                                    <span className=\"inline-flex items-center px-3 py-1 rounded-full bg-black/40 border border-white/5 text-[10px] font-bold text-slate-400 uppercase tracking-widest backdrop-blur-sm\">\r\n                                        {totalSubs} {totalSubs === 1 ? 'Mdulo' : 'Mdulos'}\r\n                                    </span>\r\n                                    {/* Category Badge */}\r\n                                    <span className={`inline-flex items-center px-2 py-0.5 rounded-md text-[9px] font-bold uppercase tracking-wider border ${theme.category === 'project'\r\n                                        ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20'\r\n                                        : 'bg-blue-500/10 text-blue-400 border-blue-500/20'\r\n                                        }`}>\r\n                                        {theme.category === 'project' ? 'Projeto' : 'Tema'}\r\n                                    </span>\r\n                                    {/* Start Date */}\r\n                                    {theme.startDate && (\r\n                                        <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-md text-[9px] font-bold bg-slate-800/60 text-slate-300 border border-slate-600/40\">\r\n                                            Incio: {new Date(theme.startDate).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}\r\n                                        </span>\r\n                                    )}\r\n                                    {/* Deadline */}\r\n                                    {theme.deadline && (\r\n                                        <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-md text-[9px] font-bold bg-slate-800/60 text-slate-300 border border-slate-600/40\">\r\n                                            Fim: {new Date(theme.deadline).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Actions - Positioned on the right */}\r\n                        {/* Actions - Positioned on the right */}\r\n                        <div className=\"flex gap-1.5 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none group-hover:pointer-events-auto\">\r\n                            <button\r\n                                onClick={(e) => { e.stopPropagation(); onEdit(); }}\r\n                                className=\"w-8 h-8 flex items-center justify-center bg-slate-950/40 hover:bg-blue-600/80 backdrop-blur-md rounded-full text-slate-400 hover:text-white transition-all duration-200 border border-white/5 hover:border-blue-400/50 shadow-sm\"\r\n                                title=\"Editar tema\"\r\n                            >\r\n                                <Pencil className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                            <button\r\n                                onClick={(e) => { e.stopPropagation(); onDelete(); }}\r\n                                className=\"w-8 h-8 flex items-center justify-center bg-slate-950/40 hover:bg-red-600/80 backdrop-blur-md rounded-full text-slate-400 hover:text-white transition-all duration-200 border border-white/5 hover:border-red-400/50 shadow-sm\"\r\n                                title=\"Excluir tema\"\r\n                            >\r\n                                <Trash2 className=\"w-3.5 h-3.5\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Body Content (Progress + Subthemes) - Kept but styled comfortably below header */}\r\n                <div className=\"relative px-6 pb-6 space-y-6\">\r\n\r\n                    {/* Progress Bar */}\r\n                    <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between items-center text-xs px-1\">\r\n                            <span className=\"text-slate-500 font-bold uppercase tracking-wider\">Progresso</span>\r\n                            <span className=\"text-slate-300 font-bold\">{Math.round(progress)}%</span>\r\n                        </div>\r\n                        <div className=\"h-1.5 bg-slate-900 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className=\"h-full rounded-full transition-all duration-1000 ease-out relative group-hover:shadow-[0_0_12px_rgba(255,255,255,0.3)]\"\r\n                                style={{ width: `${progress}%`, background: themeColor }}\r\n                            >\r\n                                <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent w-full -translate-x-full animate-[shimmer_2s_infinite]\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Subthemes List (Grouped by Modules) */}\r\n                    <div className=\"space-y-3 max-h-[260px] overflow-y-auto custom-scrollbar pr-1\">\r\n                        {(() => {\r\n                            const groups: { module: Subtheme | null, items: Subtheme[] }[] = [];\r\n                            let currentGroup: { module: Subtheme | null, items: Subtheme[] } | null = null;\r\n\r\n                            theme.subthemes.forEach(sub => {\r\n                                if (sub.difficulty === 'module') {\r\n                                    currentGroup = { module: sub, items: [] };\r\n                                    groups.push(currentGroup);\r\n                                } else {\r\n                                    if (!currentGroup) {\r\n                                        currentGroup = { module: null, items: [] };\r\n                                        groups.push(currentGroup);\r\n                                    }\r\n                                    currentGroup.items.push(sub);\r\n                                }\r\n                            });\r\n\r\n                            return groups.map((group, gIdx) => (\r\n                                <div key={gIdx} className=\"space-y-1.5\">\r\n                                    {group.module && (\r\n                                        <SubthemeItem\r\n                                            sub={group.module}\r\n                                            themeColor={themeColor}\r\n                                            onOpenNotes={onOpenNotes}\r\n                                            unlockedSubthemes={unlockedSubthemes}\r\n                                        />\r\n                                    )}\r\n                                    <div className={cn(\"space-y-1.5\", group.module && \"pl-2 border-l border-white/5 ml-1\")}>\r\n                                        {group.items.map(sub => (\r\n                                            <SubthemeItem\r\n                                                key={sub.id}\r\n                                                sub={sub}\r\n                                                themeColor={themeColor}\r\n                                                projectedStart={queuedSubthemesMap.get(sub.id)}\r\n                                                onOpenNotes={onOpenNotes}\r\n                                                unlockedSubthemes={unlockedSubthemes}\r\n                                            />\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            ));\r\n                        })()}\r\n                        {theme.subthemes.length === 0 && (\r\n                            <div className=\"py-6 text-center border border-dashed border-slate-800 rounded-xl bg-slate-900/30\">\r\n                                <p className=\"text-slate-500 text-xs\">Sem mdulos ainda</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useDashboardData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useDevice.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useDevice.ts:13:9\n  11 |         // Detect iOS\n  12 |         const ios = /iphone|ipad|ipod/.test(userAgent);\n> 13 |         setIsIOS(ios);\n     |         ^^^^^^^^ Avoid calling setState() directly within an effect\n  14 |\n  15 |         // Detect Android\n  16 |         const android = /android/.test(userAgent);","line":13,"column":9,"nodeType":null,"endLine":13,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[686,689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[686,689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\nexport const useDevice = () => {\r\n    const [isIOS, setIsIOS] = useState(false);\r\n    const [isAndroid, setIsAndroid] = useState(false);\r\n    const [isPWA, setIsPWA] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const userAgent = window.navigator.userAgent.toLowerCase();\r\n\r\n        // Detect iOS\r\n        const ios = /iphone|ipad|ipod/.test(userAgent);\r\n        setIsIOS(ios);\r\n\r\n        // Detect Android\r\n        const android = /android/.test(userAgent);\r\n        setIsAndroid(android);\r\n\r\n        // Detect PWA Mode\r\n        const isStandalone = window.matchMedia('(display-mode: standalone)').matches || (window.navigator as any).standalone === true;\r\n        setIsPWA(isStandalone);\r\n\r\n    }, []);\r\n\r\n    return {\r\n        isIOS,\r\n        isAndroid,\r\n        isPWA,\r\n        isMobile: isIOS || isAndroid,\r\n        // Helper classes for Safe Area\r\n        safeAreaTopClass: isIOS && isPWA ? 'pt-[env(safe-area-inset-top)]' : '',\r\n        safeAreaBottomClass: isIOS && isPWA ? 'pb-[env(safe-area-inset-bottom)]' : '',\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useGoals.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[592,595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[592,595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'gamification' is defined but never used.","line":19,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateStats' is defined but never used.","line":19,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":91,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":23}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport type { Goal } from '../types';\r\nimport type { GamificationState, GameStats } from '../types/gamification';\r\nimport { GoalSchema } from '../lib/validation';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\nimport { XP_VALUES } from '../config/gamification';\r\nimport { celebrate } from '../utils/celebration';\r\nimport { format } from 'date-fns';\r\nimport { useToast } from '../context/ToastContext';\r\nimport { addGoalProgressSummary, addCompletionSummary } from '../utils/summaries';\r\n\r\ninterface UseGoalsProps {\r\n    user: any;\r\n    gamification: GamificationState;\r\n    awardXP: (amount: number) => void;\r\n    updateStats: (updates: Partial<GameStats>) => void;\r\n}\r\n\r\nexport const useGoals = ({ user, gamification, awardXP, updateStats }: UseGoalsProps) => {\r\n    const { showToast } = useToast();\r\n    const [goals, setGoals] = useState<Goal[]>(() => {\r\n        try {\r\n            const saved = localStorage.getItem('study_goals_backup');\r\n            return saved ? JSON.parse(saved) : [];\r\n        } catch (e) {\r\n            console.error(\"Failed to parse study_goals_backup\", e);\r\n            return [];\r\n        }\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('study_goals_backup', JSON.stringify(goals));\r\n    }, [goals]);\r\n\r\n    const addGoal = async (goal: Omit<Goal, 'id' | 'progress' | 'createdAt'>) => {\r\n        if (!user) {\r\n            showToast(\"Erro: Usurio no identificado.\", \"error\");\r\n            return;\r\n        }\r\n        // Validation\r\n        const val = GoalSchema.omit({ id: true, progress: true }).safeParse(goal);\r\n        if (!val.success) {\r\n            showToast(\"Erro: \" + val.error.issues[0].message, \"error\");\r\n            return;\r\n        }\r\n\r\n        const newGoal: Goal = {\r\n            ...goal,\r\n            id: crypto.randomUUID(),\r\n            createdAt: Date.now(),\r\n            progress: 0,\r\n            completionHistory: [],\r\n            sessions: [],\r\n            timeSpent: 0\r\n        };\r\n\r\n        // 1. Optimistic Update\r\n        const updatedGoals = [...goals, newGoal];\r\n        setGoals(updatedGoals);\r\n\r\n        awardXP(XP_VALUES.GOAL * 0.1);\r\n\r\n        // 2. Queue Sync\r\n        SyncQueueService.enqueue({\r\n            type: 'ADD',\r\n            table: 'goals',\r\n            data: { ...newGoal, user_id: user.id }\r\n        });\r\n\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        if (newGoal.startDate && newGoal.startDate > todayStr) {\r\n            showToast(`Meta agendada para iniciar em ${format(new Date(newGoal.startDate + 'T00:00:00'), 'dd/MM')}!`, \"success\");\r\n        } else {\r\n            showToast(\"Meta criada com sucesso!\", \"success\");\r\n        }\r\n    };\r\n\r\n    const deleteGoal = async (goalId: string) => {\r\n        // Optimistic Update\r\n        const previousGoals = [...goals];\r\n        setGoals(prev => prev.filter(g => g.id !== goalId));\r\n        showToast(\"Meta excluda com sucesso!\", \"success\");\r\n\r\n        try {\r\n            // Queue Sync\r\n            SyncQueueService.enqueue({\r\n                type: 'DELETE',\r\n                table: 'goals',\r\n                data: { id: goalId }\r\n            });\r\n        } catch (error) {\r\n            setGoals(previousGoals);\r\n            showToast(\"Erro ao excluir meta.\", \"error\");\r\n        }\r\n    };\r\n\r\n    const updateGoal = async (id: string, updates: Partial<Goal>) => {\r\n        // Validation\r\n        const val = GoalSchema.partial().safeParse(updates);\r\n        if (!val.success) {\r\n            showToast(\"Erro: Dados invlidos.\", \"error\");\r\n            return;\r\n        }\r\n\r\n        // Se o progresso foi atualizado, adicionar resumo\r\n        if (updates.progress !== undefined) {\r\n            const currentGoal = goals.find(g => g.id === id);\r\n            if (currentGoal && currentGoal.progress !== updates.progress) {\r\n                const currentSummaries = currentGoal.summaries || [];\r\n                updates.summaries = addGoalProgressSummary(\r\n                    currentSummaries,\r\n                    updates.progress,\r\n                    `Progresso atualizado de ${Math.round(currentGoal.progress)}% para ${Math.round(updates.progress)}%`\r\n                );\r\n            }\r\n        }\r\n\r\n        setGoals(prev => prev.map(g => g.id === id ? { ...g, ...updates } : g));\r\n\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'goals',\r\n            data: { id, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    const toggleGoal = async (goalId: string, dateStr?: string, summaryText?: string) => {\r\n        const goal = goals.find(g => g.id === goalId);\r\n        if (!goal) return;\r\n\r\n        const now = new Date();\r\n        const todayStr = format(now, 'yyyy-MM-dd');\r\n        const date = dateStr || todayStr;\r\n\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        if (date > todayStr) {\r\n            showToast(\"Voc no pode concluir atividades de dias futuros!\", \"error\");\r\n            return;\r\n        }\r\n        let updates: Partial<Goal> = {};\r\n        let xpAwarded = 0;\r\n        let isCompletedAction = false;\r\n\r\n        // Check history for ALL goal types to prevent XP farming\r\n        const history = goal.completionHistory || [];\r\n        const hasCompletedTargetDate = history.some(d => d.startsWith(date));\r\n\r\n        if (goal.type === 'habit') {\r\n            let newHistory;\r\n            if (hasCompletedTargetDate) {\r\n                // Uncheck: Deduct XP\r\n                newHistory = history.filter(d => !d.startsWith(date));\r\n                xpAwarded = -(XP_VALUES.GOAL / 5);\r\n            } else {\r\n                // Check\r\n                const completionIso = new Date().toISOString();\r\n                newHistory = [...history, completionIso];\r\n                xpAwarded = XP_VALUES.GOAL / 5;\r\n                isCompletedAction = true;\r\n            }\r\n            updates = { completionHistory: newHistory };\r\n\r\n            // Update progress for UI\r\n            const isCompletedToday = !hasCompletedTargetDate;\r\n            updates.progress = isCompletedToday ? 100 : 0;\r\n\r\n            // Adicionar resumo para hbitos\r\n            if (isCompletedAction) {\r\n                const currentSummaries = goal.summaries || [];\r\n                updates.summaries = addCompletionSummary(\r\n                    currentSummaries,\r\n                    summaryText || `Hbito \"${goal.title}\" concludo em ${format(now, 'dd/MM/yyyy \\'s\\' HH:mm')}`\r\n                );\r\n            }\r\n\r\n        } else {\r\n            // Standard Goal\r\n            const isComplete = goal.progress >= 100;\r\n\r\n            if (isComplete) {\r\n                updates = { progress: 0 };\r\n                xpAwarded = -XP_VALUES.GOAL;\r\n            } else {\r\n                updates = { progress: 100 };\r\n\r\n                if (!hasCompletedTargetDate) {\r\n                    const completionIso = new Date().toISOString();\r\n                    updates.completionHistory = [...history, completionIso];\r\n                    xpAwarded = XP_VALUES.GOAL;\r\n                    isCompletedAction = true;\r\n\r\n                    // Adicionar resumo para metas padro\r\n                    const currentSummaries = goal.summaries || [];\r\n                    updates.summaries = addCompletionSummary(\r\n                        currentSummaries,\r\n                        summaryText || `Meta \"${goal.title}\" concluda com sucesso! `\r\n                    );\r\n                }\r\n            }\r\n        }\r\n\r\n        // 1. Optimistic Update\r\n        setGoals(prev => prev.map(g => g.id === goalId ? { ...g, ...updates } : g));\r\n\r\n        // 2. Side Effects\r\n        if (xpAwarded !== 0) {\r\n            awardXP(xpAwarded);\r\n        }\r\n        if (isCompletedAction) {\r\n            celebrate();\r\n        }\r\n\r\n        // 3. Queue Sync\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'goals',\r\n            data: { id: goalId, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    const toggleGoalItem = async (goalId: string, itemId: string, dateStr?: string, summaryText?: string) => {\r\n        const goal = goals.find(g => g.id === goalId);\r\n        if (!goal || !goal.checklist) return;\r\n\r\n        const now = new Date();\r\n        const todayStr = format(now, 'yyyy-MM-dd');\r\n        const date = dateStr || todayStr;\r\n\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        if (date > todayStr) {\r\n            showToast(\"Voc no pode concluir atividades de dias futuros!\", \"error\");\r\n            return;\r\n        }\r\n\r\n        const updatedChecklist = goal.checklist.map(item => {\r\n            if (item.id === itemId) {\r\n                const isNowCompleted = !item.completed;\r\n                return {\r\n                    ...item,\r\n                    completed: isNowCompleted,\r\n                    completedAt: isNowCompleted ? new Date().toISOString() : undefined\r\n                };\r\n            }\r\n            return item;\r\n        });\r\n\r\n        const totalItems = updatedChecklist.length;\r\n        const completedItems = updatedChecklist.filter(i => i.completed).length;\r\n        const newProgress = totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;\r\n\r\n        const updates: Partial<Goal> = {\r\n            checklist: updatedChecklist,\r\n            progress: newProgress\r\n        };\r\n\r\n        // Add summary if item completed\r\n        const completedItem = updatedChecklist.find(i => i.id === itemId);\r\n        if (completedItem?.completed) {\r\n            const currentSummaries = goal.summaries || [];\r\n            updates.summaries = addGoalProgressSummary(\r\n                currentSummaries,\r\n                newProgress,\r\n                summaryText || `Item \"${completedItem.title}\" concludo! (${newProgress}%)`\r\n            );\r\n        }\r\n\r\n        // 1. Optimistic Update\r\n        setGoals(prev => prev.map(g => g.id === goalId ? { ...g, ...updates } : g));\r\n\r\n        // 2. Award XP if completing an item\r\n        const item = updatedChecklist.find(i => i.id === itemId);\r\n        if (item?.completed) {\r\n            awardXP(XP_VALUES.GOAL / 10);\r\n        }\r\n\r\n        // 3. Queue Sync\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'goals',\r\n            data: { id: goalId, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    return {\r\n        goals,\r\n        setGoals,\r\n        addGoal,\r\n        updateGoal,\r\n        deleteGoal,\r\n        toggleGoal,\r\n        toggleGoalItem\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useLayoutModals.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1645,1648],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1645,1648],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useLayoutModals.ts:68:13\n  66 |             setIsSummaryModalOpen(false);\n  67 |             setIsMissionModalOpen(false);\n> 68 |             setIsTaskModalOpen(false);\n     |             ^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  69 |             setIsGoalModalOpen(false);\n  70 |             setIsThemeModalOpen(false);\n  71 |             setIsSidebarOpen(false);","line":68,"column":13,"nodeType":null,"endLine":68,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setIsMissionModalOpen'. Either include it or remove the dependency array. If 'setIsMissionModalOpen' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":76,"column":8,"nodeType":"ArrayExpression","endLine":76,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [activeFocus, setIsMissionModalOpen, setIsSummaryModalOpen]","fix":{"range":[3297,3333],"text":"[activeFocus, setIsMissionModalOpen, setIsSummaryModalOpen]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useStudy } from '../context/StudyContext';\r\nimport type { Goal, Theme } from '../types';\r\n\r\nexport const useLayoutModals = (\r\n    activeFocus: boolean,\r\n    setIsSummaryModalOpen: (isOpen: boolean) => void,\r\n    isMissionModalOpen: boolean,\r\n    setIsMissionModalOpen: (isOpen: boolean) => void\r\n) => {\r\n    const { user } = useAuth();\r\n    const { themes, goals, tasks } = useStudy();\r\n\r\n    // Modals\r\n    const [isTaskModalOpen, setIsTaskModalOpen] = useState(false);\r\n    const [isGoalModalOpen, setIsGoalModalOpen] = useState(false);\r\n    const [isThemeModalOpen, setIsThemeModalOpen] = useState(false);\r\n    const [isSidebarOpen, setIsSidebarOpen] = useState(false);\r\n    const [isOnboardingOpen, setIsOnboardingOpen] = useState(false);\r\n\r\n    // Edit states\r\n    const [goalToEdit, setGoalToEdit] = useState<undefined | Goal>(undefined);\r\n    const [themeToEdit, setThemeToEdit] = useState<undefined | Theme>(undefined);\r\n    const [preselectedThemeId, setPreselectedThemeId] = useState<undefined | string>(undefined);\r\n    const [themeCategory, setThemeCategory] = useState<'study' | 'project'>('study');\r\n    const [defaultGoalType, setDefaultGoalType] = useState<'simple' | 'checklist' | 'habit'>('simple');\r\n\r\n    const handleEditGoal = (goal: Goal) => {\r\n        setGoalToEdit(goal);\r\n        setIsGoalModalOpen(true);\r\n        setIsSummaryModalOpen(false);\r\n    };\r\n\r\n    const handleEditTheme = (theme: Theme) => {\r\n        setThemeToEdit(theme);\r\n        // Determine category from theme\r\n        setThemeCategory((theme as any).category || 'study');\r\n        setIsThemeModalOpen(true);\r\n        setIsSummaryModalOpen(false);\r\n    };\r\n\r\n    const handleOpenGoalModalWithTheme = (themeId: string) => {\r\n        setPreselectedThemeId(themeId);\r\n        setGoalToEdit(undefined); // Ensure we are not editing\r\n        setIsGoalModalOpen(true);\r\n        setIsSummaryModalOpen(false); // Close summary to focus on creation\r\n    };\r\n\r\n    // Onboarding Trigger\r\n    useEffect(() => {\r\n        const isCompletelyEmpty = themes.length === 0 && goals.length === 0 && tasks.length === 0;\r\n        const isDismissed = localStorage.getItem('onboarding_dismissed') === 'true';\r\n\r\n        const timer = setTimeout(() => {\r\n            if (user && !isDismissed && (user.name === 'User' || user.name === undefined || isCompletelyEmpty)) {\r\n                setIsOnboardingOpen(true);\r\n            }\r\n        }, 1000);\r\n        return () => clearTimeout(timer);\r\n    }, [user, themes.length, goals.length, tasks.length]);\r\n\r\n    // Auto-close overlaying UI when Focus Mode starts\r\n    useEffect(() => {\r\n        if (activeFocus) {\r\n            setIsSummaryModalOpen(false);\r\n            setIsMissionModalOpen(false);\r\n            setIsTaskModalOpen(false);\r\n            setIsGoalModalOpen(false);\r\n            setIsThemeModalOpen(false);\r\n            setIsSidebarOpen(false);\r\n            // Note: isMobileMenuOpen logic remains in component or needs to be passed here if managed here\r\n            // But MobileMenu logic was in MainLayout state: [isMobileMenuOpen, setIsMobileMenuOpen] \r\n            // We should probably include it here to centralize ALL overlay UI state.\r\n        }\r\n    }, [activeFocus, setIsSummaryModalOpen]);\r\n\r\n\r\n    return {\r\n        state: {\r\n            isTaskModalOpen,\r\n            isGoalModalOpen,\r\n            isThemeModalOpen,\r\n            isMissionModalOpen,\r\n            isSidebarOpen,\r\n            isOnboardingOpen,\r\n            goalToEdit,\r\n            themeToEdit,\r\n            preselectedThemeId,\r\n            themeCategory,\r\n            defaultGoalType\r\n        },\r\n        actions: {\r\n            setIsTaskModalOpen,\r\n            setIsGoalModalOpen,\r\n            setIsThemeModalOpen,\r\n            setIsMissionModalOpen,\r\n            setIsSidebarOpen,\r\n            setIsOnboardingOpen,\r\n            setGoalToEdit,\r\n            setThemeToEdit,\r\n            setPreselectedThemeId,\r\n            setThemeCategory,\r\n            setDefaultGoalType,\r\n            handleEditGoal,\r\n            handleEditTheme,\r\n            handleOpenGoalModalWithTheme\r\n        }\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useLocalStorage.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useLocalStorage.ts:42:9\n  40 |\n  41 |     useEffect(() => {\n> 42 |         setStoredValue(readValue());\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  43 |     }, [key]);\n  44 |\n  45 |     return [storedValue, setValue] as const;","line":42,"column":9,"nodeType":null,"endLine":42,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'readValue'. Either include it or remove the dependency array.","line":43,"column":8,"nodeType":"ArrayExpression","endLine":43,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [key, readValue]","fix":{"range":[1530,1535],"text":"[key, readValue]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\nexport function useLocalStorage<T>(key: string, initialValue: T) {\r\n    // Get from local storage then\r\n    // parse stored json or return initialValue\r\n    const readValue = () => {\r\n        if (typeof window === 'undefined') {\r\n            return initialValue;\r\n        }\r\n\r\n        try {\r\n            const item = window.localStorage.getItem(key);\r\n            if (!item) return initialValue;\r\n            const parsed = JSON.parse(item);\r\n            return parsed !== null ? parsed : initialValue;\r\n        } catch (error) {\r\n            console.warn(`Error reading localStorage key ${key}:`, error);\r\n            return initialValue;\r\n        }\r\n    };\r\n\r\n    const [storedValue, setStoredValue] = useState<T>(readValue);\r\n\r\n    // Return a wrapped version of useState's setter function that ...\r\n    // ... persists the new value to localStorage.\r\n    const setValue = (value: T | ((val: T) => T)) => {\r\n        try {\r\n            // Allow value to be a function so we have same API as useState\r\n            const valueToStore = value instanceof Function ? value(storedValue) : value;\r\n\r\n            setStoredValue(valueToStore);\r\n\r\n            if (typeof window !== 'undefined') {\r\n                window.localStorage.setItem(key, JSON.stringify(valueToStore));\r\n            }\r\n        } catch (error) {\r\n            console.warn(`Error setting localStorage key ${key}:`, error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        setStoredValue(readValue());\r\n    }, [key]);\r\n\r\n    return [storedValue, setValue] as const;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useOptimization.ts","messages":[{"ruleId":"react-hooks/use-memo","severity":2,"message":"Error: Expected the first argument to be an inline function expression\n\nExpected the first argument to be an inline function expression.\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useOptimization.ts:36:9\n  34 |\n  35 |     return useCallback(\n> 36 |         ((...args) => {\n     |         ^^^^^^^^^^^^^^^\n> 37 |             if (Date.now() - lastRan.current >= delay) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |                 callback(...args);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |                 lastRan.current = Date.now();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |             }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |         }) as T,\n     | ^^^^^^^^^^^^^^^^ Expected the first argument to be an inline function expression\n  42 |         [callback, delay]\n  43 |     );\n  44 | }","line":36,"column":9,"nodeType":null,"endLine":41,"endColumn":16},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useOptimization.ts:82:9\n  80 |\n  81 |         // Set initial value\n> 82 |         setMatches(mediaQuery.matches);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  83 |\n  84 |         // Listen for changes\n  85 |         if (mediaQuery.addEventListener) {","line":82,"column":9,"nodeType":null,"endLine":82,"endColumn":19},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useOptimization.ts:132:12\n  130 |     }, [value]);\n  131 |\n> 132 |     return ref.current;\n      |            ^^^^^^^^^^^ Cannot access ref value during render\n  133 | }\n  134 |\n  135 | /**","line":132,"column":12,"nodeType":null,"endLine":132,"endColumn":23},{"ruleId":"react-hooks/use-memo","severity":2,"message":"Error: Expected the first argument to be an inline function expression\n\nExpected the first argument to be an inline function expression.\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useOptimization.ts:148:24\n  146 |     }, [fn]);\n  147 |\n> 148 |     return useCallback(((...args) => ref.current(...args)) as T, []);\n      |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Expected the first argument to be an inline function expression\n  149 | }\n  150 |\n  151 | /**","line":148,"column":24,"nodeType":null,"endLine":148,"endColumn":64}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useRef, useCallback } from 'react';\r\n\r\n/**\r\n * Hook for debouncing values to reduce unnecessary re-renders and API calls\r\n * @param value - The value to debounce\r\n * @param delay - Delay in milliseconds (default: 500ms)\r\n */\r\nexport function useDebounce<T>(value: T, delay: number = 500): T {\r\n    const [debouncedValue, setDebouncedValue] = useState<T>(value);\r\n\r\n    useEffect(() => {\r\n        const handler = setTimeout(() => {\r\n            setDebouncedValue(value);\r\n        }, delay);\r\n\r\n        return () => {\r\n            clearTimeout(handler);\r\n        };\r\n    }, [value, delay]);\r\n\r\n    return debouncedValue;\r\n}\r\n\r\n/**\r\n * Hook for throttling function calls\r\n * @param callback - Function to throttle\r\n * @param delay - Delay in milliseconds (default: 500ms)\r\n */\r\nexport function useThrottle<T extends (...args: unknown[]) => unknown>(\r\n    callback: T,\r\n    delay: number = 500\r\n): T {\r\n    const lastRan = useRef(Date.now());\r\n\r\n    return useCallback(\r\n        ((...args) => {\r\n            if (Date.now() - lastRan.current >= delay) {\r\n                callback(...args);\r\n                lastRan.current = Date.now();\r\n            }\r\n        }) as T,\r\n        [callback, delay]\r\n    );\r\n}\r\n\r\n/**\r\n * Hook to track if component is mounted\r\n * Useful for preventing state updates on unmounted components\r\n */\r\nexport function useIsMounted(): () => boolean {\r\n    const isMounted = useRef(false);\r\n\r\n    useEffect(() => {\r\n        isMounted.current = true;\r\n        return () => {\r\n            isMounted.current = false;\r\n        };\r\n    }, []);\r\n\r\n    return useCallback(() => isMounted.current, []);\r\n}\r\n\r\n/**\r\n * Hook for media queries\r\n * @param query - Media query string\r\n */\r\nexport function useMediaQuery(query: string): boolean {\r\n    const [matches, setMatches] = useState(() => {\r\n        if (typeof window !== 'undefined') {\r\n            return window.matchMedia(query).matches;\r\n        }\r\n        return false;\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (typeof window === 'undefined') return;\r\n\r\n        const mediaQuery = window.matchMedia(query);\r\n        const handler = (event: MediaQueryListEvent) => setMatches(event.matches);\r\n\r\n        // Set initial value\r\n        setMatches(mediaQuery.matches);\r\n\r\n        // Listen for changes\r\n        if (mediaQuery.addEventListener) {\r\n            mediaQuery.addEventListener('change', handler);\r\n            return () => mediaQuery.removeEventListener('change', handler);\r\n        } else {\r\n            // Fallback for older browsers\r\n            mediaQuery.addListener(handler);\r\n            return () => mediaQuery.removeListener(handler);\r\n        }\r\n    }, [query]);\r\n\r\n    return matches;\r\n}\r\n\r\n/**\r\n * Hook for detecting clicks outside an element\r\n * @param callback - Function to call when clicking outside\r\n */\r\nexport function useClickOutside<T extends HTMLElement = HTMLElement>(\r\n    callback: () => void\r\n): React.RefObject<T | null> {\r\n    const ref = useRef<T | null>(null);\r\n\r\n    useEffect(() => {\r\n        const handleClick = (event: MouseEvent) => {\r\n            if (ref.current && !ref.current.contains(event.target as Node)) {\r\n                callback();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('mousedown', handleClick);\r\n        return () => document.removeEventListener('mousedown', handleClick);\r\n    }, [callback]);\r\n\r\n    return ref;\r\n}\r\n\r\n/**\r\n * Hook for managing previous value\r\n * @param value - Current value\r\n */\r\nexport function usePrevious<T>(value: T): T | undefined {\r\n    const ref = useRef<T | undefined>(undefined);\r\n\r\n    useEffect(() => {\r\n        ref.current = value;\r\n    }, [value]);\r\n\r\n    return ref.current;\r\n}\r\n\r\n/**\r\n * Hook for creating a stable callback that doesn't change between renders\r\n * Similar to useCallback but doesn't require dependencies\r\n */\r\nexport function useEventCallback<T extends (...args: unknown[]) => unknown>(\r\n    fn: T\r\n): T {\r\n    const ref = useRef(fn);\r\n\r\n    useEffect(() => {\r\n        ref.current = fn;\r\n    }, [fn]);\r\n\r\n    return useCallback(((...args) => ref.current(...args)) as T, []);\r\n}\r\n\r\n/**\r\n * Hook for local storage with state synchronization\r\n * @param key - Storage key\r\n * @param initialValue - Initial value if key doesn't exist\r\n */\r\nexport function useLocalStorage<T>(\r\n    key: string,\r\n    initialValue: T\r\n): [T, (value: T | ((val: T) => T)) => void] {\r\n    // State to store our value\r\n    const [storedValue, setStoredValue] = useState<T>(() => {\r\n        if (typeof window === 'undefined') {\r\n            return initialValue;\r\n        }\r\n        try {\r\n            const item = window.localStorage.getItem(key);\r\n            return item ? JSON.parse(item) : initialValue;\r\n        } catch (error) {\r\n            console.error(`Error reading localStorage key \"${key}\":`, error);\r\n            return initialValue;\r\n        }\r\n    });\r\n\r\n    // Return a wrapped version of useState's setter function that persists to localStorage\r\n    const setValue = useCallback(\r\n        (value: T | ((val: T) => T)) => {\r\n            try {\r\n                // Allow value to be a function so we have same API as useState\r\n                const valueToStore = value instanceof Function ? value(storedValue) : value;\r\n                setStoredValue(valueToStore);\r\n                if (typeof window !== 'undefined') {\r\n                    window.localStorage.setItem(key, JSON.stringify(valueToStore));\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error setting localStorage key \"${key}\":`, error);\r\n            }\r\n        },\r\n        [key, storedValue]\r\n    );\r\n\r\n    return [storedValue, setValue];\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\usePomodoro.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\usePomodoro.ts:64:13\n  62 |             }, 1000);\n  63 |         } else if (timeLeft === 0) {\n> 64 |             handleTimerComplete();\n     |             ^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  65 |         }\n  66 |\n  67 |         return () => clearInterval(interval);","line":64,"column":13,"nodeType":null,"endLine":64,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, useCallback } from 'react';\r\n\r\ntype Mode = 'focus' | 'shortBreak' | 'longBreak';\r\n\r\nconst SETTINGS = {\r\n    focus: 25 * 60,\r\n    shortBreak: 5 * 60,\r\n    longBreak: 15 * 60,\r\n    cyclesForLongBreak: 4,\r\n};\r\n\r\nexport const usePomodoro = () => {\r\n    const [mode, setMode] = useState<Mode>('focus');\r\n    const [timeLeft, setTimeLeft] = useState(SETTINGS.focus);\r\n    const [isActive, setIsActive] = useState(false);\r\n    const [cycles, setCycles] = useState(0);\r\n\r\n    // Audio ref (we'll create an Audio object)\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n    useEffect(() => {\r\n        audioRef.current = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3'); // Simple clear bell\r\n    }, []);\r\n\r\n    const playSound = useCallback(() => {\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = 0;\r\n            audioRef.current.play().catch(() => { });\r\n        }\r\n    }, []);\r\n\r\n    const switchMode = useCallback((nextMode: Mode) => {\r\n        setMode(nextMode);\r\n        setTimeLeft(SETTINGS[nextMode]);\r\n        setIsActive(false);\r\n    }, []);\r\n\r\n    const handleTimerComplete = useCallback(() => {\r\n        playSound();\r\n\r\n        if (mode === 'focus') {\r\n            const newCycles = cycles + 1;\r\n            setCycles(newCycles);\r\n\r\n            if (newCycles % SETTINGS.cyclesForLongBreak === 0) {\r\n                switchMode('longBreak');\r\n            } else {\r\n                switchMode('shortBreak');\r\n            }\r\n        } else {\r\n            // Break is over, back to work!\r\n            switchMode('focus');\r\n        }\r\n    }, [mode, cycles, playSound, switchMode]);\r\n\r\n    useEffect(() => {\r\n        let interval: ReturnType<typeof setInterval>;\r\n\r\n        if (isActive && timeLeft > 0) {\r\n            interval = setInterval(() => {\r\n                setTimeLeft((time) => time - 1);\r\n            }, 1000);\r\n        } else if (timeLeft === 0) {\r\n            handleTimerComplete();\r\n        }\r\n\r\n        return () => clearInterval(interval);\r\n    }, [isActive, timeLeft, handleTimerComplete]);\r\n\r\n    const toggleTimer = () => setIsActive(!isActive);\r\n\r\n    const resetTimer = () => {\r\n        setIsActive(false);\r\n        setTimeLeft(SETTINGS[mode]);\r\n    };\r\n\r\n    const skipTimer = () => {\r\n        handleTimerComplete();\r\n    };\r\n\r\n    return {\r\n        mode,\r\n        timeLeft,\r\n        isActive,\r\n        cycles,\r\n        toggleTimer,\r\n        resetTimer,\r\n        skipTimer,\r\n        settings: SETTINGS\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useSRSLogic.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[838,841],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[838,841],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1727,1730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1727,1730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { format, addDays } from 'date-fns';\r\nimport { parseLocalDate } from '../utils/dateHelpers';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport type { Theme } from '../types';\r\n\r\nexport const useSRSLogic = () => {\r\n    // Helper to generate SRS dates (Legacy/Projected)\r\n    const generateProjectedReviews = (startDate: string) => {\r\n        const offsets = [1, 3, 10, 18, 33];\r\n        return offsets.map((offset, idx) => ({\r\n            number: idx + 1,\r\n            date: format(addDays(parseLocalDate(startDate), offset), 'yyyy-MM-dd'),\r\n            status: 'pending' as const,\r\n            isProjected: true\r\n        }));\r\n    };\r\n\r\n    // Helper for Completion Date\r\n    const getThemeCompletionDate = (theme: Theme, queuedSubthemesMap: Map<string, string>) => {\r\n        let maxDate = 0;\r\n        theme.subthemes.forEach((st: any) => {\r\n            let finishDateIdx = st.reviews.length > 0 ? parseLocalDate(st.reviews[st.reviews.length - 1].date).getTime() : 0;\r\n            if (st.status === 'queue') {\r\n                const projStartStr = queuedSubthemesMap.get(st.id);\r\n                if (projStartStr) finishDateIdx = addDays(parseLocalDate(projStartStr), 33).getTime();\r\n            }\r\n            if (finishDateIdx > maxDate) maxDate = finishDateIdx;\r\n        });\r\n        return maxDate === 0 ? null : format(new Date(maxDate), \"d 'de' MMMM\", { locale: ptBR });\r\n    };\r\n\r\n    // Calculate dates for queued items based on \"one new item per day\" rule\r\n    const calculateQueuedDates = (themes: Theme[]) => {\r\n        const today = new Date();\r\n        let queueCounter = 0;\r\n        const queuedSubthemesMap = new Map<string, string>();\r\n        themes.forEach(t => {\r\n            t.subthemes.forEach((st: any) => {\r\n                if (st.status === 'queue') {\r\n                    queueCounter++;\r\n                    const projDate = format(addDays(today, queueCounter), 'yyyy-MM-dd');\r\n                    queuedSubthemesMap.set(st.id, projDate);\r\n                }\r\n            });\r\n        });\r\n        return queuedSubthemesMap;\r\n    };\r\n\r\n    return {\r\n        generateProjectedReviews,\r\n        getThemeCompletionDate,\r\n        calculateQueuedDates\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useTasks.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addSessionSummary' is defined but never used.","line":11,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":49},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[643,646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[643,646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport type { Task } from '../types';\r\nimport type { GamificationState, GameStats } from '../types/gamification';\r\nimport { TaskSchema } from '../lib/validation';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\nimport { XP_VALUES } from '../config/gamification';\r\nimport { celebrate } from '../utils/celebration';\r\nimport { format } from 'date-fns';\r\nimport { parseLocalDate } from '../utils/dateHelpers';\r\nimport { useToast } from '../context/ToastContext';\r\nimport { addCompletionSummary, addSessionSummary } from '../utils/summaries';\r\n\r\ninterface UseTasksProps {\r\n    user: any;\r\n    gamification: GamificationState;\r\n    awardXP: (amount: number) => void;\r\n    updateStats: (updates: Partial<GameStats>) => void;\r\n}\r\n\r\nexport const useTasks = ({ user, gamification, awardXP, updateStats }: UseTasksProps) => {\r\n    const { showToast } = useToast();\r\n    const [tasks, setTasks] = useState<Task[]>(() => {\r\n        const saved = localStorage.getItem('study_tasks_backup');\r\n        return saved ? JSON.parse(saved) : [];\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('study_tasks_backup', JSON.stringify(tasks));\r\n    }, [tasks]);\r\n\r\n    const addTask = async (task: Omit<Task, 'id' | 'createdAt'>) => {\r\n        if (!user) {\r\n            showToast(\"Erro: Usurio no identificado. Tente recarregar a pgina.\", \"error\");\r\n            return;\r\n        }\r\n        // Validation\r\n        const val = TaskSchema.omit({ id: true }).safeParse(task);\r\n        if (!val.success) {\r\n            showToast(\"Erro: \" + val.error.issues[0].message, \"error\");\r\n            return;\r\n        }\r\n\r\n        const taskData = { ...task };\r\n        // If a 'day' task has no date, default to today\r\n        if (taskData.type === 'day' && !taskData.date) {\r\n            taskData.date = format(new Date(), 'yyyy-MM-dd');\r\n        }\r\n        // Validate date for 'day' tasks: cannot be in the future\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        if (taskData.type === 'day' && taskData.date && taskData.date > todayStr) {\r\n            showToast('Data da tarefa no pode ser no futuro.', 'error');\r\n            return;\r\n        }\r\n\r\n        const newTask: Task = {\r\n            ...taskData,\r\n            id: crypto.randomUUID(),\r\n            createdAt: Date.now(),\r\n            status: 'pending',\r\n            completionHistory: [],\r\n            sessions: [],\r\n            timeSpent: 0\r\n        };\r\n\r\n        // 1. Optimistic UI Update\r\n        const updatedTasks = [...tasks, newTask];\r\n        setTasks(updatedTasks);\r\n\r\n        // 2. Queue for Sync\r\n        SyncQueueService.enqueue({\r\n            type: 'ADD',\r\n            table: 'tasks',\r\n            data: { ...newTask, user_id: user.id }\r\n        });\r\n\r\n        awardXP(XP_VALUES.TASK * 0.1);\r\n\r\n        // Use the previously defined todayStr\r\n        const itemDate = newTask.date || (newTask.startDate ? newTask.startDate.split('T')[0] : '');\r\n        if (itemDate > todayStr) {\r\n            showToast(`Misso agendada para ${format(parseLocalDate(itemDate), 'dd/MM')}!`, \"success\");\r\n        } else {\r\n            showToast(\"Misso criada com sucesso!\", \"success\");\r\n        }\r\n    };\r\n\r\n    const updateTask = async (id: string, updates: Partial<Task>) => {\r\n        const val = TaskSchema.partial().safeParse(updates);\r\n        if (!val.success) return;\r\n\r\n        setTasks(prev => prev.map(t => t.id === id ? { ...t, ...updates } : t));\r\n\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'tasks',\r\n            data: { id, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    const deleteTask = async (taskId: string) => {\r\n        // Optimistic UI removal\r\n        const previous = [...tasks];\r\n        setTasks(prev => prev.filter(t => t.id !== taskId));\r\n        showToast('Tarefa excluda com sucesso!', 'success');\r\n        // Queue delete operation\r\n        try {\r\n            SyncQueueService.enqueue({\r\n                type: 'DELETE',\r\n                table: 'tasks',\r\n                data: { id: taskId }\r\n            });\r\n        } catch (error) {\r\n            console.error('Error deleting task:', error);\r\n            // Rollback UI state on failure\r\n            setTasks(previous);\r\n            showToast('Erro ao excluir tarefa.', 'error');\r\n        }\r\n    };\r\n    const toggleTask = async (taskId: string, dateStr?: string, summaryText?: string) => {\r\n        const task = tasks.find(t => t.id === taskId);\r\n        if (!task) return;\r\n\r\n        const now = new Date();\r\n        const todayStr = format(now, 'yyyy-MM-dd');\r\n        const date = dateStr || todayStr;\r\n\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        if (date > todayStr) {\r\n            showToast(\"Voc no pode concluir atividades de dias futuros!\", \"error\");\r\n            return;\r\n        }\r\n        let updates: Partial<Task> = {};\r\n        let xpAwarded = 0;\r\n        let isCompletedAction = false;\r\n\r\n        if (task.type === 'period' || task.type === 'recurring') {\r\n            const history = task.completionHistory || [];\r\n            const hasCompletedTargetDate = history.some(d => d.startsWith(date));\r\n\r\n            let newHistory;\r\n            if (hasCompletedTargetDate) {\r\n                newHistory = history.filter(d => !d.startsWith(date));\r\n            } else {\r\n                const completionIso = `${date}T${format(now, 'HH:mm:ss.SSS')}`;\r\n                newHistory = [...history, completionIso];\r\n                xpAwarded = XP_VALUES.TASK;\r\n                isCompletedAction = true;\r\n            }\r\n            updates = { completionHistory: newHistory };\r\n\r\n            // Adicionar resumo para tarefas de perodo/recorrentes\r\n            if (isCompletedAction) {\r\n                const currentSummaries = task.summaries || [];\r\n                updates.summaries = addCompletionSummary(\r\n                    currentSummaries,\r\n                    summaryText || `Tarefa concluda em ${format(now, 'dd/MM/yyyy \\'s\\' HH:mm')}`\r\n                );\r\n            }\r\n        } else {\r\n            const newStatus = task.status === 'completed' ? 'pending' : 'completed';\r\n            const history = task.completionHistory || [];\r\n            let newHistory = history;\r\n\r\n            if (newStatus === 'completed') {\r\n                const completionIso = `${format(now, 'yyyy-MM-dd')}T${format(now, 'HH:mm:ss.SSS')}`;\r\n                newHistory = [...history, completionIso];\r\n                xpAwarded = XP_VALUES.TASK;\r\n                isCompletedAction = true;\r\n            } else {\r\n                const todayStr = format(now, 'yyyy-MM-dd');\r\n                newHistory = history.filter(h => !h.startsWith(todayStr));\r\n            }\r\n\r\n            updates = {\r\n                status: newStatus,\r\n                completionHistory: newHistory\r\n            };\r\n\r\n            // Adicionar resumo para tarefas simples/dia\r\n            if (newStatus === 'completed') {\r\n                const currentSummaries = task.summaries || [];\r\n                updates.summaries = addCompletionSummary(\r\n                    currentSummaries,\r\n                    summaryText || `Tarefa \"${task.title}\" concluda com sucesso!`\r\n                );\r\n            }\r\n        }\r\n\r\n        // 1. Optimistic Update\r\n        setTasks(prev => prev.map(t => t.id === taskId ? { ...t, ...updates } : t));\r\n\r\n        // 2. Side Effects\r\n        if (isCompletedAction && xpAwarded > 0) {\r\n            awardXP(xpAwarded);\r\n            updateStats({ tasksCompleted: (gamification.stats?.tasksCompleted || 0) + 1 });\r\n            celebrate();\r\n        }\r\n\r\n        // 3. Queue Sync\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'tasks',\r\n            data: { id: taskId, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    return {\r\n        tasks,\r\n        setTasks,\r\n        addTask,\r\n        updateTask,\r\n        deleteTask,\r\n        toggleTask\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\hooks\\useThemes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SummaryEntry' is defined but never used.","line":2,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":52},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1799,1802],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1799,1802],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'subtitle' is assigned a value but never used.","line":79,"column":90,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":98},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is assigned a value but never used.","line":153,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":153,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'durationMinutes' is assigned a value but never used.","line":212,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":212,"endColumn":32}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport type { Theme, Subtheme, Review, SummaryEntry } from '../types';\r\nimport type { GamificationState, GameStats } from '../types/gamification';\r\nimport { SyncQueueService } from '../services/SyncQueueService';\r\nimport { SRSService } from '../services/SRSService';\r\nimport { XP_VALUES } from '../config/gamification';\r\nimport { celebrate } from '../utils/celebration';\r\nimport { format } from 'date-fns';\r\nimport { parseLocalDate } from '../utils/dateHelpers';\r\nimport { useToast } from '../context/ToastContext';\r\nimport { addReviewSummary, addCompletionSummary } from '../utils/summaries';\r\n\r\nconst calculateInitialSubthemeState = (\r\n    startDate: string | undefined,\r\n    idx: number,\r\n    difficulty: string | undefined\r\n) => {\r\n    let introDate: string | undefined = undefined;\r\n    let status: 'queue' | 'active' = 'queue';\r\n    let reviews: Review[] = [];\r\n\r\n    if (startDate && difficulty !== 'module') {\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        const introObj = parseLocalDate(startDate);\r\n        introObj.setDate(introObj.getDate() + idx);\r\n        introDate = format(introObj, 'yyyy-MM-dd');\r\n\r\n        if (idx === 0 && introDate <= todayStr) {\r\n            status = 'active';\r\n        }\r\n\r\n        const offsets = [1, 2, 6, 14, 29];\r\n        reviews = offsets.map((offset, reviewIdx) => {\r\n            const reviewDateObj = new Date(introObj);\r\n            reviewDateObj.setDate(reviewDateObj.getDate() + offset);\r\n            return {\r\n                number: reviewIdx + 1,\r\n                date: format(reviewDateObj, 'yyyy-MM-dd'),\r\n                status: 'pending' as const\r\n            };\r\n        });\r\n    }\r\n\r\n    return { introDate, status, reviews };\r\n};\r\n\r\ninterface UseThemesProps {\r\n    user: any;\r\n    gamification: GamificationState;\r\n    awardXP: (amount: number) => void;\r\n    updateStats: (updates: Partial<GameStats>) => void;\r\n    playSFX: (type: 'success' | 'xp' | 'achievement' | 'levelUp') => void;\r\n}\r\n\r\nexport const useThemes = ({ user, gamification, awardXP, updateStats, playSFX }: UseThemesProps) => {\r\n    const { showToast } = useToast();\r\n    // Local-First State Initialization (Load backup immediately)\r\n    const [themes, setThemes] = useState<Theme[]>(() => {\r\n        try {\r\n            const saved = localStorage.getItem('study_themes_backup');\r\n            if (!saved) return [];\r\n\r\n            const parsedThemes = JSON.parse(saved);\r\n            return parsedThemes;\r\n        } catch (e) {\r\n            console.error(\"Failed to parse study_themes_backup\", e);\r\n            return [];\r\n        }\r\n    });\r\n\r\n    // Persist backups whenever state changes\r\n    useEffect(() => {\r\n        localStorage.setItem('study_themes_backup', JSON.stringify(themes));\r\n    }, [themes]);\r\n\r\n    // Data fetching logic moved to StudyContext\r\n\r\n    const addTheme = async (title: string, subthemesInit: { title: string; duration?: number; difficulty?: 'beginner' | 'intermediate' | 'advanced' | 'module' }[], options: { icon?: string, imageUrl?: string, color?: string, priority?: 'low' | 'medium' | 'high', startDate?: string, subtitle?: string, deadline?: string, category?: 'study' | 'project' } = {}) => {\r\n        const { icon: _icon, imageUrl: _imageUrl, color, priority: _priority, startDate, subtitle, deadline, category } = options;\r\n\r\n        if (!user) {\r\n            console.error(\"Add Theme failed: No user logged in\");\r\n            showToast(\"Erro: Usurio no identificado. Tente recarregar a pgina.\", \"error\");\r\n            return;\r\n        }\r\n        // Validao bsica de datas (formato YYYY-MM-DD)\r\n        const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\r\n        if (startDate && !dateRegex.test(startDate)) {\r\n            showToast('Data de incio invlida. Use o formato YYYY-MM-DD.', 'error');\r\n            return;\r\n        }\r\n        if (deadline && !dateRegex.test(deadline)) {\r\n            showToast('Data de trmino invlida. Use o formato YYYY-MM-DD.', 'error');\r\n            return;\r\n        }\r\n\r\n        // 1. Create Theme Object\r\n        const newThemeId = crypto.randomUUID();\r\n        const newTheme: Theme = {\r\n            id: newThemeId,\r\n            title,\r\n            color,\r\n            createdAt: Date.now(),\r\n            priority: _priority,\r\n            icon: _icon,\r\n            imageUrl: _imageUrl,\r\n            startDate,\r\n            deadline,\r\n            category: category || 'study', // Default to study\r\n            subthemes: []\r\n        };\r\n\r\n        // 2. Create Subthemes Objects\r\n        const newSubthemes: Subtheme[] = subthemesInit.map((s, idx) => {\r\n            const { introDate, status, reviews } = calculateInitialSubthemeState(startDate, idx, s.difficulty);\r\n\r\n            return {\r\n                id: crypto.randomUUID(),\r\n                theme_id: newThemeId,\r\n                title: s.title,\r\n                status,\r\n                introductionDate: introDate,\r\n                reviews: reviews,\r\n                sessions: [],\r\n                durationMinutes: s.duration,\r\n                difficulty: s.difficulty,\r\n                order_index: idx\r\n            };\r\n        });\r\n\r\n        newTheme.subthemes = newSubthemes;\r\n\r\n        // 3. Optimistic Update with Auto-Activation\r\n        try {\r\n            setThemes(prev => {\r\n                const allThemes = [...prev, newTheme];\r\n                // Try to activate immediately if possible\r\n                const today = SRSService.getToday();\r\n                const result = SRSService.processDailyUpdates(allThemes, today);\r\n                return result ? result.updatedThemes : allThemes;\r\n            });\r\n        } catch (e) {\r\n            console.error('Erro ao processar atualizaes dirias:', e);\r\n            // Reverte a insero do tema recm criado\r\n            setThemes(prev => prev.filter(t => t.id !== newThemeId));\r\n            showToast('Erro ao criar tema.', 'error');\r\n            return;\r\n        }\r\n\r\n        // 4. Queue Sync\r\n        // Add Theme\r\n        const themeOpId = crypto.randomUUID();\r\n        const { subthemes: _, ...themeData } = newTheme;\r\n\r\n        SyncQueueService.enqueue({\r\n            id: themeOpId,\r\n            type: 'ADD',\r\n            table: 'themes',\r\n            data: { ...themeData, user_id: user.id }\r\n        });\r\n\r\n        // Add Subthemes (Queue individually)\r\n        newSubthemes.forEach((st, idx) => {\r\n            const { durationMinutes, ...stData } = st;\r\n            SyncQueueService.enqueue({\r\n                type: 'ADD',\r\n                table: 'subthemes',\r\n                dependentOn: themeOpId,\r\n                data: { ...stData, duration_minutes: durationMinutes, user_id: user.id, order_index: idx }\r\n            });\r\n        });\r\n\r\n        const todayStr = format(new Date(), 'yyyy-MM-dd');\r\n        if (startDate && startDate > todayStr) {\r\n            const startDateObj = new Date(startDate + 'T00:00:00');\r\n            if (!isNaN(startDateObj.getTime())) {\r\n                showToast(`Tema agendado para iniciar em ${format(startDateObj, 'dd/MM')}!`, \"success\");\r\n            } else {\r\n                showToast('Data de incio invlida.', 'error');\r\n            }\r\n        } else {\r\n            showToast(\"Tema criado com sucesso!\", \"success\");\r\n        }\r\n    };\r\n\r\n\r\n    const updateTheme = async (id: string, updates: Partial<Theme>) => {\r\n        if (!user) return;\r\n        setThemes(prev => prev.map(t => t.id === id ? { ...t, ...updates } : t));\r\n\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'themes',\r\n            data: { id, ...updates, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    const addSubtheme = async (themeId: string, title: string, duration?: number) => {\r\n        if (!user) return;\r\n        const newSub: Subtheme = {\r\n            id: crypto.randomUUID(),\r\n            theme_id: themeId,\r\n            title,\r\n            status: 'queue',\r\n            reviews: [],\r\n            sessions: [],\r\n            durationMinutes: duration,\r\n        };\r\n\r\n        setThemes(prev => prev.map(t => t.id === themeId ? { ...t, subthemes: [...t.subthemes, newSub] } : t));\r\n\r\n        const { durationMinutes, ...subData } = newSub;\r\n        SyncQueueService.enqueue({\r\n            type: 'ADD',\r\n            table: 'subthemes',\r\n            data: { ...subData, duration_minutes: duration, user_id: user.id }\r\n        });\r\n    };\r\n\r\n    const deleteSubtheme = async (themeId: string, subthemeId: string) => {\r\n        setThemes(prev => prev.map(t => t.id === themeId ? { ...t, subthemes: t.subthemes.filter(st => st.id !== subthemeId) } : t));\r\n        SyncQueueService.enqueue({\r\n            type: 'DELETE',\r\n            table: 'subthemes',\r\n            data: { id: subthemeId }\r\n        });\r\n    };\r\n\r\n    // Delete a theme and all its subthemes, ensuring no leftover data\r\n    const deleteTheme = async (themeId: string) => {\r\n        const previous = [...themes];\r\n        const theme = themes.find(t => t.id === themeId);\r\n        const subIds = theme?.subthemes.map(st => st.id) ?? [];\r\n        // Optimistic UI removal\r\n        setThemes(prev => prev.filter(t => t.id !== themeId));\r\n        showToast('Tema excludo com sucesso!', 'success');\r\n        // Enfileirar excluses em uma nica operao atmica\r\n        try {\r\n            // Excluir tema\r\n            SyncQueueService.enqueue({\r\n                type: 'DELETE',\r\n                table: 'themes',\r\n                data: { id: themeId }\r\n            });\r\n            // Excluir subtemas associados\r\n            subIds.forEach(subId => {\r\n                SyncQueueService.enqueue({\r\n                    type: 'DELETE',\r\n                    table: 'subthemes',\r\n                    data: { id: subId }\r\n                });\r\n            });\r\n        } catch (e) {\r\n            console.error('Erro ao excluir tema ou subtemas:', e);\r\n            // Reverte UI caso algo falhe\r\n            setThemes(previous);\r\n            showToast('Erro ao excluir tema.', 'error');\r\n        }\r\n    };\r\n\r\n    const completeReview = async (\r\n        subthemeId: string,\r\n        reviewNumber: number = 0,\r\n        type: 'review' | 'intro' = 'review',\r\n        difficulty: 'easy' | 'medium' | 'hard' = 'medium',\r\n        summary?: string\r\n    ) => {\r\n        if (!user) return;\r\n\r\n        // PRIORIDADE MXIMA: Bloquear dias futuros\r\n        const now = new Date();\r\n        const todayStr = format(now, 'yyyy-MM-dd');\r\n\r\n        // Centralize subtheme lookup\r\n        const allSubthemes = themes.flatMap(t => t.subthemes);\r\n        const subtheme = allSubthemes.find(st => st.id === subthemeId);\r\n\r\n        if (!subtheme) return;\r\n\r\n        // Check the specific dates\r\n        if (type === 'review') {\r\n            const review = subtheme.reviews.find(r => r.number === reviewNumber);\r\n            if (review && review.date > todayStr) {\r\n                showToast(\"Voc no pode concluir revises de dias futuros!\", \"error\");\r\n                return;\r\n            }\r\n        } else if (type === 'intro') {\r\n            if (subtheme.introductionDate && subtheme.introductionDate > todayStr) {\r\n                showToast(\"Voc no pode iniciar estudos agendados para o futuro!\", \"error\");\r\n                return;\r\n            }\r\n        }\r\n\r\n        let xpAwarded = 0;\r\n        let targetSubtheme: Subtheme | null = null;\r\n\r\n        if (type === 'intro') {\r\n            const updatedThemes = themes.map(t => ({\r\n                ...t,\r\n                subthemes: t.subthemes.map(st => {\r\n                    if (st.id === subthemeId) {\r\n                        const updated: Subtheme = {\r\n                            ...st,\r\n                            status: 'active' as const,\r\n                            introductionDate: format(new Date(), 'yyyy-MM-dd')\r\n                        };\r\n\r\n                        // Adicionar resumo para introduo\r\n                        const currentSummaries = st.summaries || [];\r\n                        updated.summaries = addCompletionSummary(\r\n                            currentSummaries,\r\n                            summary || `Introduo ao tema concluda em ${format(new Date(), 'dd/MM/yyyy \\'s\\' HH:mm')}`\r\n                        );\r\n\r\n                        targetSubtheme = updated;\r\n                        return updated;\r\n                    }\r\n                    return st;\r\n                })\r\n            }));\r\n            setThemes(updatedThemes);\r\n            xpAwarded = XP_VALUES.INTRO;\r\n        } else {\r\n            const { updatedThemes, awarded } = SRSService.completeReview(themes, subthemeId, reviewNumber, difficulty);\r\n            if (awarded) {\r\n                // Adicionar resumo para reviso\r\n                const themesWithSummary = updatedThemes.map(t => ({\r\n                    ...t,\r\n                    subthemes: t.subthemes.map(st => {\r\n                        if (st.id === subthemeId) {\r\n                            const currentSummaries = st.summaries || [];\r\n                            const updatedSt = {\r\n                                ...st,\r\n                                summaries: addReviewSummary(\r\n                                    currentSummaries,\r\n                                    reviewNumber,\r\n                                    summary || `Reviso espaciada ${reviewNumber} concluda com dificuldade ${difficulty === 'easy' ? 'fcil' : difficulty === 'hard' ? 'difcil' : 'mdia'}`\r\n                                )\r\n                            };\r\n                            targetSubtheme = updatedSt;\r\n                            return updatedSt;\r\n                        }\r\n                        return st;\r\n                    })\r\n                }));\r\n\r\n                setThemes(themesWithSummary);\r\n                xpAwarded = XP_VALUES.REVIEW;\r\n            }\r\n        }\r\n\r\n        if (targetSubtheme) {\r\n            const finalSubtheme = targetSubtheme as Subtheme;\r\n\r\n            // Add summary to the specific review if provided\r\n            if (summary && type === 'review') {\r\n                finalSubtheme.reviews = finalSubtheme.reviews.map(r =>\r\n                    r.number === reviewNumber ? { ...r, summary } : r\r\n                );\r\n            }\r\n\r\n            SyncQueueService.enqueue({\r\n                type: 'UPDATE',\r\n                table: 'subthemes',\r\n                data: {\r\n                    id: subthemeId,\r\n                    reviews: finalSubtheme.reviews,\r\n                    status: finalSubtheme.status,\r\n                    introductionDate: finalSubtheme.introductionDate,\r\n                    summaries: finalSubtheme.summaries,\r\n                    user_id: user.id\r\n                }\r\n            });\r\n        }\r\n\r\n        if (xpAwarded > 0) {\r\n            awardXP(xpAwarded);\r\n            playSFX('success');\r\n            updateStats({ reviewsCompleted: (gamification.stats?.reviewsCompleted || 0) + 1 });\r\n            celebrate();\r\n        }\r\n    };\r\n\r\n    const updateSubthemeContent = async (subthemeId: string, content: string) => {\r\n        if (!user) return;\r\n        // Validao de contedo vazio\r\n        if (!content.trim()) {\r\n            showToast('Contedo vazio no pode ser salvo.', 'error');\r\n            return;\r\n        }\r\n        // Optimistic Update\r\n        setThemes(prev => prev.map(t => {\r\n            const found = t.subthemes.some(st => st.id === subthemeId);\r\n            if (found) {\r\n                return {\r\n                    ...t,\r\n                    subthemes: t.subthemes.map(st => st.id === subthemeId ? { ...st, text_content: content } : st)\r\n                };\r\n            }\r\n            return t;\r\n        }));\r\n\r\n        // Sync Queue\r\n        SyncQueueService.enqueue({\r\n            type: 'UPDATE',\r\n            table: 'subthemes',\r\n            data: {\r\n                id: subthemeId,\r\n                text_content: content,\r\n                user_id: user.id\r\n            }\r\n        });\r\n    };\r\n\r\n    return {\r\n        themes,\r\n        setThemes,\r\n        addTheme,\r\n        deleteTheme,\r\n        updateTheme,\r\n        addSubtheme,\r\n        deleteSubtheme,\r\n        completeReview,\r\n        updateSubthemeContent\r\n    };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\layouts\\MainLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Suspense' is defined but never used.","line":1,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'lazy' is defined but never used.","line":1,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Zap' is defined but never used.","line":3,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Sparkles' is defined but never used.","line":4,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Flame' is defined but never used.","line":5,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":10},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luizf\\antigraty\\study-panel\\src\\layouts\\MainLayout.tsx:69:13\n  67 |     useEffect(() => {\n  68 |         if (activeFocus) {\n> 69 |             setIsMobileMenuOpen(false);\n     |             ^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  70 |         }\n  71 |     }, [activeFocus]);\n  72 |","line":69,"column":13,"nodeType":null,"endLine":69,"endColumn":32}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, Suspense, lazy } from 'react';\r\nimport {\r\n    Zap, // Keep if used (actually CheckSquare/Target etc might still be used if passed as props? No, logic moved.)\r\n    Sparkles, // Check usages\r\n    Flame\r\n} from 'lucide-react';\r\n// Removing format, ptBR as well if unused\r\nimport { cn } from '../lib/utils';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useStudy } from '../context/StudyContext';\r\nimport { usePomodoroContext } from '../context/PomodoroContext'; // Added import\r\nimport { useAudio } from '../context/AudioContext';\r\nimport { LayoutModals } from '../components/layout/LayoutModals';\r\nimport { useLayoutModals } from '../hooks/useLayoutModals';\r\nimport { Sidebar } from '../components/layout/Sidebar';\r\nimport { Header } from '../components/layout/Header';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { MobileBottomNav } from '../components/layout/MobileBottomNav';\r\nimport { InstallPWAHint } from '../components/InstallPWAHint';\r\nimport { GlobalActionBar } from '../components/layout/GlobalActionBar';\r\nimport { PomodoroWidget } from '../features/pomodoro/PomodoroWidget';\r\nimport { useDevice } from '../hooks/useDevice';\r\n\r\n\r\ninterface MainLayoutProps {\r\n    children: React.ReactNode;\r\n    isSummaryModalOpen: boolean;\r\n    setIsSummaryModalOpen: (isOpen: boolean) => void;\r\n    isMissionModalOpen: boolean;\r\n    setIsMissionModalOpen: (isOpen: boolean) => void;\r\n}\r\n\r\n\r\n// ...\r\n\r\nexport const MainLayout: React.FC<MainLayoutProps> = ({\r\n    children,\r\n    isSummaryModalOpen,\r\n    setIsSummaryModalOpen,\r\n    isMissionModalOpen,\r\n    setIsMissionModalOpen\r\n}) => {\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    // Derive activeTab from URL\r\n    // e.g. /dashboard -> dashboard, / -> dashboard\r\n    const path = location.pathname.substring(1);\r\n    const activeTab = path || 'dashboard';\r\n\r\n    const onTabChange = (tab: string) => {\r\n        navigate(`/${tab}`);\r\n    };\r\n\r\n    const { activeFocus, syncStatus, zenMode, toggleZenMode, clearSyncQueue } = useStudy(); // removed unused vars like themes/goals/tasks/gamification as they are now in the hook or not needed\r\n    const { user, logout } = useAuth();\r\n    const { isIOS, isPWA, safeAreaTopClass, safeAreaBottomClass } = useDevice();\r\n    const [time, setTime] = useState(new Date());\r\n    const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n\r\n    // Use Layout Modals Hook\r\n    const modals = useLayoutModals(!!activeFocus, setIsSummaryModalOpen, isMissionModalOpen, setIsMissionModalOpen);\r\n\r\n    // Auto-close overlaying UI when Focus Mode starts (logic moved to hook mostly, but sidebar/mobilemenu manual handling might be needed if not in hook)\r\n    // Hook handles: summary, mission, task, goal, theme, sidebar.\r\n    // We still have MobileMenu here.\r\n    useEffect(() => {\r\n        if (activeFocus) {\r\n            setIsMobileMenuOpen(false);\r\n        }\r\n    }, [activeFocus]);\r\n\r\n\r\n    useEffect(() => {\r\n        const timer = setInterval(() => setTime(new Date()), 1000);\r\n        return () => clearInterval(timer);\r\n    }, []);\r\n\r\n    // Scroll Detection for Header\r\n    const mainRef = useRef<HTMLDivElement>(null);\r\n    const [isHeaderVisible, setIsHeaderVisible] = useState(true);\r\n    const lastScrollY = useRef(0);\r\n\r\n    useEffect(() => {\r\n        const handleScroll = () => {\r\n            const currentScrollY = mainRef.current?.scrollTop || 0;\r\n\r\n            // Header only visible at the very top to avoid clashing with sticky subtitles/calendar\r\n            if (currentScrollY < 10) {\r\n                setIsHeaderVisible(true);\r\n            } else if (currentScrollY > lastScrollY.current + 50) {\r\n                // Large down scroll always hides\r\n                setIsHeaderVisible(false);\r\n            } else if (currentScrollY < lastScrollY.current - 100) {\r\n                // Only show on significant up-scroll if we want that, \r\n                // but user asked to \"oculte o de cima\", so we'll keep it hidden except at top.\r\n                setIsHeaderVisible(false);\r\n            }\r\n\r\n            lastScrollY.current = currentScrollY;\r\n        };\r\n\r\n        const mainElement = mainRef.current;\r\n        if (mainElement) {\r\n            mainElement.addEventListener('scroll', handleScroll, { passive: true });\r\n        }\r\n\r\n        return () => {\r\n            if (mainElement) {\r\n                mainElement.removeEventListener('scroll', handleScroll);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const { settings: pomoSettings, isActive, mode } = usePomodoroContext();\r\n    const { startAudio, stopAudio, isPlaying } = useAudio();\r\n\r\n    // Auto-start/stop audio based on Pomodoro state\r\n    const prevIsActive = useRef(isActive);\r\n    useEffect(() => {\r\n        // DISABLED: Auto-start audio - users can manually enable in Pomodoro widget\r\n        // if (isActive && mode === 'focus' && !prevIsActive.current) {\r\n        //     startAudio();\r\n        // }\r\n        // When focus session stops (isActive goes from true to false)\r\n        if (!isActive && prevIsActive.current && isPlaying) {\r\n            stopAudio();\r\n        }\r\n        prevIsActive.current = isActive;\r\n    }, [isActive, mode, startAudio, stopAudio, isPlaying]);\r\n\r\n    const isStrictFocus = pomoSettings.strictMode && isActive && mode === 'focus';\r\n    const showSidebar = (!zenMode && !isStrictFocus) && (modals.state.isSidebarOpen || window.innerWidth >= 768);\r\n\r\n    return (\r\n        <div className=\"flex h-screen bg-slate-950 text-slate-100 overflow-hidden relative\" style={{ scrollbarGutter: 'stable' }}>\r\n\r\n            {/* Sidebar Desktop */}\r\n            <Sidebar\r\n                activeTab={activeTab}\r\n                onTabChange={onTabChange}\r\n                zenMode={zenMode}\r\n                user={user}\r\n                logout={logout}\r\n                showSidebar={showSidebar}\r\n            />\r\n\r\n            {/* Main Content */}\r\n            <div className=\"flex-1 flex flex-col h-full overflow-hidden relative\">\r\n                {/* Header */}\r\n                <Header\r\n                    isPWA={isPWA}\r\n                    isIOS={isIOS}\r\n                    safeAreaTopClass={safeAreaTopClass}\r\n                    isHeaderVisible={isHeaderVisible}\r\n                    isMobileMenuOpen={isMobileMenuOpen}\r\n                    setIsMobileMenuOpen={setIsMobileMenuOpen}\r\n                    zenMode={zenMode}\r\n                    toggleZenMode={toggleZenMode}\r\n                    setIsMissionModalOpen={modals.actions.setIsMissionModalOpen} // Use action from hook\r\n                    setIsSummaryModalOpen={setIsSummaryModalOpen}\r\n                    setIsTaskModalOpen={modals.actions.setIsTaskModalOpen} // Use action from hook\r\n                    setIsSidebarOpen={modals.actions.setIsSidebarOpen}\r\n                    setIsThemeModalOpen={modals.actions.setIsThemeModalOpen}\r\n                    syncStatus={syncStatus}\r\n                    clearSyncQueue={clearSyncQueue}\r\n                    time={time}\r\n                    user={user}\r\n                    onTabChange={onTabChange}\r\n                    logout={logout}\r\n                />\r\n\r\n                {/* Modals */}\r\n                <LayoutModals\r\n                    modals={modals}\r\n                    isSummaryModalOpen={isSummaryModalOpen}\r\n                    setIsSummaryModalOpen={setIsSummaryModalOpen}\r\n                    zenMode={zenMode}\r\n                />\r\n\r\n\r\n\r\n                {/* Scrollable Area */}\r\n                <main\r\n                    ref={mainRef}\r\n                    className={cn(\r\n                        \"flex-1 overflow-y-scroll custom-scrollbar overscroll-none px-4 md:px-8 relative\",\r\n                        isPWA && isIOS ? \"pt-24 pb-32\" : \"pt-20 pb-24 md:pb-8\", // Adjust usage padding\r\n                        safeAreaBottomClass // Ensure content doesn't get cut by home bar\r\n                    )}\r\n                >\r\n                    {/* Zen Mode Backdrop Override */}\r\n                    {zenMode && <div className=\"fixed inset-0 bg-slate-950/20 backdrop-grayscale pointer-events-none z-0\" />}\r\n\r\n                    <div className=\"max-w-6xl mx-auto w-full relative z-10 h-full flex flex-col\">\r\n                        {children}\r\n                    </div>\r\n                </main>\r\n\r\n                {/* Mobile Bottom Navigation (Visible only on mobile) */}\r\n                <div className={cn(\"md:hidden\", safeAreaBottomClass)}>\r\n                    <MobileBottomNav\r\n                        activeTab={activeTab}\r\n                        onTabChange={onTabChange}\r\n                        onOpenMission={() => modals.actions.setIsMissionModalOpen(true)}\r\n                    />\r\n                </div>\r\n\r\n                {/* Hints */}\r\n                <InstallPWAHint />\r\n\r\n                {/* Global Action Bar */}\r\n                <GlobalActionBar />\r\n                <PomodoroWidget />\r\n\r\n            </div >\r\n        </div >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\lib\\srs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\lib\\storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\lib\\validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\pages\\LandingPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Check' is defined but never used.","line":8,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ArrowRight' is defined but never used.","line":8,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'y2' is assigned a value but never used.","line":17,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":13},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":204,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12209,12212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12209,12212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":214,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12724,12727],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12724,12727],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { motion, useScroll, useTransform } from 'framer-motion';\r\n// Note: App.tsx uses simple state 'activeTab' inside AppContent, but top level Auth render is binary (Login or App).\r\n// We will need to adjust App.tsx to support Landing -> Login routing. For now, let's build the component.\r\n\r\n// Icons\r\nimport {\r\n    Zap, Brain, Shield, Rocket, Check, ArrowRight,\r\n    Layout, Calendar, Target, Github, Instagram, Twitter\r\n} from 'lucide-react';\r\n\r\nexport const LandingPage = ({ onGetStarted }: { onGetStarted: () => void }) => {\r\n\r\n    // Scroll Parallax\r\n    const { scrollY } = useScroll();\r\n    const y1 = useTransform(scrollY, [0, 500], [0, 200]);\r\n    const y2 = useTransform(scrollY, [0, 500], [0, -150]);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-950 font-sans text-slate-100 overflow-x-hidden selection:bg-blue-500/30\">\r\n\r\n            {/* --- Navbar --- */}\r\n            <nav className=\"fixed top-0 w-full z-50 bg-slate-950/80 backdrop-blur-md border-b border-white/5\">\r\n                <div className=\"max-w-7xl mx-auto px-6 h-20 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                            <span className=\"text-xl\"></span>\r\n                        </div>\r\n                        <span className=\"font-bold text-xl tracking-tight\">Reviso <span className=\"text-blue-400\">PRO</span></span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-6\">\r\n                        <button onClick={onGetStarted} className=\"hidden md:block text-slate-300 hover:text-white font-medium transition-colors\">Entrar</button>\r\n                        <button\r\n                            onClick={onGetStarted}\r\n                            className=\"bg-white text-slate-950 px-6 py-2.5 rounded-full font-bold hover:bg-blue-50 transition-all shadow-lg hover:shadow-blue-500/20\"\r\n                        >\r\n                            Comear Grtis\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n\r\n            {/* --- Hero Section --- */}\r\n            <section className=\"relative pt-32 pb-32 md:pt-48 md:pb-48 overflow-hidden\">\r\n                {/* Background FX */}\r\n                <div className=\"absolute inset-0 pointer-events-none\">\r\n                    <div className=\"absolute top-0 left-1/4 w-[500px] h-[500px] bg-blue-600/20 blur-[120px] rounded-full mix-blend-screen animate-pulse\" />\r\n                    <div className=\"absolute bottom-0 right-1/4 w-[500px] h-[500px] bg-purple-600/10 blur-[120px] rounded-full mix-blend-screen\" />\r\n                    <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 mix-blend-overlay\" />\r\n                </div>\r\n\r\n                <div className=\"max-w-7xl mx-auto px-6 relative z-10 text-center\">\r\n                    <motion.div\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ duration: 0.8 }}\r\n                    >\r\n                        <span className=\"inline-block px-4 py-1.5 rounded-full bg-blue-500/10 border border-blue-500/20 text-blue-400 font-bold text-sm mb-6 tracking-wide\">\r\n                             V 1.0 DISPONVEL AGORA\r\n                        </span>\r\n                        <h1 className=\"text-5xl md:text-7xl font-black text-white tracking-tight mb-8 leading-[1.1]\">\r\n                            Estude Menos. <br />\r\n                            <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500\">\r\n                                Aprenda 10x Mais.\r\n                            </span>\r\n                        </h1>\r\n                        <p className=\"text-xl text-slate-400 max-w-2xl mx-auto mb-10 leading-relaxed\">\r\n                            A nica plataforma que une <strong>Repetio Espaada (SRS)</strong>, Gamificao Avanada e Organizao em uma interface premiada.\r\n                        </p>\r\n\r\n                        <div className=\"flex flex-col md:flex-row items-center justify-center gap-4\">\r\n                            <button\r\n                                onClick={onGetStarted}\r\n                                className=\"w-full md:w-auto px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white rounded-2xl font-bold text-lg shadow-xl shadow-blue-500/25 transition-all hover:scale-105 flex items-center justify-center gap-2\"\r\n                            >\r\n                                <Rocket className=\"w-5 h-5\" />\r\n                                Criar Conta Gratuita\r\n                            </button>\r\n                            <a href=\"#features\" className=\"w-full md:w-auto px-8 py-4 bg-slate-800/50 hover:bg-slate-800 text-white rounded-2xl font-bold text-lg border border-white/5 transition-all flex items-center justify-center gap-2\">\r\n                                Saber Mais\r\n                            </a>\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n\r\n                {/* Hero UI Mockup */}\r\n                <motion.div\r\n                    style={{ y: y1 }}\r\n                    className=\"mt-20 max-w-6xl mx-auto px-6\"\r\n                >\r\n                    <div className=\"relative rounded-3xl border border-white/10 bg-slate-900/50 backdrop-blur-xl shadow-2xl overflow-hidden aspect-video group\">\r\n                        <div className=\"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-transparent to-purple-500/5\" />\r\n                        {/* Placeholder for App Screenshot */}\r\n                        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                            <div className=\"text-center\">\r\n                                <span className=\"text-6xl mb-4 block\"></span>\r\n                                <p className=\"text-slate-500 font-mono text-sm\">Interface do Painel Principal</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Fake UI Elements for \"feeling\" */}\r\n                        <div className=\"absolute top-8 left-8 right-8 bottom-8 border border-white/5 rounded-2xl p-6 grid grid-cols-12 gap-6 opacity-50\">\r\n                            <div className=\"col-span-3 bg-white/5 rounded-xl h-full\" />\r\n                            <div className=\"col-span-9 space-y-6\">\r\n                                <div className=\"h-32 bg-gradient-to-r from-blue-900/20 to-indigo-900/20 rounded-xl\" />\r\n                                <div className=\"grid grid-cols-3 gap-6\">\r\n                                    <div className=\"h-40 bg-white/5 rounded-xl\" />\r\n                                    <div className=\"h-40 bg-white/5 rounded-xl\" />\r\n                                    <div className=\"h-40 bg-white/5 rounded-xl\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            </section>\r\n\r\n            {/* --- Features Grid --- */}\r\n            <section id=\"features\" className=\"py-32 bg-slate-950 relative\">\r\n                <div className=\"max-w-7xl mx-auto px-6\">\r\n                    <div className=\"text-center mb-24\">\r\n                        <h2 className=\"text-3xl md:text-5xl font-black text-white mb-6\">Tudo que voc precisa.</h2>\r\n                        <p className=\"text-slate-400 text-lg\">Esquea planilhas e apps complicados.</p>\r\n                    </div>\r\n\r\n                    <div className=\"grid md:grid-cols-3 gap-8\">\r\n                        <FeatureCard\r\n                            icon={<Brain className=\"w-8 h-8 text-pink-400\" />}\r\n                            title=\"SRS Inteligente\"\r\n                            desc=\"O algoritmo agenda suas revises automaticamente (1, 7, 15, 30 dias). Nunca mais esquea o que estudou.\"\r\n                        />\r\n                        <FeatureCard\r\n                            icon={<Zap className=\"w-8 h-8 text-amber-400\" />}\r\n                            title=\"Gamificao Real\"\r\n                            desc=\"Ganhe XP, suba de nvel e desbloqueie conquistas. Estudar vira um jogo viciante.\"\r\n                        />\r\n                        <FeatureCard\r\n                            icon={<Layout className=\"w-8 h-8 text-emerald-400\" />}\r\n                            title=\"Organizao Visual\"\r\n                            desc=\"Temas, subtemas e matrias organizados em um painel lindo e intuitivo.\"\r\n                        />\r\n                        <FeatureCard\r\n                            icon={<Target className=\"w-8 h-8 text-blue-400\" />}\r\n                            title=\"Metas & Hbitos\"\r\n                            desc=\"Defina objetivos claros e acompanhe seu progresso dirio com grficos detalhados.\"\r\n                        />\r\n                        <FeatureCard\r\n                            icon={<Calendar className=\"w-8 h-8 text-purple-400\" />}\r\n                            title=\"Agenda Automtica\"\r\n                            desc=\"Saiba exatamente o que revisar hoje. O sistema monta seu cronograma sozinho.\"\r\n                        />\r\n                        <FeatureCard\r\n                            icon={<Shield className=\"w-8 h-8 text-red-400\" />}\r\n                            title=\"Modo Zen\"\r\n                            desc=\"Bloqueie distraes e foque no contedo com nosso timer Pomodoro integrado.\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* --- CTA Section --- */}\r\n            <section className=\"py-32 relative overflow-hidden\">\r\n                <div className=\"absolute inset-0 bg-blue-900/20\" />\r\n                <div className=\"absolute inset-0 bg-gradient-to-b from-slate-950 via-transparent to-slate-950\" />\r\n\r\n                <div className=\"max-w-4xl mx-auto px-6 relative z-10 text-center\">\r\n                    <h2 className=\"text-4xl md:text-6xl font-black text-white mb-8\">\r\n                        Pronto para evoluir?\r\n                    </h2>\r\n                    <p className=\"text-xl text-slate-300 mb-12\">\r\n                        Junte-se a usurios que j transformaram sua rotina de estudos.\r\n                        Acesso completo e gratuito.\r\n                    </p>\r\n                    <button\r\n                        onClick={onGetStarted}\r\n                        className=\"px-10 py-5 bg-white text-slate-950 rounded-2xl font-black text-xl hover:scale-105 transition-transform shadow-2xl shadow-white/20\"\r\n                    >\r\n                        Comear Agora\r\n                    </button>\r\n                    <p className=\"mt-6 text-slate-500 text-sm\">No requer carto de crdito  100% Gratuito</p>\r\n                </div>\r\n            </section>\r\n\r\n            {/* --- Footer --- */}\r\n            <footer className=\"py-12 border-t border-white/5 bg-slate-950\">\r\n                <div className=\"max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-6\">\r\n                    <div className=\"flex items-center gap-2 opacity-50\">\r\n                        <span className=\"text-lg\"></span>\r\n                        <span className=\"font-bold\">Reviso PRO</span>\r\n                    </div>\r\n                    <div className=\"text-slate-500 text-sm\">\r\n                         2024 Study Panel. Construdo com  para estudantes.\r\n                    </div>\r\n                    <div className=\"flex gap-6\">\r\n                        <SocialIcon icon={<Twitter className=\"w-5 h-5\" />} />\r\n                        <SocialIcon icon={<Instagram className=\"w-5 h-5\" />} />\r\n                        <SocialIcon icon={<Github className=\"w-5 h-5\" />} />\r\n                    </div>\r\n                </div>\r\n            </footer>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst FeatureCard = ({ icon, title, desc }: { icon: any, title: string, desc: string }) => (\r\n    <div className=\"p-8 rounded-3xl bg-white/5 border border-white/5 hover:border-white/10 hover:bg-white/10 transition-all group\">\r\n        <div className=\"mb-6 p-4 rounded-2xl bg-slate-950 w-fit group-hover:scale-110 transition-transform\">\r\n            {icon}\r\n        </div>\r\n        <h3 className=\"text-xl font-bold text-white mb-3\">{title}</h3>\r\n        <p className=\"text-slate-400 leading-relaxed\">{desc}</p>\r\n    </div>\r\n);\r\n\r\nconst SocialIcon = ({ icon }: { icon: any }) => (\r\n    <a href=\"#\" className=\"text-slate-500 hover:text-white transition-colors\">\r\n        {icon}\r\n    </a>\r\n)\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\pages\\Privacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\pages\\SummaryDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\pages\\Terms.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\pwa.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\GamificationService.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'subDays' is defined but never used.","line":3,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';\r\nimport { GamificationService } from './GamificationService';\r\nimport { format, subDays } from 'date-fns';\r\n\r\ndescribe('GamificationService', () => {\r\n    beforeEach(() => {\r\n        vi.useFakeTimers();\r\n    });\r\n\r\n    afterEach(() => {\r\n        vi.useRealTimers();\r\n    });\r\n\r\n    it('should provide initial state with level 1', () => {\r\n        const state = GamificationService.getInitialState();\r\n        expect(state.level.level).toBe(1);\r\n        expect(state.level.totalXp).toBe(0);\r\n        expect(state.streak.current).toBe(1);\r\n    });\r\n\r\n    describe('awardXP', () => {\r\n        it('should increment current and total XP', () => {\r\n            const state = GamificationService.getInitialState();\r\n            const { newState } = GamificationService.awardXP(state, 100);\r\n\r\n            expect(newState.level.currentXp).toBe(100);\r\n            expect(newState.level.totalXp).toBe(100);\r\n        });\r\n\r\n        it('should level up when reaching nextLevelXp', () => {\r\n            const state = GamificationService.getInitialState();\r\n            // Initial nextLevelXp is 500\r\n            const { newState } = GamificationService.awardXP(state, 550);\r\n\r\n            expect(newState.level.level).toBe(2);\r\n            expect(newState.level.currentXp).toBe(50);\r\n            expect(newState.level.nextLevelXp).toBeGreaterThan(500);\r\n        });\r\n\r\n        it('should clamp negative XP', () => {\r\n            const state = GamificationService.getInitialState();\r\n            const { newState } = GamificationService.awardXP(state, -100);\r\n\r\n            expect(newState.level.currentXp).toBe(0);\r\n            expect(newState.level.totalXp).toBe(0);\r\n        });\r\n\r\n        it('should increment streak if awarding XP on a new day (yesterday was last login)', () => {\r\n            const today = new Date(2025, 0, 2);\r\n            const yesterday = new Date(2025, 0, 1);\r\n\r\n            vi.setSystemTime(today);\r\n            const state = GamificationService.getInitialState();\r\n            state.streak.lastLoginDate = format(yesterday, 'yyyy-MM-dd');\r\n            state.stats.lastXpDate = format(yesterday, 'yyyy-MM-dd');\r\n\r\n            const { newState } = GamificationService.awardXP(state, 100);\r\n\r\n            expect(newState.streak.current).toBe(2);\r\n            expect(newState.streak.lastLoginDate).toBe(format(today, 'yyyy-MM-dd'));\r\n        });\r\n\r\n        it('should reset streak if awarding XP after more than 1 day of gap', () => {\r\n            const today = new Date(2025, 0, 5);\r\n            const longAgo = new Date(2025, 0, 1);\r\n\r\n            vi.setSystemTime(today);\r\n            const state = GamificationService.getInitialState();\r\n            state.streak.current = 5;\r\n            state.streak.lastLoginDate = format(longAgo, 'yyyy-MM-dd');\r\n            state.stats.lastXpDate = format(longAgo, 'yyyy-MM-dd');\r\n\r\n            const { newState } = GamificationService.awardXP(state, 100);\r\n\r\n            expect(newState.streak.current).toBe(1);\r\n        });\r\n    });\r\n\r\n    describe('achievements', () => {\r\n        it('should unlock \"Primeiros Passos\" when total XP reaches 100', () => {\r\n            const state = GamificationService.getInitialState();\r\n            const { newState, newUnlock } = GamificationService.awardXP(state, 120);\r\n\r\n            expect(newUnlock?.id).toBe('first_steps');\r\n            expect(newState.achievements.some(a => a.id === 'first_steps')).toBe(true);\r\n        });\r\n\r\n        it('should not unlock same achievement twice', () => {\r\n            const state = GamificationService.getInitialState();\r\n            const { newState: state1 } = GamificationService.awardXP(state, 120);\r\n            const { newState: state2, newUnlock } = GamificationService.awardXP(state1, 20);\r\n\r\n            expect(newUnlock).toBeNull();\r\n            expect(state2.achievements.length).toBe(1);\r\n        });\r\n\r\n        it('should unlock streak achievements', () => {\r\n            const today = new Date(2025, 0, 3);\r\n            const yesterday = new Date(2025, 0, 2);\r\n            vi.setSystemTime(today);\r\n\r\n            const state = GamificationService.getInitialState();\r\n            state.streak.current = 2; // Almost there\r\n            state.streak.lastLoginDate = format(yesterday, 'yyyy-MM-dd');\r\n            state.stats.lastXpDate = format(yesterday, 'yyyy-MM-dd');\r\n\r\n            const { newState } = GamificationService.awardXP(state, 10);\r\n\r\n            expect(newState.streak.current).toBe(3);\r\n            expect(newState.achievements.some(a => a.id === 'streak_3')).toBe(true);\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\GamificationService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GameStreak' is defined but never used.","line":2,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserLevel' is defined but never used.","line":2,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":79}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { format, subDays } from 'date-fns';\r\nimport type { Achievement, GameStreak, GamificationState, GameStats, UserLevel } from '../types/gamification';\r\nimport { ACHIEVEMENTS_LIST } from '../config/gamification';\r\n\r\nexport class GamificationService {\r\n    static getToday(): string {\r\n        return format(new Date(), 'yyyy-MM-dd');\r\n    }\r\n\r\n    static getInitialState(): GamificationState {\r\n        return {\r\n            level: { level: 1, currentXp: 0, nextLevelXp: 500, totalXp: 0 },\r\n            streak: { current: 1, max: 1, lastLoginDate: this.getToday() },\r\n            achievements: [],\r\n            stats: {\r\n                reviewsCompleted: 0,\r\n                tasksCompleted: 0,\r\n                goalsCompleted: 0,\r\n                habitsCompleted: 0,\r\n                totalFocusMinutes: 0,\r\n                dailyXp: 0,\r\n                lastXpDate: this.getToday(),\r\n                dailyHistory: {}\r\n            }\r\n        };\r\n    }\r\n\r\n    static checkAchievements(currentStats: GameStats, currentLevel: number, currentStreak: number, currentAchievements: Achievement[]): Achievement[] {\r\n        const unlocked: Achievement[] = [];\r\n\r\n        ACHIEVEMENTS_LIST.forEach(config => {\r\n            // Skip if already unlocked\r\n            if (currentAchievements && currentAchievements.some(a => a.id === config.id)) return;\r\n\r\n            let conditionMet = false;\r\n            const { type, target } = config.condition;\r\n\r\n            switch (type) {\r\n                case 'xp':\r\n                    // We don't have total XP in stats easily accessible without full state, \r\n                    // but usually 'xp' achievements are checked against level or total.\r\n                    // For safety, let's assume 'xp' target means Total XP here or just ignore if data missing\r\n                    // Actually, let's map 'xp' to Level checks for simplicity or remove XP achievements if vague.\r\n                    // Or check external stat if we had it.\r\n                    // Implementation Detail: We'll skip 'xp' here and rely on awardXP checking it.\r\n                    break;\r\n                case 'reviews':\r\n                    conditionMet = currentStats.reviewsCompleted >= target;\r\n                    break;\r\n                case 'tasks':\r\n                    conditionMet = currentStats.tasksCompleted >= target;\r\n                    break;\r\n                case 'streak':\r\n                    conditionMet = currentStreak >= target;\r\n                    break;\r\n            }\r\n\r\n            if (conditionMet) {\r\n                unlocked.push({\r\n                    ...config,\r\n                    unlockedAt: new Date().toISOString()\r\n                });\r\n            }\r\n        });\r\n\r\n        return unlocked;\r\n    }\r\n\r\n    static updateStats(state: GamificationState, updates: Partial<GameStats>): { newState: GamificationState, newUnlock: Achievement | null } {\r\n        const today = this.getToday();\r\n        const currentStats = { ...state.stats };\r\n\r\n        // Daily XP Reset\r\n        if (currentStats.lastXpDate !== today) {\r\n            currentStats.dailyXp = 0;\r\n            currentStats.lastXpDate = today;\r\n        }\r\n\r\n        const newStats = { ...currentStats, ...updates };\r\n        if (!newStats.dailyHistory) newStats.dailyHistory = {};\r\n\r\n        const newUnlocks = this.checkAchievements(newStats, state.level.level, state.streak?.current || 1, state.achievements || []);\r\n\r\n        return {\r\n            newState: {\r\n                ...state,\r\n                stats: newStats,\r\n                achievements: [...(state.achievements || []), ...newUnlocks]\r\n            },\r\n            newUnlock: newUnlocks.length > 0 ? newUnlocks[0] : null\r\n        };\r\n    }\r\n\r\n    static checkStreak(state: GamificationState): { newState: GamificationState, newUnlock: Achievement | null } {\r\n        const today = this.getToday();\r\n        const streak = { ...state.streak };\r\n        const yesterday = format(subDays(new Date(), 1), 'yyyy-MM-dd');\r\n\r\n        // Check if already updated today\r\n        if (streak.lastLoginDate === today) {\r\n            return { newState: state, newUnlock: null };\r\n        }\r\n\r\n        // Logic\r\n        if (streak.lastLoginDate === yesterday) {\r\n            streak.current += 1;\r\n            streak.max = Math.max(streak.current, streak.max);\r\n        } else {\r\n            // Only reset if it's strictly older than yesterday (missed a day)\r\n            // If it's empty/null (new user), we treat as 1\r\n            streak.current = 1;\r\n        }\r\n        streak.lastLoginDate = today;\r\n\r\n        // Reset Daily Stats\r\n        const stats = { ...state.stats };\r\n        if (stats.lastXpDate !== today) {\r\n            stats.dailyXp = 0;\r\n            stats.lastXpDate = today;\r\n        }\r\n\r\n        // Check Achievements (e.g. 7 day streak)\r\n        const newUnlocks = this.checkAchievements(stats, state.level.level, streak.current, state.achievements || []);\r\n\r\n        return {\r\n            newState: {\r\n                ...state,\r\n                streak,\r\n                stats,\r\n                achievements: [...(state.achievements || []), ...newUnlocks]\r\n            },\r\n            newUnlock: newUnlocks.length > 0 ? newUnlocks[0] : null\r\n        };\r\n    }\r\n\r\n    static awardXP(state: GamificationState, amount: number): { newState: GamificationState, newUnlock: Achievement | null } {\r\n        // 1. First ensure streak/day is up to date\r\n        const { newState: stateWithStreak, newUnlock: streakUnlock } = this.checkStreak(state);\r\n\r\n        let { level, currentXp, nextLevelXp, totalXp } = stateWithStreak.level;\r\n        const currentStats = { ...stateWithStreak.stats };\r\n\r\n        currentXp += amount;\r\n        totalXp += amount;\r\n\r\n        // Prevent negative XP (Clamping)\r\n        if (currentXp < 0) currentXp = 0;\r\n        if (totalXp < 0) totalXp = 0;\r\n\r\n        currentStats.dailyXp += amount;\r\n\r\n        // Level Up Checking\r\n        if (currentXp >= nextLevelXp) {\r\n            currentXp -= nextLevelXp;\r\n            level += 1;\r\n            nextLevelXp = Math.floor(nextLevelXp * 1.2); // Balanced curve\r\n        }\r\n\r\n        const newUnlocks = this.checkAchievements(currentStats, level, stateWithStreak.streak.current, stateWithStreak.achievements || []);\r\n\r\n        // Combine unlocks (Streak unlock + XP unlock)\r\n        const allUnlocks = [...newUnlocks];\r\n        if (streakUnlock) allUnlocks.push(streakUnlock);\r\n\r\n        // Also check XP specific achievements\r\n        ACHIEVEMENTS_LIST.filter(a => a.condition.type === 'xp').forEach(a => {\r\n            if (!stateWithStreak.achievements?.some(ex => ex.id === a.id) && totalXp >= a.condition.target) {\r\n                if (!allUnlocks.some(u => u.id === a.id)) {\r\n                    allUnlocks.push({ ...a, unlockedAt: new Date().toISOString() });\r\n                }\r\n            }\r\n        });\r\n\r\n        return {\r\n            newState: {\r\n                ...stateWithStreak,\r\n                level: { level, currentXp, nextLevelXp, totalXp },\r\n                stats: currentStats,\r\n                achievements: [...(stateWithStreak.achievements || []), ...allUnlocks]\r\n            },\r\n            newUnlock: allUnlocks.length > 0 ? allUnlocks[0] : null\r\n        };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\NotificationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\SRSService.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addDays' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'format' is defined but never used.","line":4,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';\r\nimport { SRSService } from './SRSService';\r\nimport type { Theme, Subtheme, Review } from '../types';\r\nimport { addDays, format } from 'date-fns';\r\n\r\ndescribe('SRSService', () => {\r\n    // Helper to create mock themes\r\n    const createMockTheme = (subthemes: Subtheme[] = []): Theme => ({\r\n        id: 'theme-1',\r\n        title: 'Test Theme',\r\n        icon: 'test',\r\n        imageUrl: 'test',\r\n        color: 'blue',\r\n        priority: 'medium',\r\n        createdAt: Date.now(),\r\n        subthemes\r\n    });\r\n\r\n    const createMockSubtheme = (id: string, status: 'queue' | 'active' | 'completed' = 'queue', reviews: Review[] = []): Subtheme => ({\r\n        id,\r\n        // theme_id removed as it is not part of Subtheme interface based on lint error\r\n        title: `Subtheme ${id}`,\r\n        status,\r\n        reviews,\r\n        introductionDate: status === 'active' ? '2025-01-01' : undefined\r\n    });\r\n\r\n    beforeEach(() => {\r\n        // Reset time before each test\r\n        vi.useFakeTimers();\r\n    });\r\n\r\n    afterEach(() => {\r\n        vi.useRealTimers();\r\n    });\r\n\r\n    describe('processDailyUpdates', () => {\r\n        it('should activate the first queued subtheme if nothing was introduced today', () => {\r\n            // Mock Today: 2025-01-01\r\n            const today = new Date(2025, 0, 1);\r\n            vi.setSystemTime(today);\r\n            const todayStr = '2025-01-01';\r\n\r\n            const sub1 = createMockSubtheme('sub-1', 'queue');\r\n            const sub2 = createMockSubtheme('sub-2', 'queue');\r\n            const themes = [createMockTheme([sub1, sub2])];\r\n\r\n            const result = SRSService.processDailyUpdates(themes, '2024-12-31');\r\n\r\n            expect(result).not.toBeNull();\r\n            expect(result?.processedDate).toBe(todayStr);\r\n\r\n            const updatedSub1 = result?.updatedThemes[0].subthemes[0];\r\n            expect(updatedSub1?.status).toBe('active');\r\n            expect(updatedSub1?.introductionDate).toBe(todayStr);\r\n            expect(updatedSub1?.reviews.length).toBe(5); // 5 Standard intervals\r\n\r\n            // Check first review date (Offset 1 day)\r\n            // If today is 2025-01-01, review 1 should be 2025-01-02\r\n            expect(updatedSub1?.reviews[0].date).toBe('2025-01-02');\r\n\r\n            // Sub 2 should remain queued\r\n            expect(result?.updatedThemes[0].subthemes[1].status).toBe('queue');\r\n        });\r\n\r\n        it('should NOT activate anything if a subtheme was already introduced today', () => {\r\n            const today = new Date(2025, 0, 1);\r\n            vi.setSystemTime(today);\r\n            const todayStr = '2025-01-01';\r\n\r\n            // Subtheme already active introduced today\r\n            const sub1 = createMockSubtheme('sub-1', 'active');\r\n            sub1.introductionDate = todayStr;\r\n            const sub2 = createMockSubtheme('sub-2', 'queue');\r\n\r\n            const themes = [createMockTheme([sub1, sub2])];\r\n\r\n            const result = SRSService.processDailyUpdates(themes, '2024-12-31');\r\n\r\n            // Should return null (no updates needed) or just date update if date was old?\r\n            // The service returns null if today matches OR hasIntroToday.\r\n            // If hasIntroToday but lastProcessed is old, it returns themes unchanged but new date.\r\n\r\n            expect(result).not.toBeNull();\r\n            expect(result?.updatedThemes).toEqual(themes); // Content check, not reference\r\n            expect(result?.processedDate).toBe(todayStr);\r\n        });\r\n\r\n        it('should calculate correct intervals [1, 3, 10, 18, 33]', () => {\r\n            const today = new Date(2025, 0, 1);\r\n            vi.setSystemTime(today);\r\n\r\n            const sub1 = createMockSubtheme('sub-1', 'queue');\r\n            const themes = [createMockTheme([sub1])];\r\n\r\n            const result = SRSService.processDailyUpdates(themes, '2024-12-31');\r\n            const reviews = result?.updatedThemes[0].subthemes[0].reviews;\r\n\r\n            if (!reviews) throw new Error('Reviews not created');\r\n\r\n            // Expected Dates based on 2025-01-01\r\n            // +1  -> 2025-01-02\r\n            // +3  -> 2025-01-04\r\n            // +10 -> 2025-01-11\r\n            // +18 -> 2025-01-19\r\n            // +33 -> 2025-02-03\r\n\r\n            expect(reviews[0].date).toBe('2025-01-02');\r\n            expect(reviews[1].date).toBe('2025-01-04');\r\n            expect(reviews[2].date).toBe('2025-01-11');\r\n            expect(reviews[3].date).toBe('2025-01-19');\r\n            expect(reviews[4].date).toBe('2025-02-03');\r\n        });\r\n\r\n        it('should handle leap years correctly (Feb 2024)', () => {\r\n            // Feb 28, 2024 (Leap year)\r\n            const date = new Date(2024, 1, 28);\r\n            vi.setSystemTime(date);\r\n\r\n            const sub1 = createMockSubtheme('sub-leap', 'queue');\r\n            const themes = [createMockTheme([sub1])];\r\n\r\n            const result = SRSService.processDailyUpdates(themes, '2024-02-27');\r\n            const reviews = result?.updatedThemes[0].subthemes[0].reviews;\r\n\r\n            if (!reviews) throw new Error('Reviews not created');\r\n\r\n            // Today is 2024-02-28\r\n            // +1 day -> 2024-02-29 (Leap day)\r\n            // +3 days -> 2024-03-02\r\n            expect(reviews[0].date).toBe('2024-02-29');\r\n            expect(reviews[1].date).toBe('2024-03-02');\r\n        });\r\n\r\n        it('should only activate one subtheme per day even across multiple themes', () => {\r\n            const today = new Date(2025, 0, 1);\r\n            vi.setSystemTime(today);\r\n\r\n            const theme1 = createMockTheme([createMockSubtheme('t1-s1', 'queue')]);\r\n            const theme2 = createMockTheme([createMockSubtheme('t2-s1', 'queue')]);\r\n            theme2.id = 'theme-2';\r\n\r\n            const result = SRSService.processDailyUpdates([theme1, theme2], '2024-12-31');\r\n\r\n            const updatedTheme1 = result?.updatedThemes.find(t => t.id === 'theme-1');\r\n            const updatedTheme2 = result?.updatedThemes.find(t => t.id === 'theme-2');\r\n\r\n            // Only one should be active\r\n            const activeCount =\r\n                (updatedTheme1?.subthemes.filter(s => s.status === 'active').length || 0) +\r\n                (updatedTheme2?.subthemes.filter(s => s.status === 'active').length || 0);\r\n\r\n            expect(activeCount).toBe(1);\r\n        });\r\n    });\r\n\r\n    describe('completeReview', () => {\r\n        it('should mark review as completed', () => {\r\n            const today = new Date(2025, 0, 2); // Review day\r\n            vi.setSystemTime(today);\r\n            const todayStr = '2025-01-02';\r\n\r\n            const review1: Review = { number: 1, date: todayStr, status: 'pending' };\r\n            const sub1 = createMockSubtheme('sub-1', 'active', [review1]);\r\n            const themes = [createMockTheme([sub1])];\r\n\r\n            const { updatedThemes, awarded } = SRSService.completeReview(themes, 'sub-1', 1);\r\n\r\n            expect(awarded).toBe(true);\r\n            const updatedSub = updatedThemes[0].subthemes[0];\r\n            expect(updatedSub.reviews[0].status).toBe('completed');\r\n        });\r\n\r\n        it('should NOT complete future reviews', () => {\r\n            const today = new Date(2025, 0, 1); // Before review day\r\n            vi.setSystemTime(today);\r\n\r\n            const review1: Review = { number: 1, date: '2025-01-02', status: 'pending' };\r\n            const sub1 = createMockSubtheme('sub-1', 'active', [review1]);\r\n            const themes = [createMockTheme([sub1])];\r\n\r\n            const { updatedThemes, awarded } = SRSService.completeReview(themes, 'sub-1', 1);\r\n\r\n            expect(awarded).toBe(false);\r\n            expect(updatedThemes[0].subthemes[0].reviews[0].status).toBe('pending');\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\SRSService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'parseISO' is defined but never used.","line":1,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { addDays, format, parseISO } from 'date-fns';\r\nimport type { Theme, Subtheme, Review } from '../types';\r\n\r\nexport class SRSService {\r\n    // Default intervals (in days) from the previous review/intro\r\n    // Review 1: +1d\r\n    // Review 2: +2d (Total +3)\r\n    // Review 3: +7d (Total +10)\r\n    // Review 4: +8d (Total +18)\r\n    // Review 5: +15d (Total +33)\r\n    private static DEFAULT_STEP_INTERVALS = [1, 2, 7, 8, 15];\r\n\r\n    static getToday(): string {\r\n        return format(new Date(), 'yyyy-MM-dd');\r\n    }\r\n\r\n    /**\r\n     * Calculates the next interval based on difficulty and current step\r\n     * Logic:\r\n     * - Hard: Step interval * 0.8 (min 1 day increase)\r\n     * - Medium: Step interval * 1.0 (standard)\r\n     * - Easy: Step interval * 1.5\r\n     */\r\n    static calculateNextInterval(stepIndex: number, difficulty: 'easy' | 'medium' | 'hard' = 'medium'): number {\r\n        const base = this.DEFAULT_STEP_INTERVALS[stepIndex] || 15;\r\n\r\n        switch (difficulty) {\r\n            case 'easy': return Math.ceil(base * 1.8);\r\n            case 'hard': return Math.max(1, Math.floor(base * 0.7));\r\n            default: return base;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates subtheme activation logic\r\n     */\r\n    static processDailyUpdates(themes: Theme[], lastProcessedDate: string): { updatedThemes: Theme[], processedDate: string } | null {\r\n        const today = this.getToday();\r\n        const hasIntroToday = themes.some(t =>\r\n            t.subthemes.some(st => st.introductionDate === today)\r\n        );\r\n\r\n        if (hasIntroToday && lastProcessedDate === today) return null;\r\n\r\n        let activated = false;\r\n        const updatedThemes = themes.map(theme => {\r\n            if (activated || hasIntroToday) return theme;\r\n\r\n            const queueIndex = theme.subthemes.findIndex(st => st.status === 'queue');\r\n            if (queueIndex !== -1) {\r\n                const subtheme = theme.subthemes[queueIndex];\r\n\r\n                // Initial reviews generation (standard medium)\r\n                let lastDate = new Date();\r\n                const reviews: Review[] = this.DEFAULT_STEP_INTERVALS.map((interval, idx) => {\r\n                    lastDate = addDays(lastDate, interval);\r\n                    return {\r\n                        number: idx + 1,\r\n                        date: format(lastDate, 'yyyy-MM-dd'),\r\n                        status: 'pending'\r\n                    };\r\n                });\r\n\r\n                const updatedSubtheme: Subtheme = {\r\n                    ...subtheme,\r\n                    status: 'active',\r\n                    introductionDate: today,\r\n                    reviews: reviews\r\n                };\r\n\r\n                const newSubthemes = [...theme.subthemes];\r\n                newSubthemes[queueIndex] = updatedSubtheme;\r\n\r\n                activated = true;\r\n                return { ...theme, subthemes: newSubthemes };\r\n            }\r\n            return theme;\r\n        });\r\n\r\n        if (activated || lastProcessedDate !== today) {\r\n            return { updatedThemes: updatedThemes, processedDate: today };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Completes a review and intelligently reschedules subsequent ones\r\n     */\r\n    static completeReview(\r\n        themes: Theme[],\r\n        subthemeId: string,\r\n        reviewNumber: number,\r\n        difficulty: 'easy' | 'medium' | 'hard' = 'medium'\r\n    ): { updatedThemes: Theme[], awarded: boolean } {\r\n        const today = new Date();\r\n        let awarded = false;\r\n\r\n        const updatedThemes = themes.map(t => ({\r\n            ...t,\r\n            subthemes: t.subthemes.map(st => {\r\n                if (st.id !== subthemeId) return st;\r\n\r\n                const reviewIdx = st.reviews.findIndex(r => r.number === reviewNumber);\r\n                if (reviewIdx === -1) return st;\r\n\r\n                // 0. Date check: Only allow completing if date is today or earlier\r\n                const review = st.reviews[reviewIdx];\r\n                if (review.date > format(today, 'yyyy-MM-dd')) return st;\r\n\r\n                const newReviews = [...st.reviews];\r\n\r\n                // 1. Mark current as completed\r\n                newReviews[reviewIdx] = {\r\n                    ...newReviews[reviewIdx],\r\n                    status: 'completed',\r\n                    completedAt: today.toISOString(),\r\n                    difficulty: difficulty\r\n                };\r\n                awarded = true;\r\n\r\n                // 2. Reschedule SUBSEQUENT reviews if any\r\n                // We take the current completion date as the new anchor\r\n                let anchorDate = today;\r\n\r\n                for (let i = reviewIdx + 1; i < newReviews.length; i++) {\r\n                    // Calculate next interval based on the difficulty of the JUST completed review\r\n                    // But wait, it's more expressive if we only apply difficulty to the IMMEDIATE next one\r\n                    // and subsequent ones keep their standard relative distance?\r\n                    // Actually, let's apply a \"shifted\" schedule.\r\n\r\n                    const nextInterval = this.calculateNextInterval(i, i === reviewIdx + 1 ? difficulty : 'medium');\r\n                    anchorDate = addDays(anchorDate, nextInterval);\r\n\r\n                    newReviews[i] = {\r\n                        ...newReviews[i],\r\n                        date: format(anchorDate, 'yyyy-MM-dd')\r\n                    };\r\n                }\r\n\r\n                const allDone = newReviews.every(r => r.status === 'completed');\r\n                return {\r\n                    ...st,\r\n                    reviews: newReviews,\r\n                    status: allDone ? 'completed' : st.status\r\n                };\r\n            })\r\n        }));\r\n\r\n        return { updatedThemes, awarded };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\SyncQueueService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[287,290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[287,290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":44,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5021,5024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5021,5024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":177,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6647,6650],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6647,6650],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":180,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":180,"endColumn":47},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":218,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8285,8288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8285,8288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9346,9349],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9346,9349],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '../lib/supabase';\r\nimport { SyncService } from './SyncService';\r\n\r\nexport interface SyncOp {\r\n    id: string; // Unique ID for the operation\r\n    type: 'ADD' | 'UPDATE' | 'DELETE';\r\n    table: 'themes' | 'tasks' | 'goals' | 'subthemes' | 'profiles';\r\n    data: any; // Payload - specific types handled by mappers\r\n    timestamp: number;\r\n    retryCount: number;\r\n    lastError?: string;\r\n    nextRetryTime?: number;\r\n    dependentOn?: string;\r\n}\r\n\r\nconst QUEUE_STORAGE_KEY = 'sync_queue_v1';\r\nconst QUEUE_VERSION = 'v2'; // Bump to invalidate old queues\r\nconst MAX_RETRIES = 5;\r\n\r\nexport class SyncQueueService {\r\n    private static queue: SyncOp[] = [];\r\n    private static isProcessing = false;\r\n    private static statusListeners: ((status: 'synced' | 'syncing' | 'offline' | 'error') => void)[] = [];\r\n\r\n    // --- Queue Management ---\r\n\r\n    static loadQueue() {\r\n        const saved = localStorage.getItem(QUEUE_STORAGE_KEY);\r\n        const savedVersion = localStorage.getItem('sync_queue_version');\r\n\r\n        // Version Check: If version mismatch, nuke the queue to prevent stuck poison pills\r\n        if (savedVersion !== QUEUE_VERSION) {\r\n            console.log(\"SyncQueue: Version mismatch or first run. Clearing old queue.\");\r\n            this.clearQueue();\r\n            localStorage.setItem('sync_queue_version', QUEUE_VERSION);\r\n            return;\r\n        }\r\n\r\n        if (saved) {\r\n            try {\r\n                this.queue = JSON.parse(saved);\r\n                // Sanitize: Remove potentially corrupted ops with null data\r\n                this.queue = this.queue.filter(op => op && op.data);\r\n            } catch (e) {\r\n                this.queue = [];\r\n            }\r\n        }\r\n    }\r\n\r\n    static saveQueue() {\r\n        localStorage.setItem(QUEUE_STORAGE_KEY, JSON.stringify(this.queue));\r\n        this.notifyStatus();\r\n    }\r\n\r\n    static clearQueue() {\r\n        this.queue = [];\r\n        this.saveQueue();\r\n    }\r\n\r\n    static enqueue(op: Omit<SyncOp, 'id' | 'timestamp' | 'retryCount'> & { id?: string }) {\r\n        const operation: SyncOp = {\r\n            ...op,\r\n            id: op.id || crypto.randomUUID(),\r\n            timestamp: Date.now(),\r\n            retryCount: 0\r\n        };\r\n\r\n        this.queue.push(operation);\r\n        this.saveQueue();\r\n        this.processQueue(); // Try to process immediately\r\n    }\r\n\r\n    // --- Processing ---\r\n\r\n    static removeDependentOps(parentId: string) {\r\n        // Filter out any operations that depend on the failed parentId\r\n        const initialLength = this.queue.length;\r\n        this.queue = this.queue.filter(op => op.dependentOn !== parentId);\r\n        if (this.queue.length !== initialLength) {\r\n            this.saveQueue();\r\n        }\r\n    }\r\n\r\n    private static isFatalError(error: { message?: string, code?: string }): boolean {\r\n        // Check for common fatal Supabase/Postgres errors\r\n        // 23505: Unique violation (already exists) - We should probably assume success or skip\r\n        // 23503: Foreign key violation (parent doesn't exist) - If parent creation failed, this is fatal.\r\n        // 400: Bad Request (Validation failed)\r\n        // 401: Unauthorized (RLS) - Maybe not fatal if token refreshes? But often is.\r\n        // 409: Conflict\r\n\r\n        const msg = error.message || '';\r\n        const code = error.code || '';\r\n\r\n        if (code === '23505') return true; // Unique violation\r\n        if (code === '23503') return true; // FK violation\r\n        if (code === '42P01') return true; // Undefined table\r\n        if (code === '42703') return true; // Undefined column (e.g. user_id in subthemes)\r\n        if (msg.includes('duplicate key value')) return true;\r\n        if (msg.includes('violates foreign key constraint')) return true;\r\n        if (msg.includes('Could not find the')) return true; // Schema cache error\r\n\r\n        return false;\r\n    }\r\n\r\n    static async processQueue() {\r\n        if (this.isProcessing) return;\r\n        if (this.queue.length === 0) {\r\n            this.notifyStatus();\r\n            return;\r\n        }\r\n\r\n        if (!navigator.onLine) {\r\n            this.notifyStatus();\r\n            return;\r\n        }\r\n\r\n        this.isProcessing = true;\r\n        this.notifyStatus();\r\n\r\n        // Process one by one (Sequential to preserve order/dependencies)\r\n        while (this.queue.length > 0 && navigator.onLine) {\r\n            const op = this.queue[0];\r\n\r\n            // Check Backoff\r\n            if (op.nextRetryTime && Date.now() < op.nextRetryTime) {\r\n                // Not ready yet (Backoff active)\r\n                // Set a timer to wake up logic when backoff expires\r\n                setTimeout(() => this.processQueue(), op.nextRetryTime - Date.now() + 100);\r\n                break; // Stop processing for now\r\n            }\r\n\r\n            try {\r\n                await this.executeOp(op);\r\n\r\n                // If success, remove from queue\r\n                this.queue.shift();\r\n                this.saveQueue();\r\n            } catch (error: any) {\r\n                console.error(\"SyncOp Failed:\", error);\r\n\r\n                // Check for Fatal Error\r\n                if (this.isFatalError(error)) {\r\n                    console.warn(`SyncQueue: Fatal error handling op ${op.id} (${op.type} ${op.table}). Dropping and cleaning dependencies.`);\r\n                    this.queue.shift(); // Remove failed op\r\n                    this.removeDependentOps(op.id); // Remove dependents\r\n                    this.saveQueue();\r\n                    continue; // Determine next op immediately\r\n                }\r\n\r\n                op.retryCount++;\r\n                op.lastError = error.message || 'Unknown error';\r\n\r\n                if (op.retryCount >= MAX_RETRIES) {\r\n                    // Max Retries Reached - Drop it\r\n                    this.queue.shift();\r\n                    this.removeDependentOps(op.id); // Also remove dependents if parent timed out\r\n                } else {\r\n                    // Exponential Backoff\r\n                    const delay = Math.min(1000 * Math.pow(2, op.retryCount), 30000);\r\n                    op.nextRetryTime = Date.now() + delay;\r\n                    this.saveQueue();\r\n\r\n                    // Schedule next try\r\n                    setTimeout(() => this.processQueue(), delay);\r\n                    break; // Stop processing loop to respect backoff\r\n                }\r\n                this.saveQueue();\r\n            }\r\n        }\r\n\r\n        this.isProcessing = false;\r\n        this.notifyStatus();\r\n    }\r\n\r\n    // Helper to strip undefined values so partial updates work\r\n    private static cleanPayload(payload: Record<string, any>) {\r\n        if (!payload) return {};\r\n        return Object.fromEntries(\r\n            Object.entries(payload).filter(([_, v]) => v !== undefined)\r\n        );\r\n    }\r\n\r\n    static async executeOp(op: SyncOp) {\r\n        // CONFLICT CHECK (Simplified)\r\n        if (op.type === 'UPDATE' && op.data.id) {\r\n            const { data: serverResult } = await supabase.from(op.table).select('updated_at').eq('id', op.data.id).single();\r\n            if (serverResult && serverResult.updated_at) {\r\n                // ... (logic comment maintained)\r\n            }\r\n        }\r\n\r\n        let result;\r\n\r\n        if (op.type === 'ADD') {\r\n            const payload = this.cleanPayload(this.preparePayload(op.table, op.data));\r\n            result = await supabase.from(op.table).insert(payload);\r\n        } else if (op.type === 'UPDATE') {\r\n            const rawPayload = this.preparePayload(op.table, op.data);\r\n            const payload = this.cleanPayload(rawPayload);\r\n\r\n            // Don't update ID or created_at usually\r\n            delete payload.id;\r\n            delete payload.created_at;\r\n            // Always update 'updated_at' to now if not present? Supabase might handle it.\r\n\r\n            result = await supabase.from(op.table).update(payload).eq('id', op.data.id);\r\n        } else if (op.type === 'DELETE') {\r\n            result = await supabase.from(op.table).delete().eq('id', op.data.id);\r\n        }\r\n\r\n        if (result?.error) {\r\n            throw new Error(result.error.message);\r\n        }\r\n    }\r\n\r\n    // Helper to map generic types to DB columns using SyncService\r\n    private static preparePayload(table: string, data: any) {\r\n        if (!data) return {}; // Guard against null data passed to mappers\r\n        // We reuse SyncService static methods if possible\r\n\r\n        switch (table) {\r\n            case 'tasks': return SyncService.mapTaskToDb(data);\r\n            case 'goals': return SyncService.mapGoalToDb(data);\r\n            case 'themes': return SyncService.mapThemeToDb(data);\r\n            case 'subthemes': return SyncService.mapSubthemeToDb(data);\r\n            case 'profiles': return data;\r\n            default: return data;\r\n        }\r\n    }\r\n\r\n    // --- Status ---\r\n\r\n    static getStatus(): 'synced' | 'syncing' | 'offline' | 'error' {\r\n        if (!navigator.onLine) return 'offline';\r\n        // Only show 'error' if we've retried multiple times (persistent failure)\r\n        // Transient failures (retryCount <= 3) will show as 'syncing'\r\n        if (this.queue.some(op => op.retryCount > 3)) return 'error';\r\n        if (this.queue.length > 0 || this.isProcessing) return 'syncing';\r\n        return 'synced';\r\n    }\r\n\r\n    static subscribe(listener: (status: any) => void) {\r\n        this.statusListeners.push(listener);\r\n        listener(this.getStatus());\r\n        return () => {\r\n            this.statusListeners = this.statusListeners.filter(l => l !== listener);\r\n        };\r\n    }\r\n\r\n    private static notifyStatus() {\r\n        const s = this.getStatus();\r\n        this.statusListeners.forEach(l => l(s));\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\services\\SyncService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'supabase' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[230,233],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[230,233],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":116,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":116,"endColumn":23}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '../lib/supabase';\r\nimport type { Task, Goal, Theme, Subtheme } from '../types';\r\n\r\nexport interface SyncItem {\r\n    id: string;\r\n    table: string;\r\n    action: 'insert' | 'update' | 'delete';\r\n    data: any;\r\n    priority: number;\r\n    attempts: number;\r\n    lastAttempt?: number;\r\n}\r\n\r\nexport class SyncService {\r\n    private queue: SyncItem[] = [];\r\n    private isProcessing = false;\r\n    private maxAttempts = 5;\r\n    private storageKey = 'sync_queue_v2';\r\n\r\n    constructor() {\r\n        this.loadQueue();\r\n        if (typeof window !== 'undefined') {\r\n            window.addEventListener('online', () => this.processQueue());\r\n        }\r\n    }\r\n\r\n    // --- Static Mappers (Restored for SyncQueueService) ---\r\n\r\n    static mapTaskToDb(task: Task & { user_id?: string }) {\r\n        return {\r\n            id: task.id,\r\n            title: task.title,\r\n            type: task.type,\r\n            status: task.status,\r\n            priority: task.priority,\r\n            date: task.date,\r\n            start_date: task.startDate,\r\n            end_date: task.endDate,\r\n            recurrence: task.recurrence,\r\n            image_url: task.imageUrl,\r\n            duration_minutes: task.durationMinutes,\r\n            time_spent: task.timeSpent,\r\n            completion_history: task.completionHistory,\r\n            sessions: task.sessions,\r\n            summaries: task.summaries,\r\n            user_id: task.user_id\r\n        };\r\n    }\r\n\r\n    static mapGoalToDb(goal: Goal & { user_id?: string }) {\r\n        return {\r\n            id: goal.id,\r\n            title: goal.title,\r\n            type: goal.type,\r\n            category: goal.category,\r\n            progress: goal.progress,\r\n            priority: goal.priority,\r\n            deadline: goal.deadline,\r\n            image_url: goal.imageUrl,\r\n            duration_minutes: goal.durationMinutes,\r\n            time_spent: goal.timeSpent,\r\n            completion_history: goal.completionHistory,\r\n            checklist: goal.checklist,\r\n            summaries: goal.summaries,\r\n            user_id: goal.user_id,\r\n            related_theme_id: goal.relatedThemeId,\r\n            is_habit: goal.isHabit,\r\n            start_date: goal.startDate,\r\n            recurrence: goal.recurrence\r\n        };\r\n    }\r\n\r\n    static mapThemeToDb(theme: Theme & { user_id?: string }) {\r\n        return {\r\n            id: theme.id,\r\n            title: theme.title,\r\n            icon: theme.icon,\r\n            color: theme.color,\r\n            category: theme.category,\r\n            start_date: theme.startDate,\r\n            deadline: theme.deadline,\r\n            notification_time: theme.notificationTime,\r\n            image_url: theme.imageUrl,\r\n            priority: theme.priority,\r\n            summaries: theme.summaries,\r\n            user_id: theme.user_id\r\n        };\r\n    }\r\n\r\n    static mapSubthemeToDb(sub: Subtheme & { theme_id?: string; user_id?: string }) {\r\n        return {\r\n            id: sub.id,\r\n            theme_id: sub.theme_id,\r\n            title: sub.title,\r\n            status: sub.status,\r\n            introduction_date: sub.introductionDate,\r\n            reviews: sub.reviews,\r\n            duration_minutes: sub.durationMinutes,\r\n            time_spent: sub.timeSpent,\r\n            difficulty: sub.difficulty,\r\n            text_content: sub.text_content,\r\n            summaries: sub.summaries,\r\n            user_id: sub.user_id,\r\n            order_index: sub.order_index\r\n        };\r\n    }\r\n\r\n    // --- Instance Methods for New Resilient Sync (to be integrated or used by SyncQueueService) ---\r\n\r\n    private loadQueue() {\r\n        if (typeof localStorage === 'undefined') return;\r\n        const saved = localStorage.getItem(this.storageKey);\r\n        if (saved) {\r\n            try {\r\n                this.queue = JSON.parse(saved);\r\n            } catch (e) {\r\n                this.queue = [];\r\n            }\r\n        }\r\n    }\r\n\r\n    private saveQueue() {\r\n        if (typeof localStorage === 'undefined') return;\r\n        localStorage.setItem(this.storageKey, JSON.stringify(this.queue));\r\n    }\r\n\r\n    async enqueue(item: Omit<SyncItem, 'attempts' | 'lastAttempt'>) {\r\n        this.queue.push({ ...item, attempts: 0 });\r\n        this.saveQueue();\r\n        this.processQueue();\r\n    }\r\n\r\n    private async processQueue() {\r\n        if (this.isProcessing || this.queue.length === 0 || !navigator.onLine) return;\r\n        this.isProcessing = true;\r\n        // Logic for processing queue would go here if we used this instance\r\n        this.isProcessing = false;\r\n    }\r\n}\r\n\r\nexport const syncService = new SyncService();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\setupTests.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[134,137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[134,137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import '@testing-library/jest-dom';\r\nimport { vi } from 'vitest';\r\n\r\n// Fix for ResizeObserver not being defined in jsdom\r\n(global as any).ResizeObserver = vi.fn().mockImplementation(() => ({\r\n    observe: vi.fn(),\r\n    unobserve: vi.fn(),\r\n    disconnect: vi.fn(),\r\n}));\r\n\r\n// Fix for window.matchMedia not being defined in jsdom\r\nObject.defineProperty(window, 'matchMedia', {\r\n    writable: true,\r\n    value: vi.fn().mockImplementation(query => ({\r\n        matches: false,\r\n        media: query,\r\n        onchange: null,\r\n        addListener: vi.fn(), // deprecated\r\n        removeListener: vi.fn(), // deprecated\r\n        addEventListener: vi.fn(),\r\n        removeEventListener: vi.fn(),\r\n        dispatchEvent: vi.fn(),\r\n    })),\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\types\\gamification.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\types\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[871,874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[871,874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Types Definitions\r\nexport type Priority = 'low' | 'medium' | 'high';\r\n\r\nexport interface SessionLog {\r\n    start: string; // ISO 8601\r\n    end: string;   // ISO 8601\r\n    durationMinutes: number;\r\n    status: 'completed' | 'cancelled';\r\n    summary?: string;\r\n}\r\n\r\nexport interface SummaryEntry {\r\n    id: string;\r\n    timestamp: string; // ISO 8601\r\n    type: 'review' | 'goal' | 'session' | 'completion' | 'progress' | 'note';\r\n    title?: string; // Ttulo do resumo\r\n    description?: string; // Descrio detalhada\r\n    number?: number; // Nmero da reviso (1, 2, 3) ou progresso da meta\r\n    metadata?: {\r\n        reviewNumber?: number; // Qual reviso (1-6)\r\n        goalProgress?: number; // Progresso da meta (0-100)\r\n        sessionDuration?: number; // Durao da sesso em minutos\r\n        status?: string; // Status especfico\r\n        [key: string]: any; // Metadados adicionais\r\n    };\r\n}\r\n\r\nexport interface Task {\r\n    id: string;\r\n    title: string;\r\n    status: 'pending' | 'completed';\r\n    priority: Priority;\r\n    type: 'day' | 'period' | 'recurring';\r\n    date?: string; // For day tasks (YYYY-MM-DD)\r\n    startDate?: string; // For period\r\n    endDate?: string; // For period\r\n    recurrence?: number[]; // [0, 1...6] for Sunday-Saturday\r\n    progress?: { current: number; total: number }; // For period/recurring tracking\r\n    createdAt: number;\r\n    icon?: string; // Emoji\r\n    imageUrl?: string; // Banner\r\n    color?: string;\r\n    durationMinutes?: number;\r\n    timeSpent?: number;\r\n    completionHistory?: string[]; // Dates (YYYY-MM-DD) when this was completed\r\n    sessions?: SessionLog[]; // History of focus sessions\r\n    notificationTime?: string; // HH:mm\r\n    summary?: string; // User written summary/notes\r\n    summaries?: SummaryEntry[]; // Detailed history with timestamps\r\n}\r\n\r\nexport interface Goal {\r\n    id: string;\r\n    title: string;\r\n    type: 'simple' | 'checklist' | 'habit';\r\n    category: string;\r\n    icon?: string;\r\n    imageUrl?: string; // Banner\r\n    color?: string;\r\n    checklist?: GoalItem[];\r\n    progress: number; // 0-100\r\n    isHabit?: boolean; // If converted to daily habit\r\n    startDate?: string; // YYYY-MM-DD\r\n    deadline?: string; // YYYY-MM-DD\r\n    recurrence?: number[]; // [0, 1...6] for Sunday-Saturday\r\n    createdAt: number;\r\n    durationMinutes?: number;\r\n    priority?: Priority;\r\n    timeSpent?: number;\r\n    completionHistory?: string[]; // Dates (YYYY-MM-DD) when this was completed\r\n    sessions?: SessionLog[]; // History of focus sessions\r\n    relatedThemeId?: string; // Links this goal to a Theme (Project Parent)\r\n    summary?: string; // User written summary/notes\r\n    summaries?: SummaryEntry[]; // Detailed history with timestamps and goal progress\r\n    // Newly added optional fields for detailed tracking\r\n    targetValue?: number;\r\n    currentValue?: number;\r\n    unit?: string;\r\n    // Existing recurrence already present\r\n}\r\n\r\nexport interface Theme {\r\n    id: string;\r\n    title: string;\r\n    subthemes: Subtheme[];\r\n    icon?: string; // Emoji\r\n    imageUrl?: string; // Banner\r\n    color?: string;\r\n    startDate?: string; // YYYY-MM-DD\r\n    deadline?: string; // YYYY-MM-DD\r\n    createdAt: number;\r\n    priority?: Priority;\r\n    category?: 'study' | 'project'; // 'study' = SRS/World, 'project' = Group of Goals\r\n    notificationTime?: string; // HH:mm\r\n    summary?: string; // User written summary/notes\r\n    summaries?: SummaryEntry[]; // Detailed history with timestamps\r\n    // Newly added optional field for difficulty\r\n    difficulty?: string;\r\n}\r\n\r\nexport interface Subtheme {\r\n    id: string;\r\n    theme_id?: string; // For DB linking\r\n    title: string;\r\n    status: 'queue' | 'active' | 'completed';\r\n    introductionDate?: string; // When it moved from queue to active\r\n    reviews: Review[];\r\n    durationMinutes?: number;\r\n    timeSpent?: number;\r\n    difficulty?: 'easy' | 'medium' | 'hard' | 'module' | 'beginner' | 'intermediate' | 'advanced';\r\n    text_content?: string; // Rich text content for flashcards/notes\r\n    sessions?: SessionLog[]; // History of focus sessions\r\n    summaries?: SummaryEntry[]; // Detailed history with review numbers and timestamps\r\n    order_index?: number; // Ordering\r\n    // Newly added optional fields for description and alternative text content naming\r\n    description?: string;\r\n    // Note: text_content already covers textContent; keep alias if needed elsewhere\r\n}\r\n\r\nexport interface Review {\r\n    date: string; // YYYY-MM-DD\r\n    status: 'pending' | 'completed';\r\n    number: number; // 1 to 6 (representing 0, 1, 2, 7, 15, 30)\r\n    completedAt?: string; // ISO 8601\r\n    completedBy?: string; // User ID if needed\r\n    summary?: string; // What was learned/understood\r\n    difficulty?: 'easy' | 'medium' | 'hard';\r\n}\r\n\r\nexport interface CalendarIntroItem {\r\n    id: string;\r\n    subthemeTitle: string;\r\n    themeTitle: string;\r\n    priority?: Priority;\r\n    durationMinutes?: number;\r\n}\r\n\r\nexport interface CalendarReviewItem extends Review {\r\n    id: string;\r\n    subthemeTitle: string;\r\n    themeTitle: string;\r\n    priority?: Priority;\r\n    durationMinutes?: number;\r\n    completionHistory?: string[];\r\n}\r\n\r\nexport interface CalendarTaskItem extends Task {\r\n    isCompletedToday?: boolean;\r\n}\r\n\r\nexport interface CalendarGoalItem extends Omit<Goal, 'type'> {\r\n    type: 'simple' | 'checklist' | 'habit' | 'goal-step' | 'goal-phase';\r\n    checklist_item_id?: string;\r\n    parentGoalId?: string;\r\n    parentGoalTitle?: string;\r\n    currentDay?: number;\r\n    totalDays?: number;\r\n    phaseProgress?: number;\r\n    label?: string;\r\n    isCompletedToday?: boolean;\r\n}\r\n\r\nexport interface AppState {\r\n    tasks: Task[];\r\n    goals: Goal[];\r\n    themes: Theme[];\r\n    settings: {\r\n        username: string;\r\n        focusTime: number; // minutes\r\n    };\r\n    gamification: import('./gamification').GamificationState;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\types\\summary-helpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\utils\\celebration.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[545,548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[545,548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import confetti from 'canvas-confetti';\r\n\r\n// Sound effect for completion\r\nconst successSound = new Audio('https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3'); // \"Positive Interface Beep\" or similar\r\n\r\nexport const celebrate = () => {\r\n    // 1. Play Sound\r\n    successSound.currentTime = 0;\r\n    successSound.volume = 0.4;\r\n    successSound.play().catch(() => { });\r\n\r\n    // 2. Fire Confetti\r\n    const count = 200;\r\n    const defaults = {\r\n        origin: { y: 0.7 }\r\n    };\r\n\r\n    function fire(particleRatio: number, opts: any) {\r\n        confetti({\r\n            ...defaults,\r\n            ...opts,\r\n            particleCount: Math.floor(count * particleRatio)\r\n        });\r\n    }\r\n\r\n    fire(0.25, {\r\n        spread: 26,\r\n        startVelocity: 55,\r\n    });\r\n    fire(0.2, {\r\n        spread: 60,\r\n    });\r\n    fire(0.35, {\r\n        spread: 100,\r\n        decay: 0.91,\r\n        scalar: 0.8\r\n    });\r\n    fire(0.1, {\r\n        spread: 120,\r\n        startVelocity: 25,\r\n        decay: 0.92,\r\n        scalar: 1.2\r\n    });\r\n    fire(0.1, {\r\n        spread: 120,\r\n        startVelocity: 45,\r\n    });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\utils\\dateHelpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\utils\\summaries.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luizf\\antigraty\\study-panel\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]